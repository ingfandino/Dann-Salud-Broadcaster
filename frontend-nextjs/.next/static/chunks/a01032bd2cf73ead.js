(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96877,e=>{e.v({cardAccentLight:"stats-card-module__J8wmDG__cardAccentLight",cardPrimaryLight:"stats-card-module__J8wmDG__cardPrimaryLight",cardSecondaryLight:"stats-card-module__J8wmDG__cardSecondaryLight",glowAccentLight:"stats-card-module__J8wmDG__glowAccentLight",glowPrimaryLight:"stats-card-module__J8wmDG__glowPrimaryLight",glowSecondaryLight:"stats-card-module__J8wmDG__glowSecondaryLight",iconAccentLight:"stats-card-module__J8wmDG__iconAccentLight",iconPrimaryLight:"stats-card-module__J8wmDG__iconPrimaryLight",iconSecondaryLight:"stats-card-module__J8wmDG__iconSecondaryLight",progressAccentLight:"stats-card-module__J8wmDG__progressAccentLight",progressPrimaryLight:"stats-card-module__J8wmDG__progressPrimaryLight",progressSecondaryLight:"stats-card-module__J8wmDG__progressSecondaryLight",textAccentLight:"stats-card-module__J8wmDG__textAccentLight",textPrimaryLight:"stats-card-module__J8wmDG__textPrimaryLight",textSecondaryLight:"stats-card-module__J8wmDG__textSecondaryLight"})},36657,(e,t,r)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},80807,(e,t,r)=>{"use strict";var a=e.r(36657);function n(){}function s(){}s.resetWarningCache=n,t.exports=function(){function e(e,t,r,n,s,i){if(i!==a){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:n};return r.PropTypes=r,r}},46502,(e,t,r)=>{t.exports=e.r(80807)()},93619,(e,t,r)=>{t.exports={L:1,M:0,Q:3,H:2}},51736,(e,t,r)=>{t.exports={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}},89380,(e,t,r)=>{var a=e.r(51736);function n(e){this.mode=a.MODE_8BIT_BYTE,this.data=e}n.prototype={getLength:function(e){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++)e.put(this.data.charCodeAt(t),8)}},t.exports=n},69244,(e,t,r)=>{var a=e.r(93619);function n(e,t){this.totalCount=e,this.dataCount=t}n.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],n.getRSBlocks=function(e,t){var r=n.getRsBlockTable(e,t);if(void 0==r)throw Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var a=r.length/3,s=[],i=0;i<a;i++)for(var o=r[3*i+0],l=r[3*i+1],c=r[3*i+2],d=0;d<o;d++)s.push(new n(l,c));return s},n.getRsBlockTable=function(e,t){switch(t){case a.L:return n.RS_BLOCK_TABLE[(e-1)*4+0];case a.M:return n.RS_BLOCK_TABLE[(e-1)*4+1];case a.Q:return n.RS_BLOCK_TABLE[(e-1)*4+2];case a.H:return n.RS_BLOCK_TABLE[(e-1)*4+3];default:return}},t.exports=n},72900,(e,t,r)=>{function a(){this.buffer=[],this.length=0}a.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},t.exports=a},15762,(e,t,r)=>{for(var a={glog:function(e){if(e<1)throw Error("glog("+e+")");return a.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return a.EXP_TABLE[e]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},n=0;n<8;n++)a.EXP_TABLE[n]=1<<n;for(var n=8;n<256;n++)a.EXP_TABLE[n]=a.EXP_TABLE[n-4]^a.EXP_TABLE[n-5]^a.EXP_TABLE[n-6]^a.EXP_TABLE[n-8];for(var n=0;n<255;n++)a.LOG_TABLE[a.EXP_TABLE[n]]=n;t.exports=a},97992,(e,t,r)=>{var a=e.r(15762);function n(e,t){if(void 0==e.length)throw Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}n.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var s=0;s<e.getLength();s++)t[r+s]^=a.gexp(a.glog(this.get(r))+a.glog(e.get(s)));return new n(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=a.glog(this.get(0))-a.glog(e.get(0)),r=Array(this.getLength()),s=0;s<this.getLength();s++)r[s]=this.get(s);for(var s=0;s<e.getLength();s++)r[s]^=a.gexp(a.glog(e.get(s))+t);return new n(r,0).mod(e)}},t.exports=n},37287,(e,t,r)=>{var a=e.r(51736),n=e.r(97992),s=e.r(15762),i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;i.getBCHDigit(t)-i.getBCHDigit(i.G15)>=0;)t^=i.G15<<i.getBCHDigit(t)-i.getBCHDigit(i.G15);return(e<<10|t)^i.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;i.getBCHDigit(t)-i.getBCHDigit(i.G18)>=0;)t^=i.G18<<i.getBCHDigit(t)-i.getBCHDigit(i.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return i.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case 0:return(t+r)%2==0;case 1:return t%2==0;case 2:return r%3==0;case 3:return(t+r)%3==0;case 4:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case 5:return t*r%2+t*r%3==0;case 6:return(t*r%2+t*r%3)%2==0;case 7:return(t*r%3+(t+r)%2)%2==0;default:throw Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new n([1],0),r=0;r<e;r++)t=t.multiply(new n([1,s.gexp(r)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case a.MODE_NUMBER:return 10;case a.MODE_ALPHA_NUM:return 9;case a.MODE_8BIT_BYTE:case a.MODE_KANJI:return 8;default:throw Error("mode:"+e)}if(t<27)switch(e){case a.MODE_NUMBER:return 12;case a.MODE_ALPHA_NUM:return 11;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 10;default:throw Error("mode:"+e)}if(t<41)switch(e){case a.MODE_NUMBER:return 14;case a.MODE_ALPHA_NUM:return 13;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 12;default:throw Error("mode:"+e)}throw Error("type:"+t)},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0;a<t;a++)for(var n=0;n<t;n++){for(var s=0,i=e.isDark(a,n),o=-1;o<=1;o++)if(!(a+o<0)&&!(t<=a+o))for(var l=-1;l<=1;l++)!(n+l<0)&&!(t<=n+l)&&(0!=o||0!=l)&&i==e.isDark(a+o,n+l)&&s++;s>5&&(r+=3+s-5)}for(var a=0;a<t-1;a++)for(var n=0;n<t-1;n++){var c=0;e.isDark(a,n)&&c++,e.isDark(a+1,n)&&c++,e.isDark(a,n+1)&&c++,e.isDark(a+1,n+1)&&c++,(0==c||4==c)&&(r+=3)}for(var a=0;a<t;a++)for(var n=0;n<t-6;n++)e.isDark(a,n)&&!e.isDark(a,n+1)&&e.isDark(a,n+2)&&e.isDark(a,n+3)&&e.isDark(a,n+4)&&!e.isDark(a,n+5)&&e.isDark(a,n+6)&&(r+=40);for(var n=0;n<t;n++)for(var a=0;a<t-6;a++)e.isDark(a,n)&&!e.isDark(a+1,n)&&e.isDark(a+2,n)&&e.isDark(a+3,n)&&e.isDark(a+4,n)&&!e.isDark(a+5,n)&&e.isDark(a+6,n)&&(r+=40);for(var d=0,n=0;n<t;n++)for(var a=0;a<t;a++)e.isDark(a,n)&&d++;return r+10*(Math.abs(100*d/t/t-50)/5)}};t.exports=i},15877,(e,t,r)=>{var a=e.r(89380),n=e.r(69244),s=e.r(72900),i=e.r(37287),o=e.r(97992);function l(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var c=l.prototype;c.addData=function(e){var t=new a(e);this.dataList.push(t),this.dataCache=null},c.isDark=function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw Error(e+","+t);return this.modules[e][t]},c.getModuleCount=function(){return this.moduleCount},c.make=function(){if(this.typeNumber<1){var e=1;for(e=1;e<40;e++){for(var t=n.getRSBlocks(e,this.errorCorrectLevel),r=new s,a=0,o=0;o<t.length;o++)a+=t[o].dataCount;for(var o=0;o<this.dataList.length;o++){var l=this.dataList[o];r.put(l.mode,4),r.put(l.getLength(),i.getLengthInBits(l.mode,e)),l.write(r)}if(r.getLengthInBits()<=8*a)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())},c.makeImpl=function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[r][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},c.setupPositionProbePattern=function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1)&&!(this.moduleCount<=e+r))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(0<=r&&r<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=a&&a<=4?this.modules[e+r][t+a]=!0:this.modules[e+r][t+a]=!1)},c.getBestMaskPattern=function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var a=i.getLostPoint(this);(0==r||e>a)&&(e=a,t=r)}return t},c.createMovieClip=function(e,t,r){var a=e.createEmptyMovieClip(t,r);this.make();for(var n=0;n<this.modules.length;n++)for(var s=+n,i=0;i<this.modules[n].length;i++){var o=+i;this.modules[n][i]&&(a.beginFill(0,100),a.moveTo(o,s),a.lineTo(o+1,s),a.lineTo(o+1,s+1),a.lineTo(o,s+1),a.endFill())}return a},c.setupTimingPattern=function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},c.setupPositionAdjustPattern=function(){for(var e=i.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var a=e[t],n=e[r];if(null==this.modules[a][n])for(var s=-2;s<=2;s++)for(var o=-2;o<=2;o++)-2==s||2==s||-2==o||2==o||0==s&&0==o?this.modules[a+s][n+o]=!0:this.modules[a+s][n+o]=!1}},c.setupTypeNumber=function(e){for(var t=i.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var a=!e&&(t>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=a}for(var r=0;r<18;r++){var a=!e&&(t>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=a}},c.setupTypeInfo=function(e,t){for(var r=this.errorCorrectLevel<<3|t,a=i.getBCHTypeInfo(r),n=0;n<15;n++){var s=!e&&(a>>n&1)==1;n<6?this.modules[n][8]=s:n<8?this.modules[n+1][8]=s:this.modules[this.moduleCount-15+n][8]=s}for(var n=0;n<15;n++){var s=!e&&(a>>n&1)==1;n<8?this.modules[8][this.moduleCount-n-1]=s:n<9?this.modules[8][15-n-1+1]=s:this.modules[8][15-n-1]=s}this.modules[this.moduleCount-8][8]=!e},c.mapData=function(e,t){for(var r=-1,a=this.moduleCount-1,n=7,s=0,o=this.moduleCount-1;o>0;o-=2)for(6==o&&o--;;){for(var l=0;l<2;l++)if(null==this.modules[a][o-l]){var c=!1;s<e.length&&(c=(e[s]>>>n&1)==1),i.getMask(t,a,o-l)&&(c=!c),this.modules[a][o-l]=c,-1==--n&&(s++,n=7)}if((a+=r)<0||this.moduleCount<=a){a-=r,r=-r;break}}},l.PAD0=236,l.PAD1=17,l.createData=function(e,t,r){for(var a=n.getRSBlocks(e,t),o=new s,c=0;c<r.length;c++){var d=r[c];o.put(d.mode,4),o.put(d.getLength(),i.getLengthInBits(d.mode,e)),d.write(o)}for(var u=0,c=0;c<a.length;c++)u+=a[c].dataCount;if(o.getLengthInBits()>8*u)throw Error("code length overflow. ("+o.getLengthInBits()+">"+8*u+")");for(o.getLengthInBits()+4<=8*u&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*u)&&(o.put(l.PAD0,8),!(o.getLengthInBits()>=8*u));){;o.put(l.PAD1,8)}return l.createBytes(o,a)},l.createBytes=function(e,t){for(var r=0,a=0,n=0,s=Array(t.length),l=Array(t.length),c=0;c<t.length;c++){var d=t[c].dataCount,u=t[c].totalCount-d;a=Math.max(a,d),n=Math.max(n,u),s[c]=Array(d);for(var h=0;h<s[c].length;h++)s[c][h]=255&e.buffer[h+r];r+=d;var f=i.getErrorCorrectPolynomial(u),p=new o(s[c],f.getLength()-1).mod(f);l[c]=Array(f.getLength()-1);for(var h=0;h<l[c].length;h++){var m=h+p.getLength()-l[c].length;l[c][h]=m>=0?p.get(m):0}}for(var g=0,h=0;h<t.length;h++)g+=t[h].totalCount;for(var x=Array(g),b=0,h=0;h<a;h++)for(var c=0;c<t.length;c++)h<s[c].length&&(x[b++]=s[c][h]);for(var h=0;h<n;h++)for(var c=0;c<t.length;c++)h<l[c].length&&(x[b++]=l[c][h]);return x},t.exports=l},85458,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n=o(e.r(46502)),s=e.r(91447),i=o(s);function o(e){return e&&e.__esModule?e:{default:e}}var l={bgColor:n.default.oneOfType([n.default.object,n.default.string]).isRequired,bgD:n.default.string.isRequired,fgColor:n.default.oneOfType([n.default.object,n.default.string]).isRequired,fgD:n.default.string.isRequired,size:n.default.number.isRequired,title:n.default.string,viewBoxSize:n.default.number.isRequired,xmlns:n.default.string},c=(0,s.forwardRef)(function(e,t){var r=e.bgColor,n=e.bgD,s=e.fgD,o=e.fgColor,l=e.size,c=e.title,d=e.viewBoxSize,u=e.xmlns,h=function(e,t){var r={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}(e,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",a({},h,{height:l,ref:t,viewBox:"0 0 "+d+" "+d,width:l,xmlns:void 0===u?"http://www.w3.org/2000/svg":u}),c?i.default.createElement("title",null,c):null,i.default.createElement("path",{d:n,fill:r}),i.default.createElement("path",{d:s,fill:o}))});c.displayName="QRCodeSvg",c.propTypes=l,r.default=c},10504,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QRCode=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},n=d(e.r(46502)),s=d(e.r(93619)),i=d(e.r(15877)),o=e.r(91447),l=d(o),c=d(e.r(85458));function d(e){return e&&e.__esModule?e:{default:e}}var u={bgColor:n.default.oneOfType([n.default.object,n.default.string]),fgColor:n.default.oneOfType([n.default.object,n.default.string]),level:n.default.string,size:n.default.number,value:n.default.string.isRequired},h=(0,o.forwardRef)(function(e,t){var r=e.bgColor,n=e.fgColor,o=e.level,d=e.size,u=e.value,h=function(e,t){var r={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}(e,["bgColor","fgColor","level","size","value"]),f=new i.default(-1,s.default[void 0===o?"L":o]);f.addData(u),f.make();var p=f.modules;return l.default.createElement(c.default,a({},h,{bgColor:void 0===r?"#FFFFFF":r,bgD:p.map(function(e,t){return e.map(function(e,r){return e?"":"M "+r+" "+t+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:void 0===n?"#000000":n,fgD:p.map(function(e,t){return e.map(function(e,r){return e?"M "+r+" "+t+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:t,size:void 0===d?256:d,viewBoxSize:p.length}))});r.QRCode=h,h.displayName="QRCode",h.propTypes=u,r.default=h},19275,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isUnsafeProperty=function(e){return"__proto__"===e}},93731,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isDeepKey=function(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}},68071,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.toKey=function(e){return"string"==typeof e||"symbol"==typeof e?e:Object.is(e?.valueOf?.(),-0)?"-0":String(e)}},71252,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.toString=function e(t){if(null==t)return"";if("string"==typeof t)return t;if(Array.isArray(t))return t.map(e).join(",");let r=String(t);return"0"===r&&Object.is(Number(t),-0)?"-0":r}},89032,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(71252),n=e.r(68071);r.toPath=function(e){if(Array.isArray(e))return e.map(n.toKey);if("symbol"==typeof e)return[e];e=a.toString(e);let t=[],r=e.length;if(0===r)return t;let s=0,i="",o="",l=!1;for(46===e.charCodeAt(0)&&(t.push(""),s++);s<r;){let a=e[s];o?"\\"===a&&s+1<r?i+=e[++s]:a===o?o="":i+=a:l?'"'===a||"'"===a?o=a:"]"===a?(l=!1,t.push(i),i=""):i+=a:"["===a?(l=!0,i&&(t.push(i),i="")):"."===a?i&&(t.push(i),i=""):i+=a,s++}return i&&t.push(i),t}},9379,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(19275),n=e.r(93731),s=e.r(68071),i=e.r(89032);r.get=function e(t,r,o){if(null==t)return o;switch(typeof r){case"string":{if(a.isUnsafeProperty(r))return o;let s=t[r];if(void 0===s)if(n.isDeepKey(r))return e(t,i.toPath(r),o);else return o;return s}case"number":case"symbol":{"number"==typeof r&&(r=s.toKey(r));let e=t[r];if(void 0===e)return o;return e}default:{if(Array.isArray(r)){var l=t,c=r,d=o;if(0===c.length)return d;let e=l;for(let t=0;t<c.length;t++){if(null==e||a.isUnsafeProperty(c[t]))return d;e=e[c[t]]}return void 0===e?d:e}if(r=Object.is(r?.valueOf(),-0)?"-0":String(r),a.isUnsafeProperty(r))return o;let e=t[r];if(void 0===e)return o;return e}}}},23647,(e,t,r)=>{t.exports=e.r(9379).get},40081,(e,t,r)=>{"use strict";var a=e.r(91447),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useSyncExternalStore,i=a.useRef,o=a.useEffect,l=a.useMemo,c=a.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,t,r,a,d){var u=i(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var f=s(e,(u=l(function(){function e(e){if(!o){if(o=!0,s=e,e=a(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return i=t}return i=e}if(t=i,n(s,e))return t;var r=a(e);return void 0!==d&&d(t,r)?(s=e,t):(s=e,i=r)}var s,i,o=!1,l=void 0===r?null:r;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,r,a,d]))[0],u[1]);return o(function(){h.hasValue=!0,h.value=f},[f]),c(f),f}},16428,(e,t,r)=>{"use strict";t.exports=e.r(40081)},46271,(e,t,r)=>{"use strict";var a=e.r(91447),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useState,i=a.useEffect,o=a.useLayoutEffect,l=a.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),a=s({inst:{value:r,getSnapshot:t}}),n=a[0].inst,d=a[1];return o(function(){n.value=r,n.getSnapshot=t,c(n)&&d({inst:n})},[e,r,t]),i(function(){return c(n)&&d({inst:n}),e(function(){c(n)&&d({inst:n})})},[e]),l(r),r};r.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:d},21023,(e,t,r)=>{"use strict";t.exports=e.r(46271)},74298,(e,t,r)=>{"use strict";var a=e.r(91447),n=e.r(21023),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=n.useSyncExternalStore,o=a.useRef,l=a.useEffect,c=a.useMemo,d=a.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,t,r,a,n){var u=o(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var f=i(e,(u=c(function(){function e(e){if(!l){if(l=!0,i=e,e=a(e),void 0!==n&&h.hasValue){var t=h.value;if(n(t,e))return o=t}return o=e}if(t=o,s(i,e))return t;var r=a(e);return void 0!==n&&n(t,r)?(i=e,t):(i=e,o=r)}var i,o,l=!1,c=void 0===r?null:r;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,r,a,n]))[0],u[1]);return l(function(){h.hasValue=!0,h.value=f},[f]),d(f),f}},1238,(e,t,r)=>{"use strict";t.exports=e.r(74298)},35225,(e,t,r)=>{"use strict";function a(e){return"symbol"==typeof e?1:null===e?2:void 0===e?3:4*(e!=e)}Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.compareValues=(e,t,r)=>{if(e!==t){let n=a(e),s=a(t);if(n===s&&0===n){if(e<t)return"desc"===r?1:-1;if(e>t)return"desc"===r?-1:1}return"desc"===r?s-n:n-s}return 0}},671,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isSymbol=function(e){return"symbol"==typeof e||e instanceof Symbol}},73579,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(671),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;r.isKey=function(e,t){return!Array.isArray(e)&&(!!("number"==typeof e||"boolean"==typeof e||null==e||a.isSymbol(e))||"string"==typeof e&&(s.test(e)||!n.test(e))||null!=t&&Object.hasOwn(t,e))}},73053,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(35225),n=e.r(73579),s=e.r(89032);r.orderBy=function(e,t,r,i){if(null==e)return[];r=i?void 0:r,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=null==t?[null]:[t]),0===t.length&&(t=[null]),Array.isArray(r)||(r=null==r?[]:[r]),r=r.map(e=>String(e));let o=(e,t)=>{let r=e;for(let e=0;e<t.length&&null!=r;++e)r=r[t[e]];return r},l=t.map(e=>(Array.isArray(e)&&1===e.length&&(e=e[0]),null==e||"function"==typeof e||Array.isArray(e)||n.isKey(e))?e:{key:e,path:s.toPath(e)});return e.map(e=>({original:e,criteria:l.map(t=>{var r,a;return r=t,null==(a=e)||null==r?a:"object"==typeof r&&"key"in r?Object.hasOwn(a,r.key)?a[r.key]:o(a,r.path):"function"==typeof r?r(a):Array.isArray(r)?o(a,r):"object"==typeof a?a[r]:a})})).slice().sort((e,t)=>{for(let n=0;n<l.length;n++){let s=a.compareValues(e.criteria[n],t.criteria[n],r[n]);if(0!==s)return s}return 0}).map(e=>e.original)}},10450,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.flatten=function(e,t=1){let r=[],a=Math.floor(t),n=(e,t)=>{for(let s=0;s<e.length;s++){let i=e[s];Array.isArray(i)&&t<a?n(i,t+1):r.push(i)}};return n(e,0),r}},21862,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=/^(?:0|[1-9]\d*)$/;r.isIndex=function(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return a.test(e)}}},32563,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isLength=function(e){return Number.isSafeInteger(e)&&e>=0}},28087,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(32563);r.isArrayLike=function(e){return null!=e&&"function"!=typeof e&&a.isLength(e.length)}},92881,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isObject=function(e){return null!==e&&("object"==typeof e||"function"==typeof e)}},19930,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.eq=function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}},98298,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(21862),n=e.r(28087),s=e.r(92881),i=e.r(19930);r.isIterateeCall=function(e,t,r){return!!s.isObject(r)&&(!!("number"==typeof t&&n.isArrayLike(r)&&a.isIndex(t))&&t<r.length||"string"==typeof t&&t in r)&&i.eq(r[t],e)}},12201,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(73053),n=e.r(10450),s=e.r(98298);r.sortBy=function(e,...t){let r=t.length;return r>1&&s.isIterateeCall(e,t[0],t[1])?t=[]:r>2&&s.isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),a.orderBy(e,n.flatten(t),["asc"])}},76515,(e,t,r)=>{t.exports=e.r(12201).sortBy},69835,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.debounce=function(e,t,{signal:r,edges:a}={}){let n,s=null,i=null!=a&&a.includes("leading"),o=null==a||a.includes("trailing"),l=()=>{null!==s&&(e.apply(n,s),n=void 0,s=null)},c=null,d=()=>{null!=c&&clearTimeout(c),c=setTimeout(()=>{c=null,o&&l(),u()},t)},u=()=>{null!==c&&(clearTimeout(c),c=null),n=void 0,s=null},h=function(...e){if(r?.aborted)return;n=this,s=e;let t=null==c;d(),i&&t&&l()};return h.schedule=d,h.cancel=u,h.flush=()=>{l()},r?.addEventListener("abort",u,{once:!0}),h}},85336,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(69835);r.debounce=function(e,t=0,r={}){let n;"object"!=typeof r&&(r={});let{leading:s=!1,trailing:i=!0,maxWait:o}=r,l=[,,];s&&(l[0]="leading"),i&&(l[1]="trailing");let c=null,d=a.debounce(function(...t){n=e.apply(this,t),c=null},t,{edges:l}),u=function(...t){return null!=o&&(null===c&&(c=Date.now()),Date.now()-c>=o)?(n=e.apply(this,t),c=Date.now(),d.cancel(),d.schedule(),n):(d.apply(this,t),n)};return u.cancel=d.cancel,u.flush=()=>(d.flush(),n),u}},57151,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(85336);r.throttle=function(e,t=0,r={}){let{leading:n=!0,trailing:s=!0}=r;return a.debounce(e,t,{leading:n,maxWait:t,trailing:s})}},70936,(e,t,r)=>{t.exports=e.r(57151).throttle},27799,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(671);r.toNumber=function(e){return a.isSymbol(e)?NaN:Number(e)}},5528,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(27799);r.toFinite=function(e){return e?(e=a.toNumber(e))===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e==e?e:0:0===e?e:0}},70111,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(98298),n=e.r(5528);r.range=function(e,t,r){r&&"number"!=typeof r&&a.isIterateeCall(e,t,r)&&(t=r=void 0),e=n.toFinite(e),void 0===t?(t=e,e=0):t=n.toFinite(t),r=void 0===r?e<t?1:-1:n.toFinite(r);let s=Math.max(Math.ceil((t-e)/(r||1)),0),i=Array(s);for(let t=0;t<s;t++)i[t]=e,e+=r;return i}},76197,(e,t,r)=>{t.exports=e.r(70111).range},51216,(e,t,r)=>{!function(r){"use strict";var a,n={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},s=!0,i="[DecimalError] ",o=i+"Invalid argument: ",l=i+"Exponent out of range: ",c=Math.floor,d=Math.pow,u=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,h=c(1286742750677284.5),f={};function p(e,t){var r,a,n,i,o,l,c,d,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),s?N(t,h):t;if(c=e.d,d=t.d,o=e.e,n=t.e,c=c.slice(),i=o-n){for(i<0?(a=c,i=-i,l=d.length):(a=d,n=o,l=c.length),i>(l=(o=Math.ceil(h/7))>l?o+1:l+1)&&(i=l,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for((l=c.length)-(i=d.length)<0&&(i=l,a=d,d=c,c=a),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/1e7|0,c[i]%=1e7;for(r&&(c.unshift(r),++n),l=c.length;0==c[--l];)c.pop();return t.d=c,t.e=n,s?N(t,h):t}function m(e,t,r){if(e!==~~e||e<t||e>r)throw Error(o+e)}function g(e){var t,r,a,n=e.length-1,s="",i=e[0];if(n>0){for(s+=i,t=1;t<n;t++)(r=7-(a=e[t]+"").length)&&(s+=w(r)),s+=a;(r=7-(a=(i=e[t])+"").length)&&(s+=w(r))}else if(0===i)return"0";for(;i%10==0;)i/=10;return s+i}f.absoluteValue=f.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e},f.comparedTo=f.cmp=function(e){var t,r,a,n;if(e=new this.constructor(e),this.s!==e.s)return this.s||-e.s;if(this.e!==e.e)return this.e>e.e^this.s<0?1:-1;for(t=0,r=(a=this.d.length)<(n=e.d.length)?a:n;t<r;++t)if(this.d[t]!==e.d[t])return this.d[t]>e.d[t]^this.s<0?1:-1;return a===n?0:a>n^this.s<0?1:-1},f.decimalPlaces=f.dp=function(){var e=this.d.length-1,t=(e-this.e)*7;if(e=this.d[e])for(;e%10==0;e/=10)t--;return t<0?0:t},f.dividedBy=f.div=function(e){return x(this,new this.constructor(e))},f.dividedToIntegerBy=f.idiv=function(e){var t=this.constructor;return N(x(this,new t(e),0,1),t.precision)},f.equals=f.eq=function(e){return!this.cmp(e)},f.exponent=function(){return y(this)},f.greaterThan=f.gt=function(e){return this.cmp(e)>0},f.greaterThanOrEqualTo=f.gte=function(e){return this.cmp(e)>=0},f.isInteger=f.isint=function(){return this.e>this.d.length-2},f.isNegative=f.isneg=function(){return this.s<0},f.isPositive=f.ispos=function(){return this.s>0},f.isZero=function(){return 0===this.s},f.lessThan=f.lt=function(e){return 0>this.cmp(e)},f.lessThanOrEqualTo=f.lte=function(e){return 1>this.cmp(e)},f.logarithm=f.log=function(e){var t,r=this.constructor,n=r.precision,o=n+5;if(void 0===e)e=new r(10);else if((e=new r(e)).s<1||e.eq(a))throw Error(i+"NaN");if(this.s<1)throw Error(i+(this.s?"NaN":"-Infinity"));return this.eq(a)?new r(0):(s=!1,t=x(k(this,o),k(e,o),o),s=!0,N(t,n))},f.minus=f.sub=function(e){return e=new this.constructor(e),this.s==e.s?S(this,e):p(this,(e.s=-e.s,e))},f.modulo=f.mod=function(e){var t,r=this.constructor,a=r.precision;if(!(e=new r(e)).s)throw Error(i+"NaN");return this.s?(s=!1,t=x(this,e,0,1).times(e),s=!0,this.minus(t)):N(new r(this),a)},f.naturalExponential=f.exp=function(){return b(this)},f.naturalLogarithm=f.ln=function(){return k(this)},f.negated=f.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},f.plus=f.add=function(e){return e=new this.constructor(e),this.s==e.s?p(this,e):S(this,(e.s=-e.s,e))},f.precision=f.sd=function(e){var t,r,a;if(void 0!==e&&!!e!==e&&1!==e&&0!==e)throw Error(o+e);if(t=y(this)+1,r=7*(a=this.d.length-1)+1,a=this.d[a]){for(;a%10==0;a/=10)r--;for(a=this.d[0];a>=10;a/=10)r++}return e&&t>r?t:r},f.squareRoot=f.sqrt=function(){var e,t,r,a,n,o,l,d=this.constructor;if(this.s<1){if(!this.s)return new d(0);throw Error(i+"NaN")}for(e=y(this),s=!1,0==(n=Math.sqrt(+this))||n==1/0?(((t=g(this.d)).length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=c((e+1)/2)-(e<0||e%2),a=new d(t=n==1/0?"5e"+e:(t=n.toExponential()).slice(0,t.indexOf("e")+1)+e)):a=new d(n.toString()),n=l=(r=d.precision)+3;;)if(a=(o=a).plus(x(this,o,l+2)).times(.5),g(o.d).slice(0,l)===(t=g(a.d)).slice(0,l)){if(t=t.slice(l-3,l+1),n==l&&"4999"==t){if(N(o,r+1,0),o.times(o).eq(this)){a=o;break}}else if("9999"!=t)break;l+=4}return s=!0,N(a,r)},f.times=f.mul=function(e){var t,r,a,n,i,o,l,c,d,u=this.constructor,h=this.d,f=(e=new u(e)).d;if(!this.s||!e.s)return new u(0);for(e.s*=this.s,r=this.e+e.e,(c=h.length)<(d=f.length)&&(i=h,h=f,f=i,o=c,c=d,d=o),i=[],a=o=c+d;a--;)i.push(0);for(a=d;--a>=0;){for(t=0,n=c+a;n>a;)l=i[n]+f[a]*h[n-a-1]+t,i[n--]=l%1e7|0,t=l/1e7|0;i[n]=(i[n]+t)%1e7|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,s?N(e,u.precision):e},f.toDecimalPlaces=f.todp=function(e,t){var r=this,a=r.constructor;return(r=new a(r),void 0===e)?r:(m(e,0,1e9),void 0===t?t=a.rounding:m(t,0,8),N(r,e+y(r)+1,t))},f.toExponential=function(e,t){var r,a=this,n=a.constructor;return void 0===e?r=E(a,!0):(m(e,0,1e9),void 0===t?t=n.rounding:m(t,0,8),r=E(a=N(new n(a),e+1,t),!0,e+1)),r},f.toFixed=function(e,t){var r,a,n=this.constructor;return void 0===e?E(this):(m(e,0,1e9),void 0===t?t=n.rounding:m(t,0,8),r=E((a=N(new n(this),e+y(this)+1,t)).abs(),!1,e+y(a)+1),this.isneg()&&!this.isZero()?"-"+r:r)},f.toInteger=f.toint=function(){var e=this.constructor;return N(new e(this),y(this)+1,e.rounding)},f.toNumber=function(){return+this},f.toPower=f.pow=function(e){var t,r,n,o,l,d,u=this,h=u.constructor,f=+(e=new h(e));if(!e.s)return new h(a);if(!(u=new h(u)).s){if(e.s<1)throw Error(i+"Infinity");return u}if(u.eq(a))return u;if(n=h.precision,e.eq(a))return N(u,n);if(d=(t=e.e)>=(r=e.d.length-1),l=u.s,d){if((r=f<0?-f:f)<=0x1fffffffffffff){for(o=new h(a),t=Math.ceil(n/7+4),s=!1;r%2&&C((o=o.times(u)).d,t),0!==(r=c(r/2));)C((u=u.times(u)).d,t);return s=!0,e.s<0?new h(a).div(o):N(o,n)}}else if(l<0)throw Error(i+"NaN");return l=l<0&&1&e.d[Math.max(t,r)]?-1:1,u.s=1,s=!1,o=e.times(k(u,n+12)),s=!0,(o=b(o)).s=l,o},f.toPrecision=function(e,t){var r,a,n=this,s=n.constructor;return void 0===e?(r=y(n),a=E(n,r<=s.toExpNeg||r>=s.toExpPos)):(m(e,1,1e9),void 0===t?t=s.rounding:m(t,0,8),r=y(n=N(new s(n),e,t)),a=E(n,e<=r||r<=s.toExpNeg,e)),a},f.toSignificantDigits=f.tosd=function(e,t){var r=this.constructor;return void 0===e?(e=r.precision,t=r.rounding):(m(e,1,1e9),void 0===t?t=r.rounding:m(t,0,8)),N(new r(this),e,t)},f.toString=f.valueOf=f.val=f.toJSON=function(){var e=y(this),t=this.constructor;return E(this,e<=t.toExpNeg||e>=t.toExpPos)};var x=function(){function e(e,t){var r,a=0,n=e.length;for(e=e.slice();n--;)r=e[n]*t+a,e[n]=r%1e7|0,a=r/1e7|0;return a&&e.unshift(a),e}function t(e,t,r,a){var n,s;if(r!=a)s=r>a?1:-1;else for(n=s=0;n<r;n++)if(e[n]!=t[n]){s=e[n]>t[n]?1:-1;break}return s}function r(e,t,r){for(var a=0;r--;)e[r]-=a,a=+(e[r]<t[r]),e[r]=1e7*a+e[r]-t[r];for(;!e[0]&&e.length>1;)e.shift()}return function(a,n,s,o){var l,c,d,u,h,f,p,m,g,x,b,v,w,k,j,S,E,C,T=a.constructor,A=a.s==n.s?1:-1,_=a.d,O=n.d;if(!a.s)return new T(a);if(!n.s)throw Error(i+"Division by zero");for(d=0,c=a.e-n.e,E=O.length,j=_.length,m=(p=new T(A)).d=[];O[d]==(_[d]||0);)++d;if(O[d]>(_[d]||0)&&--c,(v=null==s?s=T.precision:o?s+(y(a)-y(n))+1:s)<0)return new T(0);if(v=v/7+2|0,d=0,1==E)for(u=0,O=O[0],v++;(d<j||u)&&v--;d++)w=1e7*u+(_[d]||0),m[d]=w/O|0,u=w%O|0;else{for((u=1e7/(O[0]+1)|0)>1&&(O=e(O,u),_=e(_,u),E=O.length,j=_.length),k=E,x=(g=_.slice(0,E)).length;x<E;)g[x++]=0;(C=O.slice()).unshift(0),S=O[0],O[1]>=1e7/2&&++S;do u=0,(l=t(O,g,E,x))<0?(b=g[0],E!=x&&(b=1e7*b+(g[1]||0)),(u=b/S|0)>1?(u>=1e7&&(u=1e7-1),f=(h=e(O,u)).length,x=g.length,1==(l=t(h,g,f,x))&&(u--,r(h,E<f?C:O,f))):(0==u&&(l=u=1),h=O.slice()),(f=h.length)<x&&h.unshift(0),r(g,h,x),-1==l&&(x=g.length,(l=t(O,g,E,x))<1&&(u++,r(g,E<x?C:O,x))),x=g.length):0===l&&(u++,g=[0]),m[d++]=u,l&&g[0]?g[x++]=_[k]||0:(g=[_[k]],x=1);while((k++<j||void 0!==g[0])&&v--)}return m[0]||m.shift(),p.e=c,N(p,o?s+y(p)+1:s)}}();function b(e,t){var r,n,i,o,c,u=0,h=0,f=e.constructor,p=f.precision;if(y(e)>16)throw Error(l+y(e));if(!e.s)return new f(a);for(null==t?(s=!1,c=p):c=t,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),h+=5;for(c+=Math.log(d(2,h))/Math.LN10*2+5|0,r=n=i=new f(a),f.precision=c;;){if(n=N(n.times(e),c),r=r.times(++u),g((o=i.plus(x(n,r,c))).d).slice(0,c)===g(i.d).slice(0,c)){for(;h--;)i=N(i.times(i),c);return f.precision=p,null==t?(s=!0,N(i,p)):i}i=o}}function y(e){for(var t=7*e.e,r=e.d[0];r>=10;r/=10)t++;return t}function v(e,t,r){if(t>e.LN10.sd())throw s=!0,r&&(e.precision=r),Error(i+"LN10 precision limit exceeded");return N(new e(e.LN10),t)}function w(e){for(var t="";e--;)t+="0";return t}function k(e,t){var r,n,o,l,c,d,u,h,f,p=1,m=e,b=m.d,w=m.constructor,j=w.precision;if(m.s<1)throw Error(i+(m.s?"NaN":"-Infinity"));if(m.eq(a))return new w(0);if(null==t?(s=!1,h=j):h=t,m.eq(10))return null==t&&(s=!0),v(w,h);if(w.precision=h+=10,n=(r=g(b)).charAt(0),!(15e14>Math.abs(l=y(m))))return u=v(w,h+2,j).times(l+""),m=k(new w(n+"."+r.slice(1)),h-10).plus(u),w.precision=j,null==t?(s=!0,N(m,j)):m;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=g((m=m.times(e)).d)).charAt(0),p++;for(l=y(m),n>1?(m=new w("0."+r),l++):m=new w(n+"."+r.slice(1)),d=c=m=x(m.minus(a),m.plus(a),h),f=N(m.times(m),h),o=3;;){if(c=N(c.times(f),h),g((u=d.plus(x(c,new w(o),h))).d).slice(0,h)===g(d.d).slice(0,h))return d=d.times(2),0!==l&&(d=d.plus(v(w,h+2,j).times(l+""))),d=x(d,new w(p),h),w.precision=j,null==t?(s=!0,N(d,j)):d;d=u,o+=2}}function j(e,t){var r,a,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;48===t.charCodeAt(a);)++a;for(n=t.length;48===t.charCodeAt(n-1);)--n;if(t=t.slice(a,n)){if(n-=a,e.e=c((r=r-a-1)/7),e.d=[],a=(r+1)%7,r<0&&(a+=7),a<n){for(a&&e.d.push(+t.slice(0,a)),n-=7;a<n;)e.d.push(+t.slice(a,a+=7));a=7-(t=t.slice(a)).length}else a-=n;for(;a--;)t+="0";if(e.d.push(+t),s&&(e.e>h||e.e<-h))throw Error(l+r)}else e.s=0,e.e=0,e.d=[0];return e}function N(e,t,r){var a,n,i,o,u,f,p,m,g=e.d;for(o=1,i=g[0];i>=10;i/=10)o++;if((a=t-o)<0)a+=7,n=t,p=g[m=0];else{if((m=Math.ceil((a+1)/7))>=(i=g.length))return e;for(o=1,p=i=g[m];i>=10;i/=10)o++;a%=7,n=a-7+o}if(void 0!==r&&(u=p/(i=d(10,o-n-1))%10|0,f=t<0||void 0!==g[m+1]||p%i,f=r<4?(u||f)&&(0==r||r==(e.s<0?3:2)):u>5||5==u&&(4==r||f||6==r&&(a>0?n>0?p/d(10,o-n):0:g[m-1])%10&1||r==(e.s<0?8:7))),t<1||!g[0])return f?(i=y(e),g.length=1,t=t-i-1,g[0]=d(10,(7-t%7)%7),e.e=c(-t/7)||0):(g.length=1,g[0]=e.e=e.s=0),e;if(0==a?(g.length=m,i=1,m--):(g.length=m+1,i=d(10,7-a),g[m]=n>0?(p/d(10,o-n)%d(10,n)|0)*i:0),f)for(;;)if(0==m){1e7==(g[0]+=i)&&(g[0]=1,++e.e);break}else{if(g[m]+=i,1e7!=g[m])break;g[m--]=0,i=1}for(a=g.length;0===g[--a];)g.pop();if(s&&(e.e>h||e.e<-h))throw Error(l+y(e));return e}function S(e,t){var r,a,n,i,o,l,c,d,u,h,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),s?N(t,p):t;if(c=e.d,h=t.d,a=t.e,d=e.e,c=c.slice(),o=d-a){for((u=o<0)?(r=c,o=-o,l=h.length):(r=h,a=d,l=c.length),o>(n=Math.max(Math.ceil(p/7),l)+2)&&(o=n,r.length=1),r.reverse(),n=o;n--;)r.push(0);r.reverse()}else{for((u=(n=c.length)<(l=h.length))&&(l=n),n=0;n<l;n++)if(c[n]!=h[n]){u=c[n]<h[n];break}o=0}for(u&&(r=c,c=h,h=r,t.s=-t.s),l=c.length,n=h.length-l;n>0;--n)c[l++]=0;for(n=h.length;n>o;){if(c[--n]<h[n]){for(i=n;i&&0===c[--i];)c[i]=1e7-1;--c[i],c[n]+=1e7}c[n]-=h[n]}for(;0===c[--l];)c.pop();for(;0===c[0];c.shift())--a;return c[0]?(t.d=c,t.e=a,s?N(t,p):t):new f(0)}function E(e,t,r){var a,n=y(e),s=g(e.d),i=s.length;return t?(r&&(a=r-i)>0?s=s.charAt(0)+"."+s.slice(1)+w(a):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(n<0?"e":"e+")+n):n<0?(s="0."+w(-n-1)+s,r&&(a=r-i)>0&&(s+=w(a))):n>=i?(s+=w(n+1-i),r&&(a=r-n-1)>0&&(s=s+"."+w(a))):((a=n+1)<i&&(s=s.slice(0,a)+"."+s.slice(a)),r&&(a=r-i)>0&&(n+1===i&&(s+="."),s+=w(a))),e.s<0?"-"+s:s}function C(e,t){if(e.length>t)return e.length=t,!0}function T(e){if(!e||"object"!=typeof e)throw Error(i+"Object expected");var t,r,a,n=["precision",1,1e9,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if(void 0!==(a=e[r=n[t]]))if(c(a)===a&&a>=n[t+1]&&a<=n[t+2])this[r]=a;else throw Error(o+r+": "+a);if(void 0!==(a=e[r="LN10"]))if(a==Math.LN10)this[r]=new this(a);else throw Error(o+r+": "+a);return this}if((n=function e(t){var r,a,n;function s(e){if(!(this instanceof s))return new s(e);if(this.constructor=s,e instanceof s){this.s=e.s,this.e=e.e,this.d=(e=e.d)?e.slice():e;return}if("number"==typeof e){if(0*e!=0)throw Error(o+e);if(e>0)this.s=1;else if(e<0)e=-e,this.s=-1;else{this.s=0,this.e=0,this.d=[0];return}if(e===~~e&&e<1e7){this.e=0,this.d=[e];return}return j(this,e.toString())}if("string"!=typeof e)throw Error(o+e);if(45===e.charCodeAt(0)?(e=e.slice(1),this.s=-1):this.s=1,u.test(e))j(this,e);else throw Error(o+e)}if(s.prototype=f,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=e,s.config=s.set=T,void 0===t&&(t={}),t)for(r=0,n=["precision","rounding","toExpNeg","toExpPos","LN10"];r<n.length;)t.hasOwnProperty(a=n[r++])||(t[a]=this[a]);return s.config(t),s}(n)).default=n.Decimal=n,a=new n(1),"function"==typeof define&&define.amd){let t;e.r,void 0!==(t=n)&&e.v(t)}else t.exports?t.exports=n:(r||(r="undefined"!=typeof self&&self&&self.self==self?self:Function("return this")()),r.Decimal=n)}(e.e)},65417,(e,t,r)=>{"use strict";var a=Object.prototype.hasOwnProperty,n="~";function s(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,a,s){if("function"!=typeof r)throw TypeError("The listener must be a function");var o=new i(r,a||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new s:delete e._events[t]}function c(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1)),c.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)a.call(e,t)&&r.push(n?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},c.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,s=r.length,i=Array(s);a<s;a++)i[a]=r[a].fn;return i},c.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},c.prototype.emit=function(e,t,r,a,s,i){var o=n?n+e:e;if(!this._events[o])return!1;var l,c,d=this._events[o],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,a),!0;case 5:return d.fn.call(d.context,t,r,a,s),!0;case 6:return d.fn.call(d.context,t,r,a,s,i),!0}for(c=1,l=Array(u-1);c<u;c++)l[c-1]=arguments[c];d.fn.apply(d.context,l)}else{var h,f=d.length;for(c=0;c<f;c++)switch(d[c].once&&this.removeListener(e,d[c].fn,void 0,!0),u){case 1:d[c].fn.call(d[c].context);break;case 2:d[c].fn.call(d[c].context,t);break;case 3:d[c].fn.call(d[c].context,t,r);break;case 4:d[c].fn.call(d[c].context,t,r,a);break;default:if(!l)for(h=1,l=Array(u-1);h<u;h++)l[h-1]=arguments[h];d[c].fn.apply(d[c].context,l)}}return!0},c.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},c.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},c.prototype.removeListener=function(e,t,r,a){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return l(this,s),this;var i=this._events[s];if(i.fn)i.fn!==t||a&&!i.once||r&&i.context!==r||l(this,s);else{for(var o=0,c=[],d=i.length;o<d;o++)(i[o].fn!==t||a&&!i[o].once||r&&i[o].context!==r)&&c.push(i[o]);c.length?this._events[s]=1===c.length?c[0]:c:l(this,s)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&l(this,t)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=n,c.EventEmitter=c,t.exports=c},38326,(e,t,r)=>{"use strict";var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function x(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case s:case o:case i:case u:case h:case m:return e;default:switch(e=e&&e.$$typeof){case c:case d:case p:case f:case l:return e;default:return t}}case n:return t}}}r.ContextConsumer=l,r.ContextProvider=c,r.Element=a,r.ForwardRef=d,r.Fragment=s,r.Lazy=p,r.Memo=f,r.Portal=n,r.Profiler=o,r.StrictMode=i,r.Suspense=u,r.SuspenseList=h,r.isContextConsumer=function(e){return x(e)===l},r.isContextProvider=function(e){return x(e)===c},r.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},r.isForwardRef=function(e){return x(e)===d},r.isFragment=function(e){return x(e)===s},r.isLazy=function(e){return x(e)===p},r.isMemo=function(e){return x(e)===f},r.isPortal=function(e){return x(e)===n},r.isProfiler=function(e){return x(e)===o},r.isStrictMode=function(e){return x(e)===i},r.isSuspense=function(e){return x(e)===u},r.isSuspenseList=function(e){return x(e)===h},r.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===o||e===i||e===u||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===f||e.$$typeof===c||e.$$typeof===l||e.$$typeof===d||e.$$typeof===g||void 0!==e.getModuleId)||!1},r.typeOf=x},47169,(e,t,r)=>{"use strict";t.exports=e.r(38326)},35983,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isPlainObject=function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){let t=e[Symbol.toStringTag];return null!=t&&!!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},70289,(e,t,r)=>{t.exports=e.r(35983).isPlainObject},94481,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.last=function(e){return e[e.length-1]}},11101,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.toArray=function(e){return Array.isArray(e)?e:Array.from(e)}},47116,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(94481),n=e.r(11101),s=e.r(28087);r.last=function(e){if(s.isArrayLike(e))return a.last(n.toArray(e))}},12390,(e,t,r)=>{t.exports=e.r(47116).last},66047,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.uniqBy=function(e,t){let r=new Map;for(let a=0;a<e.length;a++){let n=e[a],s=t(n);r.has(s)||r.set(s,n)}return Array.from(r.values())}},64149,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.identity=function(e){return e}},55351,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isObjectLike=function(e){return"object"==typeof e&&null!==e}},22404,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(28087),n=e.r(55351);r.isArrayLikeObject=function(e){return n.isObjectLike(e)&&a.isArrayLike(e)}},68137,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(9379);r.property=function(e){return function(t){return a.get(t,e)}}},77228,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isPrimitive=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e}},5617,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(92881),n=e.r(77228),s=e.r(19930);function i(e,t,r,c){if(t===e)return!0;switch(typeof t){case"object":return function(e,t,r,a){if(null==t)return!0;if(Array.isArray(t))return o(e,t,r,a);if(t instanceof Map){var s=e,i=t,c=r,d=a;if(0===i.size)return!0;if(!(s instanceof Map))return!1;for(let[e,t]of i.entries())if(!1===c(s.get(e),t,e,s,i,d))return!1;return!0}if(t instanceof Set)return l(e,t,r,a);let u=Object.keys(t);if(null==e)return 0===u.length;if(0===u.length)return!0;if(a?.has(t))return a.get(t)===e;a?.set(t,e);try{for(let s=0;s<u.length;s++){let i=u[s];if(!n.isPrimitive(e)&&!(i in e)||void 0===t[i]&&void 0!==e[i]||null===t[i]&&null!==e[i]||!r(e[i],t[i],i,e,t,a))return!1}return!0}finally{a?.delete(t)}}(e,t,r,c);case"function":if(Object.keys(t).length>0)return i(e,{...t},r,c);return s.eq(e,t);default:if(!a.isObject(e))return s.eq(e,t);if("string"==typeof t)return""===t;return!0}}function o(e,t,r,a){if(0===t.length)return!0;if(!Array.isArray(e))return!1;let n=new Set;for(let s=0;s<t.length;s++){let i=t[s],o=!1;for(let l=0;l<e.length;l++){if(n.has(l))continue;let c=e[l],d=!1;if(r(c,i,s,e,t,a)&&(d=!0),d){n.add(l),o=!0;break}}if(!o)return!1}return!0}function l(e,t,r,a){return 0===t.size||e instanceof Set&&o([...e],[...t],r,a)}r.isMatchWith=function e(t,r,a){return"function"!=typeof a?e(t,r,()=>void 0):i(t,r,function e(t,r,n,s,o,l){let c=a(t,r,n,s,o,l);return void 0!==c?!!c:i(t,r,e,l)},new Map)},r.isSetMatch=l},74818,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(5617);r.isMatch=function(e,t){return a.isMatchWith(e,t,()=>void 0)}},45496,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.getSymbols=function(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}},23563,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.getTag=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}},64626,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.argumentsTag="[object Arguments]",r.arrayBufferTag="[object ArrayBuffer]",r.arrayTag="[object Array]",r.bigInt64ArrayTag="[object BigInt64Array]",r.bigUint64ArrayTag="[object BigUint64Array]",r.booleanTag="[object Boolean]",r.dataViewTag="[object DataView]",r.dateTag="[object Date]",r.errorTag="[object Error]",r.float32ArrayTag="[object Float32Array]",r.float64ArrayTag="[object Float64Array]",r.functionTag="[object Function]",r.int16ArrayTag="[object Int16Array]",r.int32ArrayTag="[object Int32Array]",r.int8ArrayTag="[object Int8Array]",r.mapTag="[object Map]",r.numberTag="[object Number]",r.objectTag="[object Object]",r.regexpTag="[object RegExp]",r.setTag="[object Set]",r.stringTag="[object String]",r.symbolTag="[object Symbol]",r.uint16ArrayTag="[object Uint16Array]",r.uint32ArrayTag="[object Uint32Array]",r.uint8ArrayTag="[object Uint8Array]",r.uint8ClampedArrayTag="[object Uint8ClampedArray]"},13006,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),r.isTypedArray=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}},11184,(e,t,r)=>{"use strict";var a=e.i(66487);Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let n=e.r(45496),s=e.r(23563),i=e.r(64626),o=e.r(77228),l=e.r(13006);function c(e,t,r,n=new Map,u){let h=u?.(e,t,r,n);if(void 0!==h)return h;if(o.isPrimitive(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){let t=Array(e.length);n.set(e,t);for(let a=0;a<e.length;a++)t[a]=c(e[a],a,r,n,u);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[a,s]of(n.set(e,t),e))t.set(a,c(s,a,r,n,u));return t}if(e instanceof Set){let t=new Set;for(let a of(n.set(e,t),e))t.add(c(a,void 0,r,n,u));return t}if(void 0!==a.Buffer&&a.Buffer.isBuffer(e))return e.subarray();if(l.isTypedArray(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);n.set(e,t);for(let a=0;a<e.length;a++)t[a]=c(e[a],a,r,n,u);return t}if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,t),d(t,e,r,n,u),t}if("undefined"!=typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return n.set(e,t),d(t,e,r,n,u),t}if("undefined"!=typeof Blob&&e instanceof Blob){let t=new Blob([e],{type:e.type});return n.set(e,t),d(t,e,r,n,u),t}if(e instanceof Error){let t=new e.constructor;return n.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,d(t,e,r,n,u),t}if(e instanceof Boolean){let t=new Boolean(e.valueOf());return n.set(e,t),d(t,e,r,n,u),t}if(e instanceof Number){let t=new Number(e.valueOf());return n.set(e,t),d(t,e,r,n,u),t}if(e instanceof String){let t=new String(e.valueOf());return n.set(e,t),d(t,e,r,n,u),t}if("object"==typeof e&&function(e){switch(s.getTag(e)){case i.argumentsTag:case i.arrayTag:case i.arrayBufferTag:case i.dataViewTag:case i.booleanTag:case i.dateTag:case i.float32ArrayTag:case i.float64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.mapTag:case i.numberTag:case i.objectTag:case i.regexpTag:case i.setTag:case i.stringTag:case i.symbolTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return n.set(e,t),d(t,e,r,n,u),t}return e}function d(e,t,r=e,a,s){let i=[...Object.keys(t),...n.getSymbols(t)];for(let n=0;n<i.length;n++){let o=i[n],l=Object.getOwnPropertyDescriptor(e,o);(null==l||l.writable)&&(e[o]=c(t[o],o,r,a,s))}}r.cloneDeepWith=function(e,t){return c(e,void 0,e,new Map,t)},r.cloneDeepWithImpl=c,r.copyProperties=d},68401,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(11184);r.cloneDeep=function(e){return a.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}},39732,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(74818),n=e.r(68401);r.matches=function(e){return e=n.cloneDeep(e),t=>a.isMatch(t,e)}},30583,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(11184),n=e.r(64626);r.cloneDeepWith=function(e,t){return a.cloneDeepWith(e,(r,s,i,o)=>{let l=t?.(r,s,i,o);if(void 0!==l)return l;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case n.numberTag:case n.stringTag:case n.booleanTag:{let t=new e.constructor(e?.valueOf());return a.copyProperties(t,e),t}case n.argumentsTag:{let t={};return a.copyProperties(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}},35629,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(30583);r.cloneDeep=function(e){return a.cloneDeepWith(e)}},52665,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(23563);r.isArguments=function(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===a.getTag(e)}},97865,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(93731),n=e.r(21862),s=e.r(52665),i=e.r(89032);r.has=function(e,t){let r;if(0===(r=Array.isArray(t)?t:"string"==typeof t&&a.isDeepKey(t)&&e?.[t]==null?i.toPath(t):[t]).length)return!1;let o=e;for(let e=0;e<r.length;e++){let t=r[e];if((null==o||!Object.hasOwn(o,t))&&!((Array.isArray(o)||s.isArguments(o))&&n.isIndex(t)&&t<o.length))return!1;o=o[t]}return!0}},83555,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(74818),n=e.r(68071),s=e.r(35629),i=e.r(9379),o=e.r(97865);r.matchesProperty=function(e,t){switch(typeof e){case"object":Object.is(e?.valueOf(),-0)&&(e="-0");break;case"number":e=n.toKey(e)}return t=s.cloneDeep(t),function(r){let n=i.get(r,e);return void 0===n?o.has(r,e):void 0===t?void 0===n:a.isMatch(n,t)}}},6346,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(64149),n=e.r(68137),s=e.r(39732),i=e.r(83555);r.iteratee=function(e){if(null==e)return a.identity;switch(typeof e){case"function":return e;case"object":if(Array.isArray(e)&&2===e.length)return i.matchesProperty(e[0],e[1]);return s.matches(e);case"string":case"symbol":case"number":return n.property(e)}}},97793,(e,t,r)=>{"use strict";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"});let a=e.r(66047),n=e.r(64149),s=e.r(22404),i=e.r(6346);r.uniqBy=function(e,t=n.identity){return s.isArrayLikeObject(e)?a.uniqBy(Array.from(e),i.iteratee(t)):[]}},73304,(e,t,r)=>{t.exports=e.r(97793).uniqBy},55387,e=>{"use strict";let t,r,a,n,s;var i,o,l,c,d,u,h,f,p,m,g,x,b,y,v,w,k,j,N,S,E,C,T,A,_,O,P,D,R,M,I,L,F,B,U,z,V,H,W,q,G,K,X,Y,Q,J,Z,ee,et,er,ea,en,es,ei,eo,el,ec,ed,eu,eh,ef,ep=e.i(13161),em=e.i(91447),eg=e.i(31981),ex=e.i(72079),eb=e.i(96877);function ey({title:e,value:t,icon:r,color:a,delay:n=0}){let[s,i]=(0,em.useState)(0),{theme:o}=(0,ex.useTheme)();(0,em.useEffect)(()=>{let e=Date.now(),r=100*n,a=setTimeout(()=>{let a=setInterval(()=>{let n=Math.min((Date.now()-e-r)/1500,1);i(Math.floor((1-Math.pow(1-n,4))*t)),n>=1&&(clearInterval(a),i(t))},16);return()=>clearInterval(a)},r);return()=>clearTimeout(a)},[t,n]);let l="dark"===o;return(0,ep.jsxs)("div",{className:(0,eg.cn)("relative rounded-2xl bg-gradient-to-br border p-4 lg:p-6 backdrop-blur-sm overflow-hidden","opacity-0 animate-fade-in-up group hover:scale-[1.02] transition-all duration-300","hover:shadow-lg",l&&"primary"===a&&"from-purple-500/20 to-purple-600/10",l&&"secondary"===a&&"from-blue-500/20 to-blue-600/10",l&&"accent"===a&&"from-pink-500/20 to-pink-600/10",!l&&"primary"===a&&eb.default.cardPrimaryLight,!l&&"secondary"===a&&eb.default.cardSecondaryLight,!l&&"accent"===a&&eb.default.cardAccentLight,l&&"primary"===a&&"shadow-purple-500/20",l&&"secondary"===a&&"shadow-blue-500/20",l&&"accent"===a&&"shadow-pink-500/20",l?"border-white/10 hover:border-white/20":"border-gray-200/50 hover:border-gray-300/50"),children:[(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -top-10 -right-10 w-24 lg:w-32 h-24 lg:h-32 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity","bg-gradient-to-br",l&&"primary"===a&&"from-purple-500 to-purple-600",l&&"secondary"===a&&"from-blue-500 to-blue-600",l&&"accent"===a&&"from-pink-500 to-pink-600",!l&&"primary"===a&&eb.default.glowPrimaryLight,!l&&"secondary"===a&&eb.default.glowSecondaryLight,!l&&"accent"===a&&eb.default.glowAccentLight)}),(0,ep.jsxs)("div",{className:"relative flex items-start justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs lg:text-sm mb-1 lg:mb-2",l?"text-gray-400":"text-gray-600"),children:e}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-3xl lg:text-4xl font-bold",l&&"primary"===a&&"text-purple-400",l&&"secondary"===a&&"text-blue-400",l&&"accent"===a&&"text-pink-400",!l&&"primary"===a&&eb.default.textPrimaryLight,!l&&"secondary"===a&&eb.default.textSecondaryLight,!l&&"accent"===a&&eb.default.textAccentLight),children:s.toLocaleString()})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("w-10 h-10 lg:w-12 lg:h-12 rounded-xl bg-gradient-to-br flex items-center justify-center","group-hover:scale-110 transition-transform duration-300",l&&"primary"===a&&"from-purple-500 to-purple-600",l&&"secondary"===a&&"from-blue-500 to-blue-600",l&&"accent"===a&&"from-pink-500 to-pink-600",!l&&"primary"===a&&eb.default.iconPrimaryLight,!l&&"secondary"===a&&eb.default.iconSecondaryLight,!l&&"accent"===a&&eb.default.iconAccentLight),children:(0,ep.jsx)(r,{className:"w-5 h-5 lg:w-6 lg:h-6 text-white"})})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("mt-3 lg:mt-4 h-1 rounded-full overflow-hidden",l?"bg-white/5":"bg-gray-100"),children:(0,ep.jsx)("div",{className:(0,eg.cn)("h-full rounded-full bg-gradient-to-r transition-all duration-1000",l&&"primary"===a&&"from-purple-500 to-purple-600",l&&"secondary"===a&&"from-blue-500 to-blue-600",l&&"accent"===a&&"from-pink-500 to-pink-600",!l&&"primary"===a&&eb.default.progressPrimaryLight,!l&&"secondary"===a&&eb.default.progressSecondaryLight,!l&&"accent"===a&&eb.default.progressAccentLight),style:{width:`${Math.min(s/t*100,100)}%`}})})]})}var ev=e.i(98275),ew=e.i(7020),ek=e.i(49163);let ej=(0,ek.default)("ContactRound",[["path",{d:"M16 2v2",key:"scm5qe"}],["path",{d:"M17.915 22a6 6 0 0 0-12 0",key:"suqz9p"}],["path",{d:"M8 2v2",key:"pbkmx"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",key:"12vinp"}]]);var eN=e.i(90167);let eS=(0,ek.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var eE=e.i(32905);let eC=(0,ek.default)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var eT=e.i(20483),eA=e.i(15942),e_=e.i(32575),eO=e.i(8950);let eP={completed:{dark:"bg-[#A8E6CF]/20 text-[#A8E6CF] border-[#A8E6CF]/30",light:"bg-[#A8E6CF]/30 text-[#2D5F3F] border-[#A8E6CF]/40"},paused:{dark:"bg-[#FFE89E]/20 text-[#FFE89E] border-[#FFE89E]/30",light:"bg-[#FFE89E]/40 text-[#8B7000] border-[#FFE89E]/50"},descanso:{dark:"bg-[#FFCBA4]/20 text-[#FFCBA4] border-[#FFCBA4]/30",light:"bg-[#FFCBA4]/40 text-[#A0522D] border-[#FFCBA4]/50"},pending:{dark:"bg-[#D3D3D3]/20 text-[#D3D3D3] border-[#D3D3D3]/30",light:"bg-[#D3D3D3]/40 text-[#696969] border-[#D3D3D3]/50"},running:{dark:"bg-[#AED6F1]/20 text-[#AED6F1] border-[#AED6F1]/30",light:"bg-[#AED6F1]/40 text-[#1F618D] border-[#AED6F1]/50"}};function eD(e){let t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleString("es-AR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}function eR(e){return({completado:"completed",completed:"completed",pausado:"paused",paused:"paused",descanso:"descanso",pendiente:"pending",pending:"pending","en proceso":"running",running:"running"})[e.toLowerCase()]||"running"}function eM(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)([]),[a,n]=(0,em.useState)(!0),s=new Date().toISOString().split("T")[0],[i,o]=(0,em.useState)(s),[l,c]=(0,em.useState)("all");(0,em.useEffect)(()=>{d()},[]);let d=async()=>{try{n(!0);let e=await e_.api.sendJobs.list();r(e.data||[])}catch(e){console.error("Error fetching campaigns:",e),eO.toast.error("Error al cargar campaas")}finally{n(!1)}},u=async e=>{try{let t=await e_.api.sendJobs.export(e),r=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.setAttribute("download",`campa\xf1a_${e}_detalle.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(a),eO.toast.success(" Excel descargado")}catch(e){console.error("Error exporting campaign:",e),eO.toast.error("Error al descargar Excel")}},h=(0,em.useMemo)(()=>{let e=t.filter(e=>"fallido"!==e.status.toLowerCase()&&"failed"!==e.status.toLowerCase());return i&&(e=e.filter(e=>new Date(e.scheduledFor||e.createdAt).toISOString().split("T")[0]===i)),"all"!==l&&(e=e.filter(e=>eR(e.status)===l)),e.sort((e,t)=>new Date(t.scheduledFor||t.createdAt).getTime()-new Date(e.scheduledFor||e.createdAt).getTime())},[t,l,i]);return a?(0,ep.jsx)("div",{className:"animate-fade-in-up flex items-center justify-center h-64",children:(0,ep.jsxs)("div",{className:"text-center",children:[(0,ep.jsx)("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Cargando campaas..."})]})}):(0,ep.jsxs)("div",{className:"animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"mb-6",children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl lg:text-2xl font-bold mb-1","dark"===e?"text-white":"text-gray-700"),children:"Reportes de Mensajera"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Historial completo de campaas de mensajera"})]}),(0,ep.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,ep.jsxs)("div",{className:"relative flex-1 sm:flex-initial sm:min-w-[180px]",children:[(0,ep.jsx)("input",{type:"date",value:i,onChange:e=>o(e.target.value),placeholder:"dd/mm/aaaa",className:(0,eg.cn)("w-full pl-4 pr-10 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/30":"bg-white border-purple-200/50 text-gray-700 placeholder:text-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-200")}),(0,ep.jsx)(eS,{className:(0,eg.cn)("absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")})]}),(0,ep.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:(0,eg.cn)("flex-1 sm:flex-initial sm:min-w-[180px] px-4 py-2.5 rounded-lg border text-sm transition-all appearance-none cursor-pointer","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/30":"bg-white border-purple-200/50 text-gray-700 focus:border-purple-400 focus:ring-1 focus:ring-purple-200"),children:[(0,ep.jsx)("option",{value:"all",children:"Todos los estados"}),(0,ep.jsx)("option",{value:"completed",children:"Completado"}),(0,ep.jsx)("option",{value:"paused",children:"Pausado"}),(0,ep.jsx)("option",{value:"descanso",children:"Descanso"}),(0,ep.jsx)("option",{value:"pending",children:"Pendiente"}),(0,ep.jsx)("option",{value:"running",children:"En proceso"})]})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("button",{onClick:d,className:(0,eg.cn)("flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all","dark"===e?"bg-cyan-500 hover:bg-cyan-400 text-white":"bg-purple-500 hover:bg-purple-400 text-white"),children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,ep.jsx)("button",{onClick:()=>{o(new Date().toISOString().split("T")[0]),c("all")},className:(0,eg.cn)("flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all","dark"===e?"bg-white/10 hover:bg-white/20 text-gray-300":"bg-gray-100 hover:bg-gray-200 text-gray-600"),children:"Limpiar filtros"})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border overflow-hidden","dark"===e?"bg-[#0d1526]/80 border-white/10":"bg-white border-purple-200/30 shadow-lg shadow-purple-100/20"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full min-w-[900px]",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:(0,eg.cn)("text-left text-xs uppercase tracking-wider","dark"===e?"text-gray-400 bg-white/5":"text-gray-500 bg-purple-50/50"),children:[(0,ep.jsx)("th",{className:"px-4 py-3 font-medium",children:"Fecha de inicio"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium",children:"Campaa"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Contactos"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Enviados"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Fallidos"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Respuestas"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Estado"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium",children:"Fecha de finalizacin"}),(0,ep.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===e?"divide-white/5":"divide-purple-100/50"),children:h.map((t,r)=>{var a,n;let s=eR(t.status);return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-purple-50/30","animate-fade-in-up"),style:{animationDelay:`${50*r}ms`},children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-sm","dark"===e?"text-gray-300":"text-gray-600"),children:eD(t.scheduledFor||t.createdAt)}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-sm font-medium","dark"===e?"text-white":"text-gray-700"),children:(a=t.name)?a.charAt(0).toUpperCase()+a.slice(1).toLowerCase():""}),(0,ep.jsx)("td",{className:"px-4 py-3",children:(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-white":"text-gray-700"),children:t.createdBy?.nombre||"N/A"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-500":"text-gray-400"),children:t.createdBy?.numeroEquipo?`Equipo ${t.createdBy.numeroEquipo}`:""})]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-sm text-center","dark"===e?"text-gray-300":"text-gray-600"),children:t.totalContacts||0}),(0,ep.jsx)("td",{className:"px-4 py-3 text-center",children:(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium","dark"===e?"bg-[#17C787]/20 text-[#17C787]":"bg-[#17C787]/10 text-[#17C787]"),children:[(0,ep.jsx)(eN.Mail,{className:"w-3 h-3"}),t.sentCount||0]})}),(0,ep.jsx)("td",{className:"px-4 py-3 text-center",children:(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium","dark"===e?"bg-[#C8376B]/20 text-[#C8376B]":"bg-[#C8376B]/10 text-[#C8376B]"),children:[(0,ep.jsx)(eT.X,{className:"w-3 h-3"}),t.failedCount||0]})}),(0,ep.jsx)("td",{className:"px-4 py-3 text-center",children:(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium","dark"===e?"bg-[#1E88E5]/20 text-[#1E88E5]":"bg-[#1E88E5]/10 text-[#1E88E5]"),children:[(0,ep.jsx)(eA.MessageSquare,{className:"w-3 h-3"}),t.repliesCount||0]})}),(0,ep.jsx)("td",{className:"px-4 py-3 text-center",children:(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium border",eP[s][e]),children:[(0,ep.jsx)(eN.Mail,{className:"w-3 h-3"}),{completado:"Completado",completed:"Completado",pausado:"Pausado",paused:"Pausado",descanso:"Descanso","en proceso":"En proceso",running:"En proceso",pendiente:"Pendiente",pending:"Pendiente"}[(n=t.status).toLowerCase()]||n]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-sm","dark"===e?"text-gray-300":"text-gray-600"),children:t.completedAt?eD(t.completedAt):"-"}),(0,ep.jsx)("td",{className:"px-4 py-3 text-center",children:(0,ep.jsxs)("button",{onClick:()=>u(t._id),className:(0,eg.cn)("inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:scale-105","dark"===e?"bg-blue-500/20 text-blue-400 hover:bg-blue-500/30":"bg-blue-100 text-blue-600 hover:bg-blue-200"),children:[(0,ep.jsx)(eC,{className:"w-3.5 h-3.5"}),"Excel"]})})]},t._id)})})]})})})]})}var eI=e.i(8074);let eL=(0,ek.default)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var eF=e.i(20277),eB=e.i(96241),eU=e.i(51444),ez=e.i(45155),eV=e.i(2372),e$=e.i(81114);let eH=(0,ek.default)("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),eW=(0,ek.default)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),eq=(0,ek.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),eG=(0,ek.default)("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]),eK=(0,ek.default)("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),eX=(0,ek.default)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);var eY=e.i(5872);let eQ=(0,ek.default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var eJ=e.i(61351);let eZ=(0,ek.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var e0=e.i(316);let e1=(0,ek.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var e2=e.i(67190);function e5({isOpen:e,onClose:t}){let{theme:r}=(0,ex.useTheme)(),[a,n]=(0,em.useState)(""),[s,i]=(0,em.useState)(""),[o,l]=(0,em.useState)("contains"),[c,d]=(0,em.useState)(!1),[u,h]=(0,em.useState)(!0),[f,p]=(0,em.useState)([]),[m,g]=(0,em.useState)(!1),[x,b]=(0,em.useState)(!1),[y,v]=(0,em.useState)(null);(0,em.useEffect)(()=>{e&&w()},[e]);let w=async()=>{g(!0);try{let e=await e_.api.autoResponses.list();p(e.data||[])}catch(e){console.error("Error loading autoresponses:",e),eO.toast.error("Error al cargar auto-respuestas")}finally{g(!1)}},k=async()=>{if(!s.trim())return void eO.toast.error("La respuesta es obligatoria");if(!c&&!a.trim())return void eO.toast.error("La palabra clave es obligatoria (o marca como comodn)");b(!0);try{let e={keyword:c?null:a.trim(),response:s.trim(),matchType:c?null:o,isFallback:c,active:u};y?(await e_.api.autoResponses.update(y,e),eO.toast.success("Auto-respuesta actualizada"),v(null)):(await e_.api.autoResponses.create(e),eO.toast.success("Auto-respuesta creada")),n(""),i(""),d(!1),h(!0),l("contains"),w()}catch(e){console.error("Error creating/updating autoresponse:",e),eO.toast.error(e.response?.data?.error||`Error al ${y?"actualizar":"crear"} auto-respuesta`)}finally{b(!1)}},j=async e=>{if(confirm("Ests seguro de eliminar esta auto-respuesta?"))try{await e_.api.autoResponses.delete(e),eO.toast.success("Auto-respuesta eliminada"),w()}catch(e){console.error("Error deleting autoresponse:",e),eO.toast.error("Error al eliminar auto-respuesta")}},N=async e=>{try{await e_.api.autoResponses.toggle(e),w()}catch(e){console.error("Error toggling autoresponse:",e),eO.toast.error("Error al cambiar estado")}};return e?(0,ep.jsx)("div",{className:"fixed top-24 right-4 z-50 w-full max-w-2xl animate-in slide-in-from-right-10 fade-in duration-300",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full overflow-hidden rounded-2xl border shadow-2xl","dark"===r?"bg-[#0f0a1e]/95 backdrop-blur-md border-white/10 shadow-black/50":"bg-white/95 backdrop-blur-md border-purple-200/50 shadow-purple-500/10"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-4 border-b","dark"===r?"border-white/10":"border-purple-100"),children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold","dark"===r?"text-white":"text-gray-700"),children:"Auto-respuestas"}),(0,ep.jsx)("button",{onClick:t,className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-60px)]",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex gap-3 p-3 rounded-xl mb-4 border","dark"===r?"bg-[#1E88E5]/10 border-[#1E88E5]/30":"bg-blue-50 border-blue-200"),children:[(0,ep.jsx)(eZ,{className:(0,eg.cn)("w-5 h-5 flex-shrink-0 mt-0.5","dark"===r?"text-[#1E88E5]":"text-blue-500")}),(0,ep.jsxs)("div",{className:"text-xs space-y-1",children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium","dark"===r?"text-[#1E88E5]":"text-blue-700"),children:"Ventana anti-spam activa: 30 minutos"}),(0,ep.jsx)("p",{className:"dark"===r?"text-gray-400":"text-gray-600",children:"Durante esta ventana, solo se enva una auto-respuesta por contacto."})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("space-y-3 mb-6 p-4 rounded-xl border","dark"===r?"bg-white/5 border-white/10":"bg-purple-50/50 border-purple-100"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-medium mb-2","dark"===r?"text-gray-300":"text-gray-700"),children:y?"Editar Regla":"Nueva Regla"}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,ep.jsx)("input",{type:"text",value:a,onChange:e=>n(e.target.value),placeholder:"Palabra clave (ej: precio, info)",disabled:c,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2 disabled:opacity-50","dark"===r?"bg-black/20 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")}),(0,ep.jsxs)("select",{value:o,onChange:e=>l(e.target.value),disabled:c,className:(0,eg.cn)("px-3 py-2 rounded-lg text-sm border transition-all disabled:opacity-50","dark"===r?"bg-black/20 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700"),children:[(0,ep.jsx)("option",{value:"contains",children:"Contiene"}),(0,ep.jsx)("option",{value:"exact",children:"Exacto"}),(0,ep.jsx)("option",{value:"startsWith",children:"Empieza con"}),(0,ep.jsx)("option",{value:"endsWith",children:"Termina con"})]})]}),(0,ep.jsx)("textarea",{value:s,onChange:e=>i(e.target.value),placeholder:"Respuesta automtica...",rows:3,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2 resize-none","dark"===r?"bg-black/20 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")}),(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-4 pt-2",children:[(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,ep.jsx)("input",{type:"checkbox",checked:c,onChange:e=>d(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-purple-500 focus:ring-purple-500"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===r?"text-gray-300":"text-gray-600"),children:"Es respuesta por defecto (Fallback)"})]}),(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,ep.jsx)("input",{type:"checkbox",checked:u,onChange:e=>h(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-purple-500 focus:ring-purple-500"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===r?"text-gray-300":"text-gray-600"),children:"Activa"})]}),(0,ep.jsxs)("button",{onClick:k,disabled:x,className:(0,eg.cn)("ml-auto flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all disabled:opacity-50","dark"===r?"bg-[#17C787] hover:bg-[#17C787]/80 text-white":"bg-emerald-500 hover:bg-emerald-600 text-white"),children:[x?(0,ep.jsx)(e2.Loader2,{className:"w-4 h-4 animate-spin"}):(0,ep.jsx)(e0.Plus,{className:"w-4 h-4"}),y?"Actualizar":"Crear Regla"]})]})]}),(0,ep.jsx)("div",{className:"overflow-x-auto rounded-xl border overflow-hidden",children:(0,ep.jsxs)("table",{className:(0,eg.cn)("w-full text-xs","dark"===r?"border-white/10":"border-purple-100"),children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:"dark"===r?"bg-white/5":"bg-purple-50",children:[(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Keyword"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Respuesta"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Tipo"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-center font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Estado"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-center font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===r?"divide-white/5":"divide-purple-100"),children:m?(0,ep.jsx)("tr",{children:(0,ep.jsxs)("td",{colSpan:5,className:"p-8 text-center",children:[(0,ep.jsx)(e2.Loader2,{className:(0,eg.cn)("w-6 h-6 animate-spin mx-auto mb-2","dark"===r?"text-purple-400":"text-purple-600")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===r?"text-gray-500":"text-gray-400"),children:"Cargando reglas..."})]})}):0===f.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:5,className:"p-8 text-center",children:(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===r?"text-gray-500":"text-gray-400"),children:"No hay auto-respuestas configuradas"})})}):f.map(e=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors","dark"===r?"hover:bg-white/5":"hover:bg-purple-50/50"),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-2 font-medium","dark"===r?"text-white":"text-gray-700"),children:e.isFallback?(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-[10px]","dark"===r?"bg-rose-500/20 text-rose-300":"bg-rose-100 text-rose-600"),children:"FALLBACK"}):e.keyword}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-2 max-w-[200px] truncate","dark"===r?"text-gray-300":"text-gray-600"),children:e.response}),(0,ep.jsx)("td",{className:"px-3 py-2",children:!e.isFallback&&(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-[10px]","dark"===r?"bg-blue-500/20 text-blue-300":"bg-blue-100 text-blue-600"),children:e.matchType})}),(0,ep.jsx)("td",{className:"px-3 py-2 text-center",children:(0,ep.jsx)("button",{onClick:()=>N(e._id),className:(0,eg.cn)("px-2 py-0.5 rounded text-[10px] transition-colors",e.active?"dark"===r?"bg-emerald-500/20 text-emerald-300 hover:bg-emerald-500/30":"bg-emerald-100 text-emerald-600 hover:bg-emerald-200":"dark"===r?"bg-gray-500/20 text-gray-400 hover:bg-gray-500/30":"bg-gray-100 text-gray-500 hover:bg-gray-200"),children:e.active?"Activa":"Inactiva"})}),(0,ep.jsx)("td",{className:"px-3 py-2",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,ep.jsx)("button",{onClick:()=>{n(e.isFallback?"":e.keyword),i(e.response),l(e.matchType||"contains"),d(e.isFallback),h(e.active),v(e._id)},className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"bg-blue-500/10 text-blue-400 hover:bg-blue-500/20":"bg-blue-50 text-blue-600 hover:bg-blue-100"),children:(0,ep.jsx)(e1,{className:"w-3.5 h-3.5"})}),(0,ep.jsx)("button",{onClick:()=>j(e._id),className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"bg-rose-500/10 text-rose-400 hover:bg-rose-500/20":"bg-rose-50 text-rose-600 hover:bg-rose-100"),children:(0,ep.jsx)(eU.Trash2,{className:"w-3.5 h-3.5"})})]})})]},e._id))})]})})]})]})}):null}function e4({isOpen:e,onClose:t,onInsert:r}){let{theme:a}=(0,ex.useTheme)(),[n,s]=(0,em.useState)(["",""]);if(!e)return null;let i=()=>{s(["",""]),t()};return(0,ep.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-2xl animate-scale-in","dark"===a?"bg-gradient-to-br from-gray-900 to-gray-800 border-white/10":"bg-white border-purple-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg","dark"===a?"bg-purple-500/20":"bg-purple-100"),children:(0,ep.jsx)(eY.Sparkles,{className:(0,eg.cn)("w-5 h-5","dark"===a?"text-purple-400":"text-purple-600")})}),(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold","dark"===a?"text-white":"text-gray-800"),children:"Crear Spintax"})]}),(0,ep.jsx)("button",{onClick:i,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===a?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("mb-4 p-3 rounded-lg text-sm","dark"===a?"bg-blue-500/10 text-blue-300 border border-blue-500/20":"bg-blue-50 text-blue-700 border border-blue-200"),children:[(0,ep.jsx)("p",{className:"font-medium mb-1",children:"Qu es Spintax?"}),(0,ep.jsx)("p",{className:"text-xs opacity-90",children:"Spintax permite crear variaciones de texto. El sistema elegir aleatoriamente una de las opciones que ingreses, haciendo cada mensaje nico y evitando que parezcan automticos."})]}),(0,ep.jsx)("div",{className:"space-y-3 mb-4 max-h-[300px] overflow-y-auto",children:n.map((e,t)=>(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-xs font-medium mb-1","dark"===a?"text-gray-400":"text-gray-600"),children:["Opcin ",t+1]}),(0,ep.jsx)("input",{type:"text",value:e,onChange:e=>{var r;let a;return r=e.target.value,void((a=[...n])[t]=r,s(a))},placeholder:`Ejemplo: "${0===t?"Hola":1===t?"Buenos das":"Saludos"}"`,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2","dark"===a?"bg-white/5 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")})]}),n.length>2&&(0,ep.jsx)("button",{onClick:()=>{n.length>2&&s(n.filter((e,r)=>r!==t))},className:(0,eg.cn)("mt-6 p-2 rounded-lg transition-colors","dark"===a?"hover:bg-red-500/20 text-red-400":"hover:bg-red-100 text-red-600"),title:"Eliminar opcin",children:(0,ep.jsx)(eU.Trash2,{className:"w-4 h-4"})})]},t))}),(0,ep.jsxs)("button",{onClick:()=>{s([...n,""])},className:(0,eg.cn)("w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all mb-4","dark"===a?"bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10":"bg-gray-50 hover:bg-gray-100 text-gray-700 border border-gray-200"),children:[(0,ep.jsx)(e0.Plus,{className:"w-4 h-4"}),"Agregar opcin"]}),n.filter(e=>""!==e.trim()).length>=2&&(0,ep.jsxs)("div",{className:(0,eg.cn)("mb-4 p-3 rounded-lg text-sm","dark"===a?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium mb-1","dark"===a?"text-green-300":"text-green-700"),children:"Vista previa:"}),(0,ep.jsx)("code",{className:(0,eg.cn)("text-xs","dark"===a?"text-green-200":"text-green-600"),children:`{${n.filter(e=>""!==e.trim()).join("|")}}`})]}),(0,ep.jsxs)("div",{className:"flex gap-3",children:[(0,ep.jsx)("button",{onClick:i,className:(0,eg.cn)("flex-1 px-4 py-2.5 rounded-lg text-sm font-medium transition-all","dark"===a?"bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10":"bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-200"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:()=>{let e=n.filter(e=>""!==e.trim());e.length<2?alert("Debes ingresar al menos 2 opciones"):(r(`{${e.join("|")}}`),s(["",""]),t())},className:(0,eg.cn)("flex-1 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all","dark"===a?"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white shadow-lg shadow-purple-500/20":"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white shadow-lg shadow-purple-200/50"),children:"Insertar Spintax"})]})]})})}let e3=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],e6=new Set(e3),e8=e=>180*e/Math.PI,e7=e=>te(e8(Math.atan2(e[1],e[0]))),e9={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:e7,rotateZ:e7,skewX:e=>e8(Math.atan(e[1])),skewY:e=>e8(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},te=e=>((e%=360)<0&&(e+=360),e),tt=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),tr=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),ta={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:tt,scaleY:tr,scale:e=>(tt(e)+tr(e))/2,rotateX:e=>te(e8(Math.atan2(e[6],e[5]))),rotateY:e=>te(e8(Math.atan2(-e[2],e[0]))),rotateZ:e7,rotate:e7,skewX:e=>e8(Math.atan(e[4])),skewY:e=>e8(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function tn(e){return+!!e.includes("scale")}function ts(e,t){let r,a;if(!e||"none"===e)return tn(t);let n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(n)r=ta,a=n;else{let t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=e9,a=t}if(!a)return tn(t);let s=r[t],i=a[1].split(",").map(ti);return"function"==typeof s?s(i):i[s]}function ti(e){return parseFloat(e.trim())}let to=e=>t=>"string"==typeof t&&t.startsWith(e),tl=to("--"),tc=to("var(--"),td=e=>!!tc(e)&&tu.test(e.split("/*")[0].trim()),tu=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function th({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}let tf=(e,t,r)=>e+(t-e)*r;function tp(e){return void 0===e||1===e}function tm({scale:e,scaleX:t,scaleY:r}){return!tp(e)||!tp(t)||!tp(r)}function tg(e){return tm(e)||tx(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function tx(e){var t,r;return(t=e.x)&&"0%"!==t||(r=e.y)&&"0%"!==r}function tb(e,t,r,a,n){return void 0!==n&&(e=a+n*(e-a)),a+r*(e-a)+t}function ty(e,t=0,r=1,a,n){e.min=tb(e.min,t,r,a,n),e.max=tb(e.max,t,r,a,n)}function tv(e,{x:t,y:r}){ty(e.x,t.translate,t.scale,t.originPoint),ty(e.y,r.translate,r.scale,r.originPoint)}function tw(e,t){e.min=e.min+t,e.max=e.max+t}function tk(e,t,r,a,n=.5){let s=tf(e.min,e.max,n);ty(e,t,r,s,a)}function tj(e,t){tk(e.x,t.x,t.scaleX,t.scale,t.originX),tk(e.y,t.y,t.scaleY,t.scale,t.originY)}function tN(e,t){return th(function(e,t){if(!t)return e;let r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}(e.getBoundingClientRect(),t))}let tS=new Set(["width","height","top","left","right","bottom",...e3]),tE=(e,t,r)=>r>t?t:r<e?e:r,tC={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},tT={...tC,transform:e=>tE(0,1,e)},tA={...tC,default:1},t_=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),tO=t_("deg"),tP=t_("%"),tD=t_("px"),tR=t_("vh"),tM=t_("vw"),tI={...tP,parse:e=>tP.parse(e)/100,transform:e=>tP.transform(100*e)},tL=e=>t=>t.test(e),tF=[tC,tD,tP,tO,tM,tR,{test:e=>"auto"===e,parse:e=>e}],tB=e=>tF.find(tL(e));var tU=e.i(57954);let tz=()=>{},tV=()=>{},t$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,tH=e=>e===tC||e===tD,tW=new Set(["x","y","z"]),tq=e3.filter(e=>!tW.has(e)),tG={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>ts(t,"x"),y:(e,{transform:t})=>ts(t,"y")};tG.translateX=tG.x,tG.translateY=tG.y;let tK=e=>e,tX={},tY=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function tQ(e,t){let r=!1,a=!0,n={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,i=tY.reduce((e,r)=>(e[r]=function(e,t){let r=new Set,a=new Set,n=!1,s=!1,i=new WeakSet,o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){i.has(t)&&(d.schedule(t),e()),l++,t(o)}let d={schedule:(e,t=!1,s=!1)=>{let o=s&&n?r:a;return t&&i.add(e),o.has(e)||o.add(e),e},cancel:e=>{a.delete(e),i.delete(e)},process:e=>{if(o=e,n){s=!0;return}n=!0,[r,a]=[a,r],r.forEach(c),t,l=0,r.clear(),n=!1,s&&(s=!1,d.process(e))}};return d}(s,t?r:void 0),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:h,render:f,postRender:p}=i,m=()=>{let s=tX.useManualTiming?n.timestamp:performance.now();r=!1,tX.useManualTiming||(n.delta=a?1e3/60:Math.max(Math.min(s-n.timestamp,40),1)),n.timestamp=s,n.isProcessing=!0,o.process(n),l.process(n),c.process(n),d.process(n),u.process(n),h.process(n),f.process(n),p.process(n),n.isProcessing=!1,r&&t&&(a=!1,e(m))};return{schedule:tY.reduce((t,s)=>{let o=i[s];return t[s]=(t,s=!1,i=!1)=>(!r&&(r=!0,a=!0,n.isProcessing||e(m)),o.schedule(t,s,i)),t},{}),cancel:e=>{for(let t=0;t<tY.length;t++)i[tY[t]].cancel(e)},state:n,steps:i}}let{schedule:tJ,cancel:tZ,state:t0,steps:t1}=tQ("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:tK,!0),t2=new Set,t5=!1,t4=!1,t3=!1;function t6(){if(t4){let e=Array.from(t2).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),r=new Map;t.forEach(e=>{let t,a=(t=[],tq.forEach(r=>{let a=e.getValue(r);void 0!==a&&(t.push([r,a.get()]),a.set(+!!r.startsWith("scale")))}),t);a.length&&(r.set(e,a),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=r.get(e);t&&t.forEach(([t,r])=>{e.getValue(t)?.set(r)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}t4=!1,t5=!1,t2.forEach(e=>e.complete(t3)),t2.clear()}function t8(){t2.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(t4=!0)})}class t7{constructor(e,t,r,a,n,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=a,this.element=n,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(t2.add(this),t5||(t5=!0,tJ.read(t8),tJ.resolveKeyframes(t6))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:r,motionValue:a}=this;if(null===e[0]){let n=a?.get(),s=e[e.length-1];if(void 0!==n)e[0]=n;else if(r&&t){let a=r.readValue(t,s);null!=a&&(e[0]=a)}void 0===e[0]&&(e[0]=s),a&&void 0===n&&a.set(e[0])}for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),t2.delete(this)}cancel(){"scheduled"===this.state&&(t2.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}let t9=e=>Math.round(1e5*e)/1e5,re=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,rt=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,rr=(e,t)=>r=>!!("string"==typeof r&&rt.test(r)&&r.startsWith(e)||t&&null!=r&&Object.prototype.hasOwnProperty.call(r,t)),ra=(e,t,r)=>a=>{if("string"!=typeof a)return a;let[n,s,i,o]=a.match(re);return{[e]:parseFloat(n),[t]:parseFloat(s),[r]:parseFloat(i),alpha:void 0!==o?parseFloat(o):1}},rn={...tC,transform:e=>Math.round(tE(0,255,e))},rs={test:rr("rgb","red"),parse:ra("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+rn.transform(e)+", "+rn.transform(t)+", "+rn.transform(r)+", "+t9(tT.transform(a))+")"},ri={test:rr("#"),parse:function(e){let t="",r="",a="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,a+=a,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:n?parseInt(n,16)/255:1}},transform:rs.transform},ro={test:rr("hsl","hue"),parse:ra("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+tP.transform(t9(t))+", "+tP.transform(t9(r))+", "+t9(tT.transform(a))+")"},rl={test:e=>rs.test(e)||ri.test(e)||ro.test(e),parse:e=>rs.test(e)?rs.parse(e):ro.test(e)?ro.parse(e):ri.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?rs.transform(e):ro.transform(e),getAnimatableNone:e=>{let t=rl.parse(e);return t.alpha=0,rl.transform(t)}},rc=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,rd="number",ru="color",rh=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function rf(e){let t=e.toString(),r=[],a={color:[],number:[],var:[]},n=[],s=0,i=t.replace(rh,e=>(rl.test(e)?(a.color.push(s),n.push(ru),r.push(rl.parse(e))):e.startsWith("var(")?(a.var.push(s),n.push("var"),r.push(e)):(a.number.push(s),n.push(rd),r.push(parseFloat(e))),++s,"${}")).split("${}");return{values:r,split:i,indexes:a,types:n}}function rp(e){return rf(e).values}function rm(e){let{split:t,types:r}=rf(e),a=t.length;return e=>{let n="";for(let s=0;s<a;s++)if(n+=t[s],void 0!==e[s]){let t=r[s];t===rd?n+=t9(e[s]):t===ru?n+=rl.transform(e[s]):n+=e[s]}return n}}let rg=e=>"number"==typeof e?0:rl.test(e)?rl.getAnimatableNone(e):e,rx={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(re)?.length||0)+(e.match(rc)?.length||0)>0},parse:rp,createTransformer:rm,getAnimatableNone:function(e){let t=rp(e);return rm(e)(t.map(rg))}},rb=new Set(["brightness","contrast","saturate","opacity"]);function ry(e){let[t,r]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[a]=r.match(re)||[];if(!a)return e;let n=r.replace(a,""),s=+!!rb.has(t);return a!==r&&(s*=100),t+"("+s+n+")"}let rv=/\b([a-z-]*)\(.*?\)/gu,rw={...rx,getAnimatableNone:e=>{let t=e.match(rv);return t?t.map(ry).join(" "):e}},rk={...tC,transform:Math.round},rj={borderWidth:tD,borderTopWidth:tD,borderRightWidth:tD,borderBottomWidth:tD,borderLeftWidth:tD,borderRadius:tD,radius:tD,borderTopLeftRadius:tD,borderTopRightRadius:tD,borderBottomRightRadius:tD,borderBottomLeftRadius:tD,width:tD,maxWidth:tD,height:tD,maxHeight:tD,top:tD,right:tD,bottom:tD,left:tD,padding:tD,paddingTop:tD,paddingRight:tD,paddingBottom:tD,paddingLeft:tD,margin:tD,marginTop:tD,marginRight:tD,marginBottom:tD,marginLeft:tD,backgroundPositionX:tD,backgroundPositionY:tD,rotate:tO,rotateX:tO,rotateY:tO,rotateZ:tO,scale:tA,scaleX:tA,scaleY:tA,scaleZ:tA,skew:tO,skewX:tO,skewY:tO,distance:tD,translateX:tD,translateY:tD,translateZ:tD,x:tD,y:tD,z:tD,perspective:tD,transformPerspective:tD,opacity:tT,originX:tI,originY:tI,originZ:tD,zIndex:rk,fillOpacity:tT,strokeOpacity:tT,numOctaves:rk},rN={...rj,color:rl,backgroundColor:rl,outlineColor:rl,fill:rl,stroke:rl,borderColor:rl,borderTopColor:rl,borderRightColor:rl,borderBottomColor:rl,borderLeftColor:rl,filter:rw,WebkitFilter:rw},rS=e=>rN[e];function rE(e,t){let r=rS(e);return r!==rw&&(r=rx),r.getAnimatableNone?r.getAnimatableNone(t):void 0}let rC=new Set(["auto","none","0"]);class rT extends t7{constructor(e,t,r,a,n){super(e,t,r,a,n,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let r=0;r<e.length;r++){let a=e[r];if("string"==typeof a&&td(a=a.trim())){let n=function e(t,r,a=1){tV(a<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[n,s]=function(e){let t=t$.exec(e);if(!t)return[,];let[,r,a,n]=t;return[`--${r??a}`,n]}(t);if(!n)return;let i=window.getComputedStyle(r).getPropertyValue(n);if(i){let e=i.trim();return/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e)?parseFloat(e):e}return td(s)?e(s,r,a+1):s}(a,t.current);void 0!==n&&(e[r]=n),r===e.length-1&&(this.finalKeyframe=a)}}if(this.resolveNoneKeyframes(),!tS.has(r)||2!==e.length)return;let[a,n]=e,s=tB(a),i=tB(n);if(s!==i)if(tH(s)&&tH(i))for(let t=0;t<e.length;t++){let r=e[t];"string"==typeof r&&(e[t]=parseFloat(r))}else tG[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,r=[];for(let t=0;t<e.length;t++)(null===e[t]||function(e){if("number"==typeof e)return 0===e;if(null===e)return!0;return"none"===e||"0"===e||/^0[^.\s]+$/u.test(e)}(e[t]))&&r.push(t);r.length&&function(e,t,r){let a,n=0;for(;n<e.length&&!a;){let t=e[n];"string"==typeof t&&!rC.has(t)&&rf(t).values.length&&(a=e[n]),n++}if(a&&r)for(let n of t)e[n]=rE(r,a)}(e,r,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;"height"===r&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tG[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let a=t[t.length-1];void 0!==a&&e.getValue(r,a).jump(a,!1)}measureEndState(){let{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;let a=e.getValue(t);a&&a.jump(this.measuredOrigin,!1);let n=r.length-1,s=r[n];r[n]=tG[t](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==s&&void 0===this.finalKeyframe&&(this.finalKeyframe=s),this.removedTransforms?.length&&this.removedTransforms.forEach(([t,r])=>{e.getValue(t).set(r)}),this.resolveNoneKeyframes()}}let rA=e=>!!(e&&e.getVelocity);function r_(){t=void 0}let rO={now:()=>(void 0===t&&rO.set(t0.isProcessing||tX.useManualTiming?t0.timestamp:performance.now()),t),set:e=>{t=e,queueMicrotask(r_)}};function rP(e,t){-1===e.indexOf(t)&&e.push(t)}function rD(e,t){let r=e.indexOf(t);r>-1&&e.splice(r,1)}class rR{constructor(){this.subscriptions=[]}add(e){return rP(this.subscriptions,e),()=>rD(this.subscriptions,e)}notify(e,t,r){let a=this.subscriptions.length;if(a)if(1===a)this.subscriptions[0](e,t,r);else for(let n=0;n<a;n++){let a=this.subscriptions[n];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}class rM{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{let t=rO.now();if(this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let e of this.dependents)e.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=rO.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=!isNaN(parseFloat(this.current)))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new rR);let r=this.events[e].add(t);return"change"===e?()=>{r(),tJ.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return s&&s.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=rO.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let r=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),r?1e3/r*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function rI(e,t){return new rM(e,t)}let rL=[...tF,rl,rx],{schedule:rF}=tQ(queueMicrotask,!1),rB={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},rU={};for(let e in rB)rU[e]={isEnabled:t=>rB[e].some(e=>!!t[e])};let rz=()=>({translate:0,scale:1,origin:0,originPoint:0}),rV=()=>({x:rz(),y:rz()}),r$=()=>({min:0,max:0}),rH=()=>({x:r$(),y:r$()}),rW="undefined"!=typeof window,rq={current:null},rG={current:!1},rK=new WeakMap;function rX(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function rY(e){return"string"==typeof e||Array.isArray(e)}let rQ=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],rJ=["initial",...rQ];function rZ(e){return rX(e.animate)||rJ.some(t=>rY(e[t]))}function r0(e){return!!(rZ(e)||e.variants)}function r1(e){let t=[{},{}];return e?.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function r2(e,t,r,a){if("function"==typeof t){let[n,s]=r1(a);t=t(void 0!==r?r:e.custom,n,s)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[n,s]=r1(a);t=t(void 0!==r?r:e.custom,n,s)}return t}let r5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class r4{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:a,blockInitialAnimation:n,visualState:s},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=t7,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=rO.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,tJ.render(this.render,!1,!0))};const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!n,this.isControllingVariants=rZ(t),this.isVariantNode=r0(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const e in d){const t=d[e];void 0!==o[e]&&rA(t)&&t.set(o[e])}}mount(e){this.current=e,rK.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),rG.current||function(){if(rG.current=!0,rW)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>rq.current=e.matches;e.addEventListener("change",t),t()}else rq.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||rq.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in this.projection&&this.projection.unmount(),tZ(this.notifyUpdate),tZ(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this),this.events)this.events[e].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){let r;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let a=e6.has(e);a&&this.onBindTransform&&this.onBindTransform();let n=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&tJ.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{n(),r&&r(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in rU){let t=rU[e];if(!t)continue;let{isEnabled:r,Feature:a}=t;if(!this.features[e]&&a&&r(this.props)&&(this.features[e]=new a(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rH()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<r5.length;t++){let r=r5[t];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);let a=e["on"+r];a&&(this.propEventSubscriptions[r]=this.on(r,a))}this.prevMotionValues=function(e,t,r){for(let a in t){let n=t[a],s=r[a];if(rA(n))e.addValue(a,n);else if(rA(s))e.addValue(a,rI(n,{owner:e}));else if(s!==n)if(e.hasValue(a)){let t=e.getValue(a);!0===t.liveStyle?t.jump(n):t.hasAnimated||t.set(n)}else{let t=e.getStaticValue(a);e.addValue(a,rI(void 0!==t?t:n,{owner:e}))}}for(let a in r)void 0===t[a]&&e.removeValue(a);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return void 0===r&&void 0!==t&&(r=rI(null===t?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];if(null!=r){let a,n;if("string"==typeof r&&(a=r,/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(a)||(n=r,/^0[^.\s]+$/u.test(n))))r=parseFloat(r);else{let a;a=r,!rL.find(tL(a))&&rx.test(t)&&(r=rE(e,t))}this.setBaseTarget(e,rA(r)?r.get():r)}return rA(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){let t,{initial:r}=this.props;if("string"==typeof r||"object"==typeof r){let a=r2(this.props,r,this.presenceContext?.custom);a&&(t=a[e])}if(r&&void 0!==t)return t;let a=this.getBaseTargetFromProps(this.props,e);return void 0===a||rA(a)?void 0!==this.initialValues[e]&&void 0===t?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new rR),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){rF.render(this.render)}}class r3 extends r4{constructor(){super(...arguments),this.KeyframeResolver=rT}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;rA(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}let r6=(e,t)=>t&&"number"==typeof e?t.transform(e):e,r8={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},r7=e3.length;function r9(e,t,r){let{style:a,vars:n,transformOrigin:s}=e,i=!1,o=!1;for(let e in t){let r=t[e];if(e6.has(e)){i=!0;continue}if(tl(e)){n[e]=r;continue}{let t=r6(r,rj[e]);e.startsWith("origin")?(o=!0,s[e]=t):a[e]=t}}if(!t.transform&&(i||r?a.transform=function(e,t,r){let a="",n=!0;for(let s=0;s<r7;s++){let i=e3[s],o=e[i];if(void 0===o)continue;let l=!0;if(!(l="number"==typeof o?o===+!!i.startsWith("scale"):0===parseFloat(o))||r){let e=r6(o,rj[i]);if(!l){n=!1;let t=r8[i]||i;a+=`${t}(${e}) `}r&&(t[i]=e)}}return a=a.trim(),r?a=r(t,n?"":a):n&&(a="none"),a}(t,e.transform,r):a.transform&&(a.transform="none")),o){let{originX:e="50%",originY:t="50%",originZ:r=0}=s;a.transformOrigin=`${e} ${t} ${r}`}}function ae(e,{style:t,vars:r},a,n){let s,i=e.style;for(s in t)i[s]=t[s];for(s in n?.applyProjectionStyles(i,a),r)i.setProperty(s,r[s])}let at={};function ar(e,{layout:t,layoutId:r}){return e6.has(e)||e.startsWith("origin")||(t||void 0!==r)&&(!!at[e]||"opacity"===e)}function aa(e,t,r){let{style:a}=e,n={};for(let s in a)(rA(a[s])||t.style&&rA(t.style[s])||ar(s,e)||r?.getValue(s)?.liveStyle!==void 0)&&(n[s]=a[s]);return n}class an extends r3{constructor(){super(...arguments),this.type="html",this.renderInstance=ae}readValueFromInstance(e,t){if(e6.has(t))return this.projection?.isProjecting?tn(t):((e,t)=>{let{transform:r="none"}=getComputedStyle(e);return ts(r,t)})(e,t);{let r=window.getComputedStyle(e),a=(tl(t)?r.getPropertyValue(t):r[t])||0;return"string"==typeof a?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:t}){return tN(e,t)}build(e,t,r){r9(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return aa(e,t,r)}}let as=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ai={offset:"stroke-dashoffset",array:"stroke-dasharray"},ao={offset:"strokeDashoffset",array:"strokeDasharray"};function al(e,{attrX:t,attrY:r,attrScale:a,pathLength:n,pathSpacing:s=1,pathOffset:i=0,...o},l,c,d){if(r9(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:u,style:h}=e;u.transform&&(h.transform=u.transform,delete u.transform),(h.transform||u.transformOrigin)&&(h.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),h.transform&&(h.transformBox=d?.transformBox??"fill-box",delete u.transformBox),void 0!==t&&(u.x=t),void 0!==r&&(u.y=r),void 0!==a&&(u.scale=a),void 0!==n&&function(e,t,r=1,a=0,n=!0){e.pathLength=1;let s=n?ai:ao;e[s.offset]=tD.transform(-a);let i=tD.transform(t),o=tD.transform(r);e[s.array]=`${i} ${o}`}(u,n,s,i,!1)}let ac=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),ad=e=>"string"==typeof e&&"svg"===e.toLowerCase();function au(e,t,r){let a=aa(e,t,r);for(let r in e)(rA(e[r])||rA(t[r]))&&(a[-1!==e3.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]);return a}class ah extends r3{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=rH}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(e6.has(t)){let e=rS(t);return e&&e.default||0}return t=ac.has(t)?t:as(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return au(e,t,r)}build(e,t,r){al(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,a){for(let r in ae(e,t,void 0,a),t.attrs)e.setAttribute(ac.has(r)?r:as(r),t.attrs[r])}mount(e){this.isSVGTag=ad(e.tagName),super.mount(e)}}let af=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ap(e){if("string"!=typeof e||e.includes("-"));else if(af.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}let am=(0,em.createContext)({}),ag=(0,em.createContext)({strict:!1}),ax=(0,em.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),ab=(0,em.createContext)({});function ay(e){return Array.isArray(e)?e.join(" "):e}let av=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function aw(e,t,r){for(let a in t)rA(t[a])||ar(a,r)||(e[a]=t[a])}let ak=()=>({...av(),attrs:{}}),aj=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function aN(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||aj.has(e)}let aS=e=>!aN(e);try{i=(()=>{let e=Error("Cannot find module '@emotion/is-prop-valid'");throw e.code="MODULE_NOT_FOUND",e})().default,"function"==typeof i&&(aS=e=>e.startsWith("on")?!aN(e):i(e))}catch{}let aE=(0,em.createContext)(null);function aC(e){let t=(0,em.useRef)(null);return null===t.current&&(t.current=e()),t.current}function aT(e){return rA(e)?e.get():e}let aA=e=>(t,r)=>{let a=(0,em.useContext)(ab),n=(0,em.useContext)(aE),s=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t},r,a,n){return{latestValues:function(e,t,r,a){let n={},s=a(e,{});for(let e in s)n[e]=aT(s[e]);let{initial:i,animate:o}=e,l=rZ(e),c=r0(e);t&&c&&!l&&!1!==e.inherit&&(void 0===i&&(i=t.initial),void 0===o&&(o=t.animate));let d=!!r&&!1===r.initial,u=(d=d||!1===i)?o:i;if(u&&"boolean"!=typeof u&&!rX(u)){let t=Array.isArray(u)?u:[u];for(let r=0;r<t.length;r++){let a=r2(e,t[r]);if(a){let{transitionEnd:e,transition:t,...r}=a;for(let e in r){let t=r[e];if(Array.isArray(t)){let e=d?t.length-1:0;t=t[e]}null!==t&&(n[e]=t)}for(let t in e)n[t]=e[t]}}}return n}(r,a,n,e),renderState:t()}})(e,t,a,n);return r?s():aC(s)},a_=aA({scrapeMotionValuesFromProps:aa,createRenderState:av}),aO=aA({scrapeMotionValuesFromProps:au,createRenderState:ak}),aP=Symbol.for("motionComponentSymbol");function aD(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}let aR="data-"+as("framerAppearId"),aM=(0,em.createContext)({}),aI=rW?em.useLayoutEffect:em.useEffect;function aL(e,{forwardMotionProps:t=!1}={},r,a){r&&function(e){for(let t in e)rU[t]={...rU[t],...e[t]}}(r);let n=ap(e)?aO:a_;function s(r,s){var i;let o,l={...(0,em.useContext)(ax),...r,layoutId:function({layoutId:e}){let t=(0,em.useContext)(am).id;return t&&void 0!==e?t+"-"+e:e}(r)},{isStatic:c}=l,d=function(e){let{initial:t,animate:r}=function(e,t){if(rZ(e)){let{initial:t,animate:r}=e;return{initial:!1===t||rY(t)?t:void 0,animate:rY(r)?r:void 0}}return!1!==e.inherit?t:{}}(e,(0,em.useContext)(ab));return(0,em.useMemo)(()=>({initial:t,animate:r}),[ay(t),ay(r)])}(r),u=n(r,c);if(!c&&rW){(0,em.useContext)(ag).strict;let t=function(e){let{drag:t,layout:r}=rU;if(!t&&!r)return{};let a={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}(l);o=t.MeasureLayout,d.visualElement=function(e,t,r,a,n){let{visualElement:s}=(0,em.useContext)(ab),i=(0,em.useContext)(ag),o=(0,em.useContext)(aE),l=(0,em.useContext)(ax).reducedMotion,c=(0,em.useRef)(null);a=a||i.renderer,!c.current&&a&&(c.current=a(e,{visualState:t,parent:s,props:r,presenceContext:o,blockInitialAnimation:!!o&&!1===o.initial,reducedMotionConfig:l}));let d=c.current,u=(0,em.useContext)(aM);d&&!d.projection&&n&&("html"===d.type||"svg"===d.type)&&function(e,t,r,a){let{layoutId:n,layout:s,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:n,layout:s,alwaysMeasureLayout:!!i||o&&aD(o),visualElement:e,animationType:"string"==typeof s?s:"both",initialPromotionConfig:a,crossfade:d,layoutScroll:l,layoutRoot:c})}(c.current,r,n,u);let h=(0,em.useRef)(!1);(0,em.useInsertionEffect)(()=>{d&&h.current&&d.update(r,o)});let f=r[aR],p=(0,em.useRef)(!!f&&!window.MotionHandoffIsComplete?.(f)&&window.MotionHasOptimisedAnimation?.(f));return aI(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),p.current&&d.animationState&&d.animationState.animateChanges())}),(0,em.useEffect)(()=>{d&&(!p.current&&d.animationState&&d.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(f)}),p.current=!1),d.enteringChildren=void 0)}),d}(e,u,l,a,t.ProjectionNode)}return(0,ep.jsxs)(ab.Provider,{value:d,children:[o&&d.visualElement?(0,ep.jsx)(o,{visualElement:d.visualElement,...l}):null,function(e,t,r,{latestValues:a},n,s=!1){let i=(ap(e)?function(e,t,r,a){let n=(0,em.useMemo)(()=>{let r=ak();return al(r,t,ad(a),e.transformTemplate,e.style),{...r.attrs,style:{...r.style}}},[t]);if(e.style){let t={};aw(t,e.style,e),n.style={...t,...n.style}}return n}:function(e,t){let r,a,n={},s=(r=e.style||{},aw(a={},r,e),Object.assign(a,function({transformTemplate:e},t){return(0,em.useMemo)(()=>{let r=av();return r9(r,t,e),Object.assign({},r.vars,r.style)},[t])}(e,t)),a);return e.drag&&!1!==e.dragListener&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n})(t,a,n,e),o=function(e,t,r){let a={};for(let n in e)("values"!==n||"object"!=typeof e.values)&&(aS(n)||!0===r&&aN(n)||!t&&!aN(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}(t,"string"==typeof e,s),l=e!==em.Fragment?{...o,...i,ref:r}:{},{children:c}=t,d=(0,em.useMemo)(()=>rA(c)?c.get():c,[c]);return(0,em.createElement)(e,{...l,children:d})}(e,r,(i=d.visualElement,(0,em.useCallback)(e=>{e&&u.onMount&&u.onMount(e),i&&(e?i.mount(e):i.unmount()),s&&("function"==typeof s?s(e):aD(s)&&(s.current=e))},[i])),u,c,t)]})}s.displayName=`motion.${"string"==typeof e?e:`create(${e.displayName??e.name??""})`}`;let i=(0,em.forwardRef)(s);return i[aP]=e,i}function aF(e,t,r){let a=e.getProps();return r2(a,t,void 0!==r?r:a.custom,e)}function aB(e,t){return e?.[t]??e?.default??e}let aU=e=>Array.isArray(e);function az(e,t){let r=e.getValue("willChange");if(rA(r)&&r.add)return r.add(t);if(!r&&tX.WillChange){let r=new tX.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function aV(e){e.duration=0,e.type="keyframes"}let a$=(e,t)=>r=>t(e(r)),aH=(...e)=>e.reduce(a$),aW=e=>1e3*e,aq={layout:0,mainThread:0,waapi:0};function aG(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function aK(e,t){return r=>r>0?t:e}let aX=(e,t,r)=>{let a=e*e,n=r*(t*t-a)+a;return n<0?0:Math.sqrt(n)},aY=[ri,rs,ro];function aQ(e){let t=aY.find(t=>t.test(e));if(tz(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!t)return!1;let r=t.parse(e);return t===ro&&(r=function({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,r/=100;let n=0,s=0,i=0;if(t/=100){let a=r<.5?r*(1+t):r+t-r*t,o=2*r-a;n=aG(o,a,e+1/3),s=aG(o,a,e),i=aG(o,a,e-1/3)}else n=s=i=r;return{red:Math.round(255*n),green:Math.round(255*s),blue:Math.round(255*i),alpha:a}}(r)),r}let aJ=(e,t)=>{let r=aQ(e),a=aQ(t);if(!r||!a)return aK(e,t);let n={...r};return e=>(n.red=aX(r.red,a.red,e),n.green=aX(r.green,a.green,e),n.blue=aX(r.blue,a.blue,e),n.alpha=tf(r.alpha,a.alpha,e),rs.transform(n))},aZ=new Set(["none","hidden"]);function a0(e,t){return r=>tf(e,t,r)}function a1(e){return"number"==typeof e?a0:"string"==typeof e?td(e)?aK:rl.test(e)?aJ:a4:Array.isArray(e)?a2:"object"==typeof e?rl.test(e)?aJ:a5:aK}function a2(e,t){let r=[...e],a=r.length,n=e.map((e,r)=>a1(e)(e,t[r]));return e=>{for(let t=0;t<a;t++)r[t]=n[t](e);return r}}function a5(e,t){let r={...e,...t},a={};for(let n in r)void 0!==e[n]&&void 0!==t[n]&&(a[n]=a1(e[n])(e[n],t[n]));return e=>{for(let t in a)r[t]=a[t](e);return r}}let a4=(e,t)=>{let r=rx.createTransformer(t),a=rf(e),n=rf(t);if(!(a.indexes.var.length===n.indexes.var.length&&a.indexes.color.length===n.indexes.color.length&&a.indexes.number.length>=n.indexes.number.length))return tz(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),aK(e,t);if(aZ.has(e)&&!n.values.length||aZ.has(t)&&!a.values.length)return aZ.has(e)?r=>r<=0?e:t:r=>r>=1?t:e;return aH(a2(function(e,t){let r=[],a={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){let s=t.types[n],i=e.indexes[s][a[s]],o=e.values[i]??0;r[n]=o,a[s]++}return r}(a,n),n.values),r)};function a3(e,t,r){return"number"==typeof e&&"number"==typeof t&&"number"==typeof r?tf(e,t,r):a1(e)(e,t)}let a6=e=>{let t=({timestamp:t})=>e(t);return{start:(e=!0)=>tJ.update(t,e),stop:()=>tZ(t),now:()=>t0.isProcessing?t0.timestamp:rO.now()}},a8=(e,t,r=10)=>{let a="",n=Math.max(Math.round(t/r),2);for(let t=0;t<n;t++)a+=Math.round(1e4*e(t/(n-1)))/1e4+", ";return`linear(${a.substring(0,a.length-2)})`};function a7(e){let t=0,r=e.next(t);for(;!r.done&&t<2e4;)t+=50,r=e.next(t);return t>=2e4?1/0:t}function a9(e,t,r){var a,n;let s=Math.max(t-5,0);return a=r-e(s),(n=t-s)?1e3/n*a:0}let ne=.01,nt=2,nr=.005,na=.5;function nn(e,t){return e*Math.sqrt(1-t*t)}let ns=["duration","bounce"],ni=["stiffness","damping","mass"];function no(e,t){return t.some(t=>void 0!==e[t])}function nl(e=.3,t=.3){let r,a="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:n,restDelta:s}=a,i=a.keyframes[0],o=a.keyframes[a.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:d,mass:u,duration:h,velocity:f,isResolvedFromDuration:p}=function(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!no(e,ni)&&no(e,ns))if(e.visualDuration){let r=2*Math.PI/(1.2*e.visualDuration),a=r*r,n=2*tE(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:1,stiffness:a,damping:n}}else{let r=function({duration:e=800,bounce:t=.3,velocity:r=0,mass:a=1}){let n,s;tz(e<=aW(10),"Spring duration must be 10 seconds or less","spring-duration-limit");let i=1-t;i=tE(.05,1,i),e=tE(.01,10,e/1e3),i<1?(n=t=>{let a=t*i,n=a*e;return .001-(a-r)/nn(t,i)*Math.exp(-n)},s=t=>{let a=t*i*e,s=Math.pow(i,2)*Math.pow(t,2)*e,o=Math.exp(-a),l=nn(Math.pow(t,2),i);return(a*r+r-s)*o*(-n(t)+.001>0?-1:1)/l}):(n=t=>-.001+Math.exp(-t*e)*((t-r)*e+1),s=t=>e*e*(r-t)*Math.exp(-t*e));let o=function(e,t,r){let a=r;for(let r=1;r<12;r++)a-=e(a)/t(a);return a}(n,s,5/e);if(e=aW(e),isNaN(o))return{stiffness:100,damping:10,duration:e};{let t=Math.pow(o,2)*a;return{stiffness:t,damping:2*i*Math.sqrt(a*t),duration:e}}}(e);(t={...t,...r,mass:1}).isResolvedFromDuration=!0}return t}({...a,velocity:-((a.velocity||0)/1e3)}),m=f||0,g=d/(2*Math.sqrt(c*u)),x=o-i,b=Math.sqrt(c/u)/1e3,y=5>Math.abs(x);if(n||(n=y?ne:nt),s||(s=y?nr:na),g<1){let e=nn(b,g);r=t=>o-Math.exp(-g*b*t)*((m+g*b*x)/e*Math.sin(e*t)+x*Math.cos(e*t))}else if(1===g)r=e=>o-Math.exp(-b*e)*(x+(m+b*x)*e);else{let e=b*Math.sqrt(g*g-1);r=t=>{let r=Math.exp(-g*b*t),a=Math.min(e*t,300);return o-r*((m+g*b*x)*Math.sinh(a)+e*x*Math.cosh(a))/e}}let v={calculatedDuration:p&&h||null,next:e=>{let t=r(e);if(p)l.done=e>=h;else{let a=0===e?m:0;g<1&&(a=0===e?aW(m):a9(r,e,t));let i=Math.abs(o-t)<=s;l.done=Math.abs(a)<=n&&i}return l.value=l.done?o:t,l},toString:()=>{let e=Math.min(a7(v),2e4),t=a8(t=>v.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return v}function nc({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:n=10,bounceStiffness:s=500,modifyTarget:i,min:o,max:l,restDelta:c=.5,restSpeed:d}){let u,h,f=e[0],p={done:!1,value:f},m=r*t,g=f+m,x=void 0===i?g:i(g);x!==g&&(m=x-f);let b=e=>-m*Math.exp(-e/a),y=e=>x+b(e),v=e=>{let t=b(e),r=y(e);p.done=Math.abs(t)<=c,p.value=p.done?x:r},w=e=>{let t;if(t=p.value,void 0!==o&&t<o||void 0!==l&&t>l){var r;u=e,h=nl({keyframes:[p.value,(r=p.value,void 0===o?l:void 0===l||Math.abs(o-r)<Math.abs(l-r)?o:l)],velocity:a9(y,e,p.value),damping:n,stiffness:s,restDelta:c,restSpeed:d})}};return w(0),{calculatedDuration:null,next:e=>{let t=!1;return(h||void 0!==u||(t=!0,v(e),w(e)),void 0!==u&&e>=u)?h.next(e-u):(t||v(e),p)}}}nl.applyToOptions=e=>{let t=function(e,t=100,r){let a=r({...e,keyframes:[0,t]}),n=Math.min(a7(a),2e4);return{type:"keyframes",ease:e=>a.next(n*e).value/t,duration:n/1e3}}(e,100,nl);return e.ease=t.ease,e.duration=aW(t.duration),e.type="keyframes",e};let nd=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e;function nu(e,t,r,a){return e===t&&r===a?tK:n=>0===n||1===n?n:nd(function(e,t,r,a,n){let s,i,o=0;do(s=nd(i=t+(r-t)/2,a,n)-e)>0?r=i:t=i;while(Math.abs(s)>1e-7&&++o<12)return i}(n,0,1,e,r),t,a)}let nh=nu(.42,0,1,1),nf=nu(0,0,.58,1),np=nu(.42,0,.58,1),nm=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,ng=e=>t=>1-e(1-t),nx=nu(.33,1.53,.69,.99),nb=ng(nx),ny=nm(nb),nv=e=>(e*=2)<1?.5*nb(e):.5*(2-Math.pow(2,-10*(e-1))),nw=e=>1-Math.sin(Math.acos(e)),nk=ng(nw),nj=nm(nw),nN=e=>Array.isArray(e)&&"number"==typeof e[0],nS={linear:tK,easeIn:nh,easeInOut:np,easeOut:nf,circIn:nw,circInOut:nj,circOut:nk,backIn:nb,backInOut:ny,backOut:nx,anticipate:nv},nE=e=>{if(nN(e)){tV(4===e.length,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[t,r,a,n]=e;return nu(t,r,a,n)}return"string"==typeof e?(tV(void 0!==nS[e],`Invalid easing type '${e}'`,"invalid-easing-type"),nS[e]):e},nC=(e,t,r)=>{let a=t-e;return 0===a?1:(r-e)/a};function nT({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){var n;let s,i=Array.isArray(a)&&"number"!=typeof a[0]?a.map(nE):nE(a),o={done:!1,value:t[0]},l=function(e,t,{clamp:r=!0,ease:a,mixer:n}={}){let s=e.length;if(tV(s===t.length,"Both input and output ranges must be the same length","range-length"),1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];let i=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());let o=function(e,t,r){let a=[],n=r||tX.mix||a3,s=e.length-1;for(let r=0;r<s;r++){let s=n(e[r],e[r+1]);t&&(s=aH(Array.isArray(t)?t[r]||tK:t,s)),a.push(s)}return a}(t,a,n),l=o.length,c=r=>{if(i&&r<e[0])return t[0];let a=0;if(l>1)for(;a<e.length-2&&!(r<e[a+1]);a++);let n=nC(e[a],e[a+1],r);return o[a](n)};return r?t=>c(tE(e[0],e[s-1],t)):c}((n=r&&r.length===t.length?r:(!function(e,t){let r=e[e.length-1];for(let a=1;a<=t;a++){let n=nC(0,t,a);e.push(tf(r,1,n))}}(s=[0],t.length-1),s),n.map(t=>t*e)),t,{ease:Array.isArray(i)?i:t.map(()=>i||np).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(o.value=l(t),o.done=t>=e,o)}}let nA=e=>null!==e;function n_(e,{repeat:t,repeatType:r="loop"},a,n=1){let s=e.filter(nA),i=n<0||t&&"loop"!==r&&t%2==1?0:s.length-1;return i&&void 0!==a?a:s[i]}let nO={decay:nc,inertia:nc,tween:nT,keyframes:nT,spring:nl};function nP(e){"string"==typeof e.type&&(e.type=nO[e.type])}class nD{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}let nR=e=>e/100;class nM extends nD{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:e}=this.options;e&&e.updatedAt!==rO.now()&&this.tick(rO.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},aq.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){let{options:e}=this;nP(e);let{type:t=nT,repeat:r=0,repeatDelay:a=0,repeatType:n,velocity:s=0}=e,{keyframes:i}=e,o=t||nT;o!==nT&&"number"!=typeof i[0]&&(this.mixKeyframes=aH(nR,a3(i[0],i[1])),i=[0,100]);let l=o({...e,keyframes:i});"mirror"===n&&(this.mirroredGenerator=o({...e,keyframes:[...i].reverse(),velocity:-s})),null===l.calculatedDuration&&(l.calculatedDuration=a7(l));let{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+a,this.totalDuration=this.resolvedDuration*(r+1)-a,this.generator=l}updateTime(e){let t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){let{generator:r,totalDuration:a,mixKeyframes:n,mirroredGenerator:s,resolvedDuration:i,calculatedDuration:o}=this;if(null===this.startTime)return r.next(0);let{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:h,type:f,onUpdate:p,finalKeyframe:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);let g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?g<0:g>a;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=a);let b=this.currentTime,y=r;if(d){let e=Math.min(this.currentTime,a)/i,t=Math.floor(e),r=e%1;!r&&e>=1&&(r=1),1===r&&t--,(t=Math.min(t,d+1))%2&&("reverse"===u?(r=1-r,h&&(r-=h/i)):"mirror"===u&&(y=s)),b=tE(0,1,r)*i}let v=x?{done:!1,value:c[0]}:y.next(b);n&&(v.value=n(v.value));let{done:w}=v;x||null===o||(w=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);let k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return k&&f!==nc&&(v.value=n_(c,this.options,m,this.speed)),p&&p(v.value),k&&this.finish(),v}then(e,t){return this.finished.then(e,t)}get duration(){return this.calculatedDuration/1e3}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+e/1e3}get time(){return this.currentTime/1e3}set time(e){e=aW(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(rO.now());let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=this.currentTime/1e3)}play(){if(this.isStopped)return;let{driver:e=a6,startTime:t}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();let r=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=r):null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(rO.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,aq.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function nI(e){let t;return()=>(void 0===t&&(t=e()),t)}let nL=nI(()=>void 0!==window.ScrollTimeline),nF={},nB=(r=nI(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0}),()=>nF.linearEasing??r()),nU=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,nz={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nU([0,.65,.55,1]),circOut:nU([.55,0,1,.45]),backIn:nU([.31,.01,.66,-.59]),backOut:nU([.33,1.53,.69,.99])};function nV(e){return"function"==typeof e&&"applyToOptions"in e}class n$ extends nD{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:a,pseudoElement:n,allowFlatten:s=!1,finalKeyframe:i,onComplete:o}=e;this.isPseudoElement=!!n,this.allowFlatten=s,this.options=e,tV("string"!=typeof e.type,'Mini animate() doesn\'t support "type" as a string.',"mini-spring");const l=function({type:e,...t}){return nV(e)&&nB()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=function(e,t,r,{delay:a=0,duration:n=300,repeat:s=0,repeatType:i="loop",ease:o="easeOut",times:l}={},c){let d={[t]:r};l&&(d.offset=l);let u=function e(t,r){if(t)return"function"==typeof t?nB()?a8(t,r):"ease-out":nN(t)?nU(t):Array.isArray(t)?t.map(t=>e(t,r)||nz.easeOut):nz[t]}(o,n);Array.isArray(u)&&(d.easing=u);let h={delay:a,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===i?"alternate":"normal"};c&&(h.pseudoElement=c);let f=e.animate(d,h);return f}(t,r,a,l,n),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!n){let e=n_(a,this.options,i,this.speed);this.updateMotionValue?this.updateMotionValue(e):r.startsWith("--")?t.style.setProperty(r,e):t.style[r]=e,this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){return Number(this.animation.effect?.getComputedTiming?.().duration||0)/1e3}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+e/1e3}get time(){return(Number(this.animation.currentTime)||0)/1e3}set time(e){this.finishedTime=null,this.animation.currentTime=aW(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return(this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&nL())?(this.animation.timeline=e,tK):t(this)}}let nH={anticipate:nv,backInOut:ny,circInOut:nj};class nW extends n${constructor(e){!function(e){"string"==typeof e.ease&&e.ease in nH&&(e.ease=nH[e.ease])}(e),nP(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){let{motionValue:t,onUpdate:r,onComplete:a,element:n,...s}=this.options;if(!t)return;if(void 0!==e)return void t.set(e);let i=new nM({...s,autoplay:!1}),o=aW(this.finishedTime??this.time);t.setWithVelocity(i.sample(o-10).value,i.sample(o).value,10),i.stop()}}let nq=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(rx.test(e)||"0"===e)&&!e.startsWith("url(")),nG=new Set(["opacity","clipPath","filter","transform"]),nK=nI(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class nX extends nD{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:a=0,repeatDelay:n=0,repeatType:s="loop",keyframes:i,name:o,motionValue:l,element:c,...d}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=rO.now();const u={autoplay:e,delay:t,type:r,repeat:a,repeatDelay:n,repeatType:s,name:o,motionValue:l,element:c,...d},h=c?.KeyframeResolver||t7;this.keyframeResolver=new h(i,(e,t,r)=>this.onKeyframesResolved(e,t,u,!r),o,l,c),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,a){this.keyframeResolver=void 0;let{name:n,type:s,velocity:i,delay:o,isHandoff:l,onUpdate:c}=r;this.resolvedAt=rO.now(),!function(e,t,r,a){let n=e[0];if(null===n)return!1;if("display"===t||"visibility"===t)return!0;let s=e[e.length-1],i=nq(n,t),o=nq(s,t);return tz(i===o,`You are trying to animate ${t} from "${n}" to "${s}". "${i?s:n}" is not an animatable value.`,"value-not-animatable"),!!i&&!!o&&(function(e){let t=e[0];if(1===e.length)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}(e)||("spring"===r||nV(r))&&a)}(e,n,s,i)&&((tX.instantAnimations||!o)&&c?.(n_(e,r,t)),e[0]=e[e.length-1],aV(r),r.repeat=0);let d={startTime:a?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},u=!l&&function(e){let{motionValue:t,name:r,repeatDelay:a,repeatType:n,damping:s,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:o,transformTemplate:l}=t.owner.getProps();return nK()&&r&&nG.has(r)&&("transform"!==r||!l)&&!o&&!a&&"mirror"!==n&&0!==s&&"inertia"!==i}(d)?new nW({...d,element:d.motionValue.owner.current}):new nM(d);u.finished.then(()=>this.notifyFinished()).catch(tK),this.pendingTimeline&&(this.stopTimeline=u.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=u}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),t3=!0,t8(),t6(),t3=!1),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}let nY=e=>null!==e,nQ={type:"spring",stiffness:500,damping:25,restSpeed:10},nJ={type:"keyframes",duration:.8},nZ={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},n0=(e,t,r,a={},n,s)=>i=>{let o=aB(a,e)||{},l=o.delay||a.delay||0,{elapsed:c=0}=a;c-=aW(l);let d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:n};!function({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:n,repeat:s,repeatType:i,repeatDelay:o,from:l,elapsed:c,...d}){return!!Object.keys(d).length}(o)&&Object.assign(d,((e,{keyframes:t})=>t.length>2?nJ:e6.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:nQ:nZ)(e,d)),d.duration&&(d.duration=aW(d.duration)),d.repeatDelay&&(d.repeatDelay=aW(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let u=!1;if(!1!==d.type&&(0!==d.duration||d.repeatDelay)||(aV(d),0===d.delay&&(u=!0)),(tX.instantAnimations||tX.skipAnimations)&&(u=!0,aV(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,u&&!s&&void 0!==t.get()){let e=function(e,{repeat:t,repeatType:r="loop"},a){let n=e.filter(nY),s=t&&"loop"!==r&&t%2==1?0:n.length-1;return n[s]}(d.keyframes,o);if(void 0!==e)return void tJ.update(()=>{d.onUpdate(e),d.onComplete()})}return o.isSync?new nM(d):new nX(d)};function n1(e,t,{delay:r=0,transitionOverride:a,type:n}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:i,...o}=t;a&&(s=a);let l=[],c=n&&e.animationState&&e.animationState.getState()[n];for(let t in o){let a=e.getValue(t,e.latestValues[t]??null),n=o[t];if(void 0===n||c&&function({protectedKeys:e,needsAnimating:t},r){let a=e.hasOwnProperty(r)&&!0!==t[r];return t[r]=!1,a}(c,t))continue;let i={delay:r,...aB(s||{},t)},d=a.get();if(void 0!==d&&!a.isAnimating&&!Array.isArray(n)&&n===d&&!i.velocity)continue;let u=!1;if(window.MotionHandoffAnimation){let r=e.props[aR];if(r){let e=window.MotionHandoffAnimation(r,t,tJ);null!==e&&(i.startTime=e,u=!0)}}az(e,t),a.start(n0(t,a,n,e.shouldReduceMotion&&tS.has(t)?{type:!1}:i,e,u));let h=a.animation;h&&l.push(h)}return i&&Promise.all(l).then(()=>{tJ.update(()=>{i&&function(e,t){let{transitionEnd:r={},transition:a={},...n}=aF(e,t)||{};for(let t in n={...n,...r}){var s;let r=aU(s=n[t])?s[s.length-1]||0:s;e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,rI(r))}}(e,i)})}),l}function n2(e,t,r,a=0,n=1){let s=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),i=e.size,o=(i-1)*a;return"function"==typeof r?r(s,i):1===n?s*a:o-s*a}function n5(e,t,r={}){let a=aF(e,t,"exit"===r.type?e.presenceContext?.custom:void 0),{transition:n=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(n=r.transitionOverride);let s=a?()=>Promise.all(n1(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(a=0)=>{let{delayChildren:s=0,staggerChildren:i,staggerDirection:o}=n;return function(e,t,r=0,a=0,n=0,s=1,i){let o=[];for(let l of e.variantChildren)l.notify("AnimationStart",t),o.push(n5(l,t,{...i,delay:r+("function"==typeof a?0:a)+n2(e.variantChildren,l,a,n,s)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,a,s,i,o,r)}:()=>Promise.resolve(),{when:o}=n;if(!o)return Promise.all([s(),i(r.delay)]);{let[e,t]="beforeChildren"===o?[s,i]:[i,s];return e().then(()=>t())}}function n4(e,t){if(!Array.isArray(t))return!1;let r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}let n3=rJ.length,n6=[...rQ].reverse(),n8=rQ.length;function n7(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function n9(){return{animate:n7(!0),whileInView:n7(),whileHover:n7(),whileTap:n7(),whileDrag:n7(),whileFocus:n7(),exit:n7()}}class se{constructor(e){this.isMounted=!1,this.node=e}update(){}}let st=0,sr={x:!1,y:!1};function sa(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}let sn=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function ss(e){return{point:{x:e.pageX,y:e.pageY}}}function si(e,t,r,a){return sa(e,t,e=>sn(e)&&r(e,ss(e)),a)}function so(e){return e.max-e.min}function sl(e,t,r,a=.5){e.origin=a,e.originPoint=tf(t.min,t.max,e.origin),e.scale=so(r)/so(t),e.translate=tf(r.min,r.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function sc(e,t,r,a){sl(e.x,t.x,r.x,a?a.originX:void 0),sl(e.y,t.y,r.y,a?a.originY:void 0)}function sd(e,t,r){e.min=r.min+t.min,e.max=e.min+so(t)}function su(e,t,r){e.min=t.min-r.min,e.max=e.min+so(t)}function sh(e,t,r){su(e.x,t.x,r.x),su(e.y,t.y,r.y)}function sf(e){return[e("x"),e("y")]}let sp=({current:e})=>e?e.ownerDocument.defaultView:null,sm=(e,t)=>Math.abs(e-t);class sg{constructor(e,t,{transformPagePoint:r,contextWindow:a=window,dragSnapToOrigin:n=!1,distanceThreshold:s=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{var e,t;if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let r=sy(this.lastMoveEventInfo,this.history),a=null!==this.startEvent,n=(e=r.offset,t={x:0,y:0},Math.sqrt(sm(e.x,t.x)**2+sm(e.y,t.y)**2)>=this.distanceThreshold);if(!a&&!n)return;let{point:s}=r,{timestamp:i}=t0;this.history.push({...s,timestamp:i});let{onStart:o,onMove:l}=this.handlers;a||(o&&o(this.lastMoveEvent,r),this.startEvent=this.lastMoveEvent),l&&l(this.lastMoveEvent,r)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=sx(t,this.transformPagePoint),tJ.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:r,onSessionEnd:a,resumeAnimation:n}=this.handlers;if(this.dragSnapToOrigin&&n&&n(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let s=sy("pointercancel"===e.type?this.lastMoveEventInfo:sx(t,this.transformPagePoint),this.history);this.startEvent&&r&&r(e,s),a&&a(e,s)},!sn(e))return;this.dragSnapToOrigin=n,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=s,this.contextWindow=a||window;const i=sx(ss(e),this.transformPagePoint),{point:o}=i,{timestamp:l}=t0;this.history=[{...o,timestamp:l}];const{onSessionStart:c}=t;c&&c(e,sy(i,this.history)),this.removeListeners=aH(si(this.contextWindow,"pointermove",this.handlePointerMove),si(this.contextWindow,"pointerup",this.handlePointerUp),si(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),tZ(this.updatePoint)}}function sx(e,t){return t?{point:t(e.point)}:e}function sb(e,t){return{x:e.x-t.x,y:e.y-t.y}}function sy({point:e},t){return{point:e,delta:sb(e,sv(t)),offset:sb(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null,n=sv(e);for(;r>=0&&(a=e[r],!(n.timestamp-a.timestamp>aW(.1)));)r--;if(!a)return{x:0,y:0};let s=(n.timestamp-a.timestamp)/1e3;if(0===s)return{x:0,y:0};let i={x:(n.x-a.x)/s,y:(n.y-a.y)/s};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}(t,.1)}}function sv(e){return e[e.length-1]}function sw(e,t,r){return{min:void 0!==t?e.min+t:void 0,max:void 0!==r?e.max+r-(e.max-e.min):void 0}}function sk(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function sj(e,t,r){return{min:sN(e,t),max:sN(e,r)}}function sN(e,t){return"number"==typeof e?e:e[t]||0}let sS=new WeakMap;class sE{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rH(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){let{presenceContext:a}=this.visualElement;if(a&&!1===a.isPresent)return;let n=e=>{let{dragSnapToOrigin:r}=this.getProps();r?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(ss(e).point)},s=(e,t)=>{let{drag:r,dragPropagation:a,onDragStart:n}=this.getProps();if(r&&!a&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(e){if("x"===e||"y"===e)if(sr[e])return null;else return sr[e]=!0,()=>{sr[e]=!1};return sr.x||sr.y?null:(sr.x=sr.y=!0,()=>{sr.x=sr.y=!1})}(r),!this.openDragLock))return;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),sf(e=>{let t=this.getAxisMotionValue(e).get()||0;if(tP.test(t)){let{projection:r}=this.visualElement;if(r&&r.layout){let a=r.layout.layoutBox[e];a&&(t=so(a)*(parseFloat(t)/100))}}this.originPoint[e]=t}),n&&tJ.postRender(()=>n(e,t)),az(this.visualElement,"transform");let{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},i=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;let{dragPropagation:r,dragDirectionLock:a,onDirectionLock:n,onDrag:s}=this.getProps();if(!r&&!this.openDragLock)return;let{offset:i}=t;if(a&&null===this.currentDirection){this.currentDirection=function(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}(i),null!==this.currentDirection&&n&&n(this.currentDirection);return}this.updateAxis("x",t.point,i),this.updateAxis("y",t.point,i),this.visualElement.render(),s&&s(e,t)},o=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},l=()=>sf(e=>"paused"===this.getAnimationState(e)&&this.getAxisMotionValue(e).animation?.play()),{dragSnapToOrigin:c}=this.getProps();this.panSession=new sg(e,{onSessionStart:n,onStart:s,onMove:i,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:r,contextWindow:sp(this.visualElement)})}stop(e,t){let r=e||this.latestPointerEvent,a=t||this.latestPanInfo,n=this.isDragging;if(this.cancel(),!n||!a||!r)return;let{velocity:s}=a;this.startAnimation(s);let{onDragEnd:i}=this.getProps();i&&tJ.postRender(()=>i(r,a))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){let{drag:a}=this.getProps();if(!r||!sC(e,a,this.currentDirection))return;let n=this.getAxisMotionValue(e),s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=function(e,{min:t,max:r},a){return void 0!==t&&e<t?e=a?tf(t,e,a.min):Math.max(e,t):void 0!==r&&e>r&&(e=a?tf(r,e,a.max):Math.min(e,r)),e}(s,this.constraints[e],this.elastic[e])),n.set(s)}resolveConstraints(){let{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,a=this.constraints;e&&aD(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=function(e,{top:t,left:r,bottom:a,right:n}){return{x:sw(e.x,r,n),y:sw(e.y,t,a)}}(r.layoutBox,e):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:sj(e,"left","right"),y:sj(e,"top","bottom")}}(t),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&sf(e=>{var t,a;let n;!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=(t=r.layoutBox[e],a=this.constraints[e],n={},void 0!==a.min&&(n.min=a.min-t.min),void 0!==a.max&&(n.max=a.max-t.min),n))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!aD(t))return!1;let a=t.current;tV(null!==a,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:n}=this.visualElement;if(!n||!n.layout)return!1;let s=function(e,t,r){let a=tN(e,r),{scroll:n}=t;return n&&(tw(a.x,n.offset.x),tw(a.y,n.offset.y)),a}(a,n.root,this.visualElement.getTransformPagePoint()),i=(e=n.layout.layoutBox,{x:sk(e.x,s.x),y:sk(e.y,s.y)});if(r){let e=r(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(i));this.hasMutatedConstraints=!!e,e&&(i=th(e))}return i}startAnimation(e){let{drag:t,dragMomentum:r,dragElastic:a,dragTransition:n,dragSnapToOrigin:s,onDragTransitionEnd:i}=this.getProps(),o=this.constraints||{};return Promise.all(sf(i=>{if(!sC(i,t,this.currentDirection))return;let l=o&&o[i]||{};s&&(l={min:0,max:0});let c={type:"inertia",velocity:r?e[i]:0,bounceStiffness:a?200:1e6,bounceDamping:a?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...n,...l};return this.startAxisValueAnimation(i,c)})).then(i)}startAxisValueAnimation(e,t){let r=this.getAxisMotionValue(e);return az(this.visualElement,e),r.start(n0(e,r,0,t,this.visualElement,!1))}stopAnimation(){sf(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){sf(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){let t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps();return r[t]||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){sf(t=>{let{drag:r}=this.getProps();if(!sC(t,r,this.currentDirection))return;let{projection:a}=this.visualElement,n=this.getAxisMotionValue(t);if(a&&a.layout){let{min:r,max:s}=a.layout.layoutBox[t];n.set(e[t]-tf(r,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!aD(t)||!r||!this.constraints)return;this.stopAnimation();let a={x:0,y:0};sf(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){var r,n;let s,i,o,l=t.get();a[e]=(r={min:l,max:l},n=this.constraints[e],s=.5,i=so(r),(o=so(n))>i?s=nC(n.min,n.max-i,r.min):i>o&&(s=nC(r.min,r.max-o,n.min)),tE(0,1,s))}});let{transformTemplate:n}=this.visualElement.getProps();this.visualElement.current.style.transform=n?n({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),sf(t=>{if(!sC(t,e,null))return;let r=this.getAxisMotionValue(t),{min:n,max:s}=this.constraints[t];r.set(tf(n,s,a[t]))})}addListeners(){if(!this.visualElement.current)return;sS.set(this.visualElement,this);let e=si(this.visualElement.current,"pointerdown",e=>{let{drag:t,dragListener:r=!0}=this.getProps();t&&r&&this.start(e)}),t=()=>{let{dragConstraints:e}=this.getProps();aD(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",t);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),tJ.read(t);let n=sa(window,"resize",()=>this.scalePositionWithinConstraints()),s=r.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(sf(t=>{let r=this.getAxisMotionValue(t);r&&(this.originPoint[t]+=e[t].translate,r.set(r.get()+e[t].translate))}),this.visualElement.render())});return()=>{n(),e(),a(),s&&s()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:a=!1,dragConstraints:n=!1,dragElastic:s=.35,dragMomentum:i=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:a,dragConstraints:n,dragElastic:s,dragMomentum:i}}}function sC(e,t,r){return(!0===t||t===e)&&(null===r||r===e)}let sT=e=>(t,r)=>{e&&tJ.postRender(()=>e(t,r))};var sA=em;function s_(e=!0){let t=(0,em.useContext)(aE);if(null===t)return[!0,null];let{isPresent:r,onExitComplete:a,register:n}=t,s=(0,em.useId)();(0,em.useEffect)(()=>{if(e)return n(s)},[e]);let i=(0,em.useCallback)(()=>e&&a&&a(s),[s,a,e]);return!r&&a?[!1,i]:[!0]}let sO={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function sP(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let sD={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e)if(!tD.test(e))return e;else e=parseFloat(e);let r=sP(e,t.target.x),a=sP(e,t.target.y);return`${r}% ${a}%`}},sR=!1;class sM extends sA.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:a}=this.props,{projection:n}=e;for(let e in sL)at[e]=sL[e],tl(e)&&(at[e].isCSSVariable=!0);n&&(t.group&&t.group.add(n),r&&r.register&&a&&r.register(n),sR&&n.root.didUpdate(),n.addEventListener("animationComplete",()=>{this.safeToRemove()}),n.setOptions({...n.options,onExitComplete:()=>this.safeToRemove()})),sO.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:r,drag:a,isPresent:n}=this.props,{projection:s}=r;return s&&(s.isPresent=n,sR=!0,a||e.layoutDependency!==t||void 0===t||e.isPresent!==n?s.willUpdate():this.safeToRemove(),e.isPresent!==n&&(n?s.promote():s.relegate()||tJ.postRender(()=>{let e=s.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rF.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:a}=e;sR=!0,a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),r&&r.deregister&&r.deregister(a))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function sI(e){let[t,r]=s_(),a=(0,sA.useContext)(am);return(0,ep.jsx)(sM,{...e,layoutGroup:a,switchLayoutGroup:(0,sA.useContext)(aM),isPresent:t,safeToRemove:r})}let sL={borderRadius:{...sD,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:sD,borderTopRightRadius:sD,borderBottomLeftRadius:sD,borderBottomRightRadius:sD,boxShadow:{correct:(e,{treeScale:t,projectionDelta:r})=>{let a=rx.parse(e);if(a.length>5)return e;let n=rx.createTransformer(e),s=+("number"!=typeof a[0]),i=r.x.scale*t.x,o=r.y.scale*t.y;a[0+s]/=i,a[1+s]/=o;let l=tf(i,o,.5);return"number"==typeof a[2+s]&&(a[2+s]/=l),"number"==typeof a[3+s]&&(a[3+s]/=l),n(a)}}};function sF(e){return"object"==typeof e&&null!==e}function sB(e){return sF(e)&&"ownerSVGElement"in e}let sU=(e,t)=>e.depth-t.depth;class sz{constructor(){this.children=[],this.isDirty=!1}add(e){rP(this.children,e),this.isDirty=!0}remove(e){rD(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(sU),this.isDirty=!1,this.children.forEach(e)}}let sV=["TopLeft","TopRight","BottomLeft","BottomRight"],s$=sV.length,sH=e=>"string"==typeof e?parseFloat(e):e,sW=e=>"number"==typeof e||tD.test(e);function sq(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let sG=sX(0,.5,nk),sK=sX(.5,.95,tK);function sX(e,t,r){return a=>a<e?0:a>t?1:r(nC(e,t,a))}function sY(e,t){e.min=t.min,e.max=t.max}function sQ(e,t){sY(e.x,t.x),sY(e.y,t.y)}function sJ(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function sZ(e,t,r,a,n){return e-=t,e=a+1/r*(e-a),void 0!==n&&(e=a+1/n*(e-a)),e}function s0(e,t,[r,a,n],s,i){!function(e,t=0,r=1,a=.5,n,s=e,i=e){if(tP.test(t)&&(t=parseFloat(t),t=tf(i.min,i.max,t/100)-i.min),"number"!=typeof t)return;let o=tf(s.min,s.max,a);e===s&&(o-=t),e.min=sZ(e.min,t,r,o,n),e.max=sZ(e.max,t,r,o,n)}(e,t[r],t[a],t[n],t.scale,s,i)}let s1=["x","scaleX","originX"],s2=["y","scaleY","originY"];function s5(e,t,r,a){s0(e.x,t,s1,r?r.x:void 0,a?a.x:void 0),s0(e.y,t,s2,r?r.y:void 0,a?a.y:void 0)}function s4(e){return 0===e.translate&&1===e.scale}function s3(e){return s4(e.x)&&s4(e.y)}function s6(e,t){return e.min===t.min&&e.max===t.max}function s8(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function s7(e,t){return s8(e.x,t.x)&&s8(e.y,t.y)}function s9(e){return so(e.x)/so(e.y)}function ie(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class it{constructor(){this.members=[]}add(e){rP(this.members,e),e.scheduleRender()}remove(e){if(rD(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t,r=this.members.findIndex(t=>e===t);if(0===r)return!1;for(let e=r;e>=0;e--){let r=this.members[e];if(!1!==r.isPresent){t=r;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:a}=e.options;!1===a&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let ir=["","X","Y","Z"],ia=0;function is(e,t,r,a){let{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),a&&(a[e]=0))}function ii({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:n}){return class{constructor(e={},r=t?.()){this.id=ia++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(ic),this.nodes.forEach(ix),this.nodes.forEach(ib),this.nodes.forEach(id)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=r?r.root||r:this,this.path=r?[...r.path,r]:[],this.parent=r,this.depth=r?r.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new sz)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new rR),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let r=this.eventHandlers.get(e);r&&r.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;this.isSVG=sB(t)&&!(sB(t)&&"svg"===t.tagName),this.instance=t;let{layoutId:r,layout:a,visualElement:n}=this.options;if(n&&!n.current&&n.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||r)&&(this.isLayoutDirty=!0),e){let r,a=0,n=()=>this.root.updateBlockedByResize=!1;tJ.read(()=>{a=window.innerWidth}),e(t,()=>{let e=window.innerWidth;if(e!==a){let t,s;a=e,this.root.updateBlockedByResize=!0,r&&r(),t=rO.now(),s=({timestamp:e})=>{let r=e-t;r>=250&&(tZ(s),n(r-250))},tJ.setup(s,!0),r=()=>tZ(s),sO.hasAnimatedSinceResize&&(sO.hasAnimatedSinceResize=!1,this.nodes.forEach(ig))}})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&n&&(r||a)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:r,layout:a})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let s=this.options.transition||n.getDefaultTransition()||iN,{onLayoutAnimationStart:i,onLayoutAnimationComplete:o}=n.getProps(),l=!this.targetLayout||!s7(this.targetLayout,a),c=!t&&r;if(this.options.layoutRoot||this.resumeFrom||c||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let t={...aB(s,"layout"),onPlay:i,onComplete:o};(n.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,c)}else t||ig(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=a})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),tZ(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(iy),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:r}=t.options;if(!r)return;let a=r.props[aR];if(window.MotionHasOptimisedAnimation(a,"transform")){let{layout:e,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",tJ,!(e||r))}let{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&e(n)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:r}=this.options;if(void 0===t&&!r)return;let a=this.getTransformTemplate();this.prevTransformTemplateValue=a?a(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ih);return}if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(ip);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(im),this.nodes.forEach(io),this.nodes.forEach(il)):this.nodes.forEach(ip),this.clearAllSnapshots();let e=rO.now();t0.delta=tE(0,1e3/60,e-t0.timestamp),t0.timestamp=e,t0.isProcessing=!0,t1.update.process(t0),t1.preRender.process(t0),t1.render.process(t0),t0.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rF.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(iu),this.sharedNodes.forEach(iv)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tJ.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tJ.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||so(this.snapshot.measuredBox.x)||so(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=rH(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){let t=a(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!n)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!s3(this.projectionDelta),r=this.getTransformTemplate(),a=r?r(this.latestValues,""):void 0,s=a!==this.prevTransformTemplateValue;e&&this.instance&&(t||tg(this.latestValues)||s)&&(n(this.instance,a),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let r=this.measurePageBox(),a=this.removeElementScroll(r);return e&&(a=this.removeTransform(a)),iC((t=a).x),iC(t.y),{animationId:this.root.animationId,measuredBox:r,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return rH();let t=e.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(iA))){let{scroll:e}=this.root;e&&(tw(t.x,e.offset.x),tw(t.y,e.offset.y))}return t}removeElementScroll(e){let t=rH();if(sQ(t,e),this.scroll?.wasRoot)return t;for(let r=0;r<this.path.length;r++){let a=this.path[r],{scroll:n,options:s}=a;a!==this.root&&n&&s.layoutScroll&&(n.wasRoot&&sQ(t,e),tw(t.x,n.offset.x),tw(t.y,n.offset.y))}return t}applyTransform(e,t=!1){let r=rH();sQ(r,e);for(let e=0;e<this.path.length;e++){let a=this.path[e];!t&&a.options.layoutScroll&&a.scroll&&a!==a.root&&tj(r,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),tg(a.latestValues)&&tj(r,a.latestValues)}return tg(this.latestValues)&&tj(r,this.latestValues),r}removeTransform(e){let t=rH();sQ(t,e);for(let e=0;e<this.path.length;e++){let r=this.path[e];if(!r.instance||!tg(r.latestValues))continue;tm(r.latestValues)&&r.updateSnapshot();let a=rH();sQ(a,r.measurePageBox()),s5(t,r.latestValues,r.snapshot?r.snapshot.layoutBox:void 0,a)}return tg(this.latestValues)&&s5(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==t0.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){let t=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=t.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=t.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=t.isSharedProjectionDirty);let r=!!this.resumingFrom||this!==t;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:a,layoutId:n}=this.options;if(!this.layout||!(a||n))return;this.resolvedRelativeTargetAt=t0.timestamp;let s=this.getClosestProjectingParent();if(s&&this.linkedParentVersion!==s.layoutVersion&&!s.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(s&&s.layout?this.createRelativeTarget(s,this.layout.layoutBox,s.layout.layoutBox):this.removeRelativeTarget()),this.relativeTarget||this.targetDelta){if(this.target||(this.target=rH(),this.targetWithTransforms=rH()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target){var i,o,l;this.forceRelativeParentToResolveTarget(),i=this.target,o=this.relativeTarget,l=this.relativeParent.target,sd(i.x,o.x,l.x),sd(i.y,o.y,l.y)}else this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):sQ(this.target,this.layout.layoutBox),tv(this.target,this.targetDelta)):sQ(this.target,this.layout.layoutBox);this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,s&&!!s.resumingFrom==!!this.resumingFrom&&!s.options.layoutScroll&&s.target&&1!==this.animationProgress?this.createRelativeTarget(s,this.target,s.target):this.relativeParent=this.relativeTarget=void 0)}}getClosestProjectingParent(){if(!(!this.parent||tm(this.parent.latestValues)||tx(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(e,t,r){this.relativeParent=e,this.linkedParentVersion=e.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rH(),this.relativeTargetOrigin=rH(),sh(this.relativeTargetOrigin,t,r),sQ(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){let e=this.getLead(),t=!!this.resumingFrom||this!==e,r=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(r=!1),t&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===t0.timestamp&&(r=!1),r)return;let{layout:a,layoutId:n}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(a||n))return;sQ(this.layoutCorrected,this.layout.layoutBox);let s=this.treeScale.x,i=this.treeScale.y;!function(e,t,r,a=!1){let n,s,i=r.length;if(i){t.x=t.y=1;for(let o=0;o<i;o++){s=(n=r[o]).projectionDelta;let{visualElement:i}=n.options;(!i||!i.props.style||"contents"!==i.props.style.display)&&(a&&n.options.layoutScroll&&n.scroll&&n!==n.root&&tj(e,{x:-n.scroll.offset.x,y:-n.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,tv(e,s)),a&&tg(n.latestValues)&&tj(e,n.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}}(this.layoutCorrected,this.treeScale,this.path,t),e.layout&&!e.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(e.target=e.layout.layoutBox,e.targetWithTransforms=rH());let{target:o}=e;if(!o){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(sJ(this.prevProjectionDelta.x,this.projectionDelta.x),sJ(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),sc(this.projectionDelta,this.layoutCorrected,o,this.latestValues),this.treeScale.x===s&&this.treeScale.y===i&&ie(this.projectionDelta.x,this.prevProjectionDelta.x)&&ie(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",o))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.visualElement?.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=rV(),this.projectionDelta=rV(),this.projectionDeltaWithTransform=rV()}setAnimationOrigin(e,t=!1){let r,a=this.snapshot,n=a?a.latestValues:{},s={...this.latestValues},i=rV();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let o=rH(),l=(a?a.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,u=!!(l&&!d&&!0===this.options.crossfade&&!this.path.some(ij));this.animationProgress=0,this.mixTargetDelta=t=>{let a=t/1e3;if(iw(i.x,e.x,a),iw(i.y,e.y,a),this.setTargetDelta(i),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var c,h,f,p,m,g;sh(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),f=this.relativeTarget,p=this.relativeTargetOrigin,m=o,g=a,ik(f.x,p.x,m.x,g),ik(f.y,p.y,m.y,g),r&&(c=this.relativeTarget,h=r,s6(c.x,h.x)&&s6(c.y,h.y))&&(this.isProjectionDirty=!1),r||(r=rH()),sQ(r,this.relativeTarget)}l&&(this.animationValues=s,function(e,t,r,a,n,s){n?(e.opacity=tf(0,r.opacity??1,sG(a)),e.opacityExit=tf(t.opacity??1,0,sK(a))):s&&(e.opacity=tf(t.opacity??1,r.opacity??1,a));for(let n=0;n<s$;n++){let s=`border${sV[n]}Radius`,i=sq(t,s),o=sq(r,s);(void 0!==i||void 0!==o)&&(i||(i=0),o||(o=0),0===i||0===o||sW(i)===sW(o)?(e[s]=Math.max(tf(sH(i),sH(o),a),0),(tP.test(o)||tP.test(i))&&(e[s]+="%")):e[s]=o)}(t.rotate||r.rotate)&&(e.rotate=tf(t.rotate||0,r.rotate||0,a))}(s,n,this.latestValues,a,u,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=a},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(tZ(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tJ.update(()=>{var t,r,a;let n;sO.hasAnimatedSinceResize=!0,aq.layout++,this.motionValue||(this.motionValue=rI(0)),this.currentAnimation=(t=this.motionValue,r=[0,1e3],a={...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{aq.layout--},onComplete:()=>{aq.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}},(n=rA(t)?t:rI(t)).start(n0("",n,r,a)),n.animation),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:r,layout:a,latestValues:n}=e;if(t&&r&&a){if(this!==e&&this.layout&&a&&iT(this.options.animationType,this.layout.layoutBox,a.layoutBox)){r=this.target||rH();let t=so(this.layout.layoutBox.x);r.x.min=e.target.x.min,r.x.max=r.x.min+t;let a=so(this.layout.layoutBox.y);r.y.min=e.target.y.min,r.y.max=r.y.min+a}sQ(t,r),tj(t,n),sc(this.projectionDeltaWithTransform,this.layoutCorrected,t,n)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new it),this.sharedNodes.get(e).add(t);let r=t.options.initialPromotionConfig;t.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){let{layoutId:e}=this.options;return e&&this.getStack()?.lead||this}getPrevLead(){let{layoutId:e}=this.options;return e?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:r}={}){let a=this.getStack();a&&a.promote(this,r),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:r}=e;if((r.z||r.rotate||r.rotateX||r.rotateY||r.rotateZ||r.skewX||r.skewY)&&(t=!0),!t)return;let a={};r.z&&is("z",e,a,this.animationValues);for(let t=0;t<ir.length;t++)is(`rotate${ir[t]}`,e,a,this.animationValues),is(`skew${ir[t]}`,e,a,this.animationValues);for(let t in e.render(),a)e.setStaticValue(t,a[t]),this.animationValues&&(this.animationValues[t]=a[t]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible){e.visibility="hidden";return}let r=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=aT(t?.pointerEvents)||"",e.transform=r?r(this.latestValues,""):"none";return}let a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target){this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=aT(t?.pointerEvents)||""),this.hasProjected&&!tg(this.latestValues)&&(e.transform=r?r({},""):"none",this.hasProjected=!1);return}e.visibility="";let n=a.animationValues||a.latestValues;this.applyTransformsToTarget();let s=function(e,t,r){let a="",n=e.x.translate/t.x,s=e.y.translate/t.y,i=r?.z||0;if((n||s||i)&&(a=`translate3d(${n}px, ${s}px, ${i}px) `),(1!==t.x||1!==t.y)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){let{transformPerspective:e,rotate:t,rotateX:n,rotateY:s,skewX:i,skewY:o}=r;e&&(a=`perspective(${e}px) ${a}`),t&&(a+=`rotate(${t}deg) `),n&&(a+=`rotateX(${n}deg) `),s&&(a+=`rotateY(${s}deg) `),i&&(a+=`skewX(${i}deg) `),o&&(a+=`skewY(${o}deg) `)}let o=e.x.scale*t.x,l=e.y.scale*t.y;return(1!==o||1!==l)&&(a+=`scale(${o}, ${l})`),a||"none"}(this.projectionDeltaWithTransform,this.treeScale,n);r&&(s=r(n,s)),e.transform=s;let{x:i,y:o}=this.projectionDelta;for(let t in e.transformOrigin=`${100*i.origin}% ${100*o.origin}% 0`,a.animationValues?e.opacity=a===this?n.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:n.opacityExit:e.opacity=a===this?void 0!==n.opacity?n.opacity:"":void 0!==n.opacityExit?n.opacityExit:0,at){if(void 0===n[t])continue;let{correct:r,applyTo:i,isCSSVariable:o}=at[t],l="none"===s?n[t]:r(n[t],a);if(i){let t=i.length;for(let r=0;r<t;r++)e[i[r]]=l}else o?this.options.visualElement.renderState.vars[t]=l:e[t]=l}this.options.layoutId&&(e.pointerEvents=a===this?aT(t?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>e.currentAnimation?.stop()),this.root.nodes.forEach(ih),this.root.sharedNodes.clear()}}}function io(e){e.updateLayout()}function il(e){let t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){let{layoutBox:r,measuredBox:a}=e.layout,{animationType:n}=e.options,s=t.source!==e.layout.source;"size"===n?sf(e=>{let a=s?t.measuredBox[e]:t.layoutBox[e],n=so(a);a.min=r[e].min,a.max=a.min+n}):iT(n,t.layoutBox,r)&&sf(a=>{let n=s?t.measuredBox[a]:t.layoutBox[a],i=so(r[a]);n.max=n.min+i,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[a].max=e.relativeTarget[a].min+i)});let i=rV();sc(i,r,t.layoutBox);let o=rV();s?sc(o,e.applyTransform(a,!0),t.measuredBox):sc(o,r,t.layoutBox);let l=!s3(i),c=!1;if(!e.resumeFrom){let a=e.getClosestProjectingParent();if(a&&!a.resumeFrom){let{snapshot:n,layout:s}=a;if(n&&s){let i=rH();sh(i,t.layoutBox,n.layoutBox);let o=rH();sh(o,r,s.layoutBox),s7(i,o)||(c=!0),a.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=i,e.relativeParent=a)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function ic(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function id(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function iu(e){e.clearSnapshot()}function ih(e){e.clearMeasurements()}function ip(e){e.isLayoutDirty=!1}function im(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function ig(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function ix(e){e.resolveTargetDelta()}function ib(e){e.calcProjection()}function iy(e){e.resetSkewAndRotation()}function iv(e){e.removeLeadSnapshot()}function iw(e,t,r){e.translate=tf(t.translate,0,r),e.scale=tf(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function ik(e,t,r,a){e.min=tf(t.min,r.min,a),e.max=tf(t.max,r.max,a)}function ij(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let iN={duration:.45,ease:[.4,0,.1,1]},iS=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),iE=iS("applewebkit/")&&!iS("chrome/")?Math.round:tK;function iC(e){e.min=iE(e.min),e.max=iE(e.max)}function iT(e,t,r){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(s9(t)-s9(r)))}function iA(e){return e!==e.root&&e.scroll?.wasRoot}let i_=ii({attachResizeListener:(e,t)=>sa(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),iO={current:void 0},iP=ii({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!iO.current){let e=new i_({});e.mount(window),e.setOptions({layoutScroll:!0}),iO.current=e}return iO.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function iD(e,t){let r=function(e,t,r){if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document,r=(void 0)??t.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e)}(e),a=new AbortController;return[r,{passive:!0,...t,signal:a.signal},()=>a.abort()]}function iR(e){return!("touch"===e.pointerType||sr.x||sr.y)}function iM(e,t,r){let{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover","Start"===r);let n=a["onHover"+r];n&&tJ.postRender(()=>n(t,ss(t)))}function iI(e){return sF(e)&&"offsetHeight"in e}let iL=(e,t)=>!!t&&(e===t||iL(e,t.parentElement)),iF=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),iB=new WeakSet;function iU(e){return t=>{"Enter"===t.key&&e(t)}}function iz(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function iV(e){return sn(e)&&!(sr.x||sr.y)}function i$(e,t,r){let{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap","Start"===r);let n=a["onTap"+("End"===r?"":r)];n&&tJ.postRender(()=>n(t,ss(t)))}let iH=new WeakMap,iW=new WeakMap,iq=e=>{let t=iH.get(e.target);t&&t(e)},iG=e=>{e.forEach(iq)},iK={some:0,all:1},iX=function(e,t){if("undefined"==typeof Proxy)return aL;let r=new Map,a=(r,a)=>aL(r,a,e,t);return new Proxy((e,t)=>a(e,t),{get:(n,s)=>"create"===s?a:(r.has(s)||r.set(s,aL(s,void 0,e,t)),r.get(s))})}({animation:{Feature:class extends se{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:r})=>(function(e,t,r={}){let a;if(e.notify("AnimationStart",t),Array.isArray(t))a=Promise.all(t.map(t=>n5(e,t,r)));else if("string"==typeof t)a=n5(e,t,r);else{let n="function"==typeof t?aF(e,t,r.custom):t;a=Promise.all(n1(e,n,r))}return a.then(()=>{e.notify("AnimationComplete",t)})})(e,t,r))),r=n9(),a=!0,n=t=>(r,a)=>{let n=aF(e,a,"exit"===t?e.presenceContext?.custom:void 0);if(n){let{transition:e,transitionEnd:t,...a}=n;r={...r,...a,...t}}return r};function s(s){let{props:i}=e,o=function e(t){if(!t)return;if(!t.isControllingVariants){let r=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(r.initial=t.props.initial),r}let r={};for(let e=0;e<n3;e++){let a=rJ[e],n=t.props[a];(rY(n)||!1===n)&&(r[a]=n)}return r}(e.parent)||{},l=[],c=new Set,d={},u=1/0;for(let t=0;t<n8;t++){var h,f;let p=n6[t],m=r[p],g=void 0!==i[p]?i[p]:o[p],x=rY(g),b=p===s?m.isActive:null;!1===b&&(u=t);let y=g===o[p]&&g!==i[p]&&x;if(y&&a&&e.manuallyAnimateOnMount&&(y=!1),m.protectedKeys={...d},!m.isActive&&null===b||!g&&!m.prevProp||rX(g)||"boolean"==typeof g)continue;let v=(h=m.prevProp,"string"==typeof(f=g)?f!==h:!!Array.isArray(f)&&!n4(f,h)),w=v||p===s&&m.isActive&&!y&&x||t>u&&x,k=!1,j=Array.isArray(g)?g:[g],N=j.reduce(n(p),{});!1===b&&(N={});let{prevResolvedValues:S={}}=m,E={...S,...N},C=t=>{w=!0,c.has(t)&&(k=!0,c.delete(t)),m.needsAnimating[t]=!0;let r=e.getValue(t);r&&(r.liveStyle=!1)};for(let e in E){let t=N[e],r=S[e];if(!d.hasOwnProperty(e))(aU(t)&&aU(r)?n4(t,r):t===r)?void 0!==t&&c.has(e)?C(e):m.protectedKeys[e]=!0:null!=t?C(e):c.add(e)}m.prevProp=g,m.prevResolvedValues=N,m.isActive&&(d={...d,...N}),a&&e.blockInitialAnimation&&(w=!1);let T=y&&v,A=!T||k;w&&A&&l.push(...j.map(t=>{let r={type:p};if("string"==typeof t&&a&&!T&&e.manuallyAnimateOnMount&&e.parent){let{parent:a}=e,n=aF(a,t);if(a.enteringChildren&&n){let{delayChildren:t}=n.transition||{};r.delay=n2(a.enteringChildren,e,t)}}return{animation:t,options:r}}))}if(c.size){let t={};if("boolean"!=typeof i.initial){let r=aF(e,Array.isArray(i.initial)?i.initial[0]:i.initial);r&&r.transition&&(t.transition=r.transition)}c.forEach(r=>{let a=e.getBaseTarget(r),n=e.getValue(r);n&&(n.liveStyle=!0),t[r]=a??null}),l.push({animation:t})}let p=!!l.length;return a&&(!1===i.initial||i.initial===i.animate)&&!e.manuallyAnimateOnMount&&(p=!1),a=!1,p?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,a){if(r[t].isActive===a)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(t,a)),r[t].isActive=a;let n=s(t);for(let e in r)r[e].protectedKeys={};return n},setAnimateFunction:function(r){t=r(e)},getState:()=>r,reset:()=>{r=n9()}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();rX(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}},exit:{Feature:class extends se{constructor(){super(...arguments),this.id=st++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;let a=this.node.animationState.setActive("exit",!e);t&&!e&&a.then(()=>{t(this.id)})}mount(){let{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}},inView:{Feature:class extends se{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){var e;let t;this.unmount();let{viewport:r={}}=this.node.getProps(),{root:a,margin:n,amount:s="some",once:i}=r,o={root:a?a.current:void 0,rootMargin:n,threshold:"number"==typeof s?s:iK[s]},l=e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,i&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:r,onViewportLeave:a}=this.node.getProps(),n=t?r:a;n&&n(e)};return e=this.node.current,t=function({root:e,...t}){let r=e||document;iW.has(r)||iW.set(r,{});let a=iW.get(r),n=JSON.stringify(t);return a[n]||(a[n]=new IntersectionObserver(iG,{root:e,...t})),a[n]}(o),iH.set(e,l),t.observe(e),()=>{iH.delete(e),t.unobserve(e)}}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends se{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){let[a,n,s]=iD(e,r),i=e=>{let a=e.currentTarget;if(!iV(e))return;iB.add(a);let s=t(a,e),i=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),iB.has(a)&&iB.delete(a),iV(e)&&"function"==typeof s&&s(e,{success:t})},o=e=>{i(e,a===window||a===document||r.useGlobalTarget||iL(a,e.target))},l=e=>{i(e,!1)};window.addEventListener("pointerup",o,n),window.addEventListener("pointercancel",l,n)};return a.forEach(e=>{((r.useGlobalTarget?window:e).addEventListener("pointerdown",i,n),iI(e))&&(e.addEventListener("focus",e=>((e,t)=>{let r=e.currentTarget;if(!r)return;let a=iU(()=>{if(iB.has(r))return;iz(r,"down");let e=iU(()=>{iz(r,"up")});r.addEventListener("keyup",e,t),r.addEventListener("blur",()=>iz(r,"cancel"),t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)})(e,n)),iF.has(e.tagName)||-1!==e.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),s}(e,(e,t)=>(i$(this.node,t,"Start"),(e,{success:t})=>i$(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends se{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=aH(sa(this.node.current,"focus",()=>this.onFocus()),sa(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends se{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){let[a,n,s]=iD(e,r),i=e=>{if(!iR(e))return;let{target:r}=e,a=t(r,e);if("function"!=typeof a||!r)return;let s=e=>{iR(e)&&(a(e),r.removeEventListener("pointerleave",s))};r.addEventListener("pointerleave",s,n)};return a.forEach(e=>{e.addEventListener("pointerenter",i,n)}),s}(e,(e,t)=>(iM(this.node,t,"Start"),e=>iM(this.node,e,"End"))))}unmount(){}}},pan:{Feature:class extends se{constructor(){super(...arguments),this.removePointerDownListener=tK}onPointerDown(e){this.session=new sg(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:sp(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:a}=this.node.getProps();return{onSessionStart:sT(e),onStart:sT(t),onMove:r,onEnd:(e,t)=>{delete this.session,a&&tJ.postRender(()=>a(e,t))}}}mount(){this.removePointerDownListener=si(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends se{constructor(e){super(e),this.removeGroupControls=tK,this.removeListeners=tK,this.controls=new sE(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||tK}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:iP,MeasureLayout:sI},layout:{ProjectionNode:iP,MeasureLayout:sI}},(e,t)=>ap(e)?new ah(t):new an(t,{allowProjection:e!==em.Fragment}));var iY=e.i(10504),iQ=e.i(8152);function iJ({onSuccess:e}){let{theme:t}=(0,ex.useTheme)(),[r,a]=(0,em.useState)(null),[n,s]=(0,em.useState)("loading"),[i,o]=(0,em.useState)("Iniciando vinculacin..."),[l,c]=(0,em.useState)(!1),d=(0,em.useRef)(null),u=(0,em.useRef)(!1),h=(0,em.useCallback)(()=>{u.current||(u.current=!0,d.current&&(clearInterval(d.current),d.current=null),eO.toast.success(" WhatsApp vinculado correctamente"),setTimeout(()=>e(),500))},[e]),f=(0,em.useCallback)(async()=>{try{let e=await e_.api.whatsapp.status();e.data?.connected&&(console.log("[VincularQR] Estado conectado detectado por polling"),s("connected"),o("Vinculacin exitosa"),h())}catch(e){}},[h]),p=(0,em.useCallback)(()=>{d.current&&clearInterval(d.current),console.log("[VincularQR] Iniciando polling de estado..."),f(),d.current=setInterval(()=>{f()},3e3)},[f]),m=(0,em.useCallback)(async()=>{try{console.log("[VincularQR] Solicitando QR..."),s("loading"),o("Generando cdigo QR...");let e=await e_.api.whatsapp.qr();if(e.data?.connected){console.log("[VincularQR] Ya est conectado"),h();return}e.data?.qr?(a(e.data.qr),s("scanning"),o(" Escanea este cdigo QR con WhatsApp")):e.data?.initializing?o(" Inicializando cliente de WhatsApp..."):o(" Esperando cdigo QR...")}catch(e){console.error("[VincularQR] Error obteniendo QR:",e),s("error"),o("Error al generar cdigo QR"),eO.toast.error("No se pudo obtener el cdigo QR")}},[h]),g=async()=>{try{c(!0),a(null),o("Generando nuevo cdigo QR..."),await e_.api.whatsapp.relink(),eO.toast.success("Solicitando nuevo cdigo QR..."),setTimeout(()=>{l&&(c(!1),console.warn("[VincularQR] Timeout esperando nuevo QR"))},1e4)}catch(e){console.error("[VincularQR] Error en relink:",e),eO.toast.error("No se pudo refrescar el cdigo QR"),c(!1)}};return(0,em.useEffect)(()=>{console.log("[VincularQR] Montando componente...");let e=(0,iQ.connectSocket)(),t=e=>{console.log("[VincularQR] Socket: 'qr' recibido"),a(e),s("scanning"),o(" Escanea este cdigo QR con WhatsApp")},n=()=>{console.log("[VincularQR] Socket: 'ready' recibido"),s("connected"),o("Vinculacin exitosa"),h()},i=()=>{console.log("[VincularQR] Socket: 'authenticated' recibido"),s("connected"),o("Vinculacin exitosa"),h()},l=()=>{console.log("[VincularQR] Socket: 'qr_refresh' o 'qr_expired' recibido"),a(null),o(" Generando nuevo cdigo QR..."),s("loading"),m()},c=()=>{console.log("[VincularQR] Socket: 'logout_success' recibido"),a(null),o("Generando nuevo cdigo QR..."),setTimeout(()=>{m(),p()},1e3)},f=t=>{console.warn("[VincularQR] Socket desconectado:",t),"io server disconnect"===t&&(console.log("[VincularQR] Reconectando..."),e.connect())},g=e=>{console.log("[VincularQR] Socket reconectado despus de",e,"intentos"),u.current||r||(console.log("[VincularQR] Refrescando QR despus de reconexin"),m())},x=e=>{console.log("[VincularQR] Intento de reconexin:",e),o(` Reconectando (intento ${e})...`)},b=e=>{console.error("[VincularQR] Error de conexin socket:",e.message)};e.on("qr",t),e.on("ready",n),e.on("authenticated",i),e.on("qr_refresh",l),e.on("qr_expired",l),e.on("logout_success",c),e.on("disconnect",f),e.on("reconnect",g),e.on("reconnect_attempt",x),e.on("connect_error",b);let y=setInterval(()=>{e.connected||u.current||(console.warn("[VincularQR] Socket no conectado, intentando reconectar..."),e.connect())},5e3);return(async()=>{try{let e=await e_.api.whatsapp.status();if(e.data?.connected){console.log("[VincularQR] Ya est conectado, navegando..."),h();return}m(),p()}catch(e){console.error("[VincularQR] Error en init:",e),m(),p()}})(),()=>{console.log("[VincularQR] Desmontando componente..."),clearInterval(y),d.current&&(clearInterval(d.current),d.current=null),e.off("qr",t),e.off("ready",n),e.off("authenticated",i),e.off("qr_refresh",l),e.off("qr_expired",l),e.off("logout_success",c),e.off("disconnect",f),e.off("reconnect",g),e.off("reconnect_attempt",x),e.off("connect_error",b)}},[]),(0,ep.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] p-6",children:(0,ep.jsxs)(iX.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:(0,eg.cn)("w-full max-w-md rounded-2xl shadow-2xl p-8 flex flex-col items-center","dark"===t?"bg-gradient-to-br from-gray-900/90 to-gray-800/90 border border-white/10":"bg-gradient-to-br from-white to-gray-50 border border-purple-100"),children:[(0,ep.jsxs)("div",{className:"text-center mb-6",children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-2xl font-bold mb-2","dark"===t?"text-white":"text-gray-800"),children:" Vincular WhatsApp"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===t?"text-gray-400":"text-gray-600"),children:i})]}),(0,ep.jsx)("div",{className:"mb-6",children:"loading"===n||l?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center w-64 h-64",children:[(0,ep.jsx)(e2.Loader2,{className:(0,eg.cn)("w-12 h-12 animate-spin","dark"===t?"text-gray-400":"text-gray-500")}),(0,ep.jsx)("p",{className:(0,eg.cn)("mt-4 text-sm","dark"===t?"text-gray-500":"text-gray-400"),children:"Cargando..."})]}):r?(0,ep.jsx)(iX.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"border-4 border-white shadow-xl p-3 bg-white rounded-xl",children:r.startsWith("data:")?(0,ep.jsx)("img",{src:r,alt:"QR Code",width:256,height:256}):(0,ep.jsx)(iY.default,{value:r,size:256})},r.substring(0,50)):"connected"===n?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center w-64 h-64",children:[(0,ep.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-lg font-semibold","dark"===t?"text-green-400":"text-green-600"),children:"Conectado"})]}):(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center w-64 h-64",children:[(0,ep.jsx)("div",{className:"text-6xl mb-4",children:""}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===t?"text-gray-500":"text-gray-400"),children:"Esperando cdigo QR..."})]})}),(0,ep.jsx)("div",{className:"w-full flex flex-col gap-3",children:(0,ep.jsxs)("button",{onClick:g,disabled:l||"connected"===n,className:(0,eg.cn)("w-full px-4 py-3 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",l||"connected"===n?"bg-gray-400 cursor-not-allowed text-gray-200":"dark"===t?"bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white shadow-lg":"bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white shadow-lg"),children:[(0,ep.jsx)(eE.RefreshCw,{className:(0,eg.cn)("w-4 h-4",l&&"animate-spin")}),l?"Actualizando...":" Refrescar cdigo QR"]})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("mt-6 p-4 rounded-lg text-sm text-center","dark"===t?"bg-white/5 text-gray-400":"bg-purple-50 text-gray-600"),children:[(0,ep.jsx)("p",{className:"font-semibold mb-1",children:"Cmo vincular:"}),(0,ep.jsxs)("p",{children:["1. Abre WhatsApp en tu telfono",(0,ep.jsx)("br",{}),"2. Ve a ",(0,ep.jsx)("strong",{children:"Dispositivos vinculados"}),(0,ep.jsx)("br",{}),"3. Escanea este cdigo QR"]})]})]})})}function iZ({onDismiss:e,onReconnect:t}){let{theme:r}=(0,ex.useTheme)();return(0,ep.jsx)("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in-right",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-96 rounded-xl border-2 shadow-2xl p-5 animate-pulse-border","dark"===r?"bg-gradient-to-br from-red-900/90 to-red-800/90 border-red-500 backdrop-blur-md":"bg-gradient-to-br from-red-50 to-orange-50 border-red-400"),children:[(0,ep.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2.5 rounded-lg animate-bounce","dark"===r?"bg-red-500/30":"bg-red-200"),children:(0,ep.jsx)(eL,{className:(0,eg.cn)("w-6 h-6","dark"===r?"text-red-300":"text-red-700")})}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold mb-1","dark"===r?"text-red-100":"text-red-900"),children:" WhatsApp Desconectado"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===r?"text-red-200":"text-red-800"),children:"Se perdi la conexin con WhatsApp"})]}),(0,ep.jsx)("button",{onClick:e,className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"hover:bg-red-700/50 text-red-300":"hover:bg-red-200 text-red-700"),title:"Cerrar notificacin",children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg mb-4 text-sm","dark"===r?"bg-red-800/50 text-red-100 border border-red-600/50":"bg-white/80 text-red-900 border border-red-300"),children:[(0,ep.jsx)("p",{className:"font-medium mb-2",children:" Tus campaas se han detenido"}),(0,ep.jsx)("p",{className:"text-xs opacity-90",children:"Es necesario volver a vincular WhatsApp para reanudar el envo de mensajes. Las campaas en progreso permanecern pausadas hasta que reconectes."})]}),(0,ep.jsxs)("button",{onClick:t,className:(0,eg.cn)("w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-semibold transition-all transform hover:scale-[1.02]","dark"===r?"bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 text-white shadow-lg":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white shadow-lg"),children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-5 h-5"}),"Vincular WhatsApp Ahora"]}),(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-2 h-2 rounded-full animate-ping","dark"===r?"bg-red-400":"bg-red-600")}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-[10px] font-medium","dark"===r?"text-red-300":"text-red-700"),children:"Alerta activa - Requiere atencin"})]})]})})}var i0=e.i(33121);let i1=(0,ek.default)("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function i2({count:e,onDismiss:t,onDownload:r}){let{theme:a}=(0,ex.useTheme)();return(0,ep.jsx)("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in-right",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-96 rounded-xl border-2 shadow-2xl p-5","dark"===a?"bg-gradient-to-br from-yellow-900/90 to-orange-900/90 border-yellow-500 backdrop-blur-md":"bg-gradient-to-br from-yellow-50 to-orange-50 border-yellow-400"),children:[(0,ep.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2.5 rounded-lg","dark"===a?"bg-yellow-500/30":"bg-yellow-200"),children:(0,ep.jsx)(eJ.AlertTriangle,{className:(0,eg.cn)("w-6 h-6","dark"===a?"text-yellow-300":"text-yellow-700")})}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold mb-1","dark"===a?"text-yellow-100":"text-yellow-900"),children:" Contactos Rechazados"}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===a?"text-yellow-200":"text-yellow-800"),children:[e," contacto",1!==e?"s":""," no se ",1!==e?"pudieron":"pudo"," cargar"]})]}),(0,ep.jsx)("button",{onClick:t,className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===a?"hover:bg-yellow-700/50 text-yellow-300":"hover:bg-yellow-200 text-yellow-700"),title:"Cerrar notificacin",children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg mb-4 text-sm","dark"===a?"bg-yellow-800/50 text-yellow-100 border border-yellow-600/50":"bg-white/80 text-yellow-900 border border-yellow-300"),children:[(0,ep.jsxs)("p",{className:"font-medium mb-2 flex items-center gap-2",children:[(0,ep.jsx)(i1,{className:"w-4 h-4"}),"Motivos comunes:"]}),(0,ep.jsxs)("ul",{className:"list-disc list-inside text-xs opacity-90 space-y-1",children:[(0,ep.jsx)("li",{children:"Nmeros de telfono invlidos"}),(0,ep.jsx)("li",{children:"Datos obligatorios faltantes"}),(0,ep.jsx)("li",{children:"Duplicados en el archivo"})]})]}),(0,ep.jsxs)("button",{onClick:r,className:(0,eg.cn)("w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-semibold transition-all transform hover:scale-[1.02]","dark"===a?"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white shadow-lg":"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white shadow-lg"),children:[(0,ep.jsx)(i0.Download,{className:"w-5 h-5"}),"Descargar Reporte de Rechazos"]})]})})}function i5({data:e,onDismiss:t}){let{theme:r}=(0,ex.useTheme)();return(0,ep.jsx)("div",{className:"fixed bottom-4 right-4 z-[100] animate-slide-in-right",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-80 rounded-xl border shadow-2xl p-4","dark"===r?"bg-[#1a1333]/95 border-purple-500/30 backdrop-blur-md":"bg-white/95 border-purple-200"),children:[(0,ep.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-1.5 rounded-lg","dark"===r?"bg-purple-500/20":"bg-purple-100"),children:(0,ep.jsx)(eA.MessageSquare,{className:(0,eg.cn)("w-4 h-4","dark"===r?"text-purple-300":"text-purple-600")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold","dark"===r?"text-white":"text-gray-900"),children:"Auto-respuesta enviada"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-[10px]","dark"===r?"text-gray-400":"text-gray-500"),children:new Date(e.timestamp).toLocaleTimeString()})]})]}),(0,ep.jsx)("button",{onClick:t,className:(0,eg.cn)("p-1 rounded-md transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-4 h-4"})})]}),(0,ep.jsxs)("div",{className:"space-y-2",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("text-xs p-2 rounded-lg","dark"===r?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("p",{className:(0,eg.cn)("font-medium mb-1","dark"===r?"text-gray-300":"text-gray-700"),children:["Contacto: ",(0,ep.jsx)("span",{className:"font-normal",children:e.contact?.nombre||e.contact?.telefono})]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("font-medium","dark"===r?"text-gray-300":"text-gray-700"),children:["Keyword: ",(0,ep.jsx)("span",{className:(0,eg.cn)("font-normal px-1.5 py-0.5 rounded text-[10px]","dark"===r?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-600"),children:e.keyword})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("text-xs italic opacity-80 pl-2 border-l-2","dark"===r?"border-purple-500/50 text-gray-400":"border-purple-300 text-gray-600"),children:['"',e.response.length>50?e.response.substring(0,50)+"...":e.response,'"']})]})]})})}var i4=e.i(97220);function i3(e){return({running:"ejecutando",completed:"completado",failed:"fallido",paused:"pausado",pending:"ejecutando",resting:"descanso"})[e.toLowerCase()]||e}function i6(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),[r,a]=(0,em.useState)([]),[n,s]=(0,em.useState)([]),[i,o]=(0,em.useState)(!1),[l,c]=(0,em.useState)(""),[d,u]=(0,em.useState)(""),[h,f]=(0,em.useState)(""),[p,m]=(0,em.useState)("60"),[g,x]=(0,em.useState)("90"),[b,y]=(0,em.useState)("15"),[v,w]=(0,em.useState)("25"),[k,j]=(0,em.useState)(""),[N,S]=(0,em.useState)(new Date().toISOString().split("T")[0]),[E,C]=(0,em.useState)(!1),[T,A]=(0,em.useState)(!1),[_,O]=(0,em.useState)(null),[P,D]=(0,em.useState)([]),[R,M]=(0,em.useState)(null),[I,L]=(0,em.useState)(null),[F,B]=(0,em.useState)(!1),[U,z]=(0,em.useState)(null),[V,H]=(0,em.useState)(null),[W,q]=(0,em.useState)(!0),[G,K]=(0,em.useState)([]),[X,Y]=(0,em.useState)(!1),[Q,J]=(0,em.useState)(!1),[Z,ee]=(0,em.useState)(!1),[et,er]=(0,em.useState)(!1),[ea,en]=(0,em.useState)(0),[es,ei]=(0,em.useState)(null),[eo,el]=(0,em.useState)([]),[ec,ed]=(0,em.useState)([]),[eu,eh]=(0,em.useState)({mensajesHoy:0,usuariosActivos:0,contactosCargados:0});(0,em.useEffect)(()=>{let e=(0,iQ.connectSocket)();return(async()=>{try{let e=await e_.api.whatsapp.status();H(e.data?.connected||!1),q(!1),e.data?.connected||A(!0)}catch(e){console.error("[MensajeriaMasiva] Error checking WhatApp status:",e),H(!1),q(!1),A(!0)}})(),e.on("whatsapp:disconnected",e=>{console.log("[MensajeriaMasiva] WhatsApp disconnected:",e),H(!1),ee(!0),eO.toast.error("WhatsApp desconectado - Las campaas se han detenido")}),e.emit("jobs:subscribe"),e.on("jobs:update",e=>{console.log("[MensajeriaMasiva] Job update received:",e),a(t=>e.deleted||"cancelado"===e.status&&!t.find(t=>t._id===e._id)?t.filter(t=>t._id!==e._id):t.some(t=>t._id===e._id)?t.map(t=>t._id===e._id?{...t,...e}:t):[e,...t]),ef()}),e.on("auto_response:sent",e=>{console.log("[MensajeriaMasiva] Auto-response sent:",e),ei(e),setTimeout(()=>ei(null),5e3)}),e.on("job:progress",e=>{console.log("[MensajeriaMasiva] Job progress received:",e),a(t=>{let r=e._id||e.jobId;if(!r)return console.warn("[MensajeriaMasiva] Progress data missing job ID:",e),t;let a=t.findIndex(e=>e._id===r||e._id.toString()===r.toString());if(-1===a)return console.warn("[MensajeriaMasiva] Job not found in campaigns:",r),t;let n=[...t],s=n[a];console.log("[MensajeriaMasiva] Updating campaign:",s.name,"Progress:",e.stats);let i=s.stats?.sent||0,o=e.stats?.sent??i,l=o-i;return l>0&&(console.log("[MensajeriaMasiva] Updating global metrics. Delta:",l),eh(e=>({...e,mensajesHoy:e.mensajesHoy+l}))),n[a]={...s,status:e.status||s.status,sentCount:o,failedCount:e.stats?.failed??s.failedCount,pendingCount:e.stats?.pending??s.pendingCount,repliesCount:e.repliesCount??s.repliesCount,restBreakUntil:e.restBreakUntil??s.restBreakUntil,stats:{sent:o,failed:e.stats?.failed??s.stats?.failed??0,pending:e.stats?.pending??s.stats?.pending??0,total:s.stats?.total??0}},"pendiente"===e.status&&"pendiente"!==s.status&&(ee(!0),eO.toast.error("Campaa en estado Pendiente - Revisa la conexin de WhatsApp")),n})}),e.on("campaign:reply",e=>{console.log("[MensajeriaMasiva] Reply received:",e),a(t=>{let r=t.findIndex(t=>t._id===e.campaignId);if(-1===r)return t;let a=[...t],n=a[r];return a[r]={...n,repliesCount:(n.repliesCount||0)+1},a})}),ev(),ek(),ef(),ej(),()=>{e.off("whatsapp:disconnected"),e.off("jobs:update"),e.off("auto_response:sent"),e.off("job:progress"),e.off("campaign:reply"),e.emit("jobs:unsubscribe")}},[]);let ef=async()=>{try{let e=await e_.api.metrics.dashboard();eh(e.data)}catch(e){console.error("Error fetching metrics:",e)}},ey=async e=>{let t=e.target.files?.[0];if(t)try{O(t);let e=await e_.api.contacts.upload(t);if(e.data){let{contacts:t,resumen:r,rejectedFileId:a,headers:n}=e.data;if(D(t||[]),L(r),M(a),n&&n.length>0)console.log("[MensajeriaMasiva] Headers from backend:",n),K(n);else if(t&&t.length>0){let e=t[0],r=Object.keys(e.extraData||{});console.log("[MensajeriaMasiva] Headers from first contact:",r),K(r)}let s=r?.accepted||0,i=r?.rejected||0;i>0&&(en(i),er(!0)),eO.toast.success(` ${s} afiliados cargados correctamente`)}}catch(e){console.error("Error uploading contacts:",e),eO.toast.error(e.response?.data?.message||"Error al cargar contactos"),O(null),D([]),L(null),M(null),K([])}},ev=async()=>{try{let e=await e_.api.sendJobs.list();a(e.data||[])}catch(e){console.error("Error fetching campaigns:",e),eO.toast.error("Error al cargar campaas")}},ek=async()=>{try{let e=await e_.api.templates.list();s(e.data||[])}catch(e){console.error("Error fetching templates:",e),eO.toast.error("Error al cargar plantillas")}},ej=async()=>{try{let e=await e_.api.bannedWords.list(),t=e.data?.bannedWords||[];el(t.filter(e=>e.active))}catch(e){console.error("Error fetching banned words:",e)}};(0,em.useEffect)(()=>{ed((e=>{if(!e||0===eo.length)return[];let t=e.toLowerCase(),r=[];for(let e of eo)RegExp(`\\b${e.word.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`,"gi").test(t)&&r.push(e.word);return r})(h))},[h,eo]);let eN=(e,t="")=>{let r=document.querySelector("textarea[name='mensaje']");if(!r)return void console.warn("[insertAtCursor] Textarea not found");let a=r.selectionStart,n=r.selectionEnd,s=h.substring(a,n);f(h.substring(0,a)+e+s+t+h.substring(n)),setTimeout(()=>{r.focus();let n=a+e.length+s.length+t.length;r.selectionStart=n,r.selectionEnd=n},0)},eE=new Set(["telefono","phone","celular","telefono1","telefonocelular","movil"]),eA=G.filter(e=>e&&!eE.has(String(e).toLowerCase())),eP=async()=>{if(!h.trim())return void eO.toast.error("Escribe un mensaje para guardar como plantilla");let e=prompt("Nombre de la plantilla:");if(e)try{d?(await e_.api.templates.update(d,{nombre:e,contenido:h}),eO.toast.success("Plantilla actualizada")):(await e_.api.templates.create({nombre:e,contenido:h}),eO.toast.success("Plantilla guardada")),ek()}catch(e){console.error("Error saving template:",e),eO.toast.error(e.response?.data?.message||"Error al guardar plantilla")}},eD=async()=>{if(!d)return void eO.toast.error("Selecciona una plantilla para eliminar");if(confirm("Eliminar esta plantilla?"))try{await e_.api.templates.delete(d),eO.toast.success("Plantilla eliminada"),u(""),f(""),ek()}catch(e){console.error("Error deleting template:",e),eO.toast.error(e.response?.data?.message||"Error al eliminar plantilla")}},eR=async()=>{if(!l.trim())return void eO.toast.error("Ingresa un nombre para la campaa");if(0===P.length)return void eO.toast.error("Debes cargar contactos primero");if(!h.trim()&&!d)return void eO.toast.error("Escribe un mensaje o selecciona una plantilla");try{o(!0);let e=k&&""!==k.trim();await e_.api.sendJobs.start({name:l,templateId:d||void 0,message:d?void 0:h,contacts:P,delayMin:parseInt(p),delayMax:parseInt(g),batchSize:parseInt(b),pauseBetweenBatches:parseInt(v),scheduledFor:e?new Date(k).toISOString():void 0}),eO.toast.success(e?`Campa\xf1a programada para ${new Date(k).toLocaleString("es-AR")}`:"Campaa iniciada exitosamente"),c(""),u(""),f(""),D([]),O(null),j(""),ev()}catch(e){console.error("Error starting campaign:",e),eO.toast.error(e.response?.data?.message||"Error al iniciar campaa")}finally{o(!1)}},eM=async e=>{try{await e_.api.sendJobs.pause(e),eO.toast.success("Campaa pausada"),ev()}catch(e){console.error("Error pausing campaign:",e),eO.toast.error(e.response?.data?.message||"Error al pausar campaa")}},eZ=async e=>{try{await e_.api.sendJobs.resume(e),eO.toast.success("Campaa reanudada"),ev()}catch(e){console.error("Error resuming campaign:",e),eO.toast.error(e.response?.data?.message||"Error al reanudar campaa")}},e0=async e=>{if(confirm("Cancelar esta campaa?"))try{await e_.api.sendJobs.cancel(e),eO.toast.success("Campaa cancelada"),ev()}catch(e){console.error("Error canceling campaign:",e),eO.toast.error(e.response?.data?.message||"Error al cancelar campaa")}},e1=async e=>{try{let t=await e_.api.sendJobs.export(e),r=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=r,a.setAttribute("download",`campaign_${e}.xlsx`),document.body.appendChild(a),a.click(),a.remove(),eO.toast.success("Campaa exportada")}catch(e){console.error("Error exporting campaign:",e),eO.toast.error(e.response?.data?.message||"Error al exportar campaa")}},e2=async()=>{if(R)try{let e=await e_.api.contacts.downloadRejected(R),t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t,r.setAttribute("download",`afiliados_rechazados_${Date.now()}.txt`),document.body.appendChild(r),r.click(),r.remove(),eO.toast.success("Archivo de rechazados descargado")}catch(e){console.error("Error downloading rejected file:",e),eO.toast.error("Error al descargar archivo de rechazados")}},e3=async()=>{if(confirm("Ests seguro de que deseas desconectar el dispositivo? Debers vincular uno nuevo."))try{await e_.api.whatsapp.logout(),eO.toast.success("Dispositivo desconectado exitosamente"),H(!1),A(!0)}catch(e){console.error("Error disconnecting device:",e),eO.toast.error(e.response?.data?.message||"Error al desconectar dispositivo")}},e6=r.filter(e=>!N||new Date(e.createdAt).toISOString().split("T")[0]===N);return W?(0,ep.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)]",children:(0,ep.jsxs)("div",{className:"text-center",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("inline-block w-12 h-12 border-4 border-t-transparent rounded-full animate-spin mb-4","dark"===e?"border-white/20 border-t-white":"border-gray-300 border-t-purple-600")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Verificando conexin de WhatsApp..."})]})}):!1===V?(0,ep.jsx)(iJ,{onSuccess:()=>{H(!0),eO.toast.success("WhatsApp vinculado correctamente"),ev()}}):(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-4 lg:space-y-6",children:[(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-2xl border shadow-sm transition-all duration-300 hover:shadow-lg relative overflow-hidden group","dark"===e?"bg-white/5 border-white/10":(0,eg.cn)("border-gray-200/50",eb.default.cardPrimaryLight)),style:{animationDelay:"0ms"},children:["dark"!==e&&(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -top-10 -right-10 w-24 h-24 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity",eb.default.glowPrimaryLight)}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg flex items-center justify-center w-10 h-10 lg:w-12 lg:h-12","dark"===e?"bg-blue-500/20 text-blue-400":(0,eg.cn)("text-white",eb.default.iconPrimaryLight)),children:(0,ep.jsx)(eF.MessageCircle,{className:"w-5 h-5 lg:w-6 lg:h-6"})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Mensajes enviados hoy"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-2xl lg:text-3xl font-bold","dark"===e?"text-white":eb.default.textPrimaryLight),children:eu.mensajesHoy})]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-2xl border shadow-sm transition-all duration-300 hover:shadow-lg relative overflow-hidden group","dark"===e?"bg-white/5 border-white/10":(0,eg.cn)("border-gray-200/50",eb.default.cardSecondaryLight)),style:{animationDelay:"100ms"},children:["dark"!==e&&(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -top-10 -right-10 w-24 h-24 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity",eb.default.glowSecondaryLight)}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg flex items-center justify-center w-10 h-10 lg:w-12 lg:h-12","dark"===e?"bg-emerald-500/20 text-emerald-400":(0,eg.cn)("text-white",eb.default.iconSecondaryLight)),children:(0,ep.jsx)(ew.Users,{className:"w-5 h-5 lg:w-6 lg:h-6"})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Usuarios activos"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-2xl lg:text-3xl font-bold","dark"===e?"text-white":eb.default.textSecondaryLight),children:eu.usuariosActivos})]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-2xl border shadow-sm transition-all duration-300 hover:shadow-lg relative overflow-hidden group","dark"===e?"bg-white/5 border-white/10":(0,eg.cn)("border-gray-200/50",eb.default.cardAccentLight)),style:{animationDelay:"200ms"},children:["dark"!==e&&(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -top-10 -right-10 w-24 h-24 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity",eb.default.glowAccentLight)}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg flex items-center justify-center w-10 h-10 lg:w-12 lg:h-12","dark"===e?"bg-purple-500/20 text-purple-400":(0,eg.cn)("text-white",eb.default.iconAccentLight)),children:(0,ep.jsx)(eI.Upload,{className:"w-5 h-5 lg:w-6 lg:h-6"})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Contactos cargados"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-2xl lg:text-3xl font-bold","dark"===e?"text-white":eb.default.textAccentLight),children:eu.contactosCargados})]})]})]})]}),(0,ep.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all cursor-pointer","dark"===e?"bg-[#17C787] hover:bg-[#17C787]/80 text-white":"bg-emerald-500 hover:bg-emerald-600 text-white"),children:[(0,ep.jsx)(eI.Upload,{className:"w-3.5 h-3.5"}),(0,ep.jsx)("span",{className:"hidden sm:inline",children:"Subir contactos (CSV/XLS)"}),(0,ep.jsx)("span",{className:"sm:hidden",children:"Subir"}),(0,ep.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:ey,className:"hidden"})]}),(0,ep.jsxs)("button",{onClick:e3,className:(0,eg.cn)("flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#C8376B] hover:bg-[#C8376B]/80 text-white":"bg-rose-500 hover:bg-rose-600 text-white"),children:[(0,ep.jsx)(eL,{className:"w-3.5 h-3.5"}),(0,ep.jsx)("span",{className:"hidden sm:inline",children:"Desconectar dispositivo"}),(0,ep.jsx)("span",{className:"sm:hidden",children:"Desconectar"})]}),(0,ep.jsxs)("button",{onClick:()=>C(!0),className:(0,eg.cn)("flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#1E88E5] hover:bg-[#1E88E5]/80 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:[(0,ep.jsx)(eF.MessageCircle,{className:"w-3.5 h-3.5"}),(0,ep.jsx)("span",{className:"hidden sm:inline",children:"Auto-respuestas"}),(0,ep.jsx)("span",{className:"sm:hidden",children:"Auto"})]})]}),I&&(0,ep.jsxs)("div",{className:"space-y-2",children:[I.accepted>0&&(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border","dark"===e?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-emerald-50 border-emerald-200 text-emerald-700"),children:[" ",I.accepted," afiliados aceptados y listos para contactar desde ",_?.name]}),I.rejected>0&&R&&(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border flex items-center justify-between","dark"===e?"bg-orange-500/10 border-orange-500/30 text-orange-400":"bg-orange-50 border-orange-200 text-orange-700"),children:[(0,ep.jsxs)("span",{children:[" ",I.rejected," afiliados rechazados (duplicados o ya contactados)"]}),(0,ep.jsxs)("button",{onClick:e2,className:(0,eg.cn)("flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-orange-500/20 hover:bg-orange-500/30 text-orange-300":"bg-orange-200 hover:bg-orange-300 text-orange-800"),children:[(0,ep.jsx)(eC,{className:"w-3.5 h-3.5"}),"Descargar rechazados"]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:"Nombre de la campaa"}),(0,ep.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Ingresa el nombre...",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:"Plantilla (opcional)"}),(0,ep.jsxs)("select",{value:d,onChange:e=>(e=>{if(u(e),e){let t=n.find(t=>t._id===e);t&&f(t.contenido)}})(e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 focus:border-purple-400 focus:ring-purple-200/50"),children:[(0,ep.jsx)("option",{value:"",children:"-- Selecciona plantilla --"}),n.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("button",{onClick:eP,className:(0,eg.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#17C787]/20 hover:bg-[#17C787]/30 text-[#17C787] border border-[#17C787]/30":"bg-emerald-100 hover:bg-emerald-200 text-emerald-700 border border-emerald-200"),children:[(0,ep.jsx)(eB.Save,{className:"w-3.5 h-3.5"}),"Guardar"]}),(0,ep.jsxs)("button",{onClick:eD,className:(0,eg.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#C8376B]/20 hover:bg-[#C8376B]/30 text-[#C8376B] border border-[#C8376B]/30":"bg-rose-100 hover:bg-rose-200 text-rose-700 border border-rose-200"),children:[(0,ep.jsx)(eU.Trash2,{className:"w-3.5 h-3.5"}),"Eliminar"]})]})]}),(0,ep.jsxs)("div",{className:"space-y-2",children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:"Mensaje"}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-1 px-2 py-1.5 rounded-t-lg border-b relative","dark"===e?"bg-white/5 border-white/10":"bg-purple-50 border-purple-100"),children:[(0,ep.jsx)("button",{type:"button",onClick:()=>eN("*","*"),title:"Negrita",className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-600"),children:(0,ep.jsx)(eG,{className:"w-3.5 h-3.5"})}),(0,ep.jsx)("button",{type:"button",onClick:()=>eN("_","_"),title:"Cursiva",className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-600"),children:(0,ep.jsx)(eK,{className:"w-3.5 h-3.5"})}),(0,ep.jsx)("button",{type:"button",onClick:()=>Y(!X),title:"Emoji",className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-600"),children:(0,ep.jsx)(eX,{className:"w-3.5 h-3.5"})}),X&&(0,ep.jsx)("div",{className:(0,eg.cn)("absolute top-full left-0 mt-1 p-2 rounded-lg shadow-lg border grid grid-cols-10 gap-1 z-20","dark"===e?"bg-gray-800 border-white/10":"bg-white border-purple-200"),children:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""].map(e=>(0,ep.jsx)("button",{type:"button",onClick:()=>{eN(e),Y(!1)},className:(0,eg.cn)("text-xl hover:bg-gray-100 dark:hover:bg-gray-700 rounded p-1"),children:e},e))}),(0,ep.jsx)("div",{className:(0,eg.cn)("w-px h-4 mx-1","dark"===e?"bg-white/10":"bg-purple-200")}),(0,ep.jsx)("button",{type:"button",onClick:()=>J(!0),title:"Spintax - Variaciones de texto",className:(0,eg.cn)("px-2 py-1 rounded text-xs font-medium transition-colors","dark"===e?"hover:bg-white/10 text-purple-400":"hover:bg-purple-100 text-purple-600"),children:"Spintax"}),eA.length>0&&(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-px h-4 mx-1","dark"===e?"bg-white/10":"bg-purple-200")}),eA.map(t=>(0,ep.jsxs)("button",{type:"button",onClick:()=>eN(`[${t}]`),title:`Insertar campo din\xe1mico: ${t}`,className:(0,eg.cn)("px-2 py-1 rounded text-xs font-medium transition-colors","dark"===e?"hover:bg-white/10 text-blue-400":"hover:bg-blue-100 text-blue-600"),children:["[",String(t).toUpperCase(),"]"]},t))]})]}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("textarea",{name:"mensaje",value:h,onChange:e=>f(e.target.value),placeholder:"Escribe tu mensaje aqu... (se ignora si seleccionas plantilla)",rows:4,spellCheck:!0,lang:"es",className:(0,eg.cn)("w-full px-3 py-2 rounded-b-lg text-sm border border-t-0 transition-all focus:ring-2 resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50",ec.length>0&&"border-red-400 focus:border-red-500 focus:ring-red-200/50")}),ec.length>0&&(0,ep.jsx)("div",{"aria-hidden":"true",className:"absolute inset-0 px-3 py-2 text-sm pointer-events-none overflow-hidden whitespace-pre-wrap break-words rounded-b-lg",style:{color:"transparent"},dangerouslySetInnerHTML:{__html:(()=>{if(!h||0===ec.length)return null;let e=h.replace(/</g,"&lt;").replace(/>/g,"&gt;");for(let t of ec){let r=RegExp(`\\b(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})\\b`,"gi");e=e.replace(r,'<mark class="bg-red-500/30 text-red-600 dark:text-red-400 rounded px-0.5">$1</mark>')}return e})()||""}})]}),ec.length>0&&(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-start gap-2 p-3 rounded-lg border mt-2","dark"===e?"bg-red-500/10 border-red-500/30 text-red-400":"bg-red-50 border-red-200 text-red-700"),children:[(0,ep.jsx)(eJ.AlertTriangle,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),(0,ep.jsxs)("div",{className:"text-xs",children:[(0,ep.jsx)("p",{className:"font-semibold",children:" Palabras/frases prohibidas detectadas:"}),(0,ep.jsx)("p",{className:"mt-1",children:ec.map(e=>`"${e}"`).join(", ")}),(0,ep.jsx)("p",{className:"mt-1 opacity-80",children:"Debes eliminarlas para poder enviar la campaa."})]})]}),(0,ep.jsxs)("button",{onClick:()=>{if(!h.trim())return void eO.toast.error("Escribe un mensaje para previsualizar");if(!P||0===P.length)return void eO.toast.error("Carga un archivo para previsualizar con datos reales");try{let e=P[0],t=h;console.log("[Preview] First contact:",e),console.log("[Preview] First contact FULL:",JSON.stringify(e,null,2)),console.log("[Preview] Import headers:",G),console.log("[Preview] Original message:",h),G.forEach(r=>{let a=e[r]||e.extraData?.[r]||e[r.toLowerCase()]||e.extraData?.[r.toLowerCase()]||`[${r}]`;console.log(`[Preview] Replacing [${r}] with:`,a);let n=RegExp(`\\[${r}\\]`,"gi");t=t.replace(n,String(a))}),e.extraData&&Object.keys(e.extraData).forEach(r=>{let a=e.extraData[r],n=RegExp(`\\[${r}\\]`,"gi");t=t.replace(n,String(a))}),console.log("[Preview] After replacement:",t),t=t.replace(/{([^}]+)}/g,(e,t)=>t.split("|").map(e=>e.trim())[0]||e),z({message:t,contactName:e.nombre||e.extraData?.nombre||"Ejemplo"}),B(!0)}catch(e){console.error("Error previewing message:",e),eO.toast.error("Error al generar vista previa")}},className:(0,eg.cn)("w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-gradient-to-r from-purple-600/50 to-blue-600/50 hover:from-purple-600/70 hover:to-blue-600/70 text-white border border-white/10":"bg-gradient-to-r from-purple-200 to-blue-200 hover:from-purple-300 hover:to-blue-300 text-purple-700 border border-purple-200"),children:[(0,ep.jsx)(ez.Eye,{className:"w-3.5 h-3.5"}),"Previsualizar"]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4 pt-4 border-t","dark"===e?"border-white/10":"border-purple-100"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(eV.Clock,{className:"w-3 h-3"}),"Tiempo (seg)"]}),(0,ep.jsxs)("div",{className:"flex gap-1",children:[(0,ep.jsx)("input",{type:"number",value:p,onChange:e=>m(e.target.value),className:(0,eg.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")}),(0,ep.jsx)("input",{type:"number",value:g,onChange:e=>x(e.target.value),className:(0,eg.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(e$.Package,{className:"w-3 h-3"}),"Tamao lote"]}),(0,ep.jsx)("input",{type:"number",value:b,onChange:e=>y(e.target.value),className:(0,eg.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(eH,{className:"w-3 h-3"}),"Descanso (min)"]}),(0,ep.jsx)("input",{type:"number",value:v,onChange:e=>w(e.target.value),className:(0,eg.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(eS,{className:"w-3 h-3"}),"Programar"]}),(0,ep.jsx)("input",{type:"datetime-local",value:k,onChange:e=>j(e.target.value),className:(0,eg.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]})]}),(0,ep.jsx)("button",{onClick:eR,disabled:i||ec.length>0,className:(0,eg.cn)("w-full mt-4 flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm font-semibold transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",ec.length>0?"dark"===e?"bg-gradient-to-r from-red-600 to-red-500 text-white":"bg-gradient-to-r from-red-400 to-red-500 text-white":"dark"===e?"bg-gradient-to-r from-[#17C787] to-[#1E88E5] hover:from-[#17C787]/90 hover:to-[#1E88E5]/90 text-white shadow-lg shadow-[#17C787]/20":"bg-gradient-to-r from-emerald-500 to-blue-500 hover:from-emerald-600 hover:to-blue-600 text-white shadow-lg shadow-emerald-200/50"),children:ec.length>0?(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)(eJ.AlertTriangle,{className:"w-4 h-4"}),"Elimina las palabras prohibidas"]}):(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)(eY.Sparkles,{className:"w-4 h-4"}),i?"Iniciando...":"Iniciar envo"]})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border backdrop-blur-sm overflow-hidden","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 p-4 border-b","dark"===e?"border-white/10":"border-purple-100"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Campaas creadas"}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Fecha:"}),(0,ep.jsx)("input",{type:"date",value:N,onChange:e=>S(e.target.value),className:(0,eg.cn)("px-2 py-1 rounded text-xs border w-28","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]})]}),(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:"dark"===e?"bg-white/5":"bg-purple-50",children:[(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Nombre"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Usuario/Equipo"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Estado"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Progreso"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Mtricas"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Hora"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-center font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===e?"divide-white/5":"divide-purple-100"),children:e6.map(t=>{let r={running:{bg:"dark"===e?"bg-blue-500/20":"bg-blue-100",text:"dark"===e?"text-blue-400":"text-blue-600"},pending:{bg:"dark"===e?"bg-yellow-500/20":"bg-yellow-100",text:"dark"===e?"text-yellow-400":"text-yellow-600"},failed:{bg:"dark"===e?"bg-red-500/20":"bg-red-100",text:"dark"===e?"text-red-400":"text-red-600"},completed:{bg:"dark"===e?"bg-green-500/20":"bg-green-100",text:"dark"===e?"text-green-400":"text-green-600"},completado:{bg:"dark"===e?"bg-green-500/20":"bg-green-100",text:"dark"===e?"text-green-400":"text-green-600"},paused:{bg:"dark"===e?"bg-orange-500/20":"bg-orange-100",text:"dark"===e?"text-orange-400":"text-orange-600"},pausado:{bg:"dark"===e?"bg-orange-500/20":"bg-orange-100",text:"dark"===e?"text-orange-400":"text-orange-600"},ejecutando:{bg:"dark"===e?"bg-blue-500/20":"bg-blue-100",text:"dark"===e?"text-blue-400":"text-blue-600"},fallido:{bg:"dark"===e?"bg-red-500/20":"bg-red-100",text:"dark"===e?"text-red-400":"text-red-600"},descanso:{bg:"dark"===e?"bg-yellow-500/20":"bg-yellow-100",text:"dark"===e?"text-yellow-400":"text-yellow-600"}}[i3(t.status).toLowerCase()]||{bg:"dark"===e?"bg-gray-500/20":"bg-gray-100",text:"dark"===e?"text-gray-400":"text-gray-600"},a=t.progress||0;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-purple-50/50"),children:[(0,ep.jsx)("td",{className:"px-3 py-2.5",children:(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium","dark"===e?"text-purple-400":"text-purple-600"),children:t.name})}),(0,ep.jsx)("td",{className:"px-3 py-2.5",children:(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:"dark"===e?"text-white":"text-gray-700",children:t.createdBy?.nombre||"N/A"}),(0,ep.jsx)("span",{className:(0,eg.cn)("ml-2 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600"),children:t.createdBy?.numeroEquipo||"N/A"})]})}),(0,ep.jsx)("td",{className:"px-3 py-2.5",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded-full text-[10px] font-medium",r.bg,r.text),children:i3(t.status)})}),(0,ep.jsx)("td",{className:"px-3 py-2.5",children:(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:"flex-1 h-1.5 bg-gray-100 dark:bg-white/10 rounded-full overflow-hidden",children:(0,ep.jsx)("div",{className:(0,eg.cn)("h-full transition-all duration-500","completed"===t.status?"bg-[#17C787]":"failed"===t.status?"bg-[#C8376B]":"dark"===e?"bg-purple-500":"bg-purple-400"),style:{width:`${a}% `}})}),(0,ep.jsxs)("span",{className:(0,eg.cn)("text-[10px]","dark"===e?"text-gray-400":"text-gray-500"),children:[a,"%"]}),("resting"===t.status||"descanso"===t.status)&&t.restBreakUntil&&(0,ep.jsx)(i8,{targetDate:t.restBreakUntil})]})}),(0,ep.jsx)("td",{className:"px-3 py-2.5",children:(0,ep.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-[#17C787]/20 text-[#17C787]":"bg-emerald-100 text-emerald-600"),children:["",t.stats?.sent||0]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-[#C8376B]/20 text-[#C8376B]":"bg-rose-100 text-rose-600"),children:["",t.stats?.failed||0]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-[#1E88E5]/20 text-[#1E88E5]":"bg-blue-100 text-blue-600"),children:["",t.stats?.pending||0]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-600"),title:"Respuestas recibidas",children:["",t.repliesCount||0]})]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-2.5","dark"===e?"text-gray-400":"text-gray-600"),children:new Date(t.createdAt).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!0})}),(0,ep.jsx)("td",{className:"px-3 py-2.5",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[!["paused","pausado","completado","completed","fallida","failed"].includes(t.status?.toLowerCase()||"")&&(0,ep.jsx)("button",{onClick:()=>eM(t._id),className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#F4C04A]/20 text-[#F4C04A] hover:bg-[#F4C04A]/30":"bg-amber-100 text-amber-600 hover:bg-amber-200"),title:"Pausar campaa",children:(0,ep.jsx)(eW,{className:"w-3 h-3"})}),("paused"===t.status||"pausado"===t.status)&&(0,ep.jsx)("button",{onClick:()=>eZ(t._id),className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#17C787]/20 text-[#17C787] hover:bg-[#17C787]/30":"bg-emerald-100 text-emerald-600 hover:bg-emerald-200"),title:"Reanudar campaa",children:(0,ep.jsx)(eq,{className:"w-3 h-3"})}),(0,ep.jsx)("button",{onClick:()=>e0(t._id),className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#C8376B]/20 text-[#C8376B] hover:bg-[#C8376B]/30":"bg-rose-100 text-rose-600 hover:bg-rose-200"),title:"Borrar campaa",children:(0,ep.jsx)(eU.Trash2,{className:"w-3 h-3"})}),(0,ep.jsx)("button",{onClick:()=>e1(t._id),className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#17C787]/20 text-[#17C787] hover:bg-[#17C787]/30":"bg-emerald-100 text-emerald-600 hover:bg-emerald-200"),title:"Descargar reporte",children:(0,ep.jsx)(eC,{className:"w-3 h-3"})})]})})]},t._id)})})]})})]}),F&&U&&(0,ep.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-md rounded-2xl border p-6 shadow-2xl pointer-events-auto","dark"===e?"bg-gradient-to-br from-gray-900 to-gray-800 border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold","dark"===e?"text-white":"text-gray-800"),children:"Vista Previa del Mensaje"}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:["Ejemplo con: ",U.contactName]})]}),(0,ep.jsx)("button",{onClick:()=>B(!1),className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsx)("div",{className:"mb-6",children:(0,ep.jsx)("div",{className:"flex justify-end",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("max-w-[85%] rounded-lg p-3 shadow-md","dark"===e?"bg-green-900/50 text-green-100":"bg-green-100 text-gray-800"),children:[(0,ep.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:U.message}),(0,ep.jsxs)("div",{className:"flex items-center justify-end gap-1 mt-1",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-[10px]","dark"===e?"text-green-300/70":"text-gray-500"),children:new Date().toLocaleTimeString("es",{hour:"2-digit",minute:"2-digit"})}),(0,ep.jsx)(eQ,{className:(0,eg.cn)("w-3 h-3","dark"===e?"text-blue-400":"text-blue-500")})]})]})})}),(0,ep.jsx)("button",{onClick:()=>B(!1),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg font-semibold transition-all","dark"===e?"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white":"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white"),children:"Cerrar"})]})}),T&&(0,ep.jsx)(iJ,{onSuccess:()=>{H(!0),A(!1),ev()}}),(0,ep.jsx)(e5,{isOpen:E,onClose:()=>C(!1)}),(0,ep.jsx)(e4,{isOpen:Q,onClose:()=>J(!1),onInsert:e=>{eN(e),J(!1)}}),Z&&(0,ep.jsx)(iZ,{onDismiss:()=>ee(!1),onReconnect:()=>{ee(!1),A(!0)}}),et&&(0,ep.jsx)(i2,{count:ea,onDismiss:()=>er(!1),onDownload:e2}),es&&(0,ep.jsx)(i5,{data:es,onDismiss:()=>ei(null)})]})}function i8({targetDate:e}){let[t,r]=(0,em.useState)("");return(0,em.useEffect)(()=>{let t=setInterval(()=>{let a=new Date().getTime(),n=new Date(e).getTime()-a;if(n<=0)r("Reanudando..."),clearInterval(t);else{let e=Math.floor(n%36e5/6e4),t=Math.floor(n%6e4/1e3);r(`${e}m ${t}s`)}},1e3);return()=>clearInterval(t)},[e]),(0,ep.jsxs)("span",{className:"text-[10px] font-mono bg-blue-500/20 text-blue-400 px-1.5 py-0.5 rounded animate-pulse",children:[" ",t]})}var i7=e.i(35389),i9=e.i(33133),oe=e.i(29396),ot=e.i(74402);function or({isOpen:e,onClose:t}){let{theme:r}=(0,ex.useTheme)(),a=(0,iQ.useSocket)(),[n,s]=(0,em.useState)("inbox"),[i,o]=(0,em.useState)(null),[l,c]=(0,em.useState)(!1),[d,u]=(0,em.useState)(void 0),[h,f]=(0,em.useState)([]),[p,m]=(0,em.useState)(!0),[g,x]=(0,em.useState)({page:1,pages:1,total:0}),[b,y]=(0,em.useState)(0),[v,w]=(0,em.useState)([]);(0,em.useEffect)(()=>{e&&(k(),j())},[e,n,g.page]),(0,em.useEffect)(()=>(a&&e&&(a.on("new_message",e=>{eO.toast.info(`Nuevo mensaje de ${e.from.nombre}: ${e.subject}`),j(),"inbox"===n&&k()}),a.on("message_read",()=>{"sent"===n&&k()})),()=>{a&&(a.off("new_message"),a.off("message_read"))}),[a,n,e]);let k=async()=>{m(!0);try{let e,t={page:g.page,limit:20};"inbox"===n?e=await e_.api.internalMessages.getInbox(t):"sent"===n?e=await e_.api.internalMessages.getSent(t):"starred"===n&&(e=await e_.api.internalMessages.getStarred(t)),e&&(f(e.data.messages),x(t=>({...t,pages:e.data.pagination.pages,total:e.data.pagination.total})))}catch(e){console.error("Error loading messages:",e),eO.toast.error("Error al cargar mensajes")}finally{m(!1)}},j=async()=>{try{let e=await e_.api.internalMessages.getUnreadCount();y(e.data.unreadCount)}catch(e){console.error("Error loading unread count:",e)}},N=async e=>{if("inbox"===n&&!e.read)try{await e_.api.internalMessages.markAsRead(e._id,!0),y(e=>Math.max(0,e-1)),f(t=>t.map(t=>t._id===e._id?{...t,read:!0}:t)),e.read=!0}catch(e){console.error("Error marking as read:",e)}o(e)},S=async(e,t)=>{e.stopPropagation();try{await e_.api.internalMessages.toggleStarred(t),f(e=>e.map(e=>e._id===t?{...e,starred:!e.starred}:e)),i?._id===t&&o(e=>e?{...e,starred:!e.starred}:null),"starred"===n&&k()}catch(e){console.error("Error toggling star:",e)}},E=async e=>{if(confirm(`\xbfEst\xe1 seguro de eliminar ${e.length} mensaje(s)?`))try{await Promise.all(e.map(e=>e_.api.internalMessages.delete(e))),eO.toast.success("Mensajes eliminados"),w([]),i&&e.includes(i._id)&&o(null),k()}catch(e){console.error("Error deleting messages:",e),eO.toast.error("Error al eliminar mensajes")}},C=async()=>{if(confirm("Est seguro de eliminar TODOS los mensajes? Esta accin no se puede deshacer."))try{await e_.api.internalMessages.deleteAll(),eO.toast.success("Todos los mensajes eliminados"),w([]),k()}catch(e){console.error("Error deleting all messages:",e),eO.toast.error("Error al eliminar todos los mensajes")}};return e?(0,ep.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,ep.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:t}),(0,ep.jsxs)("div",{className:(0,eg.cn)("relative w-full max-w-6xl h-[85vh] overflow-hidden rounded-2xl border shadow-2xl animate-scale-in flex flex-col","dark"===r?"bg-gradient-to-br from-[#1a1333] to-[#0f0a1e] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2] border-purple-200/50"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-4 border-b flex-shrink-0","dark"===r?"border-white/10":"border-purple-100"),children:[(0,ep.jsx)("div",{className:"flex items-center gap-2",children:(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold","dark"===r?"text-white":"text-gray-700"),children:"Mensajera Interna"})}),(0,ep.jsx)("button",{onClick:t,className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,ep.jsx)(i7.MessagesSidebar,{currentView:n,onViewChange:e=>{s(e),o(null),x({...g,page:1})},onCompose:()=>{u(void 0),c(!0)},unreadCount:b}),(0,ep.jsx)("div",{className:"flex-1 flex flex-col min-w-0 border-l border-opacity-10 dark:border-white/10 border-gray-200",children:i?(0,ep.jsx)(oe.MessageDetail,{message:i,onBack:()=>o(null),onReply:()=>{i&&(u({to:[i.from._id],subject:`RE: ${i.subject}`,replyTo:i._id,content:`

--- En respuesta a ---
Fecha: ${new Date(i.createdAt).toLocaleString()}
De: ${i.from.nombre}
Asunto: ${i.subject}

${i.content}`}),c(!0))},onForward:()=>{i&&(u({subject:`FW: ${i.subject}`,content:`

--- Mensaje reenviado ---
Fecha: ${new Date(i.createdAt).toLocaleString()}
De: ${i.from.nombre}
Asunto: ${i.subject}

${i.content}`,isForward:!0}),c(!0))},onDelete:()=>E([i._id]),onToggleStar:()=>S({stopPropagation:()=>{}},i._id)}):(0,ep.jsx)(i9.MessageList,{messages:h,loading:p,view:n,onSelectMessage:N,onToggleStar:S,onDelete:E,selectedIds:v,onToggleSelect:e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},onToggleSelectAll:()=>{v.length===h.length?w([]):w(h.map(e=>e._id))},onDeleteAll:C,pagination:g,onPageChange:e=>x(t=>({...t,page:e}))})})]}),(0,ep.jsx)(ot.ComposeModal,{isOpen:l,onClose:()=>c(!1),initialData:d,onSent:()=>{"sent"===n&&k()}})]})]}):null}var oa=e.i(61956);let on=(0,ek.default)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var os=e.i(21264);function oi(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)(null),[a,n]=(0,em.useState)(!0),[s,i]=(0,em.useState)(0),[o,l]=(0,em.useState)(0);(0,em.useEffect)(()=>{c()},[]);let c=async()=>{try{n(!0);let[e,t,a]=await Promise.all([e_.api.affiliates.stats(),e_.api.affiliates.getFresh(),e_.api.affiliates.getReusableData()]);r(e.data),i(t.data.total||0),l(a.data.total||0)}catch(e){console.error("Error loading stats:",e),eO.toast.error("Error al cargar estadsticas")}finally{n(!1)}};if(a)return(0,ep.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6 h-20","dark"===e?"bg-white/5 border-white/10":"bg-gray-100 border-gray-200")}),(0,ep.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[1,2,3].map(t=>(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl h-32","dark"===e?"bg-white/5":"bg-gray-100")},t))})]});if(!t)return(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6 text-center","dark"===e?"bg-white/5 border-white/10 text-gray-400":"bg-gray-50 border-gray-200 text-gray-600"),children:"No hay estadsticas disponibles"});let d=t.total-s-o,u=t.total>0?(s/t.total*100).toFixed(1):"0.0",h=t.total>0?(o/t.total*100).toFixed(1):"0.0",f=t.total>0?(d/t.total*100).toFixed(1):"0.0",p=t.obrasSociales.slice(0,5);return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2","dark"===e?"text-white":"text-gray-700"),children:[(0,ep.jsx)(oa.BarChart3,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Estadsticas de la Base"]})}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl p-5 transition-all duration-300 hover:scale-[1.02]","dark"===e?"bg-gradient-to-br from-blue-600 to-blue-700":"bg-gradient-to-br from-blue-500 to-blue-600"),children:[(0,ep.jsx)("p",{className:"text-4xl lg:text-5xl font-bold text-white mb-2",children:t.total.toLocaleString()}),(0,ep.jsxs)("p",{className:"text-sm text-blue-100 flex items-center gap-2",children:[(0,ep.jsx)(ew.Users,{className:"w-4 h-4"}),"Afiliados Totales"]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl p-5 transition-all duration-300 hover:scale-[1.02]","dark"===e?"bg-gradient-to-br from-emerald-600 to-emerald-700":"bg-gradient-to-br from-emerald-500 to-emerald-600"),children:[(0,ep.jsx)("p",{className:"text-4xl lg:text-5xl font-bold text-white mb-2",children:s.toLocaleString()}),(0,ep.jsxs)("p",{className:"text-sm text-emerald-100 flex items-center gap-2",children:[(0,ep.jsx)(eY.Sparkles,{className:"w-4 h-4"}),"Disponibles (Sin usar)"]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl p-5 transition-all duration-300 hover:scale-[1.02]","dark"===e?"bg-gradient-to-br from-orange-500 to-orange-600":"bg-gradient-to-br from-orange-400 to-orange-500"),children:[(0,ep.jsx)("p",{className:"text-4xl lg:text-5xl font-bold text-white mb-2",children:t.exported.toLocaleString()}),(0,ep.jsxs)("p",{className:"text-sm text-orange-100 flex items-center gap-2",children:[(0,ep.jsx)(on,{className:"w-4 h-4"}),"Ya Exportados"]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-base font-semibold mb-4","dark"===e?"text-white":"text-gray-700"),children:"Estado de Uso"}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("h-8 rounded-lg overflow-hidden flex","dark"===e?"bg-gray-700":"bg-gray-200"),children:[(0,ep.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 flex items-center justify-center text-xs font-medium text-white",style:{width:`${u}%`},children:Number(u)>5&&`${u}%`}),(0,ep.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center text-xs font-medium text-white",style:{width:`${h}%`},children:Number(h)>5&&`${h}%`}),(0,ep.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-400 to-orange-500 flex items-center justify-center text-xs font-medium text-white",style:{width:`${f}%`},children:Number(f)>5&&`${f}%`})]}),(0,ep.jsxs)("div",{className:"flex justify-between mt-2 text-xs flex-wrap gap-2",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-white text-xs","dark"===e?"bg-emerald-600":"bg-emerald-500"),children:"Frescos"}),(0,ep.jsxs)("span",{className:(0,eg.cn)("flex items-center gap-1","dark"===e?"text-emerald-400":"text-emerald-600"),children:[(0,ep.jsx)(eY.Sparkles,{className:"w-3 h-3"})," ",s.toLocaleString()]})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-white text-xs","dark"===e?"bg-purple-600":"bg-purple-500"),children:"Reutilizables"}),(0,ep.jsxs)("span",{className:(0,eg.cn)("flex items-center gap-1","dark"===e?"text-purple-400":"text-purple-600"),children:[(0,ep.jsx)(os.Recycle,{className:"w-3 h-3"})," ",o.toLocaleString()]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-1","dark"===e?"text-orange-400":"text-orange-600"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-white text-xs","dark"===e?"bg-orange-600":"bg-orange-500"),children:"Usados"}),(0,ep.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ep.jsx)(on,{className:"w-3 h-3"})," ",d.toLocaleString()]})]})]})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-base font-semibold mb-4","dark"===e?"text-white":"text-gray-700"),children:"Top Obras Sociales"}),(0,ep.jsx)("div",{className:"space-y-3",children:p.length>0?p.map((t,r)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-start justify-between gap-2 pb-3",r!==p.length-1&&("dark"===e?"border-b border-white/10":"border-b border-gray-100")),children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm flex-1","dark"===e?"text- gray-300":"text-gray-600"),children:t.name}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-semibold shrink-0","dark"===e?"text-blue-400":"text-blue-600"),children:t.count.toLocaleString()})]},r)):(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm text-center","dark"===e?"text-gray-500":"text-gray-400"),children:"No hay datos disponibles"})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-base font-semibold mb-4","dark"===e?"text-white":"text-gray-700"),children:"Cargas Recientes"}),(0,ep.jsx)("div",{className:"space-y-4",children:t.recentBatches.length>0?t.recentBatches.map((r,a)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-start justify-between gap-2 pb-3",a!==t.recentBatches.length-1&&("dark"===e?"border-b border-white/10":"border-b border-gray-100")),children:[(0,ep.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm font-medium truncate flex items-center gap-2","dark"===e?"text-gray-200":"text-gray-700"),children:[(0,ep.jsx)(eC,{className:(0,eg.cn)("w-4 h-4 shrink-0","dark"===e?"text-emerald-400":"text-emerald-500")}),r.sourceFile]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1 flex items-center gap-1","dark"===e?"text-gray-500":"text-gray-400"),children:[(0,ep.jsx)(eV.Clock,{className:"w-3 h-3"}),new Date(r.uploadDate).toLocaleString("es-AR")]})]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm font-semibold shrink-0","dark"===e?"text-orange-400":"text-orange-500"),children:[r.count.toLocaleString()," registros"]})]},a)):(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm text-center","dark"===e?"text-gray-500":"text-gray-400"),children:"No hay cargas recientes"})})]})]})]})}let oo=(0,ek.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ol=(0,ek.default)("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);function oc(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)([]),[a,n]=(0,em.useState)(!0),[s,i]=(0,em.useState)(null);(0,em.useEffect)(()=>{o()},[]);let o=async()=>{try{n(!0);let e=await e_.api.affiliates.listExports();r(e.data.exports||[])}catch(e){console.error("Error fetching exports:",e),eO.toast.error("Error al cargar archivos exportados")}finally{n(!1)}},l=async e=>{try{i(e);let t=await e_.api.affiliates.downloadExport(e),r=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a),eO.toast.success("Archivo descargado correctamente")}catch(e){console.error("Error downloading file:",e),eO.toast.error("Error al descargar archivo")}finally{i(null)}};return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2","dark"===e?"text-white":"text-gray-700"),children:[(0,ep.jsx)(i0.Download,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Archivos Exportados"]})}),a&&(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-8 text-center backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-sm"),children:(0,ep.jsx)("p",{className:(0,eg.cn)("dark"===e?"text-gray-400":"text-gray-500"),children:"Cargando archivos..."})}),!a&&0===t.length&&(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-8 text-center backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-sm"),children:(0,ep.jsx)("p",{className:(0,eg.cn)("dark"===e?"text-gray-400":"text-gray-500"),children:"No hay archivos exportados disponibles"})}),!a&&t.length>0&&(0,ep.jsx)("div",{className:"space-y-3",children:t.map((t,r)=>{var a;return(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-4 backdrop-blur-sm transition-all duration-300 hover:scale-[1.01]","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10 hover:border-purple-500/30":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-sm hover:shadow-md hover:border-purple-300/50"),style:{animationDelay:`${50*r}ms`},children:(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3",children:[(0,ep.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("font-medium text-sm lg:text-base truncate mb-2","dark"===e?"text-white":"text-gray-700"),children:t.filename}),(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-3 lg:gap-4 text-xs",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,ep.jsx)(oo,{className:"w-3.5 h-3.5"}),(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-purple-400":"text-purple-500"),children:t.supervisorName})]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,ep.jsx)(eS,{className:"w-3.5 h-3.5"}),new Date(t.createdAt).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,ep.jsx)(ol,{className:"w-3.5 h-3.5"}),(a=t.size)<1024?`${a} B`:a<1048576?`${(a/1024).toFixed(2)} KB`:`${(a/1048576).toFixed(2)} MB`]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,ep.jsx)(ew.Users,{className:"w-3.5 h-3.5"}),t.affiliateCount," afiliados"]})]})]}),(0,ep.jsxs)("button",{onClick:()=>l(t.filename),disabled:s===t.filename,className:(0,eg.cn)("flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 shrink-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100","dark"===e?"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white hover:from-cyan-500 hover:to-cyan-400":"bg-gradient-to-r from-cyan-500 to-cyan-400 text-white hover:from-cyan-400 hover:to-cyan-300"),children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),s===t.filename?"Descargando...":"Descargar"]})]})},t.filename)})})]})}var od=e.i(37239),ou=e.i(47248),oh=e.i(50400),of=e.i(82726);let op=(0,ek.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function om({isOpen:e,onClose:t,availableObrasSociales:r,onAdd:a,triggerElement:n}){let{theme:s}=(0,ex.useTheme)(),[i,o]=(0,em.useState)(""),[l,c]=(0,em.useState)(0),[d,u]=(0,em.useState)({top:0,left:0}),h=(0,em.useRef)(null),[f,p]=(0,em.useState)(null),[m,g]=(0,em.useState)(!1);(0,em.useEffect)(()=>{if(e&&n){let e=n.getBoundingClientRect(),t=window.scrollY||window.pageYOffset,r=window.scrollX||window.pageXOffset;u({top:e.bottom+t+8,left:e.left+r})}},[e,n]),(0,em.useEffect)(()=>{let r=e=>{"Escape"===e.key&&(console.log(" [Modal Debug] Closing: Escape key"),t())};if(e)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e,t]);let x=async e=>{if(!e)return void p(null);try{g(!0);let t=await e_.api.affiliates.getStockByObraSocial(e);p(t.data)}catch(e){console.error("Error cargando stock:",e),p(null)}finally{g(!1)}};return e?(0,ep.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:e=>{e.target===e.currentTarget&&(console.log(" [Modal Debug] Closing: Backdrop click"),t())},children:(0,ep.jsxs)("div",{ref:h,onClick:e=>e.stopPropagation(),className:(0,eg.cn)("w-full max-w-md rounded-2xl shadow-xl overflow-hidden transform transition-all animate-in zoom-in-95 duration-200","dark"===s?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("px-6 py-4 border-b flex items-center justify-between","dark"===s?"border-white/10":"border-gray-100"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold","dark"===s?"text-white":"text-gray-800"),children:"Agregar Obra Social"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-500"),children:"Nueva configuracin de distribucin"})]}),(0,ep.jsx)("button",{onClick:t,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===s?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"p-6 space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Nombre de Obra Social"}),(0,ep.jsxs)("select",{value:i,onChange:e=>{var t;o(t=e.target.value),c(0),x(t)},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-purple-500/50","dark"===s?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccione una Obra Social --"}),r.map(e=>(0,ep.jsx)("option",{value:e,className:"dark"===s?"bg-[#1a1333]":"",children:e},e))]})]}),i&&(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-lg p-3 border","dark"===s?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ep.jsx)(op,{className:(0,eg.cn)("w-4 h-4","dark"===s?"text-blue-400":"text-blue-600")}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-medium","dark"===s?"text-blue-300":"text-blue-700"),children:"Disponibilidad actual"}),m&&(0,ep.jsx)(e2.Loader2,{className:"w-3 h-3 animate-spin text-blue-400"})]}),f?(0,ep.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded p-2","dark"===s?"bg-green-500/10":"bg-green-50"),children:[(0,ep.jsx)("div",{className:(0,eg.cn)("text-lg font-bold","dark"===s?"text-green-400":"text-green-600"),children:f.freshCount.toLocaleString()}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-xs","dark"===s?"text-green-300":"text-green-700"),children:"Frescos"})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded p-2","dark"===s?"bg-amber-500/10":"bg-amber-50"),children:[(0,ep.jsx)("div",{className:(0,eg.cn)("text-lg font-bold","dark"===s?"text-amber-400":"text-amber-600"),children:f.reusableCount.toLocaleString()}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-xs","dark"===s?"text-amber-300":"text-amber-700"),children:"Reutilizables"})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded p-2","dark"===s?"bg-purple-500/10":"bg-purple-50"),children:[(0,ep.jsx)("div",{className:(0,eg.cn)("text-lg font-bold","dark"===s?"text-purple-400":"text-purple-600"),children:f.totalCount.toLocaleString()}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-xs","dark"===s?"text-purple-300":"text-purple-700"),children:"Total"})]})]}):m?(0,ep.jsx)("div",{className:(0,eg.cn)("text-sm text-center py-2","dark"===s?"text-gray-400":"text-gray-500"),children:"Cargando disponibilidad..."}):(0,ep.jsx)("div",{className:(0,eg.cn)("text-sm text-center py-2","dark"===s?"text-gray-400":"text-gray-500"),children:"No se pudo cargar la disponibilidad"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Cantidad de Afiliados"}),(0,ep.jsx)("input",{type:"number",value:l,onChange:e=>c(Number(e.target.value)),min:"1",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-purple-500/50","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("px-6 py-4 border-t flex justify-end gap-3","dark"===s?"border-white/10 bg-white/5":"border-gray-100 bg-gray-50"),children:[(0,ep.jsx)("button",{onClick:t,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===s?"hover:bg-white/10 text-gray-300":"hover:bg-gray-200 text-gray-600"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:()=>{i&&!(l<=0)&&(a(i,l),o(""),c(0),p(null),t())},disabled:!i||l<=0,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-all shadow-lg shadow-purple-500/20 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none","dark"===s?"bg-purple-600 text-white hover:bg-purple-500":"bg-purple-600 text-white hover:bg-purple-700"),children:"Agregar Obra Social"})]})]})}):null}function og(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),[r,a]=(0,em.useState)(!0),[n,s]=(0,em.useState)(!1),[i,o]=(0,em.useState)("masivo"),[l,c]=(0,em.useState)(100),[d,u]=(0,em.useState)("09:00"),[h,f]=(0,em.useState)([]),[p,m]=(0,em.useState)([{id:"1",supervisorId:"",supervisorName:"",cantidad:50,obrasSociales:[]}]),[g,x]=(0,em.useState)(null),[b,y]=(0,em.useState)(!1),[v,w]=(0,em.useState)(null),[k,j]=(0,em.useState)([]),N=(0,em.useRef)({}),[S,E]=(0,em.useState)(50),[C,T]=(0,em.useState)(50),[A,_]=(0,em.useState)(!1),[O,P]=(0,em.useState)(!1),[D,R]=(0,em.useState)(null),M=t?.role?.toLowerCase()==="supervisor";t?.role?.toLowerCase(),(0,em.useEffect)(()=>{I()},[t]);let I=async()=>{try{if(a(!0),M){let e=await e_.api.affiliates.getSupervisorStats();R(e.data)}else{let[e,t,r]=await Promise.all([e_.api.users.getSupervisors(),e_.api.affiliates.getExportConfig(),e_.api.affiliates.getObrasSociales()]);if(f(e.data||[]),j(r.data?.obrasSociales||[]),t.data?.config){let e=t.data.config;if(x(e),o(e.sendType||"masivo"),u(e.scheduledTime||"09:00"),"masivo"===e.sendType)c(e.affiliatesPerFile||100),e.dataSourceMix&&(E(e.dataSourceMix.freshPercentage),T(e.dataSourceMix.reusablePercentage));else if("avanzado"===e.sendType&&e.supervisorConfigs){let t=e.supervisorConfigs.map(e=>({id:e._id||Date.now().toString(),supervisorId:e.supervisorId?._id||e.supervisorId,supervisorName:e.supervisorId?.nombre||"Sin nombre",cantidad:e.affiliatesPerFile||50,obrasSociales:e.obraSocialDistribution?.map(e=>({id:Date.now().toString()+Math.random(),nombre:e.obraSocial,cantidad:e.cantidad}))||[]}));m(t)}}}}catch(e){console.error("Error loading data:",e),eO.toast.error("Error al cargar datos")}finally{a(!1)}},L=e=>{e!==i&&(o(e),"masivo"===e?m([{id:"1",supervisorId:"",supervisorName:"",cantidad:50,obrasSociales:[]}]):c(100))},F=async e=>{try{P(!0),await e_.api.affiliates.cancelExports(e),eO.toast.success("today"===e?"Envos cancelados solo por hoy. Se reanudarn maana automticamente.":"Envos cancelados indefinidamente. Guarda una nueva configuracin para reanudar."),_(!1),I()}catch(e){console.error("Error cancelling exports:",e),eO.toast.error("Error al cancelar envos")}finally{P(!1)}},B=async()=>{try{if(s(!0),"masivo"===i&&S+C!==100)return void eO.toast.error("La suma de porcentajes debe ser 100%");let e={sendType:i,scheduledTime:d};if("masivo"===i)e.affiliatesPerFile=l,e.dataSourceMix={enabled:!0,freshPercentage:S,reusablePercentage:C};else{if(p.some(e=>!e.supervisorId))return void eO.toast.error("Seleccione todos los supervisores");e.supervisorConfigs=p.map(e=>{let t={supervisorId:e.supervisorId,affiliatesPerFile:e.cantidad};return e.obrasSociales.length>0&&(t.obraSocialDistribution=e.obrasSociales.map(e=>({obraSocial:e.nombre,cantidad:e.cantidad}))),t})}await e_.api.affiliates.saveExportConfig(e),eO.toast.success("Configuracin guardada correctamente"),I()}catch(e){console.error("Error saving config:",e),eO.toast.error(e.response?.data?.error||"Error al guardar configuracin")}finally{s(!1)}};return r?(0,ep.jsx)("div",{className:"animate-fade-in-up flex items-center justify-center p-12",children:(0,ep.jsx)("div",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Cargando configuracin..."})}):M?(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-xl font-semibold flex items-center gap-2 mb-6","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)(op,{className:(0,eg.cn)("w-6 h-6","dark"===e?"text-purple-400":"text-purple-600")}),"Disponibilidad de Datos"]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("p-6 rounded-2xl border transition-all duration-300","dark"===e?"bg-emerald-500/10 border-emerald-500/20 hover:bg-emerald-500/20":"bg-emerald-50 border-emerald-200 hover:bg-emerald-100"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-emerald-300":"text-emerald-700"),children:"Datos Frescos"}),(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg","dark"===e?"bg-emerald-500/20":"bg-emerald-200"),children:(0,ep.jsx)(ew.Users,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-emerald-400":"text-emerald-600")})})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-3xl font-bold","dark"===e?"text-white":"text-gray-900"),children:D?.freshCount||0}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-2","dark"===e?"text-gray-400":"text-gray-500"),children:"Disponibles para asignar"})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-6 rounded-2xl border transition-all duration-300","dark"===e?"bg-blue-500/10 border-blue-500/20 hover:bg-blue-500/20":"bg-blue-50 border-blue-200 hover:bg-blue-100"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-blue-300":"text-blue-700"),children:"Datos Reutilizables"}),(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg","dark"===e?"bg-blue-500/20":"bg-blue-200"),children:(0,ep.jsx)(oa.BarChart3,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-blue-400":"text-blue-600")})})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-3xl font-bold","dark"===e?"text-white":"text-gray-900"),children:D?.reusableCount||0}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-2","dark"===e?"text-gray-400":"text-gray-500"),children:"Disponibles para re-asignar"})]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-semibold mb-4","dark"===e?"text-white":"text-gray-800"),children:"Detalle por Obra Social"}),D?.byObraSocial&&D.byObraSocial.length>0?(0,ep.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:D.byObraSocial.map((t,r)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-3 rounded-xl border","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-100"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-medium truncate flex-1","dark"===e?"text-gray-300":"text-gray-700"),children:t.obraSocial||"Sin especificar"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-bold px-2 py-1 rounded-lg ml-2","dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"),children:t.count})]},r))}):(0,ep.jsx)("div",{className:(0,eg.cn)("text-center py-8 text-sm","dark"===e?"text-gray-500":"text-gray-400"),children:"No hay datos disponibles"})]})]}):(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2 mb-3","dark"===e?"text-white":"text-gray-700"),children:[(0,ep.jsx)(od.Settings,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Configuracin de Envos Programados"]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-lg p-3 text-sm","dark"===e?"bg-blue-500/10 border border-blue-500/20 text-blue-300":"bg-blue-50 border border-blue-200 text-blue-700"),children:["Los archivos ",(0,ep.jsx)("strong",{children:"XLSX (Excel)"})," se generarn automticamente cada da a la hora indicada. Cada"," ",(0,ep.jsx)("strong",{className:(0,eg.cn)("dark"===e?"text-purple-400":"text-purple-600"),children:"Supervisor"})," recibir su archivo exclusivo va mensajera interna."]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-3 block","dark"===e?"text-gray-300":"text-gray-600"),children:"Tipo de Envo"}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ep.jsxs)("button",{onClick:()=>L("masivo"),className:(0,eg.cn)("p-4 rounded-xl border-2 transition-all duration-200 text-center relative","masivo"===i?"dark"===e?"border-purple-500 bg-purple-500/10":"border-purple-400 bg-purple-50":"dark"===e?"border-white/10 hover:border-white/20 opacity-50":"border-gray-200 hover:border-purple-200 opacity-50"),children:["masivo"!==i&&(0,ep.jsx)("div",{className:"absolute top-2 right-2",children:(0,ep.jsx)(oh.Lock,{className:(0,eg.cn)("w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")})}),(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-1",children:[(0,ep.jsx)(e$.Package,{className:(0,eg.cn)("w-5 h-5","masivo"===i?"dark"===e?"text-orange-400":"text-orange-500":"dark"===e?"text-gray-400":"text-gray-500")}),(0,ep.jsx)("span",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Masivo"})]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Misma cantidad para todos"})]}),(0,ep.jsxs)("button",{onClick:()=>L("avanzado"),className:(0,eg.cn)("p-4 rounded-xl border-2 transition-all duration-200 text-center relative","avanzado"===i?"dark"===e?"border-purple-500 bg-purple-500/10":"border-purple-400 bg-purple-50":"dark"===e?"border-white/10 hover:border-white/20 opacity-50":"border-gray-200 hover:border-purple-200 opacity-50"),children:["avanzado"!==i&&(0,ep.jsx)("div",{className:"absolute top-2 right-2",children:(0,ep.jsx)(oh.Lock,{className:(0,eg.cn)("w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")})}),(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-1",children:[(0,ep.jsx)(od.Settings,{className:(0,eg.cn)("w-5 h-5","avanzado"===i?"dark"===e?"text-orange-400":"text-orange-500":"dark"===e?"text-gray-400":"text-gray-500")}),(0,ep.jsx)("span",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Avanzado"})]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Configurar por supervisor"})]})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:"masivo"===i?(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold flex items-center gap-2","dark"===e?"text-orange-400":"text-orange-500"),children:[(0,ep.jsx)(e$.Package,{className:"w-4 h-4"}),"Configuracin Masiva"]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm mb-2 block","dark"===e?"text-gray-400":"text-gray-600"),children:"Cantidad de afiliados por archivo"}),(0,ep.jsx)("input",{type:"number",value:l,onChange:e=>c(Number(e.target.value)),className:(0,eg.cn)("w-32 px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm mb-2 block font-medium","dark"===e?"text-gray-300":"text-gray-600"),children:"Proporcin de Datos (Fresh/Reusable)"}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Frescos (%)"}),(0,ep.jsx)("input",{type:"number",min:"0",max:"100",value:S,onChange:e=>{let t=Number(e.target.value);E(t),T(100-t)},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Reutilizables (%)"}),(0,ep.jsx)("input",{type:"number",min:"0",max:"100",value:C,onChange:e=>{let t=Number(e.target.value);T(t),E(100-t)},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]})]}),S+C!==100&&(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs mt-1 flex items-center gap-1","dark"===e?"text-amber-400":"text-amber-600"),children:[(0,ep.jsx)(eJ.AlertTriangle,{className:"w-3 h-3"}),"La suma debe ser 100%"]})]})]}):(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold flex items-center gap-2","dark"===e?"text-orange-400":"text-orange-500"),children:[(0,ep.jsx)(od.Settings,{className:"w-4 h-4"}),"Configuracin Avanzada"]}),(0,ep.jsxs)("button",{type:"button",onClick:()=>{m([...p,{id:Date.now().toString(),supervisorId:"",supervisorName:"",cantidad:50,obrasSociales:[]}])},className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors","dark"===e?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-green-100 text-green-600 hover:bg-green-200"),children:[(0,ep.jsx)(e0.Plus,{className:"w-4 h-4"}),"Agregar Supervisor"]})]}),(0,ep.jsx)("div",{className:"space-y-3",children:p.map((t,r)=>{let a=t.obrasSociales.reduce((e,t)=>e+t.cantidad,0),n=t.cantidad-a;return(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl border p-4","dark"===e?"border-white/10 bg-white/5":"border-gray-200 bg-gray-50"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("font-medium text-sm","dark"===e?"text-white":"text-gray-700"),children:["Supervisor #",r+1]}),p.length>1&&(0,ep.jsxs)("button",{type:"button",onClick:()=>{var e;return e=t.id,void(p.length>1&&m(p.filter(t=>t.id!==e)))},className:(0,eg.cn)("flex items-center gap-1 px-2 py-1 rounded text-xs","dark"===e?"text-red-400 hover:bg-red-500/20":"text-red-500 hover:bg-red-50"),children:[(0,ep.jsx)(eU.Trash2,{className:"w-3 h-3"}),"Eliminar"]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Seleccionar Supervisor"}),(0,ep.jsxs)("select",{value:t.supervisorId,onChange:e=>{var r,a;let n;return r=t.id,a=e.target.value,n=h.find(e=>e._id===a),void m(p.map(e=>e.id===r?{...e,supervisorId:a,supervisorName:n?.nombre||""}:e))},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700"),children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccione --"}),h.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Cantidad Total de Afiliados"}),(0,ep.jsx)("input",{type:"number",value:t.cantidad,onChange:e=>{var r,a;return r=t.id,a=Number(e.target.value),void m(p.map(e=>e.id===r?{...e,cantidad:a}:e))},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")}),n>0&&(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs mt-1 flex items-center gap-1","dark"===e?"text-amber-400":"text-amber-600"),children:[(0,ep.jsx)(eJ.AlertTriangle,{className:"w-3 h-3"}),"Faltan ",n," afiliados por distribuir"]})]})]}),(0,ep.jsxs)("div",{className:"mt-3",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Distribucin por Obra Social"}),(0,ep.jsxs)("button",{type:"button",ref:e=>{e&&(N.current[t.id]=e)},onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log(" [Modal Trigger] Button clicked for supervisor:",t.id),w(t.id),y(!0)},className:(0,eg.cn)("flex items-center gap-1 text-xs px-2 py-1 rounded","dark"===e?"text-green-400 hover:bg-green-500/20":"text-green-600 hover:bg-green-100"),children:[(0,ep.jsx)(e0.Plus,{className:"w-3 h-3"}),"Agregar Obra Social"]})]}),0===t.obrasSociales.length?(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-lg border-2 border-dashed p-4 text-center text-xs","dark"===e?"border-white/10 text-gray-500":"border-gray-200 text-gray-400"),children:"Sin obras sociales configuradas"}):(0,ep.jsx)("div",{className:"space-y-2",children:t.obrasSociales.map(r=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-2 rounded text-xs","dark"===e?"bg-white/5":"bg-white"),children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("dark"===e?"text-white":"text-gray-700"),children:[r.nombre,": ",(0,ep.jsx)("strong",{children:r.cantidad})," afiliados"]}),(0,ep.jsx)("button",{onClick:()=>{var e,a;return e=t.id,a=r.id,void m(p.map(t=>t.id===e?{...t,obrasSociales:t.obrasSociales.filter(e=>e.id!==a)}:t))},className:(0,eg.cn)("p-1 rounded hover:bg-red-500/20","dark"===e?"text-red-400":"text-red-500"),children:(0,ep.jsx)(eU.Trash2,{className:"w-3 h-3"})})]},r.id))})]})]},t.id)})})]})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-2 block","dark"===e?"text-gray-300":"text-gray-600"),children:"Hora de envo diario (HH:mm)"}),(0,ep.jsx)("input",{type:"time",value:d,onChange:e=>u(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]}),g&&(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-green-500/10 to-green-500/5 border-green-500/20":"bg-gradient-to-br from-green-50 to-green-50/50 border-green-200"),children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold flex items-center gap-2 mb-3","dark"===e?"text-green-400":"text-green-600"),children:[(0,ep.jsx)(ou.CheckCircle,{className:"w-5 h-5"}),"Configuracin Actual"]}),(0,ep.jsxs)("ul",{className:(0,eg.cn)("space-y-1 text-sm","dark"===e?"text-green-300":"text-green-700"),children:[(0,ep.jsxs)("li",{children:[" Tipo: ",(0,ep.jsx)("strong",{children:"masivo"===g.sendType?"Masivo":"Avanzado"})]}),(0,ep.jsxs)("li",{children:[" ","masivo"===g.sendType?"Configuracin masiva para todos los supervisores":`${g.supervisorConfigs?.length||0} supervisor(es) configurado(s)`]}),(0,ep.jsxs)("li",{children:[" Envo diario a las ",g.scheduledTime]}),g.lastExecutedAt&&(0,ep.jsxs)("li",{children:[" ltima ejecucin: ",new Date(g.lastExecutedAt).toLocaleString("es-AR")]})]})]}),(0,ep.jsxs)("button",{onClick:B,disabled:n,className:(0,eg.cn)("flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed","dark"===e?"bg-gradient-to-r from-blue-600 to-blue-500 text-white hover:from-blue-500 hover:to-blue-400":"bg-gradient-to-r from-blue-500 to-blue-400 text-white hover:from-blue-400 hover:to-blue-300"),children:[(0,ep.jsx)(ou.CheckCircle,{className:"w-5 h-5"}),n?"Guardando...":"Guardar Configuracin"]}),g&&(0,ep.jsxs)("button",{onClick:()=>_(!0),disabled:O,className:(0,eg.cn)("flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-200 hover:scale-105 disabled:opacity-50","dark"===e?"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30":"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200"),children:[(0,ep.jsx)(of.XCircle,{className:"w-5 h-5"}),"Cancelar Envos"]}),A&&(0,ep.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>_(!1),children:(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl p-6 max-w-md w-full mx-4","dark"===e?"bg-gray-800 border border-white/10":"bg-white"),onClick:e=>e.stopPropagation(),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold mb-4","dark"===e?"text-white":"text-gray-900"),children:"Cancelar Envos Programados"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mb-6","dark"===e?"text-gray-400":"text-gray-600"),children:"Selecciona cmo deseas cancelar los envos:"}),(0,ep.jsxs)("div",{className:"space-y-3",children:[(0,ep.jsxs)("button",{onClick:()=>F("today"),disabled:O,className:(0,eg.cn)("w-full p-4 rounded-xl border-2 transition-all text-left","dark"===e?"border-white/10 hover:border-yellow-500/50 hover:bg-yellow-500/10":"border-gray-200 hover:border-yellow-400 hover:bg-yellow-50"),children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium mb-1","dark"===e?"text-white":"text-gray-900"),children:"Solo por hoy"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:"Se reanudar maana automticamente"})]}),(0,ep.jsxs)("button",{onClick:()=>F("indefinite"),disabled:O,className:(0,eg.cn)("w-full p-4 rounded-xl border-2 transition-all text-left","dark"===e?"border-red-500/30 hover:border-red-500/50 hover:bg-red-500/10":"border-red-200 hover:border-red-400 hover:bg-red-50"),children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium mb-1","dark"===e?"text-red-400":"text-red-600"),children:"Indefinidamente"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:"Hasta que guardes una nueva configuracin"})]})]}),(0,ep.jsx)("button",{onClick:()=>_(!1),disabled:O,className:(0,eg.cn)("mt-4 w-full py-2 rounded-lg font-medium","dark"===e?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-800"),children:"Cerrar"})]})}),b&&v&&(0,ep.jsx)(om,{isOpen:b,onClose:()=>y(!1),onAdd:(e,t)=>{m(p.map(r=>r.id===v?{...r,obrasSociales:[...r.obrasSociales,{id:Date.now().toString(),nombre:e,cantidad:t}]}:r)),y(!1),eO.toast.success("Obra social agregada")},availableObrasSociales:k,triggerElement:N.current[v]})]})}var ox=e.i(53609);function ob(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),[r,a]=(0,em.useState)([]),[n,s]=(0,em.useState)(!0),[i,o]=(0,em.useState)(""),[l,c]=(0,em.useState)(""),[d,u]=(0,em.useState)(1),[h,f]=(0,em.useState)(1),[p,m]=(0,em.useState)(!1),g=t?.nombre?.toLowerCase().includes("daniel")&&t?.nombre?.toLowerCase().includes("fandio"),x=async()=>{try{m(!0);let e=await e_.api.affiliates.exportAll(),t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`base_afiliados_completa_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(r),eO.toast.success("Base de afiliados descargada correctamente")}catch(e){console.error("Error downloading all affiliates:",e),eO.toast.error(e.response?.data?.error||"Error al descargar la base de afiliados")}finally{m(!1)}},b=async()=>{try{s(!0);let e=await e_.api.affiliates.list({page:d,limit:50,search:i,obraSocial:l});a(e.data.affiliates||[]),f(e.data.totalPages||1)}catch(e){console.error("Error loading affiliates:",e),eO.toast.error("Error al cargar afiliados")}finally{s(!1)}};(0,em.useEffect)(()=>{b()},[d,i,l]);let y=async e=>{if(confirm("Est seguro de eliminar este afiliado?"))try{await e_.api.affiliates.delete(e),eO.toast.success("Afiliado eliminado"),b()}catch(e){eO.toast.error("Error al eliminar afiliado")}};return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-end gap-4",children:[(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2 mb-4","dark"===e?"text-white":"text-gray-700"),children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Buscar y Filtrar Afiliados"]}),(0,ep.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Bsqueda por Nombre, CUIL o Telfono"}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar...",value:i,onChange:e=>o(e.target.value),className:(0,eg.cn)("w-full pl-9 pr-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-700 placeholder:text-gray-400")})]})]})})]}),(0,ep.jsxs)("button",{onClick:b,disabled:n,className:(0,eg.cn)("flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 shrink-0 disabled:opacity-50","dark"===e?"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white":"bg-gradient-to-r from-cyan-500 to-cyan-400 text-white"),children:[(0,ep.jsx)(eE.RefreshCw,{className:(0,eg.cn)("w-4 h-4",n&&"animate-spin")}),"Recargar Datos"]})]})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl p-4 text-sm","dark"===e?"bg-blue-500/10 text-blue-300":"bg-blue-50 text-blue-700"),children:["Mostrando ",r.length," afiliados"]}),g&&(0,ep.jsx)("div",{className:"flex justify-end",children:(0,ep.jsxs)("button",{onClick:x,disabled:p,className:(0,eg.cn)("flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 disabled:opacity-50","dark"===e?"bg-gradient-to-r from-green-600 to-green-500 text-white":"bg-gradient-to-r from-green-500 to-green-400 text-white"),children:[(0,ep.jsx)(i0.Download,{className:(0,eg.cn)("w-4 h-4",p&&"animate-pulse")}),p?"Descargando...":"Descargar Base Completa"]})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border backdrop-blur-sm overflow-hidden","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-sm",children:[(0,ep.jsx)("thead",{children:(0,ep.jsx)("tr",{className:(0,eg.cn)("dark"===e?"bg-white/5 border-b border-white/10":"bg-purple-50/50 border-b border-purple-100"),children:["Nombre","CUIL","Obra Social","Telfono","Localidad","Cargado","Acciones"].map(t=>(0,ep.jsx)("th",{className:(0,eg.cn)("px-4 py-3 text-left font-semibold whitespace-nowrap","dark"===e?"text-gray-300":"text-gray-600"),children:t},t))})}),(0,ep.jsx)("tbody",{children:n?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:7,className:"px-4 py-8 text-center",children:(0,ep.jsx)("div",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Cargando..."})})}):0===r.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:7,className:"px-4 py-8 text-center",children:(0,ep.jsx)("div",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"No se encontraron afiliados"})})}):r.map(t=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-b transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-purple-50 hover:bg-purple-50/50"),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 font-medium","dark"===e?"text-white":"text-gray-700"),children:t.nombre}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3","dark"===e?"text-gray-300":"text-gray-600"),children:t.cuil}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 max-w-xs truncate","dark"===e?"text-gray-400":"text-gray-500"),children:t.obraSocial}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3","dark"===e?"text-gray-300":"text-gray-600"),children:t.telefono1}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3","dark"===e?"text-gray-300":"text-gray-600"),children:t.localidad}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3","dark"===e?"text-gray-400":"text-gray-500"),children:new Date(t.uploadDate).toLocaleDateString("es-AR")}),(0,ep.jsx)("td",{className:"px-4 py-3",children:(0,ep.jsx)("button",{onClick:()=>y(t._id),className:(0,eg.cn)("p-1.5 rounded transition-colors","dark"===e?"text-red-400 hover:bg-red-500/20":"text-red-600 hover:bg-red-100"),children:(0,ep.jsx)(eU.Trash2,{className:"w-4 h-4"})})})]},t._id))})]})})})]})}function oy(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)(!1),[a,n]=(0,em.useState)(null),[s,i]=(0,em.useState)(!1),[o,l]=(0,em.useState)(null),c=(0,em.useRef)(null),d=async e=>{if(e.stopPropagation(),a)try{i(!0),l(null);let e=await e_.api.affiliates.upload(a);console.log(" [Upload Debug] Response data:",e.data);let t=e.data.imported||e.data.processed||0,r=e.data.duplicates||0,s=e.data.duplicatesReport;console.log(" [Upload Debug] Extracted report URL:",s);let o={success:!0,message:`Archivo procesado: ${t} afiliados cargados${r>0?`, ${r} rechazados`:""}.`,stats:{...e.data,duplicatesReportUrl:s}};console.log(" [Upload Debug] Setting result state:",o),l(o),eO.toast.success(`${t} afiliados cargados exitosamente`),n(null)}catch(t){console.error("Error procesando archivo:",t);let e=t.response?.data?.message||t.message||"Error al procesar el archivo";l({success:!1,message:e}),eO.toast.error(e)}finally{i(!1)}};return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2 mb-4","dark"===e?"text-white":"text-gray-700"),children:[(0,ep.jsx)(eI.Upload,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Cargar Archivo de Afiliados"]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl p-4 space-y-2","dark"===e?"bg-blue-500/10 border border-blue-500/20":"bg-blue-50 border border-blue-200"),children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold text-sm flex items-center gap-2","dark"===e?"text-blue-300":"text-blue-700"),children:[(0,ep.jsx)(eZ,{className:"w-4 h-4"}),"Requisitos del archivo:"]}),(0,ep.jsxs)("ul",{className:(0,eg.cn)("text-sm space-y-1 ml-6","dark"===e?"text-blue-200":"text-blue-600"),children:[(0,ep.jsxs)("li",{children:[(0,ep.jsx)("strong",{children:"Formato:"})," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-cyan-400":"text-cyan-600"),children:".xlsx"})," o"," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-cyan-400":"text-cyan-600"),children:".xls"})]}),(0,ep.jsxs)("li",{children:[(0,ep.jsx)("strong",{children:"Campos obligatorios:"})," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-purple-400":"text-purple-600"),children:"Nombre, CUIL, Obra Social, Localidad, Telfono_1"})]}),(0,ep.jsxs)("li",{children:[(0,ep.jsx)("strong",{children:"Campos opcionales:"})," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-gray-400":"text-gray-600"),children:"Telfono_2, Telfono_3, Edad, Cdigo de obra social"})]}),(0,ep.jsxs)("li",{children:[(0,ep.jsx)("strong",{children:"Tolerancia de headers:"})," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-gray-400":"text-gray-600"),children:'Acepta variantes (ej: "nombre", "Name", "NOMBRE")'})]})]})]})]}),(0,ep.jsxs)("div",{onDragOver:e=>{e.preventDefault(),r(!0)},onDragLeave:()=>{r(!1)},onDrop:e=>{e.preventDefault(),r(!1);let t=e.dataTransfer.files[0];t&&(t.name.endsWith(".xlsx")||t.name.endsWith(".xls"))&&n(t)},onClick:()=>c.current?.click(),className:(0,eg.cn)("rounded-2xl border-2 border-dashed p-8 lg:p-12 text-center cursor-pointer transition-all duration-300",t?"dark"===e?"border-purple-500 bg-purple-500/10":"border-purple-400 bg-purple-50":"dark"===e?"border-white/20 bg-white/5 hover:border-purple-500/50 hover:bg-purple-500/5":"border-gray-300 bg-white hover:border-purple-300 hover:bg-purple-50/50"),children:[(0,ep.jsx)("input",{ref:c,type:"file",accept:".xlsx,.xls",onChange:e=>{let t=e.target.files?.[0];t&&(n(t),l(null))},className:"hidden"}),a?(0,ep.jsxs)("div",{className:"space-y-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-16 h-16 mx-auto rounded-xl flex items-center justify-center","dark"===e?"bg-green-500/20":"bg-green-100"),children:(0,ep.jsx)(ou.CheckCircle,{className:(0,eg.cn)("w-8 h-8","dark"===e?"text-green-400":"text-green-500")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:a.name}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:[(a.size/1024).toFixed(2)," KB"]})]}),(0,ep.jsx)("button",{onClick:d,disabled:s,className:(0,eg.cn)("px-6 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed","dark"===e?"bg-gradient-to-r from-green-600 to-green-500 text-white":"bg-gradient-to-r from-green-500 to-green-400 text-white"),children:s?"Procesando...":"Procesar Archivo"})]}):(0,ep.jsxs)("div",{className:"space-y-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-16 h-16 mx-auto rounded-xl flex items-center justify-center","dark"===e?"bg-white/10":"bg-gray-100"),children:(0,ep.jsx)(eC,{className:(0,eg.cn)("w-8 h-8","dark"===e?"text-purple-400":"text-purple-500")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Click aqu para seleccionar archivo"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"O arrastra y suelta tu archivo .xlsx"})]})]})]}),o&&(0,ep.jsx)("div",{className:"mt-4",children:(0,ep.jsx)("div",{className:(0,eg.cn)("p-4 rounded-xl text-sm border shadow-sm transition-all duration-300 animate-in fade-in slide-in-from-top-2",o.success?"dark"===e?"bg-green-500/10 text-green-300 border-green-500/20":"bg-green-50 text-green-700 border-green-200":"dark"===e?"bg-red-500/10 text-red-300 border-red-500/20":"bg-red-50 text-red-700 border-red-200"),children:(0,ep.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-full shrink-0",o.success?"dark"===e?"bg-green-500/20":"bg-green-100":"dark"===e?"bg-red-500/20":"bg-red-100"),children:o.success?(0,ep.jsx)(ou.CheckCircle,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-green-400":"text-green-600")}):(0,ep.jsx)(eZ,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-red-400":"text-red-600")})}),(0,ep.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,ep.jsx)("p",{className:"font-medium pt-1",children:o.message}),o.stats?.duplicatesReportUrl&&(0,ep.jsxs)("button",{onClick:async()=>{try{let e=await e_.api.client.get(o.stats.duplicatesReportUrl,{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t;let a=o.stats.duplicatesReportUrl.split("/").pop()||"reporte_rechazos.xlsx";r.setAttribute("download",a),document.body.appendChild(r),r.click(),r.parentNode?.removeChild(r),window.URL.revokeObjectURL(t)}catch(e){console.error("Error downloading report:",e),eO.toast.error("Error al descargar el reporte")}},className:(0,eg.cn)("inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 cursor-pointer","dark"===e?"bg-yellow-500/10 text-yellow-300 border border-yellow-500/20 hover:bg-yellow-500/20":"bg-yellow-50 text-yellow-700 border border-yellow-200 hover:bg-yellow-100"),children:[(0,ep.jsx)(eC,{className:"w-4 h-4"}),"Descargar Reporte de Rechazos"]})]})]})})})]})}var ov=e.i(56667),ow=e.i(92062),ok=e.i(34684);let oj=(0,ek.default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var oN=e.i(66487),oS={};oS.version="0.18.5";var oE=1200,oC=1252,oT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],oA={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},o_=function(e){-1!=oT.indexOf(e)&&(oC=oA[0]=e)},oO=function(e){oE=e,o_(e)};function oP(){oO(1200),o_(1252)}function oD(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function oR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var oM=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);if(255==t&&254==r){for(var a=e.slice(2),n=[],s=0;s<a.length>>1;++s)n[s]=String.fromCharCode(a.charCodeAt(2*s)+(a.charCodeAt(2*s+1)<<8));return n.join("")}return 254==t&&255==r?oR(e.slice(2)):65279==t?e.slice(1):e},oI=function(e){return String.fromCharCode(e)},oL=function(e){return String.fromCharCode(e)},oF="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function oB(e){for(var t="",r=0,a=0,n=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(a=e.charCodeAt(c++))>>4,o=(15&a)<<2|(n=e.charCodeAt(c++))>>6,l=63&n,isNaN(a)?o=l=64:isNaN(n)&&(l=64),t+=oF.charAt(s)+oF.charAt(i)+oF.charAt(o)+oF.charAt(l);return t}function oU(e){var t="",r=0,a=0,n=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)t+=String.fromCharCode((n=oF.indexOf(e.charAt(l++)))<<2|(s=oF.indexOf(e.charAt(l++)))>>4),r=(15&s)<<4|(i=oF.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(r)),a=(3&i)<<6|(o=oF.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var oz=void 0!==oN.Buffer&&void 0!==tU.default&&void 0!==tU.default.versions&&!!tU.default.versions.node,oV=function(){if(void 0!==oN.Buffer){var e=!oN.Buffer.from;if(!e)try{oN.Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new oN.Buffer(e,t):new oN.Buffer(e)}:oN.Buffer.from.bind(oN.Buffer)}return function(){}}();function o$(e){return oz?oN.Buffer.alloc?oN.Buffer.alloc(e):new oN.Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):Array(e)}function oH(e){return oz?oN.Buffer.allocUnsafe?oN.Buffer.allocUnsafe(e):new oN.Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):Array(e)}var oW=function(e){return oz?oV(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function oq(e){if("undefined"==typeof ArrayBuffer)return oW(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function oG(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function oK(e){if("undefined"==typeof ArrayBuffer)throw Error("Unsupported");if(e instanceof ArrayBuffer)return oK(new Uint8Array(e));for(var t=Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var oX=oz?function(e){return oN.Buffer.concat(e.map(function(e){return oN.Buffer.isBuffer(e)?e:oV(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else if("string"==typeof e[t])throw"wtf";else a.set(new Uint8Array(e[t]),r);return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))},oY=/\u0000/g,oQ=/[\u0001-\u0006]/g;function oJ(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function oZ(e,t){var r=""+e;return r.length>=t?r:lG("0",t-r.length)+r}function o0(e,t){var r=""+e;return r.length>=t?r:lG(" ",t-r.length)+r}function o1(e,t){var r=""+e;return r.length>=t?r:r+lG(" ",t-r.length)}function o2(e,t){var r,a;return e>0x100000000||e<-0x100000000?(r=""+Math.round(e)).length>=t?r:lG("0",t-r.length)+r:(a=""+Math.round(e)).length>=t?a:lG("0",t-a.length)+a}function o5(e,t){return t=t||0,e.length>=7+t&&(32|e.charCodeAt(t))==103&&(32|e.charCodeAt(t+1))==101&&(32|e.charCodeAt(t+2))==110&&(32|e.charCodeAt(t+3))==101&&(32|e.charCodeAt(t+4))==114&&(32|e.charCodeAt(t+5))==97&&(32|e.charCodeAt(t+6))==108}var o4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],o3=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],o6={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},o8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function o9(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,i=1,o=0,l=1,c=0,d=0,u=Math.floor(n);c<t&&(o=(u=Math.floor(n))*i+s,d=u*c+l,!(n-u<5e-8));)n=1/(n-u),s=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=s):(d=c,o=i)),!r)return[0,a*o,d];var h=Math.floor(a*o/d);return[h,a*o-h*d,d]}function le(e,t,r){if(e>2958465||e<0)return null;var a=0|e,n=Math.floor(86400*(e-a)),s=0,i=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(1e-6>Math.abs(o.u)&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,86400==++n&&(o.T=n=0,++a,++o.D)),60===a)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===a)i=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var l,c,d,u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),i=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),a<60&&(s=(s+6)%7),r&&(l=u,c=i,c[0]-=581,d=l.getDay(),l<60&&(d=(d+6)%7),s=d)}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,o.M=(n=Math.floor(n/60))%60,o.H=n=Math.floor(n/60),o.q=s,o}var lt=new Date(1899,11,31,0,0,0),lr=lt.getTime(),la=new Date(1900,2,1,0,0,0);function ln(e,t){var r=e.getTime();return t?r-=1262304e5:e>=la&&(r+=864e5),(r-(lr+(e.getTimezoneOffset()-lt.getTimezoneOffset())*6e4))/864e5}function ls(e){return -1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function li(e){var t,r,a,n,s,i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return i>=-4&&i<=-1?s=e.toPrecision(10+i):9>=Math.abs(i)?(t=e<0?12:11,s=(r=ls(e.toFixed(12))).length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)):s=10===i?e.toFixed(10).substr(0,12):(a=ls(e.toFixed(11))).length>(e<0?12:11)||"0"===a||"-0"===a?e.toPrecision(6):a,ls(-1==(n=s.toUpperCase()).indexOf("E")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function lo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):li(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return lk(14,ln(e,t&&t.date1904),t)}throw Error("unsupported value in General format: "+e)}function ll(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var lc=/%/g,ld=/# (\?+)( ?)\/( ?)(\d+)/,lu=/^#*0*\.([0#]+)/,lh=/\).*[0#]/,lf=/\(###\) ###\\?-####/;function lp(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function lm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lg(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function lx(e,t,r){return(0|r)===r?function e(t,r,a){if(40===t.charCodeAt(0)&&!r.match(lh)){var n,s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?e("n",s,a):"("+e("n",s,-a)+")"}if(44===r.charCodeAt(r.length-1)){for(var i=r,o=i.length-1;44===i.charCodeAt(o-1);)--o;return lx(t,i.substr(0,o),a/Math.pow(10,3*(i.length-o)))}if(-1!==r.indexOf("%"))return c=(l=r).replace(lc,""),d=l.length-c.length,lx(t,c,a*Math.pow(10,2*d))+lG("%",d);if(-1!==r.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%s;if(i<0&&(i+=s),!(a=(r/Math.pow(10,i)).toPrecision(n+1+(s+i)%s)).match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+i)%s)+"."+a.substr(i)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(r,a);if(36===r.charCodeAt(0))return"$"+e(t,r.substr(" "==r.charAt(1)?2:1),a);var l,c,d,u,h,f,p,m=Math.abs(a),g=a<0?"-":"";if(r.match(/^00+$/))return g+oZ(m,r.length);if(r.match(/^[#?]+$/))return u=""+a,0===a&&(u=""),u.length>r.length?u:lp(r.substr(0,r.length-u.length))+u;if(h=r.match(ld))return g+(0===m?"":""+m)+lG(" ",(n=h)[1].length+2+n[4].length);if(r.match(/^#+0+$/))return g+oZ(m,r.length-r.indexOf("0"));if(h=r.match(lu))return u=(u=(""+a).replace(/^([^\.]+)$/,"$1."+lp(h[1])).replace(/\.$/,"."+lp(h[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+lG("0",lp(h[1]).length-t.length)}),-1!==r.indexOf("0.")?u:u.replace(/^0\./,".");if(h=(r=r.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return g+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,h[1].length?"0.":".");if(h=r.match(/^#{1,3},##0(\.?)$/))return g+ll(""+m);if(h=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+e(t,r,-a):ll(""+a)+"."+lG("0",h[1].length);if(h=r.match(/^#,#*,#0/))return e(t,r.replace(/^#,#*,/,""),a);if(h=r.match(/^([0#]+)(\\?-([0#]+))+$/))return u=oJ(e(t,r.replace(/[\\-]/g,""),a)),f=0,oJ(oJ(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return f<u.length?u.charAt(f++):"0"===e?"0":""}));if(r.match(lf))return"("+(u=e(t,"##########",a)).substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var x="";if(h=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return p=o9(m,Math.pow(10,f=Math.min(h[4].length,7))-1,!1),u=""+g," "==(x=lx("n",h[1],p[1])).charAt(x.length-1)&&(x=x.substr(0,x.length-1)+"0"),u+=x+h[2]+"/"+h[3],(x=o1(p[2],f)).length<h[4].length&&(x=lp(h[4].substr(h[4].length-x.length))+x),u+=x;if(h=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g+((p=o9(m,Math.pow(10,f=Math.min(Math.max(h[1].length,h[4].length),7))-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?o0(p[1],f)+h[2]+"/"+h[3]+o1(p[2],f):lG(" ",2*f+1+h[2].length+h[3].length));if(h=r.match(/^[#0?]+$/))return(u=""+a,r.length<=u.length)?u:lp(r.substr(0,r.length-u.length))+u;if(h=r.match(/^([#0]+)\.([#0]+)$/)){f=(u=""+a.toFixed(Math.min(h[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");var b=r.indexOf(".")-f,y=r.length-u.length-b;return lp(r.substr(0,b)+u+r.substr(r.length-y))}if(h=r.match(/^00,000\.([#0]*0)$/))return a<0?"-"+e(t,r,-a):ll(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?oZ(0,3-e.length):"")+e})+"."+oZ(0,h[1].length);switch(r){case"###,###":case"##,###":case"#,###":var v=ll(""+m);return"0"!==v?g+v:"";default:if(r.match(/\.[0#?]*$/))return e(t,r.slice(0,r.lastIndexOf(".")),a)+lp(r.slice(r.lastIndexOf(".")))}throw Error("unsupported format |"+r+"|")}(e,t,r):function e(t,r,a){if(40===t.charCodeAt(0)&&!r.match(lh)){var n,s,i,o,l,c,d=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?e("n",d,a):"("+e("n",d,-a)+")"}if(44===r.charCodeAt(r.length-1)){for(var u=r,h=u.length-1;44===u.charCodeAt(h-1);)--h;return lx(t,u.substr(0,h),a/Math.pow(10,3*(u.length-h)))}if(-1!==r.indexOf("%"))return p=(f=r).replace(lc,""),m=f.length-p.length,lx(t,p,a*Math.pow(10,2*m))+lG("%",m);if(-1!==r.indexOf("E"))return function e(t,r){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var s=t.indexOf(".");-1===s&&(s=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%s;if(i<0&&(i+=s),-1===(a=(r/Math.pow(10,i)).toPrecision(n+1+(s+i)%s)).indexOf("e")){var o=Math.floor(Math.log(r)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,s)+"."+a.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(s+i)%s)+"."+a.substr(i)+"E"})}else a=r.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(r,a);if(36===r.charCodeAt(0))return"$"+e(t,r.substr(" "==r.charAt(1)?2:1),a);var f,p,m,g,x,b,y,v=Math.abs(a),w=a<0?"-":"";if(r.match(/^00+$/))return w+o2(v,r.length);if(r.match(/^[#?]+$/))return"0"===(g=o2(a,0))&&(g=""),g.length>r.length?g:lp(r.substr(0,r.length-g.length))+g;if(x=r.match(ld))return o=Math.floor((i=Math.round(v*(s=parseInt((n=x)[4],10))))/s),l=i-o*s,w+(0===o?"":""+o)+" "+(0===l?lG(" ",n[1].length+1+n[4].length):o0(l,n[1].length)+n[2]+"/"+n[3]+oZ(s,n[4].length));if(r.match(/^#+0+$/))return w+o2(v,r.length-r.indexOf("0"));if(x=r.match(lu))return g=lm(a,x[1].length).replace(/^([^\.]+)$/,"$1."+lp(x[1])).replace(/\.$/,"."+lp(x[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+lG("0",lp(x[1]).length-t.length)}),-1!==r.indexOf("0.")?g:g.replace(/^0\./,".");if(x=(r=r.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return w+lm(v,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=r.match(/^#{1,3},##0(\.?)$/))return w+ll(o2(v,0));if(x=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+e(t,r,-a):ll(""+(Math.floor(a)+ +((c=x[1].length)<(""+Math.round((a-Math.floor(a))*Math.pow(10,c))).length)))+"."+oZ(lg(a,x[1].length),x[1].length);if(x=r.match(/^#,#*,#0/))return e(t,r.replace(/^#,#*,/,""),a);if(x=r.match(/^([0#]+)(\\?-([0#]+))+$/))return g=oJ(e(t,r.replace(/[\\-]/g,""),a)),b=0,oJ(oJ(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return b<g.length?g.charAt(b++):"0"===e?"0":""}));if(r.match(lf))return"("+(g=e(t,"##########",a)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var k="";if(x=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=o9(v,Math.pow(10,b=Math.min(x[4].length,7))-1,!1),g=""+w," "==(k=lx("n",x[1],y[1])).charAt(k.length-1)&&(k=k.substr(0,k.length-1)+"0"),g+=k+x[2]+"/"+x[3],(k=o1(y[2],b)).length<x[4].length&&(k=lp(x[4].substr(x[4].length-k.length))+k),g+=k;if(x=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return w+((y=o9(v,Math.pow(10,b=Math.min(Math.max(x[1].length,x[4].length),7))-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?o0(y[1],b)+x[2]+"/"+x[3]+o1(y[2],b):lG(" ",2*b+1+x[2].length+x[3].length));if(x=r.match(/^[#0?]+$/))return(g=o2(a,0),r.length<=g.length)?g:lp(r.substr(0,r.length-g.length))+g;if(x=r.match(/^([#0?]+)\.([#0]+)$/)){b=(g=""+a.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");var j=r.indexOf(".")-b,N=r.length-g.length-j;return lp(r.substr(0,j)+g+r.substr(r.length-N))}if(x=r.match(/^00,000\.([#0]*0)$/))return b=lg(a,x[1].length),a<0?"-"+e(t,r,-a):ll(a<0x7fffffff&&a>-0x80000000?""+(a>=0?0|a:a-1|0):""+Math.floor(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?oZ(0,3-e.length):"")+e})+"."+oZ(b,x[1].length);switch(r){case"###,##0.00":return e(t,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var S=ll(o2(v,0));return"0"!==S?w+S:"";case"###,###.00":return e(t,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return e(t,"#,##0.00",a).replace(/^0\./,".")}throw Error("unsupported format |"+r+"|")}(e,t,r)}var lb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ly(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":o5(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if("A/P"===e.substr(t,3).toUpperCase()||"AM/PM"===e.substr(t,5).toUpperCase()||"/"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(lb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(" "==e.charAt(t)||"*"==e.charAt(t))&&++t;break;case"(":case")":case" ":default:++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);}return!1}var lv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lw(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function lk(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:o6)[e])&&(a=r.table&&r.table[o8[e]]||o6[o8[e]]),null==a&&(a=o7[e]||"General")}if(o5(a,0))return lo(t,r);t instanceof Date&&(t=ln(t,r.date1904));var n=function(e,t){var r=function(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),!0===r)throw Error("Format |"+e+"| unterminated string ");return t}(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(lv),o=r[1].match(lv);return lw(t,i)?[a,r[0]]:lw(t,o)?[a,r[1]]:[a,r[null!=i&&null!=o?2:1]]}return[a,s]}(a,t);if(o5(n[1]))return lo(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,a){for(var n,s,i,o=[],l="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!o5(e,c))throw Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==n&&null==(n=le(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||null==n&&null==(n=le(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"":var m={t:d,v:d};if(null==n&&(n=le(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=n&&(m.v=n.H>=12?"P":"A"),m.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=n&&(m.v=n.H>=12?"PM":"AM"),m.t="T",c+=5,h="h"):"/"===e.substr(c,5).toUpperCase()?(null!=n&&(m.v=n.H>=12?"":""),m.t="T",c+=5,h="h"):(m.t="t",++c),null==n&&"T"===m.t)return"";o[o.length]=m,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(lb)){if(null==n&&null==(n=le(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ly(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=n){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c,(" "==e.charAt(c)||"*"==e.charAt(c))&&++c;break;case"(":case")":o[o.length]={t:1===a?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d))throw Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,x=0,b=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,u="h",x<1&&(x=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&o[c].v.match(/[Hh]/)&&(x=1),x<2&&o[c].v.match(/[Mm]/)&&(x=2),x<3&&o[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var y,v="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=function(e,t,r,a){var n,s="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:n=l%100,c=2;break;default:n=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:n=r.m,c=t.length;break;case 3:return o3[r.m-1][1];case 5:return o3[r.m-1][0];default:return o3[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=r.d,c=t.length;break;case 3:return o4[r.q][0];default:return o4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;if(0===r.u&&("s"==t||"ss"==t))return oZ(r.S,t.length);if((i=Math.round((o=a>=2?3===a?1e3:100:1===a?10:1)*(r.S+r.u)))>=60*o&&(i=0),"s"===t)return 0===i?"0":""+i/o;if(s=oZ(i,2+a),"ss"===t)return s.substr(0,2);return"."+s.substr(2,t.length-1);case 90:switch(t){case"[h]":case"[hh]":n=24*r.D+r.H;break;case"[m]":case"[mm]":n=(24*r.D+r.H)*60+r.M;break;case"[s]":case"[ss]":n=((24*r.D+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:n=l,c=1}return c>0?oZ(n,c):""}(o[c].t.charCodeAt(0),o[c].v,n,b),o[c].t="t";break;case"n":case"?":for(y=c+1;null!=o[y]&&("?"===(d=o[y].t)||"D"===d||(" "===d||"t"===d)&&null!=o[y+1]&&("?"===o[y+1].t||"t"===o[y+1].t&&"/"===o[y+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[y].v||" "===o[y].v&&null!=o[y+1]&&"?"==o[y+1].t));)o[c].v+=o[y].v,o[y]={v:"",t:";"},++y;v+=o[c].v,c=y-1;break;case"G":o[c].t="t",o[c].v=lo(t,r)}var w,k,j="";if(v.length>0){40==v.charCodeAt(0)?(w=t<0&&45===v.charCodeAt(0)?-t:t,k=lx("n",v,w)):(k=lx("n",v,w=t<0&&a>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(k=k.substr(1),o[0].v="-"+o[0].v)),y=k.length-1;var N=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){N=c;break}var S=o.length;if(N===o.length&&-1===k.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(y>=o[c].v.length-1?(y-=o[c].v.length,o[c].v=k.substr(y+1,o[c].v.length)):y<0?o[c].v="":(o[c].v=k.substr(0,y+1),y=-1),o[c].t="t",S=c);y>=0&&S<o.length&&(o[S].v=k.substr(0,y+1)+o[S].v)}else if(N!==o.length&&-1===k.indexOf("E")){for(y=k.indexOf(".")-1,c=N;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===N?o[c].v.indexOf(".")-1:o[c].v.length-1,j=o[c].v.substr(s+1);s>=0;--s)y>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(j=k.charAt(y--)+j);o[c].v=j,o[c].t="t",S=c}for(y>=0&&S<o.length&&(o[S].v=k.substr(0,y+1)+o[S].v),y=k.indexOf(".")+1,c=N;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===N)){for(s=o[c].v.indexOf(".")>-1&&c===N?o[c].v.indexOf(".")+1:0,j=o[c].v.substr(0,s);s<o[c].v.length;++s)y<k.length&&(j+=k.charAt(y++));o[c].v=j,o[c].t="t",S=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=a>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=lx(o[c].t,o[c].v,w),o[c].t="t");var E="";for(c=0;c!==o.length;++c)null!=o[c]&&(E+=o[c].v);return E}(n[1],t,r,n[0])}function lj(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r){if(void 0==o6[r]){t<0&&(t=r);continue}if(o6[r]==e){t=r;break}}t<0&&(t=391)}return o6[t]=e,t}function lN(e){for(var t=0;392!=t;++t)void 0!==e[t]&&lj(e[t],t)}function lS(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',o6=e}var lE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},lC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,lT=((o={}).version="1.2.0",d=(c=function(e){var t=0,r=0,a=0,n="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(a=0;256!=a;++a)n[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=n[t]=r>>>8^e[255&r];var s=[];for(a=1;16!=a;++a)s[a-1]="undefined"!=typeof Int32Array?n.subarray(256*a,256*a+256):n.slice(256*a,256*a+256);return s}(l=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}()))[0],u=c[1],h=c[2],f=c[3],p=c[4],m=c[5],g=c[6],x=c[7],b=c[8],y=c[9],v=c[10],w=c[11],k=c[12],j=c[13],N=c[14],o.table=l,o.bstr=function(e,t){for(var r=-1^t,a=0,n=e.length;a<n;)r=r>>>8^l[(r^e.charCodeAt(a++))&255];return~r},o.buf=function(e,t){for(var r=-1^t,a=e.length-15,n=0;n<a;)r=N[e[n++]^255&r]^j[e[n++]^r>>8&255]^k[e[n++]^r>>16&255]^w[e[n++]^r>>>24]^v[e[n++]]^y[e[n++]]^b[e[n++]]^x[e[n++]]^g[e[n++]]^m[e[n++]]^p[e[n++]]^f[e[n++]]^h[e[n++]]^u[e[n++]]^d[e[n++]]^l[e[n++]];for(a+=15;n<a;)r=r>>>8^l[(r^e[n++])&255];return~r},o.str=function(e,t){for(var r=-1^t,a=0,n=e.length,s=0,i=0;a<n;)(s=e.charCodeAt(a++))<128?r=r>>>8^l[(r^s)&255]:s<2048?r=(r=r>>>8^l[(r^(192|s>>6&31))&255])>>>8^l[(r^(128|63&s))&255]:s>=55296&&s<57344?(s=(1023&s)+64,i=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^l[(r^(240|s>>8&7))&255])>>>8^l[(r^(128|s>>2&63))&255])>>>8^l[(r^(128|i>>6&15|(3&s)<<4))&255])>>>8^l[(r^(128|63&i))&255]):r=(r=(r=r>>>8^l[(r^(224|s>>12&15))&255])>>>8^l[(r^(128|s>>6&63))&255])>>>8^l[(r^(128|63&s))&255];return~r},o),lA=function(){var e,t,r={};function a(e){if("/"==e.charAt(e.length-1))return -1===e.slice(0,-1).indexOf("/")?e:a(e.slice(0,-1));var t=e.lastIndexOf("/");return -1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return -1===t?e:e.slice(t+1)}function s(e){dm(e,0);for(var t={},r=0;e.l<=e.length-4;){var a=e.read_shift(2),n=e.read_shift(2),s=e.l+n,i={};21589===a&&(1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),n>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime))),e.l=s,t[a]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return Q(e,t);if((32|e[0])==109&&(32|e[1])==105)return function(e,t){if("mime-version:"!=b(e.slice(0,13)).toLowerCase())throw Error("Unsupported MAD header");var r=t&&t.root||"",a=(oz&&oN.Buffer.isBuffer(e)?e.toString("binary"):b(e)).split("\r\n"),n=0,s="";for(n=0;n<a.length;++n)if((s=a[n],/^Content-Location:/i.test(s))&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(a[1]||"").match(/boundary="(.*?)"/);if(!i)throw Error("MAD cannot find boundary");var o="--"+(i[1]||""),l={FileIndex:[],FullPaths:[]};c(l);var d,u=0;for(n=0;n<a.length;++n){var h=a[n];(h===o||h===o+"--")&&(u++&&function(e,t,r){for(var a,n="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":n=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":a=oW(oU(t.slice(o).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return oW(t.join("\r\n"))}(t.slice(o));break;default:throw Error("Unsupported Content-Transfer-Encoding "+s)}var d=Z(e,n.slice(r.length),a,{unsafe:!0});i&&(d.ctype=i)}(l,a.slice(d,n),r),d=n)}return l}(e,t);if(e.length<512)throw Error("CFB file size "+e.length+" < 512");var r=3,a=512,n=0,s=0,i=0,o=0,d=0,u=[],m=e.slice(0,512);dm(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(p,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(r=g[0]){case 3:a=512;break;case 4:a=4096;break;case 0:if(0==g[1])return Q(e,t);default:throw Error("Major Version: Expected 3 or 4 saw "+r)}512!==a&&dm(m=e.slice(0,a),28);var x=e.slice(0,a),y=m,v=r,w=9;switch(y.l+=2,w=y.read_shift(2)){case 9:if(3!=v)throw Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(4!=v)throw Error("Sector Shift: Expected 12 saw "+w);break;default:throw Error("Sector Shift: Expected 9 or 12 saw "+w)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ");var k=m.read_shift(4,"i");if(3===r&&0!==k)throw Error("# Directory Sectors: Expected 0 saw "+k);m.l+=4,i=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),o=m.read_shift(4,"i"),n=m.read_shift(4,"i"),d=m.read_shift(4,"i"),s=m.read_shift(4,"i");for(var j=-1,N=0;N<109&&!((j=m.read_shift(4,"i"))<0);++N)u[N]=j;var S=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],n=1;n<r;++n)a[n-1]=e.slice(n*t,(n+1)*t);return a[r-1]=e.slice(r*t),a}(e,a);!function e(t,r,a,n,s){var i=f;if(t===f){if(0!==r)throw Error("DIFAT chain shorter than expected")}else if(-1!==t){var o=a[t],l=(n>>>2)-1;if(!o)return;for(var c=0;c<l&&(i=dl(o,4*c))!==f;++c)s.push(i);e(dl(o,n-4),r-1,a,n,s)}}(d,s,S,a,u);var E=function(e,t,r,a){var n=e.length,s=[],i=[],o=[],l=[],c=a-1,d=0,u=0,h=0,f=0;for(d=0;d<n;++d)if(o=[],(h=d+t)>=n&&(h-=n),!i[h]){l=[];var p=[];for(u=h;u>=0;){p[u]=!0,i[u]=!0,o[o.length]=u,l.push(e[u]);var m=r[Math.floor(4*u/a)];if(a<4+(f=4*u&c))throw Error("FAT boundary crossed: "+u+" 4 "+a);if(!e[m]||p[u=dl(e[m],f)])break}s[h]={nodes:o,data:cG([l])}}return s}(S,i,u,a);E[i].name="!Directory",n>0&&o!==f&&(E[o].name="!MiniFAT"),E[u[0]].name="!FAT",E.fat_addrs=u,E.ssz=a;var C=[],T=[],A=[];(function(e,t,r,a,n,s,i,o){for(var c,d=0,u=2*!!a.length,p=t[e].data,m=0,g=0;m<p.length;m+=128){var x=p.slice(m,m+128);dm(x,64),g=x.read_shift(2),c=cX(x,0,g-u),a.push(c);var b={name:c,type:x.read_shift(1),color:x.read_shift(1),L:x.read_shift(4,"i"),R:x.read_shift(4,"i"),C:x.read_shift(4,"i"),clsid:x.read_shift(16),state:x.read_shift(4,"i"),start:0,size:0};0!==x.read_shift(2)+x.read_shift(2)+x.read_shift(2)+x.read_shift(2)&&(b.ct=l(x,x.l-8)),0!==x.read_shift(2)+x.read_shift(2)+x.read_shift(2)+x.read_shift(2)&&(b.mt=l(x,x.l-8)),b.start=x.read_shift(4,"i"),b.size=x.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=f,b.name=""),5===b.type?(d=b.start,n>0&&d!==f&&(t[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=function(e,t,r,a,n){var s=[],i=[];n||(n=[]);var o=a-1,l=0,c=0;for(l=t;l>=0;){n[l]=!0,s[s.length]=l,i.push(e[l]);var d=r[Math.floor(4*l/a)];if(a<4+(c=4*l&o))throw Error("FAT boundary crossed: "+l+" 4 "+a);if(!e[d])break;l=dl(e[d],c)}return{nodes:s,data:cG([i])}}(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==f&&b.start!==f&&t[d]&&(b.content=function(e,t,r){for(var a=e.start,n=e.size,s=[],i=a;r&&n>0&&i>=0;)s.push(t.slice(i*h,i*h+h)),n-=h,i=dl(r,4*i);return 0===s.length?dx(0):oX(s).slice(0,e.size)}(b,t[d].data,(t[o]||{}).data))),b.content&&dm(b.content,0),s[c]=b,i.push(b)}})(i,E,S,C,n,{},T,o),function(e,t,r){for(var a=0,n=0,s=0,i=0,o=0,l=r.length,c=[],d=[];a<l;++a)c[a]=d[a]=a,t[a]=r[a];for(;o<d.length;++o)n=e[a=d[o]].L,s=e[a].R,i=e[a].C,c[a]===a&&(-1!==n&&c[n]!==n&&(c[a]=c[n]),-1!==s&&c[s]!==s&&(c[a]=c[s])),-1!==i&&(c[i]=a),-1!==n&&a!=c[a]&&(c[n]=c[a],d.lastIndexOf(n)<o&&d.push(n)),-1!==s&&a!=c[a]&&(c[s]=c[a],d.lastIndexOf(s)<o&&d.push(s));for(a=1;a<l;++a)c[a]===a&&(-1!==s&&c[s]!==s?c[a]=c[s]:-1!==n&&c[n]!==n&&(c[a]=c[n]));for(a=1;a<l;++a)if(0!==e[a].type){if((o=a)!=c[o])do o=c[o],t[a]=t[o]+"/"+t[a];while(0!==o&&-1!==c[o]&&o!=c[o])c[a]=-1}for(t[0]+="/",a=1;a<l;++a)2!==e[a].type&&(t[a]+="/")}(T,A,C),C.shift();var _={FileIndex:T,FullPaths:A};return t&&t.raw&&(_.raw={header:x,sectors:S}),_}function l(e,t){return new Date((di(e,t+4)/1e7*0x100000000+di(e,t)/1e7-0x2b6109100)*1e3)}function c(e,t){var r=t||{},a=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(!lA.find(e,"/"+t)){var r=dx(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}}(e)}function d(e,t){c(e);for(var r=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(r=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||t){var l=new Date(1987,1,19),d=0,u=Object.create?Object.create(null):{},h=[];for(i=0;i<e.FullPaths.length;++i)u[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&h.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<h.length;++i){var f=a(h[i][0]);(s=u[f])||(h.push([f,{name:n(f).replace("/",""),type:1,clsid:g,ct:l,mt:l,content:null}]),u[f]=!0)}for(h.sort(function(e,t){return function(e,t){for(var r=e.split("/"),a=t.split("/"),n=0,s=0,i=Math.min(r.length,a.length);n<i;++n){if(s=r[n].length-a[n].length)return s;if(r[n]!=a[n])return r[n]<a[n]?-1:1}return r.length-a.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<h.length;++i)e.FullPaths[i]=h[i][0],e.FileIndex[i]=h[i][1];for(i=0;i<h.length;++i){var p=e.FileIndex[i],m=e.FullPaths[i];if(p.name=n(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||g,0===i)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(d=i+1;d<h.length&&a(e.FullPaths[d])!=m;++d);for(p.C=d>=h.length?-1:d,d=i+1;d<h.length&&a(e.FullPaths[d])!=a(m);++d);p.R=d>=h.length?-1:d,p.type=1}else a(e.FullPaths[i+1]||"")==a(m)&&(p.R=i+1),p.type=2}}}function u(e,r){var a=r||{};if("mad"==a.fileType)return function(e,t){for(var r=t||{},a=r.boundary||"SheetJS",n=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(a="------="+a).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=oz&&oN.Buffer.isBuffer(c)?c.toString("binary"):b(c),u=0,h=Math.min(1024,d.length),f=0,p=0;p<=h;++p)(f=d.charCodeAt(p))>=32&&f<128&&++u;var m=u>=4*h/5;n.push(a),n.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),n.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),n.push("Content-Type: "+function(e,t){if(e.ctype)return e.ctype;var r=e.name||"",a=r.match(/\.([^\.]+)$/);return a&&J[a[1]]||t&&(a=(r=t).match(/[\.\\]([^\.\\])+$/))&&J[a[1]]?J[a[1]]:"application/octet-stream"}(o,i)),n.push(""),n.push(m?function(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/mg,"=20").replace(/\t$/mg,"=09")).charAt(0)&&(t="=0D"+t.slice(1)),t=t.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,"\n=0A").replace(/([^\r\n])\n/mg,"$1=0A");for(var r=[],a=t.split("\r\n"),n=0;n<a.length;++n){var s=a[n];if(0==s.length){r.push("");continue}for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),r.push(l)}}return r.join("\r\n")}(d):function(e){for(var t=oB(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"}(d))}return n.push(a+"--\r\n"),n.join("\r\n")}(e,a);if(d(e),"zip"===a.fileType)return function(e,r){var a=[],n=[],s=dx(1),i=8*!!(r||{}).compression,o=0,l=0,c=0,d=0,u=e.FullPaths[0],h=u,f=e.FileIndex[0],p=[],m=0;for(o=1;o<e.FullPaths.length;++o)if(h=e.FullPaths[o].slice(u.length),(f=e.FileIndex[o]).size&&f.content&&"\x01Sh33tJ5"!=h){var g,x=c,b=dx(h.length);for(l=0;l<h.length;++l)b.write_shift(1,127&h.charCodeAt(l));b=b.slice(0,b.l),p[d]=lT.buf(f.content,0);var y=f.content;8==i&&(g=y,y=t?t.deflateRawSync(g):V(g)),(s=dx(30)).write_shift(4,0x4034b50),s.write_shift(2,20),s.write_shift(2,0),s.write_shift(2,i),f.mt?function(e,t){"string"==typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var a=t.getFullYear()-1980;a=(a=a<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,a)}(s,f.mt):s.write_shift(4,0),s.write_shift(-4,(0,p[d])),s.write_shift(4,(0,y.length)),s.write_shift(4,(0,f.content.length)),s.write_shift(2,b.length),s.write_shift(2,0),c+=s.length,a.push(s),c+=b.length,a.push(b),c+=y.length,a.push(y),(s=dx(46)).write_shift(4,0x2014b50),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,0),s.write_shift(2,i),s.write_shift(4,0),s.write_shift(-4,p[d]),s.write_shift(4,y.length),s.write_shift(4,f.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,x),m+=s.l,n.push(s),m+=b.length,n.push(b),++d}return(s=dx(22)).write_shift(4,0x6054b50),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,d),s.write_shift(2,d),s.write_shift(4,m),s.write_shift(4,c),s.write_shift(2,0),oX([oX(a),oX(n),s])}(e,a);var n=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var n=e.FileIndex[a];if(n.content){var s=n.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+7>>3,l=t+127>>7,c=o+r+i+l,d=c+127>>7,u=d<=109?0:Math.ceil((d-109)/127);c+d+u+127>>7>d;)u=++d<=109?0:Math.ceil((d-109)/127);var h=[1,u,d,l,i,r,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),s=dx(n[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,m[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:f),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:f),s.write_shift(4,n[1]),i=0;i<109;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);if(n[1])for(o=0;o<n[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);s.write_shift(-4,o===n[1]-1?f:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,f))};for(o=(i=0)+n[1];i<o;++i)s.write_shift(-4,x.DIFSECT);for(o+=n[2];i<o;++i)s.write_shift(-4,x.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=o,l(u+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(c=0,o=i=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(u=h.content.length)&&!(u>=4096)&&(h.start=o,l(u+63>>6));for(;511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(i=0;i<n[4]<<2;++i){var p=e.FullPaths[i];if(!p||0===p.length){for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0);continue}h=e.FileIndex[i],0===i&&(h.start=h.size?h.start-1:f);var g=0===i&&a.root||h.name;if(u=2*(g.length+1),s.write_shift(64,g,"utf16le"),s.write_shift(2,u),s.write_shift(1,h.type),s.write_shift(1,h.color),s.write_shift(-4,h.L),s.write_shift(-4,h.R),s.write_shift(-4,h.C),h.clsid)s.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,h.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,h.start),s.write_shift(4,h.size),s.write_shift(4,0)}for(i=1;i<e.FileIndex.length;++i)if((h=e.FileIndex[i]).size>=4096)if(s.l=h.start+1<<9,oz&&oN.Buffer.isBuffer(h.content))h.content.copy(s,s.l,0,h.size),s.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)s.write_shift(1,h.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((h=e.FileIndex[i]).size>0&&h.size<4096)if(oz&&oN.Buffer.isBuffer(h.content))h.content.copy(s,s.l,0,h.size),s.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)s.write_shift(1,h.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(oz)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}r.version="1.2.1";var h=64,f=-2,p="d0cf11e0a1b11ae1",m=[208,207,17,224,161,177,26,225],g="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:-2,FREESECT:-1,HEADER_SIGNATURE:p,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:g,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function b(e){for(var t=Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}for(var y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],k="undefined"!=typeof Uint8Array,j=k?new Uint8Array(256):[],N=0;N<256;++N)j[N]=function(e){var t=(e<<1|e<<11)&139536|(e<<5|e<<15)&558144;return(t>>16|t>>8|t)&255}(N);function S(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=5?0:e[a+1]<<8))>>>r&7}function E(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=3?0:e[a+1]<<8))>>>r&31}function C(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=1?0:e[a+1]<<8))>>>r&127}function T(e,t,r){var a=7&t,n=t>>>3,s=(1<<r)-1,i=e[n]>>>a;return r<8-a||(i|=e[n+1]<<8-a,r<16-a||(i|=e[n+2]<<16-a,r<24-a))?i&s:(i|=e[n+3]<<24-a)&s}function A(e,t,r){var a=7&t,n=t>>>3;return a<=5?e[n]|=(7&r)<<a:(e[n]|=r<<a&255,e[n+1]=(7&r)>>8-a),t+3}function _(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=r,t+8}function O(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=255&r,e[a+2]=r>>>8,t+16}function P(e,t){var r=e.length,a=2*r>t?2*r:t+5,n=0;if(r>=t)return e;if(oz){var s=oH(a);if(e.copy)e.copy(s);else for(;n<e.length;++n)s[n]=e[n];return s}if(k){var i=new Uint8Array(a);if(i.set)i.set(e);else for(;n<r;++n)i[n]=e[n];return i}return e.length=a,e}function D(e){for(var t=Array(e),r=0;r<e;++r)t[r]=0;return t}function R(e,t,r){var a=1,n=0,s=0,i=0,o=0,l=e.length,c=k?new Uint16Array(32):D(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var d=k?new Uint16Array(l):D(l);for(s=0;s<l;++s)c[n=e[s]]++,a<n&&(a=n),d[s]=0;for(s=1,c[0]=0;s<=a;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(d[s]=c[o+16]++);var u=0;for(s=0;s<l;++s)if(0!=(u=e[s]))for(o=function(e,t){var r=j[255&e];return t<=8?r>>>8-t:(r=r<<8|j[e>>8&255],t<=16)?r>>>16-t:(r=r<<8|j[e>>16&255])>>>24-t}(d[s],a)>>a-u,i=(1<<a+4-u)-1;i>=0;--i)t[o|i<<u]=15&u|s<<4;return a}var M=k?new Uint16Array(512):D(512),I=k?new Uint16Array(32):D(32);if(!k){for(var L=0;L<512;++L)M[L]=0;for(L=0;L<32;++L)I[L]=0}for(var F=[],B=0;B<32;B++)F.push(5);R(F,I,32);var U=[];for(B=0;B<=143;B++)U.push(8);for(;B<=255;B++)U.push(9);for(;B<=279;B++)U.push(7);for(;B<=287;B++)U.push(8);R(U,M,288);var z=function(){for(var e=k?new Uint8Array(32768):[],t=0,r=0;t<w.length-1;++t)for(;r<w[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var a=k?new Uint8Array(259):[];for(t=0,r=0;t<v.length-1;++t)for(;r<v[t+1];++r)a[r]=t;return function(t,r){if(t.length<8){for(var n=0;n<t.length;){var s=Math.min(65535,t.length-n),i=n+s==t.length;for(r.write_shift(1,+i),r.write_shift(2,s),r.write_shift(2,65535&~s);s-- >0;)r[r.l++]=t[n++]}return r.l}return function(t,r){for(var n=0,s=0,i=k?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(n=A(r,n,+(s+o==t.length)))&&(n+=8-(7&n)),r.l=n/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[s++];n=8*r.l;continue}n=A(r,n,+(s+o==t.length)+2);for(var l=0;o-- >0;){var c,d,u=t[s],h=-1,f=0;if((h=i[l=(l<<5^u)&32767])&&((h|=-32768&s)>s&&(h-=32768),h<s))for(;t[h+f]==t[s+f]&&f<250;)++f;if(f>2){(u=a[f])<=22?n=_(r,n,j[u+1]>>1)-1:(_(r,n,3),_(r,n+=5,j[u-23]>>5),n+=3);var p=u<8?0:u-4>>2;p>0&&(O(r,n,f-v[u]),n+=p),n=_(r,n,j[u=e[s-h]]>>3)-3;var m=u<4?0:u-2>>1;m>0&&(O(r,n,s-h-w[u]),n+=m);for(var g=0;g<f;++g)i[l]=32767&s,l=(l<<5^t[s])&32767,++s;o-=f-1}else u<=143?u+=48:(d=(1&(d=1))<<(7&(c=n)),r[c>>>3]|=d,n=c+1),n=_(r,n,j[u]),i[l]=32767&s,++s}n=_(r,n,0)-1}return r.l=(n+7)/8|0,r.l}(t,r)}}();function V(e){var t=dx(50+Math.floor(1.1*e.length)),r=z(e,t);return t.slice(0,r)}var H=k?new Uint16Array(32768):D(32768),W=k?new Uint16Array(32768):D(32768),q=k?new Uint16Array(128):D(128),G=1,K=1;function X(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[o$(t),2];for(var r=0,a=0,n=oH(t||262144),s=0,i=n.length>>>0,o=0,l=0;(1&a)==0;){if(a=S(e,r),r+=3,a>>>1==0){7&r&&(r+=8-(7&r));var c=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,c>0)for(!t&&i<s+c&&(i=(n=P(n,s+c)).length);c-- >0;)n[s++]=e[r>>>3],r+=8;continue}for(a>>1==1?(o=9,l=5):(r=function(e,t){var r,a,n,s=E(e,t)+257,i=E(e,t+=5)+1;t+=5;var o=(a=7&(r=t),((e[n=r>>>3]|(a<=4?0:e[n+1]<<8))>>>a&15)+4);t+=4;for(var l=0,c=k?new Uint8Array(19):D(19),d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=1,h=k?new Uint8Array(8):D(8),f=k?new Uint8Array(8):D(8),p=c.length,m=0;m<o;++m)c[y[m]]=l=S(e,t),u<l&&(u=l),h[l]++,t+=3;var g=0;for(m=1,h[0]=0;m<=u;++m)f[m]=g=g+h[m-1]<<1;for(m=0;m<p;++m)0!=(g=c[m])&&(d[m]=f[g]++);var x=0;for(m=0;m<p;++m)if(0!=(x=c[m])){g=j[d[m]]>>8-x;for(var b=(1<<7-x)-1;b>=0;--b)q[g|b<<x]=7&x|m<<3}var v=[];for(u=1;v.length<s+i;)switch(g=q[C(e,t)],t+=7&g,g>>>=3){case 16:for(l=3+function(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=6?0:e[a+1]<<8))>>>r&3}(e,t),t+=2,g=v[v.length-1];l-- >0;)v.push(g);break;case 17:for(l=3+S(e,t),t+=3;l-- >0;)v.push(0);break;case 18:for(l=11+C(e,t),t+=7;l-- >0;)v.push(0);break;default:v.push(g),u<g&&(u=g)}var w=v.slice(0,s),N=v.slice(s);for(m=s;m<286;++m)w[m]=0;for(m=i;m<30;++m)N[m]=0;return G=R(w,H,286),K=R(N,W,30),t}(e,r),o=G,l=K);;){!t&&i<s+32767&&(i=(n=P(n,s+32767)).length);var d=T(e,r,o),u=a>>>1==1?M[d]:H[d];if(r+=15&u,((u>>>=4)>>>8&255)==0)n[s++]=u;else if(256==u)break;else{var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var f=s+v[u];h>0&&(f+=T(e,r,h),r+=h),d=T(e,r,l),r+=15&(u=a>>>1==1?I[d]:W[d]);var p=(u>>>=4)<4?0:u-2>>1,m=w[u];for(p>0&&(m+=T(e,r,p),r+=p),!t&&i<f&&(i=(n=P(n,f+100)).length);s<f;)n[s]=n[s-m],++s}}}return t?[n,r+7>>>3]:[n.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function Y(e,t){if(e)"undefined"!=typeof console&&console.error(t);else throw Error(t)}function Q(e,r){dm(e,0);var a={FileIndex:[],FullPaths:[]};c(a,{root:r.root});for(var n=e.length-4;(80!=e[n]||75!=e[n+1]||5!=e[n+2]||6!=e[n+3])&&n>=0;)--n;e.l=n+4,e.l+=4;var i=e.read_shift(2);e.l+=6;var o=e.read_shift(4);for(n=0,e.l=o;n<i;++n){e.l+=20;var l=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f=e.read_shift(2);e.l+=8;var p=e.read_shift(4),m=s(e.slice(e.l+u,e.l+u+h));e.l+=u+h+f;var g=e.l;e.l=p+4,function(e,r,a,n,i){e.l+=2;var o,l,c,d,u,h,f,p=e.read_shift(2),m=e.read_shift(2),g=(o=65535&e.read_shift(2),l=65535&e.read_shift(2),c=new Date,d=31&l,u=15&(l>>>=5),l>>>=4,c.setMilliseconds(0),c.setFullYear(l+1980),c.setMonth(u-1),c.setDate(d),h=31&o,f=63&(o>>>=5),o>>>=6,c.setHours(o),c.setMinutes(f),c.setSeconds(h<<1),c);if(8257&p)throw Error("Unsupported ZIP encryption");for(var x=e.read_shift(4),b=e.read_shift(4),y=e.read_shift(4),v=e.read_shift(2),w=e.read_shift(2),k="",j=0;j<v;++j)k+=String.fromCharCode(e[e.l++]);if(w){var N=s(e.slice(e.l,e.l+w));(N[21589]||{}).mt&&(g=N[21589].mt),((i||{})[21589]||{}).mt&&(g=i[21589].mt)}e.l+=w;var S=e.slice(e.l,e.l+b);switch(m){case 8:S=function(e,r){if(!t)return X(e,r);var a=new t.InflateRaw,n=a._processChunk(e.slice(e.l),a._finishFlushFlag);return e.l+=a.bytesRead,n}(e,y);break;case 0:break;default:throw Error("Unsupported ZIP Compression method "+m)}var E=!1;8&p&&(0x8074b50==e.read_shift(4)&&(e.read_shift(4),E=!0),b=e.read_shift(4),y=e.read_shift(4)),b!=r&&Y(E,"Bad compressed size: "+r+" != "+b),y!=a&&Y(E,"Bad uncompressed size: "+a+" != "+y),Z(n,k,S,{unsafe:!0,mt:g})}(e,l,d,a,m),e.l=g}return a}var J={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Z(e,t,r,a){var s=a&&a.unsafe;s||c(e);var i=!s&&lA.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:n(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||lA.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return r.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),n=!1;47===t.charCodeAt(0)?(n=!0,t=r[0].slice(0,-1)+t):n=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===n?r.indexOf(s):a.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(oQ);for(s=s.replace(oY,""),o&&(s=s.replace(oQ,"!")),i=0;i<r.length;++i)if((o?r[i].replace(oQ,"!"):r[i]).replace(oY,"")==s||(o?a[i].replace(oQ,"!"):a[i]).replace(oY,"")==s)return e.FileIndex[i];return null},r.read=function(t,r){var a=r&&r.type;switch(!a&&oz&&oN.Buffer.isBuffer(t)&&(a="buffer"),a||"base64"){case"file":return i(),o(e.readFileSync(t),r);case"base64":return o(oW(oU(t)),r);case"binary":return o(oW(t),r)}return o(t,r)},r.parse=o,r.write=function(t,r){var a=u(t,r);switch(r&&r.type||"buffer"){case"file":i(),e.writeFileSync(r.filename,a);break;case"binary":return"string"==typeof a?a:b(a);case"base64":return oB("string"==typeof a?a:b(a));case"buffer":if(oz)return oN.Buffer.isBuffer(a)?a:oV(a);case"array":return"string"==typeof a?oW(a):a}return a},r.writeFile=function(t,r,a){i();var n=u(t,a);e.writeFileSync(r,n)},r.utils={cfb_new:function(e){var t={};return c(t,e),t},cfb_add:Z,cfb_del:function(e,t){c(e);var r=lA.find(e,t);if(r){for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0}return!1},cfb_mov:function(e,t,r){c(e);var a=lA.find(e,t);if(a){for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0}return!1},cfb_gc:function(e){d(e,!0)},ReadShift:dc,CheckField:dp,prep_blob:dm,bconcat:oX,use_zlib:function(e){try{var r=new e.InflateRaw;if(r._processChunk(new Uint8Array([3,0]),r._finishFlushFlag),r.bytesRead)t=e;else throw Error("zlib does not expose bytesRead")}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:V,_inflateRaw:X,consts:x},r}();function l_(e,t,r){if(void 0!==a&&a.writeFileSync)return r?a.writeFileSync(e,t,r):a.writeFileSync(e,t);if("undefined"!=typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=oq(t);break;default:throw Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?cj(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!=typeof Blob){var s=new Blob([function(e){if("string"==typeof e)return oq(e);if(Array.isArray(e)){if("undefined"==typeof Uint8Array)throw Error("Unsupported");return new Uint8Array(e)}return e}(n)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if("undefined"!=typeof saveAs)return saveAs(s,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=oG(t)),l.write(t),l.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw Error("cannot save file "+e)}function lO(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function lP(e,t){for(var r=[],a=lO(e),n=0;n!==a.length;++n)null==r[e[a[n]][t]]&&(r[e[a[n]][t]]=a[n]);return r}function lD(e){for(var t=[],r=lO(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function lR(e){for(var t=[],r=lO(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}var lM=new Date(1899,11,30,0,0,0);function lI(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(lM.getTime()+(e.getTimezoneOffset()-lM.getTimezoneOffset())*6e4))/864e5}var lL=new Date,lF=lM.getTime()+(lL.getTimezoneOffset()-lM.getTimezoneOffset())*6e4,lB=lL.getTimezoneOffset();function lU(e){var t=new Date;return t.setTime(24*e*36e5+lF),t.getTimezoneOffset()!==lB&&t.setTime(t.getTime()+(t.getTimezoneOffset()-lB)*6e4),t}var lz=new Date("2017-02-19T19:06:09.000Z"),lV=isNaN(lz.getFullYear())?new Date("2/19/17"):lz,l$=2017==lV.getFullYear();function lH(e,t){var r=new Date(e);if(l$)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==lV.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function lW(e,t){if(oz&&oN.Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return cj(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return cj(oR(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return cj(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return cj(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"",:"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(e){return r[e]||e})}catch(e){}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function lq(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=lq(e[r]));return t}function lG(e,t){for(var r="";r.length<t;)r+=e;return r}function lK(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))&&isNaN(t=Number(a=a.replace(/[(](.*)[)]/,function(e,t){return r=-r,t})))?t:t/r}var lX=["january","february","march","april","may","june","july","august","september","october","november","december"];function lY(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==lX.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&101!=a?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lQ=(S=5=="abacaba".split(/(:?b)/i).length,function(e,t,r){if(S||"string"==typeof t)return e.split(t);for(var a=e.split(t),n=[a[0]],s=1;s<a.length;++s)n.push(r),n.push(a[s]);return n});function lJ(e){return e?e.content&&e.type?lW(e.content,!0):e.data?oM(e.data):e.asNodeBuffer&&oz?oM(e.asNodeBuffer().toString("binary")):e.asBinary?oM(e.asBinary()):e._data&&e._data.getContent?oM(lW(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function lZ(e){if(!e)return null;if(e.data)return oD(e.data);if(e.asNodeBuffer&&oz)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?oD(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function l0(e,t){for(var r=e.FullPaths||lO(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function l1(e,t){var r=l0(e,t);if(null==r)throw Error("Cannot find file "+t+" in zip");return r}function l2(e,t,r){if(!r){var a;return(a=l1(e,t))&&".bin"===a.name.slice(-4)?lZ(a):lJ(a)}if(!t)return null;try{return l2(e,t)}catch(e){return null}}function l5(e,t,r){if(!r)return lJ(l1(e,t));if(!t)return null;try{return l5(e,t)}catch(e){return null}}function l4(e){for(var t=e.FullPaths||lO(e.files),r=[],a=0;a<t.length;++a)"/"!=t[a].slice(-1)&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function l3(e,t,r){if(e.FullPaths){if("string"==typeof r){var a;return a=oz?oV(r):function(e){for(var t=[],r=0,a=e.length+250,n=o$(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[r++]=i;else if(i<2048)n[r++]=192|i>>6&31,n[r++]=128|63&i;else if(i>=55296&&i<57344){i=(1023&i)+64;var o=1023&e.charCodeAt(++s);n[r++]=240|i>>8&7,n[r++]=128|i>>2&63,n[r++]=128|o>>6&15|(3&i)<<4,n[r++]=128|63&o}else n[r++]=224|i>>12&15,n[r++]=128|i>>6&63,n[r++]=128|63&i;r>a&&(t.push(n.slice(0,r)),r=0,n=o$(65535),a=65530)}return t.push(n.slice(0,r)),oX(t)}(r),lA.utils.cfb_add(e,t,a)}lA.utils.cfb_add(e,t,r)}else e.file(t,r)}function l6(){return lA.utils.cfb_new()}function l8(e,t){switch(t.type){case"base64":return lA.read(e,{type:"base64"});case"binary":return lA.read(e,{type:"binary"});case"buffer":case"array":return lA.read(e,{type:"buffer"})}throw Error("Unrecognized type "+t.type)}function l7(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var a=e.split("/");0!==a.length;){var n=a.shift();".."===n?r.pop():"."!==n&&r.push(n)}return r.join("/")}var l9='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ce=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ct=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,cr=l9.match(ct)?ct:/<[^>]*>/g,ca=/<\w*:/,cn=/<(\/?)\w+:/;function cs(e,t,r){for(var a={},n=0,s=0;n!==e.length&&32!==(s=e.charCodeAt(n))&&10!==s&&13!==s;++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(ce),o=0,l="",c=0,d="",u="",h=1;if(i)for(c=0;c!=i.length;++c){for(s=0,u=i[c];s!=u.length&&61!==u.charCodeAt(s);++s);for(d=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(o=0,h=+(34==(n=u.charCodeAt(s+1))||39==n),l=u.slice(s+1+h,u.length-h);o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=l,r||(a[d.toLowerCase()]=l);else{var f=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(a[f]&&"ext"==d.slice(o-3,o))continue;a[f]=l,r||(a[f.toLowerCase()]=l)}}return a}function ci(e){return e.replace(cn,"<$1")}var co={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cl=lD(co),cc=(E=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,C=/_x([\da-fA-F]{4})_/ig,function e(t){var r=t+"",a=r.indexOf("<![CDATA[");if(-1==a)return r.replace(E,function(e,t){return co[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(C,function(e,t){return String.fromCharCode(parseInt(t,16))});var n=r.indexOf("]]>");return e(r.slice(0,a))+r.slice(a+9,n)+e(r.slice(n+3))}),cd=/[&<>'"]/g,cu=/[\u0000-\u0008\u000b-\u001f]/g;function ch(e){return(e+"").replace(cd,function(e){return cl[e]}).replace(cu,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function cf(e){return ch(e).replace(/ /g,"_x0020_")}var cp=/[\u0000-\u001f]/g;function cm(e){return(e+"").replace(cd,function(e){return cl[e]}).replace(/\n/g,"<br/>").replace(cp,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var cg=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function cx(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cb(e){for(var t="",r=0,a=0,n=0,s=0,i=0,o=0;r<e.length;){if((a=e.charCodeAt(r++))<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){t+=String.fromCharCode((31&a)<<6|63&n);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((15&a)<<12|(63&n)<<6|63&s);continue}t+=String.fromCharCode(55296+((o=((7&a)<<18|(63&n)<<12|(63&s)<<6|63&e.charCodeAt(r++))-65536)>>>10&1023)),t+=String.fromCharCode(56320+(1023&o))}return t}function cy(e){var t,r,a,n=o$(2*e.length),s=1,i=0,o=0;for(r=0;r<e.length;r+=s)s=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=(31&a)*64+(63&e.charCodeAt(r+1)),s=2):a<240?(t=(15&a)*4096+(63&e.charCodeAt(r+1))*64+(63&e.charCodeAt(r+2)),s=3):(s=4,o=55296+((t=(7&a)*262144+(63&e.charCodeAt(r+1))*4096+(63&e.charCodeAt(r+2))*64+(63&e.charCodeAt(r+3))-65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(n[i++]=255&o,n[i++]=o>>>8,o=0),n[i++]=t%256,n[i++]=t>>>8;return n.slice(0,i).toString("ucs2")}function cv(e){return oV(e,"binary").toString("utf8")}var cw="foo bar baz",ck=oz&&(cv(cw)==cb(cw)&&cv||cy(cw)==cb(cw)&&cy)||cb,cj=oz?function(e){return oV(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,t.push(String.fromCharCode(240+((n=e.charCodeAt(r++)-56320+(a<<10))>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)))}return t.join("")},cN=(T={},function(e,t){var r=e+"|"+(t||"");return T[r]?T[r]:T[r]=RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||"")}),cS=(A=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[RegExp("&"+e[0]+";","ig"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<A.length;++r)t=t.replace(A[r][0],A[r][1]);return t}),cE=(_={},function(e){return void 0!==_[e]?_[e]:_[e]=RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}),cC=/<\/?(?:vt:)?variant>/g,cT=/<(?:vt:)([^>]*)>([\s\S]*)</;function cA(e,t){var r=cs(e),a=e.match(cE(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(e){var t=e.replace(cC,"").match(cT);t&&n.push({v:ck(t[2]),t:t[1]})}),n}var c_=/(^\s|\s$|\n)/;function cO(e,t){return"<"+e+(t.match(c_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function cP(e){return lO(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function cD(e,t,r){return"<"+e+(null!=r?cP(r):"")+(null!=t?(t.match(c_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function cR(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function cM(e){if(oz&&oN.Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return ck(oG(oK(e)));throw Error("Bad input format: expected Buffer or string")}var cI=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,cL="http://schemas.openxmlformats.org/package/2006/content-types",cF="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",cB="http://schemas.openxmlformats.org/officeDocument/2006/relationships",cU="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",cz="http://www.w3.org/2001/XMLSchema-instance",cV=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],c$="urn:schemas-microsoft-com:office:office",cH="urn:schemas-microsoft-com:office:excel",cW="urn:schemas-microsoft-com:office:spreadsheet",cq=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,n=e[0][r].length;a<n;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t},cG=oz?function(e){return e[0].length>0&&oN.Buffer.isBuffer(e[0][0])?oN.Buffer.concat(e[0].map(function(e){return oN.Buffer.isBuffer(e)?e:oV(e)})):cq(e)}:cq,cK=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(dn(e,n)));return a.join("").replace(oY,"")},cX=oz?function(e,t,r){return oN.Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(oY,""):cK(e,t,r)}:cK,cY=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},cQ=oz?function(e,t,r){return oN.Buffer.isBuffer(e)?e.toString("hex",t,t+r):cY(e,t,r)}:cY,cJ=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(da(e,n)));return a.join("")},cZ=oz?function(e,t,r){return oN.Buffer.isBuffer(e)?e.toString("utf8",t,r):cJ(e,t,r)}:cJ,c0=function(e,t){var r=di(e,t);return r>0?cZ(e,t+4,t+4+r-1):""},c1=c0,c2=function(e,t){var r=di(e,t);return r>0?cZ(e,t+4,t+4+r-1):""},c5=c2,c4=function(e,t){var r=2*di(e,t);return r>0?cZ(e,t+4,t+4+r-1):""},c3=c4,c6=function(e,t){var r=di(e,t);return r>0?cX(e,t+4,t+4+r):""},c8=c6,c7=function(e,t){var r=di(e,t);return r>0?cZ(e,t+4,t+4+r):""},c9=c7,de=function(e,t){for(var r=1-2*(e[t+7]>>>7),a=((127&e[t+7])<<4)+(e[t+6]>>>4&15),n=15&e[t+6],s=5;s>=0;--s)n=256*n+e[t+s];return 2047==a?0==n?1/0*r:NaN:(0==a?a=-1022:(a-=1023,n+=0x10000000000000),r*Math.pow(2,a-52)*n)},dt=de,dr=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};oz&&(c1=function(e,t){if(!oN.Buffer.isBuffer(e))return c0(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},c5=function(e,t){if(!oN.Buffer.isBuffer(e))return c2(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},c3=function(e,t){if(!oN.Buffer.isBuffer(e))return c4(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},c8=function(e,t){if(!oN.Buffer.isBuffer(e))return c6(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},c9=function(e,t){if(!oN.Buffer.isBuffer(e))return c7(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},dt=function(e,t){return oN.Buffer.isBuffer(e)?e.readDoubleLE(t):de(e,t)},dr=function(e){return oN.Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array}),void 0!==ee&&(cX=function(e,t,r){return ee.utils.decode(1200,e.slice(t,r)).replace(oY,"")},cZ=function(e,t,r){return ee.utils.decode(65001,e.slice(t,r))},c1=function(e,t){var r=di(e,t);return r>0?ee.utils.decode(oC,e.slice(t+4,t+4+r-1)):""},c5=function(e,t){var r=di(e,t);return r>0?ee.utils.decode(oE,e.slice(t+4,t+4+r-1)):""},c3=function(e,t){var r=2*di(e,t);return r>0?ee.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},c8=function(e,t){var r=di(e,t);return r>0?ee.utils.decode(1200,e.slice(t+4,t+4+r)):""},c9=function(e,t){var r=di(e,t);return r>0?ee.utils.decode(65001,e.slice(t+4,t+4+r)):""});var da=function(e,t){return e[t]},dn=function(e,t){return 256*e[t+1]+e[t]},ds=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-((65535-r+1)*1)},di=function(e,t){return 0x1000000*e[t+3]+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},dl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]};function dc(e,t){var r,a,n,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,oz&&oN.Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(dn(this,o)),o+=2;e*=2;break;case"utf8":l=cZ(this,this.l,this.l+e);break;case"utf16le":e*=2,l=cX(this,this.l,this.l+e);break;case"wstr":if(void 0===ee)return dc.call(this,e,"dbcs");l=ee.utils.decode(oE,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=c1(this,this.l),e=4+di(this,this.l);break;case"lpstr-cp":l=c5(this,this.l),e=4+di(this,this.l);break;case"lpwstr":l=c3(this,this.l),e=4+2*di(this,this.l);break;case"lpp4":e=4+di(this,this.l),l=c8(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+di(this,this.l),l=c9(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(n=da(this,this.l+e++));)c.push(oI(n));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(n=dn(this,this.l+e));)c.push(oI(n)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(i=0,l="",o=this.l;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return n=da(this,o),this.l=o+1,s=dc.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(oI(dn(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if(void 0!==ee){l=ee.utils.decode(oE,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(i=0,l="",o=this.l;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return n=da(this,o),this.l=o+1,s=dc.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(oI(da(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=da(this,this.l),this.l++,r;case 2:return r=("i"===t?ds:dn)(this,this.l),this.l+=2,r;case 4:case -4:if("i"===t||(128&this[this.l+3])==0)return r=(e>0?dl:function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]})(this,this.l),this.l+=4,r;return a=di(this,this.l),this.l+=4,a;case 8:case -8:if("f"===t)return a=8==e?dt(this,this.l):dt([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:l=cQ(this,this.l,e)}}return this.l+=e,l}var dd=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},du=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},dh=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function df(e,t,r){var a=0,n=0;if("dbcs"===r){for(n=0;n!=t.length;++n)dh(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if("sbcs"===r){if(void 0!==ee&&874==oC)for(n=0;n!=t.length;++n){var s=ee.utils.encode(oC,t.charAt(n));this[this.l+n]=s[0]}else for(n=0,t=t.replace(/[^\x00-\x7F]/g,"_");n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);a=t.length}else if("hex"===r){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:a=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:a=4,dd(this,t,this.l);break;case 8:if(a=8,"f"===r){!function(e,t,r){var a=(t<0||1/t==-1/0)<<7,n=0,s=0,i=a?-t:t;isFinite(i)?0==i?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<0x10000000000000)?n=-1022:(s-=0x10000000000000,n+=1023)):(n=2047,s=26985*!!isNaN(t));for(var o=0;o<=5;++o,s/=256)e[r+o]=255&s;e[r+6]=(15&n)<<4|15&s,e[r+7]=n>>4|a}(this,t,this.l);break}case 16:break;case -4:a=4,du(this,t,this.l)}return this.l+=a,this}function dp(e,t){var r=cQ(this,this.l,e.length>>1);if(r!==e)throw Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function dm(e,t){e.l=t,e.read_shift=dc,e.chk=dp,e.write_shift=df}function dg(e,t){e.l+=t}function dx(e){var t=o$(e);return dm(t,0),t}function db(e,t,r){if(e){dm(e,e.l||0);for(var a,n,s,i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=pG[o]||pG[65535];for(n=1,s=127&(a=e.read_shift(1));n<4&&128&a;++n)s+=(127&(a=e.read_shift(1)))<<7*n;l=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=l,t(d,c,o))return}}}function dy(){var e=[],t=oz?256:2048,r=function(e){var t=dx(e);return dm(t,0),t},a=r(t),n=function(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},s=function(e){return a&&e<a.length-a.l?a:(n(),a=r(Math.max(e+1,t)))};return{next:s,push:function(e){n(),null==(a=e).l&&(a.l=a.length),s(t)},end:function(){return n(),oX(e)},_bufs:e}}function dv(e,t,r,a){var n,s=+t;if(!isNaN(s)){a||(a=pG[s].p||(r||[]).length||0),n=1+ +(s>=128)+1,a>=128&&++n,a>=16384&&++n,a>=2097152&&++n;var i=e.next(n);s<=127?i.write_shift(1,s):(i.write_shift(1,(127&s)+128),i.write_shift(1,s>>7));for(var o=0;4!=o;++o)if(a>=128)i.write_shift(1,(127&a)+128),a>>=7;else{i.write_shift(1,a);break}a>0&&dr(r)&&e.push(r)}}function dw(e,t,r){var a=lq(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function dk(e,t,r){var a=lq(e);return a.s=dw(a.s,t.s,r),a.e=dw(a.e,t.s,r),a}function dj(e,t){if(e.cRel&&e.c<0)for(e=lq(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lq(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=d_(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),r}function dN(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?dj(e.s,t.biff)+":"+dj(e.e,t.biff):(e.s.rRel?"":"$")+dE(e.s.r)+":"+(e.e.rRel?"":"$")+dE(e.e.r):(e.s.cRel?"":"$")+dT(e.s.c)+":"+(e.e.cRel?"":"$")+dT(e.e.c)}function dS(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function dE(e){return""+(e+1)}function dC(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function dT(e){if(e<0)throw Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function dA(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function d_(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function dO(e){var t=e.indexOf(":");return -1==t?{s:dA(e),e:dA(e)}:{s:dA(e.slice(0,t)),e:dA(e.slice(t+1))}}function dP(e,t){return void 0===t||"number"==typeof t?dP(e.s,e.e):("string"!=typeof e&&(e=d_(e)),"string"!=typeof t&&(t=d_(t)),e==t?e:e+":"+t)}function dD(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1)&&!(n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0)&&!(n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||10!=n)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1)&&!(n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0)&&!(n>9);++a)r=10*r+n;return t.e.r=--r,t}function dR(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=lk(e.z,r?lI(t):t)}catch(e){}try{return e.w=lk((e.XF||{}).numFmtId||14*!!r,r?lI(t):t)}catch(e){return""+t}}function dM(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t)?d7[e.v]||e.v:void 0==t?dR(e,e.v):dR(e,t)}function dI(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function dL(e,t){return function(e,t,r){var a=r||{},n=(0,a.dense),s=n?[]:{},i=0,o=0;if(s&&null!=a.origin){if("number"==typeof a.origin)i=a.origin;else{var l="string"==typeof a.origin?dA(a.origin):a.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=dD(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(void 0!==t[u][h]){var f={v:t[u][h]},p=i+u,m=o+h;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[u][h]||"object"!=typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(a.nullError)f.t="e",f.v=0;else{if(!a.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=a.dateNF||o6[14],a.cellDates?(f.t="d",f.w=lk(f.z,lI(f.v))):(f.t="n",f.v=lI(f.v),f.w=lk(f.z,f.v))):f.t="s";else f=t[u][h];if(n)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(f.z=s[p][m].z),s[p][m]=f;else{var g=d_({c:m,r:p});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=dP(c)),s}(null,e,t)}function dF(e,t){return t||(t=dx(4)),t.write_shift(4,e),t}function dB(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function dU(e,t){var r=!1;return null==t&&(r=!0,t=dx(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dz(e,t){var r=e.l,a=e.read_shift(1),n=dB(e),s=[],i={t:n,h:n};if((1&a)!=0){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push({ich:e.read_shift(2),ifnt:e.read_shift(2)});i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function dV(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function d$(e,t){return null==t&&(t=dx(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function dH(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function dW(e,t){return null==t&&(t=dx(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function dq(e){var t=e.read_shift(4);return 0===t||0xffffffff===t?"":e.read_shift(t,"dbcs")}function dG(e,t){var r=!1;return null==t&&(r=!0,t=dx(127)),t.write_shift(4,e.length>0?e.length:0xffffffff),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dK(e){var t=e.slice(e.l,e.l+4),r=1&t[0],a=2&t[0];e.l+=4;var n=0===a?dt([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):dl(t,0)>>2;return r?n/100:n}function dX(e,t){null==t&&(t=dx(4));var r=0,a=0,n=100*e;if(e==(0|e)&&e>=-0x20000000&&e<0x20000000?a=1:n==(0|n)&&n>=-0x20000000&&n<0x20000000&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw Error("unsupported RkNumber "+e)}function dY(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var dQ=function(e,t){return t||(t=dx(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function dJ(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function dZ(e,t){return(t||dx(8)).write_shift(8,e,"f")}function d0(e,t){if(t||(t=dx(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var a=e.rgb||"FFFFFF";"number"==typeof a&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function d1(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 0xffffffff:case 0xfffffffe:return({2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"})[e.read_shift(4)]||""}if(r>400)throw Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var d2=[80,81],d5={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},0x80000000:{n:"Locale",t:19},0x80000003:{n:"Behavior",t:19},0x72627262:{}},d4={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},0x80000000:{n:"Locale",t:19},0x80000003:{n:"Behavior",t:19},0x72627262:{}},d3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},d6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],d8=lq([0,0xffffff,0xff0000,65280,255,0xffff00,0xff00ff,65535,0,0xffffff,0xff0000,65280,255,0xffff00,0xff00ff,65535,8388608,32768,128,8421376,8388736,32896,0xc0c0c0,8421504,0x9999ff,0x993366,0xffffcc,0xccffff,6684774,0xff8080,26316,0xccccff,128,0xff00ff,0xffff00,65535,8388736,8388608,32896,255,52479,0xccffff,0xccffcc,0xffff99,0x99ccff,0xff99cc,0xcc99ff,0xffcc99,3368703,3394764,0x99cc00,0xffcc00,0xff9900,0xff6600,6710937,9868950,13158,3381606,13056,3355392,0x993300,0x993366,3355545,3355443,0xffffff,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),d7={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},d9={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ue={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ut={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ur(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ua(e,t){var r,a=function(e){for(var t=[],r=lO(e),a=0;a!==r.length;++a)null==t[e[r[a]]]&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}(ue),n=[];n[n.length]=l9,n[n.length]=cD("Types",null,{xmlns:cL,"xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":cz}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return cD("Default",null,{Extension:e[0],ContentType:e[1]})}));var s=function(a){e[a]&&e[a].length>0&&(r=e[a][0],n[n.length]=cD("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:ut[a][t.bookType]||ut[a].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){n[n.length]=cD("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ut[r][t.bookType]||ut[r].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){n[n.length]=cD("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:a[t][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var un="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",us="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",ui="http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",uo="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",ul="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",uc="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",ud="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",uu="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",uh="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",uf="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",up="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",um=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],ug="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",ux="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",ub="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",uy="http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",uv="http://schemas.microsoft.com/office/2006/relationships/vbaProject";function uw(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function uk(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var a={};return(e.match(cr)||[]).forEach(function(e){var n=cs(e);if("<Relationship"===n[0]){var s={};s.Type=n.Type,s.Target=n.Target,s.Id=n.Id,n.TargetMode&&(s.TargetMode=n.TargetMode),r["External"===n.TargetMode?n.Target:l7(n.Target,t)]=s,a[n.Id]=s}}),r["!id"]=a,r}function uj(e){var t=[l9,cD("Relationships",null,{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"})];return lO(e["!id"]).forEach(function(r){t[t.length]=cD("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function uN(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,s?n.TargetMode=s:[us,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath","http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing"].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function uS(e,t,r){return'  <rdf:Description rdf:about="'+e+'">\n'+('    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#")+t+'"/>\n  </rdf:Description>\n'}function uE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+oS.version+"</meta:generator></office:meta></office:document-meta>"}var uC=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],uT=function(){for(var e=Array(uC.length),t=0;t<uC.length;++t){var r=uC[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function uA(e){var t={};e=ck(e);for(var r=0;r<uC.length;++r){var a=uC[r],n=e.match(uT[r]);null!=n&&n.length>0&&(t[a[1]]=cc(n[1])),"date"===a[2]&&t[a[1]]&&(t[a[1]]=lH(t[a[1]]))}return t}function u_(e,t,r,a,n){null==n[e]&&null!=t&&""!==t&&(n[e]=t,t=ch(t),a[a.length]=r?cD(e,t,r):cO(e,t))}function uO(e,t){var r=t||{},a=[l9,cD("cp:coreProperties",null,{"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":cz})],n={};if(!e&&!r.Props)return a.join("");e&&(null!=e.CreatedDate&&u_("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:cR(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),null!=e.ModifiedDate&&u_("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:cR(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=uC.length;++s){var i=uC[s],o=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&u_(i[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var uP=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uD=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uR(e,t,r,a){var n=[];if("string"==typeof e)n=cA(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?cA(t,a).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==n.length;c+=2){switch(l=+n[c+1].v,n[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l)}o+=l}}function uM(e){var t=[];return e||(e={}),e.Application="SheetJS",t[t.length]=l9,t[t.length]=cD("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":cU}),uP.forEach(function(r){var a;if(void 0!==e[r[1]]){switch(r[2]){case"string":a=ch(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=cD(r[0],a))}}),t[t.length]=cD("HeadingPairs",cD("vt:vector",cD("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+cD("vt:variant",cD("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=cD("TitlesOfParts",cD("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+ch(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uI=/<[^>]+>[^<]*/g;function uL(e){var t=[l9,cD("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties","xmlns:vt":cU})];if(!e)return t.join("");var r=1;return lO(e).forEach(function(a){++r,t[t.length]=cD("property",function(e,t){switch(typeof e){case"string":var r=cD("vt:lpwstr",ch(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return cD((0|e)==e?"vt:i4":"vt:r8",ch(String(e)));case"boolean":return cD("vt:bool",e?"true":"false")}if(e instanceof Date)return cD("vt:filetime",cR(e));throw Error("Unable to serialize "+e)}(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ch(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function uB(e){var t=e.read_shift(4);return new Date((e.read_shift(4)/1e7*0x100000000+t/1e7-0x2b6109100)*1e3).toISOString().replace(/\.000/,"")}function uU(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function uz(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function uV(e,t,r){return 31===t?uz(e):uU(e,t,r)}function u$(e,t,r){return uV(e,t,4*(!1!==r))}function uH(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(oY,"").replace(oQ,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),a}function uW(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function uq(e,t,r){var a,n,s=e.read_shift(2),i=r||{};if(e.l+=2,12!==t&&s!==t&&-1===d2.indexOf(t)&&((65534&t)!=4126||(65534&s)!=4126))throw Error("Expected type "+t+" saw "+s);switch(12===t?s:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:return uU(e,s,4).replace(oY,"");case 31:return uz(e);case 64:return uB(e);case 65:return uW(e);case 71:return(a={}).Size=e.read_shift(4),e.l+=a.Size+3-(a.Size-1)%4,a;case 80:return u$(e,s,!i.raw).replace(oY,"");case 81:return(function(e,t){if(!t)throw Error("VtUnalignedString must have positive length");return uV(e,t,0)})(e,s).replace(oY,"");case 4108:for(var o=e.read_shift(4),l=[],c=0;c<o/2;++c)l.push(function(e){var t=e.l,r=uq(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,uq(e,3)]}(e));return l;case 4126:case 4127:return 4127==s?function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(oY,""),e.l-n&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(oY,"");return r}(e);default:throw Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function uG(e,t){var r,a,n,s,i,o=dx(4),l=dx(4);switch(o.write_shift(4,80==e?31:e),e){case 3:l.write_shift(-4,t);break;case 5:(l=dx(8)).write_shift(8,t,"f");break;case 11:l.write_shift(4,+!!t);break;case 64:a=(r=("string"==typeof t?new Date(Date.parse(t)):t).getTime()/1e3+0x2b6109100)%0x100000000,n=(r-a)/0x100000000*1e7,(s=(a*=1e7)/0x100000000|0)>0&&(a%=0x100000000,n+=s),(i=dx(8)).write_shift(4,a),i.write_shift(4,n),l=i;break;case 31:case 80:for((l=dx(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),l.write_shift(0,t,"dbcs");l.l!=l.length;)l.write_shift(1,0);break;default:throw Error("TypedPropertyValue unrecognized type "+e+" "+t)}return oX([o,l])}function uK(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=n;++i){var d=e.read_shift(4),u=e.read_shift(4);s[i]=[d,u+r]}s.sort(function(e,t){return e[1]-t[1]});var h={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var f=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],f=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(f=!1,e.l=s[i][1]),f)throw Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(h[p.n]=uq(e,p.t,{raw:!0}),"version"===p.p&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(65535&h[p.n])).slice(-4)),"CodePage"==p.n)switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case -536:case 65001:case -535:oO(o=h[p.n]>>>0&65535);break;default:throw Error("Unsupported CodePage: "+h[p.n])}}else if(1===s[i][0]){if(oO(o=h.CodePage=uq(e,2)),-1!==l){var m=e.l;e.l=s[l][1],c=uH(e,o),e.l=m}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=uH(e,o)}else{var g,x=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=uW(e);break;case 30:case 31:e.l+=4,g=u$(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=u0(e,4);break;case 64:e.l+=4,g=lH(uB(e));break;default:throw Error("unparsed value: "+e[e.l])}h[x]=g}}return e.l=r+a,h}var uX=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uY(e,t,r){var a=dx(8),n=[],s=[],i=8,o=0,l=dx(8),c=dx(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),n.push(c),i+=8+l.length,!t){(c=dx(8)).write_shift(4,0),n.unshift(c);var d=[dx(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for((l=dx(8+2*(u.length+1)+(u.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=oX(d),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]]||uX.indexOf(e[o][0])>-1||uD.indexOf(e[o][0])>-1)&&null!=e[o][1]){var h=e[o][1],f=0;if(t){var p=r[f=+t[e[o][0]]];if("version"==p.p&&"string"==typeof h){var m=h.split(".");h=(m[0]<<16)+(+m[1]||0)}l=uG(p.t,h)}else{var g=function(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return -1}(h);-1==g&&(g=31,h=String(h)),l=uG(g,h)}s.push(l),(c=dx(8)).write_shift(4,t?f:2+o),n.push(c),i+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,x),x+=s[o].length;return a.write_shift(4,i),a.write_shift(4,s.length),oX([a].concat(n).concat(s))}function uQ(e,t,r){var a,n=e.content;if(!n)return{};dm(n,0);var s,i,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),u=n.read_shift(16);if(u!==lA.utils.consts.HEADER_CLSID&&u!==r)throw Error("Bad PropertySet CLSID "+u);if(1!==(s=n.read_shift(4))&&2!==s)throw Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),l=n.read_shift(4),1===s&&l!==n.l)throw Error("Length mismatch: "+l+" !== "+n.l);2===s&&(o=n.read_shift(16),c=n.read_shift(4));var h=uK(n,t),f={SystemIdentifier:d};for(var p in h)f[p]=h[p];if(f.FMTID=i,1===s)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw Error("Length mismatch 2: "+n.l+" !== "+c);try{a=uK(n,null)}catch(e){}for(p in a)f[p]=a[p];return f.FMTID=[i,o],f}function uJ(e,t,r,a,n,s){var i=dx(n?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,0x32363237),i.write_shift(16,lA.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var l=uY(e,r,a);if(o.push(l),n){var c=uY(n,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return oX(o)}function uZ(e,t){return e.read_shift(t),null}function u0(e,t){return 1===e.read_shift(t)}function u1(e,t){return t||(t=dx(2)),t.write_shift(2,+!!e),t}function u2(e){return e.read_shift(2,"u")}function u5(e,t){return t||(t=dx(2)),t.write_shift(2,e),t}function u4(e,t){for(var r=[],a=e.l+t;e.l<a;)r.push(u2(e,a-e.l));if(a!==e.l)throw Error("Slurp error");return r}function u3(e,t,r){return r||(r=dx(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,+("e"==t)),r}function u6(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont",s=oE;r&&r.biff>=8&&(oE=1200),r&&8!=r.biff?12==r.biff&&(n="wstr"):e.read_shift(1)&&(n="dbcs-cont"),r.biff>=2&&r.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return oE=s,i}function u8(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function u7(e,t,r){var a=e.read_shift(r&&2==r.biff?1:2);return 0===a?(e.l++,""):u8(e,a,r)}function u9(e,t,r){if(r.biff>5)return u7(e,t,r);var a=e.read_shift(1);return 0===a?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function he(e,t,r){return r||(r=dx(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ht(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(oY,""):""}function hr(e,t){t||(t=dx(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function ha(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function hn(e,t){var r=ha(e,t);return r[3]=0,r}function hs(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function hi(e,t,r,a){return a||(a=dx(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function ho(e){return[e.read_shift(2),dK(e)]}function hl(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function hc(e,t){return t||(t=dx(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function hd(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}function hu(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function hh(e){e.l+=2,e.l+=e.read_shift(2)}var hf={0:hh,4:hh,5:hh,6:hh,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:hh,9:hh,10:hh,11:hh,12:hh,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:hh,15:hh,16:hh,17:hh,18:hh,19:hh,20:hh,21:hu};function hp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function hm(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;default:throw Error("unsupported BIFF version")}var s=dx(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function hg(e,t,r){var a=0;r&&2==r.biff||(a=e.read_shift(2));var n=e.read_shift(2);return r&&2==r.biff&&(a=1-(n>>15),n&=32767),[{Unsynced:1&a,DyZero:(2&a)>>1,ExAsc:(4&a)>>2,ExDsc:(8&a)>>3},n]}function hx(e,t,r){var a=e.l+t,n=8!=r.biff&&r.biff?2:4,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),l=e.read_shift(2);return e.l=a,{s:{r:s,c:o},e:{r:i,c:l}}}function hb(e,t,r,a){var n=r&&5==r.biff;a||(a=dx(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function hy(e,t,r){var a,n=hs(e,6);(2==r.biff||9==t)&&++e.l;var s=(a=e.read_shift(1),1===e.read_shift(1)?a:1===a);return n.val=s,n.t=!0===s||!1===s?"b":"e",n}var hv=function(e,t,r){return 0===t?"":u9(e,t,r)};function hw(e,t,r){var a,n=e.read_shift(2),s={fBuiltIn:1&n,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return 14849===r.sbcch&&(a=function(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=u6(e,t,r),s=e.read_shift(2);if(s!==(a-=e.l))throw Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}(e,t-2,r)),s.body=a||e.read_shift(t-2),"string"==typeof a&&(s.Name=a),s}var hk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hj(e,t,r){var a,n,s,i,o,l,c,d=e.l+t,u=e.read_shift(2),h=e.read_shift(1),f=e.read_shift(1),p=e.read_shift(r&&2==r.biff?1:2),m=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),m=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var g=u8(e,f,r);32&u&&(g=hk[g.charCodeAt(0)]);var x=d-e.l;return r&&2==r.biff&&--x,{chKey:h,Name:g,itab:m,rgce:d!=e.l&&0!==p&&x>0?(a=e,n=x,s=r,i=p,l=a.l+n,c=fX(a,i,s),l!==a.l&&(o=fK(a,l-a.l,c,s)),[c,o]):[]}}function hN(e,t,r){if(r.biff<8){var a,n,s,i;return a=e,n=t,s=r,3==a[a.l+1]&&a[a.l]++,3==(i=u6(a,n,s)).charCodeAt(0)?i.slice(1):i}for(var o=[],l=e.l+t,c=e.read_shift(r.biff>8?4:2);0!=c--;)o.push(function(e,t,r){var a=r.biff>8?4:2;return[e.read_shift(a),e.read_shift(a,"i"),e.read_shift(a,"i")]}(e,r.biff,r));if(e.l!=l)throw Error("Bad ExternSheet: "+e.l+" != "+l);return o}function hS(e,t,r){var a=hd(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,function(e,t,r){var a,n,s=e.l+t,i=2==r.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],(a=t-2,void(e.l+=a))];var l=fX(e,o,r);return t!==o+i&&(n=fK(e,t-o-i,l,r)),e.l=s,[l,n]}(e,t,r,a)]}var hE={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function hC(e,t,r){if(!r.cellStyles)return void(e.l+=t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2);2==a&&(e.l+=2);var c={s:n,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var hT=[2,3,48,49,131,139,140,245],hA=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=lD({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var a=r||{};a.dateNF||(a.dateNF="yyyymmdd");var n=dL(function(t,r){var a=[],n=o$(1);switch(r.type){case"base64":n=oW(oU(t));break;case"binary":n=oW(t);break;case"buffer":case"array":n=t}dm(n,0);var s=n.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw Error("DBF Unsupported Version: "+s.toString(16))}var c=0,d=521;2==s&&(c=n.read_shift(2)),n.l+=3,2!=s&&(c=n.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(d=n.read_shift(2));var u=n.read_shift(2),h=r.codepage||1252;2!=s&&(n.l+=16,n.read_shift(1),0!==n[n.l]&&(h=e[n[n.l]]),n.l+=1,n.l+=2),l&&(n.l+=36);for(var f=[],p={},m=Math.min(n.length,2==s?521:d-10-264*!!o),g=l?32:11;n.l<m&&13!=n[n.l];)switch((p={}).name=ee.utils.decode(h,n.slice(n.l,n.l+g)).replace(/[\u0000\r\n].*$/g,""),n.l+=g,p.type=String.fromCharCode(n.read_shift(1)),2!=s&&!l&&(p.offset=n.read_shift(4)),p.len=n.read_shift(1),2==s&&(p.offset=n.read_shift(2)),p.dec=n.read_shift(1),p.name.length&&f.push(p),2!=s&&(n.l+=l?13:14),p.type){case"B":(!o||8!=p.len)&&r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw Error("Unknown Field Type: "+p.type)}if(13!==n[n.l]&&(n.l=d-1),13!==n.read_shift(1))throw Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=d;var x=0,b=0;for(b=0,a[0]=[];b!=f.length;++b)a[0][b]=f[b].name;for(;c-- >0;){if(42===n[n.l]){n.l+=u;continue}for(++n.l,a[++x]=[],b=0,b=0;b!=f.length;++b){var y=n.slice(n.l,n.l+f[b].len);n.l+=f[b].len,dm(y,0);var v=ee.utils.decode(h,y);switch(f[b].type){case"C":v.trim().length&&(a[x][b]=v.replace(/\s+$/,""));break;case"D":8===v.length?a[x][b]=new Date(+v.slice(0,4),v.slice(4,6)-1,+v.slice(6,8)):a[x][b]=v;break;case"F":a[x][b]=parseFloat(v.trim());break;case"+":case"I":a[x][b]=l?0x80000000^y.read_shift(-4,"i"):y.read_shift(4,"i");break;case"L":switch(v.trim().toUpperCase()){case"Y":case"T":a[x][b]=!0;break;case"N":case"F":a[x][b]=!1;break;case"":case"?":break;default:throw Error("DBF Unrecognized L:|"+v+"|")}break;case"M":if(!i)throw Error("DBF Unexpected MEMO for type "+s.toString(16));a[x][b]="##MEMO##"+(l?parseInt(v.trim(),10):y.read_shift(4));break;case"N":(v=v.replace(/\u0000/g,"").trim())&&"."!=v&&(a[x][b]=+v||0);break;case"@":a[x][b]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":a[x][b]=new Date((y.read_shift(4)-2440588)*864e5+y.read_shift(4));break;case"Y":a[x][b]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*0x100000000;break;case"O":a[x][b]=-y.read_shift(-8,"f");break;case"B":if(o&&8==f[b].len){a[x][b]=y.read_shift(8,"f");break}case"G":case"P":y.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw Error("DBF Unsupported data type "+f[b].type)}}}if(2!=s&&n.l<n.length&&26!=n[n.l++])throw Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return r&&r.sheetRows&&(a=a.slice(0,r.sheetRows)),r.DBF=f,a}(t,a),a);return n["!cols"]=a.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete a.DBF,n}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return dI(r(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var n=r||{};if(+n.codepage>=0&&oO(+n.codepage),"string"==n.type)throw Error("Cannot write DBF to JS string");var s=dy(),i=mN(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<o.length;++d){if(((c[d]||{}).DBF||{}).name){o[d]=c[d].DBF.name,++h;continue}if(null!=o[d]){if(++h,"number"==typeof o[d]&&(o[d]=o[d].toString(10)),"string"!=typeof o[d])throw Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d){for(u=0;u<1024;++u)if(-1==o.indexOf(o[d]+"_"+u)){o[d]+="_"+u;break}}}}var p=dD(e["!ref"]),m=[],g=[],x=[];for(d=0;d<=p.e.c-p.s.c;++d){var b="",y="",v=0,w=[];for(u=0;u<l.length;++u)null!=l[u][d]&&w.push(l[u][d]);if(0==w.length||null==o[d]){m[d]="?";continue}for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":y="B";break;case"string":default:y="C";break;case"boolean":y="L";break;case"object":y=w[u]instanceof Date?"D":"C"}v=Math.max(v,String(w[u]).length),b=b&&b!=y?"C":y}v>250&&(v=250),"C"==(y=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>v&&(v=c[d].DBF.len),"B"==b&&"N"==y&&(b="N",x[d]=c[d].DBF.dec,v=c[d].DBF.len),g[d]="C"==b||"N"==y?v:a[b]||0,f+=g[d],m[d]=b}var k=s.next(32);for(k.write_shift(4,0x13021130),k.write_shift(4,l.length),k.write_shift(2,296+32*h),k.write_shift(2,f),d=0;d<4;++d)k.write_shift(4,0);for(k.write_shift(4,(+t[oC]||3)<<8),d=0,u=0;d<o.length;++d)if(null!=o[d]){var j=s.next(32),N=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,N,"sbcs"),j.write_shift(1,"?"==m[d]?"C":m[d],"sbcs"),j.write_shift(4,u),j.write_shift(1,g[d]||a[m[d]]||0),j.write_shift(1,x[d]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),u+=g[d]||a[m[d]]||0}var S=s.next(264);for(S.write_shift(4,13),d=0;d<65;++d)S.write_shift(4,0);for(d=0;d<l.length;++d){var E=s.next(f);for(E.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(m[u]){case"L":E.write_shift(1,null==l[d][u]?63:l[d][u]?84:70);break;case"B":E.write_shift(8,l[d][u]||0,"f");break;case"N":var C="0";for("number"==typeof l[d][u]&&(C=l[d][u].toFixed(x[u]||0)),h=0;h<g[u]-C.length;++h)E.write_shift(1,32);E.write_shift(1,C,"sbcs");break;case"D":l[d][u]?(E.write_shift(4,("0000"+l[d][u].getFullYear()).slice(-4),"sbcs"),E.write_shift(2,("00"+(l[d][u].getMonth()+1)).slice(-2),"sbcs"),E.write_shift(2,("00"+l[d][u].getDate()).slice(-2),"sbcs")):E.write_shift(8,"00000000","sbcs");break;case"C":var T=String(null!=l[d][u]?l[d][u]:"").slice(0,g[u]);for(E.write_shift(1,T,"sbcs"),h=0;h<g[u]-T.length;++h)E.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),h_=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=RegExp("\x1bN("+lO(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var a=e[r];return"number"==typeof a?oL(a):a},a=function(e,t,r){var a=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==a?e:oL(a)};function n(e,n){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],h=[],f=null,p={},m=[],g=[],x=[],b=0;for(+n.codepage>=0&&oO(+n.codepage);c!==i.length;++c){b=0;var y,v=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),w=v.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),k=w[0];if(v.length>0)switch(k){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(v.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,N=!1,S=!1,E=!1,C=-1,T=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,N=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,N||(l=0),s=u.length;s<=o;++s)u[s]=[];break;case"K":'"'===(y=w[d].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(lK(y))?isNaN(lY(y).getDate())||(y=lH(y)):(y=lK(y),null!==f&&ly(f)&&(y=lU(y))),void 0!==ee&&"string"==typeof y&&"string"!=(n||{}).type&&(n||{}).codepage&&(y=ee.utils.decode(n.codepage,y)),j=!0;break;case"E":E=!0;var A=fT(w[d].slice(1),{r:o,c:l});u[o][l]=[u[o][l],A];break;case"S":S=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":C=parseInt(w[d].slice(1))-1;break;case"C":T=parseInt(w[d].slice(1))-1;break;default:if(n&&n.WTF)throw Error("SYLK bad record "+v)}if(j&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=y:u[o][l]=y,f=null),S){if(E)throw Error("SYLK shared formula cannot have own formula");var _=C>-1&&u[C][T];if(!_||!_[1])throw Error("SYLK shared formula cannot find base");u[o][l][1]=fO(_[1],{r:o-C,c:l-T})}break;case"F":var O=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++O;break;case"Y":for(o=parseInt(w[d].slice(1))-1,s=u.length;s<=o;++s)u[s]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[d].slice(1))];break;case"W":for(s=parseInt((x=w[d].slice(1).split(" "))[0],10);s<=parseInt(x[1],10);++s)b=parseInt(x[2],10),g[s-1]=0===b?{hidden:!0}:{wch:b},fe(g[s-1]);break;case"C":g[l=parseInt(w[d].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(w[d].slice(1))-1]||(m[o]={}),b>0?(m[o].hpt=b,m[o].hpx=fr(b)):0===b&&(m[o].hidden=!0);break;default:if(n&&n.WTF)throw Error("SYLK bad record "+v)}O<1&&(f=null);break;default:if(n&&n.WTF)throw Error("SYLK bad record "+v)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),n&&n.sheetRows&&(u=u.slice(0,n.sheetRows)),[u,p]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return n(oU(e),t);case"binary":return n(e,t);case"buffer":return n(oz&&oN.Buffer.isBuffer(e)?e.toString("binary"):oG(e),t);case"array":return n(lW(e),t)}throw Error("Unrecognized type "+t.type)}(e,t),a=r[0],s=r[1],i=dL(a,t);return lO(s).forEach(function(e){i[e]=s[e]}),i}return e["|"]=254,{to_workbook:function(e,t){return dI(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,a=["ID;PWXL;N;E"],n=[],s=dD(e["!ref"]),i=Array.isArray(e);a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=h3(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=h6(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&a.push(r)}),e["!rows"]&&e["!rows"].forEach(function(e,t){var r="F;";e.hidden?r+="M0;":e.hpt?r+="M"+20*e.hpt+";":e.hpx&&(r+="M"+20*ft(e.hpx)+";"),r.length>2&&a.push(r+"R"+(t+1))}),a.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=d_({r:o,c:l});(r=i?(e[o]||[])[l]:e[c])&&(null!=r.v||r.f&&!r.F)&&n.push(function(e,t,r,a){var n="C;Y"+(r+1)+";X"+(a+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+f_(e.f,{r:r,c:a}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}(r,0,o,l,t))}return a.join("\r\n")+"\r\n"+n.join("\r\n")+"\r\nE\r\n"}}}(),hO=function(){var e,t;function r(e,t){for(var r=e.split("\n"),a=-1,n=-1,s=0,i=[];s!==r.length;++s){if("BOT"===r[s].trim()){i[++a]=[],n=0;continue}if(!(a<0)){for(var o=r[s].trim().split(","),l=o[0],c=o[1],d=r[++s]||"";1&(d.match(/["]/g)||[]).length&&s<r.length-1;)d+="\n"+r[++s];switch(d=d.trim(),+l){case -1:if("BOT"===d){i[++a]=[],n=0;continue}if("EOD"!==d)throw Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[a][n]=!0:"FALSE"===d?i[a][n]=!1:isNaN(lK(c))?isNaN(lY(c).getDate())?i[a][n]=c:i[a][n]=lH(c):i[a][n]=lK(c),++n;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[a][n++]=""!==d?d:null}if("EOD"===d)break}}return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function a(e,t){return dL(function(e,t){switch(t.type){case"base64":return r(oU(e),t);case"binary":return r(e,t);case"buffer":return r(oz&&oN.Buffer.isBuffer(e)?e.toString("binary"):oG(e),t);case"array":return r(lW(e),t)}throw Error("Unrecognized type "+t.type)}(e,t),t)}return{to_workbook:function(e,t){return dI(a(e,t),t)},to_sheet:a,from_sheet:(e=function(e,t,r,a,n){e.push(t),e.push(r+","+a),e.push('"'+n.replace(/"/g,'""')+'"')},t=function(e,t,r,a){e.push(t+","+r),e.push(1==t?'"'+a.replace(/"/g,'""')+'"':a)},function(r){var a,n=[],s=dD(r["!ref"]),i=Array.isArray(r);e(n,"TABLE",0,1,"sheetjs"),e(n,"VECTORS",0,s.e.r-s.s.r+1,""),e(n,"TUPLES",0,s.e.c-s.s.c+1,""),e(n,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(n,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=d_({r:o,c:l});if(!(a=i?(r[o]||[])[l]:r[c])){t(n,1,0,"");continue}switch(a.t){case"n":var d=a.w;d||null==a.v||(d=a.v),null==d?!a.f||a.F?t(n,1,0,""):t(n,1,0,"="+a.f):t(n,0,d,"V");break;case"b":t(n,0,+!!a.v,a.v?"TRUE":"FALSE");break;case"s":t(n,1,0,isNaN(a.v)?a.v:'="'+a.v+'"');break;case"d":a.w||(a.w=lk(a.z||o6[14],lI(lH(a.v)))),t(n,0,a.w,"V");break;default:t(n,1,0,"")}}}return t(n,-1,0,"EOD"),n.join("\r\n")})}}(),hP=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return dL(function(e,t){for(var r=e.split("\n"),a=-1,n=-1,s=0,i=[];s!==r.length;++s){var o=r[s].trim().split(":");if("cell"===o[0]){var l=dA(o[1]);if(i.length<=l.r)for(a=i.length;a<=l.r;++a)i[a]||(i[a]=[]);switch(a=l.r,n=l.c,o[2]){case"t":i[a][n]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":i[a][n]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?i[a][n]=!!+o[4]:i[a][n]=+o[4],"vtf"==o[2]&&(i[a][n]=[i[a][n],c])}}}return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}(e,t),t)}var r="--SocialCalcSpreadsheetControlSave\nContent-type: text/plain; charset=UTF-8\n";return{to_workbook:function(e,r){return dI(t(e,r),r)},to_sheet:t,from_sheet:function(t){return["socialcalc:version:1.5\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave",r,"# SocialCalc Spreadsheet Control Save\npart:sheet",r,function(t){if(!t||!t["!ref"])return"";for(var r,a=[],n=[],s="",i=dO(t["!ref"]),o=Array.isArray(t),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=d_({r:l,c:c}),(r=o?(t[l]||[])[c]:t[s])&&null!=r.v&&"z"!==r.t){switch(n=["cell",s,"t"],r.t){case"s":case"str":n.push(e(r.v));break;case"n":r.f?(n[2]="vtf",n[3]="n",n[4]=r.v,n[5]=e(r.f)):(n[2]="v",n[3]=r.v);break;case"b":n[2]="vt"+(r.f?"f":"c"),n[3]="nl",n[4]=r.v?"1":"0",n[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=lI(lH(r.v));n[2]="vtc",n[3]="nd",n[4]=""+d,n[5]=r.w||lk(r.z||o6[14],d);break;case"e":continue}a.push(n.join(":"))}return a.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}(t),"--SocialCalcSpreadsheetControlSave--"].join("\n")}}}(),hD=function(){function e(e,t,r,a,n){n.raw?t[r][a]=e:""===e||("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(lK(e))?isNaN(lY(e).getDate())?t[r][a]=e:t[r][a]=lH(e):t[r][a]=lK(e))}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(e){for(var a={},n=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?n=!n:!n&&i in t&&(a[i]=(a[i]||0)+1);for(s in i=[],a)Object.prototype.hasOwnProperty.call(a,s)&&i.push([a[s],s]);if(!i.length)for(s in a=r)Object.prototype.hasOwnProperty.call(a,s)&&i.push([a[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function n(t,r){var n,s="",i="string"==r.type?[0,0,0,0]:mx(t,r);switch(r.type){case"base64":s=oU(t);break;case"binary":case"string":s=t;break;case"buffer":s=65001==r.codepage?t.toString("utf8"):r.codepage&&void 0!==ee?ee.utils.decode(r.codepage,t):oz&&oN.Buffer.isBuffer(t)?t.toString("binary"):oG(t);break;case"array":s=lW(t);break;default:throw Error("Unrecognized type "+r.type)}return(239==i[0]&&187==i[1]&&191==i[2]?s=ck(s.slice(3)):"string"!=r.type&&"buffer"!=r.type&&65001==r.codepage?s=ck(s):"binary"==r.type&&void 0!==ee&&r.codepage&&(s=ee.utils.decode(r.codepage,ee.utils.encode(28591,s))),"socialcalc:version:"==s.slice(0,19))?hP.to_sheet("string"==r.type?s:ck(s),r):(n=s,!(r&&r.PRN)||r.FS||"sep="==n.slice(0,4)||n.indexOf("	")>=0||n.indexOf(",")>=0||n.indexOf(";")>=0?function(e,t){var r,n=t||{},s="",i=n.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(s=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(s=e.charAt(4),e=e.slice(6)):s=a(e.slice(0,1024)):s=n&&n.FS?n.FS:a(e.slice(0,1024));var l=0,c=0,d=0,u=0,h=0,f=s.charCodeAt(0),p=!1,m=0,g=e.charCodeAt(0);e=e.replace(/\r\n/mg,"\n");var x=null!=n.dateNF?RegExp("^"+("number"==typeof(r=n.dateNF)?o6[r]:r).replace(lC,"(\\d+)")+"$"):null;function b(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(d=lK(t)))if(!isNaN(lY(t).getDate())||x&&t.match(x)){r.z=n.dateNF||o6[14];var a,s,p,b,y,v,w,k,j,N,S=0;x&&t.match(x)&&(a=n.dateNF,s=t.match(x)||[],p=-1,b=-1,y=-1,v=-1,w=-1,k=-1,(a.match(lC)||[]).forEach(function(e,t){var r=parseInt(s[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":p=r;break;case"d":y=r;break;case"h":v=r;break;case"s":k=r;break;case"m":v>=0?w=r:b=r}}),k>=0&&-1==w&&b>=0&&(w=b,b=-1),7==(j=(""+(p>=0?p:new Date().getFullYear())).slice(-4)+"-"+("00"+(b>=1?b:1)).slice(-2)+"-"+("00"+(y>=1?y:1)).slice(-2)).length&&(j="0"+j),8==j.length&&(j="20"+j),N=("00"+(v>=0?v:0)).slice(-2)+":"+("00"+(w>=0?w:0)).slice(-2)+":"+("00"+(k>=0?k:0)).slice(-2),t=-1==v&&-1==w&&-1==k?j:-1==p&&-1==b&&-1==y?N:j+"T"+N,S=1),n.cellDates?(r.t="d",r.v=lH(t,S)):(r.t="n",r.v=lI(lH(t,S))),!1!==n.cellText&&(r.w=lk(r.z,r.v instanceof Date?lI(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=d;if("z"==r.t||(n.dense?(i[l]||(i[l]=[]),i[l][c]=r):i[d_({c:c,r:l})]=r),u=h+1,g=e.charCodeAt(u),o.e.c<c&&(o.e.c=c),o.e.r<l&&(o.e.r=l),m==f)++c;else if(c=0,++l,n.sheetRows&&n.sheetRows<=l)return!0}e:for(;h<e.length;++h)switch(m=e.charCodeAt(h)){case 34:34===g&&(p=!p);break;case f:case 10:case 13:if(!p&&b())break e}return h-u>0&&b(),i["!ref"]=dP(o),i}(n,r):dL(function(t,r){var a=r||{},n=[];if(!t||0===t.length)return n;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){n[c]=[];var d=0;for(e(s[c].slice(0,o).trim(),n,c,d,a),d=1;d<=(s[c].length-o)/10+1;++d)e(s[c].slice(o+(d-1)*10,o+10*d).trim(),n,c,d,a)}return a.sheetRows&&(n=n.slice(0,a.sheetRows)),n}(n,r),r))}return{to_workbook:function(e,t){return dI(n(e,t),t)},to_sheet:n,from_sheet:function(e){for(var t,r=[],a=dD(e["!ref"]),n=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){for(var i=[],o=a.s.c;o<=a.e.c;++o){var l=d_({r:s,c:o});if(!(t=n?(e[s]||[])[o]:e[l])||null==t.v){i.push("          ");continue}for(var c=(t.w||(dM(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}r.push(i.join(""))}return r.join("\n")}}}(),hR=function(){function e(e,t,r){if(e){dm(e,e.l||0);for(var a=r.Enum||u;e.l<e.length;){var n=e.read_shift(2),s=a[n]||a[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,r);if(e.l=o,t(l,s,n))return}}}function t(t,r){if(!t)return t;var a=r||{},n=a.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],d=[],f={s:{r:0,c:0},e:{r:0,c:0}},p=a.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw Error("Unsupported Works 3 for Mac file");if(2==t[2])a.Enum=u,e(t,function(e,t,r){switch(r){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:f=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&(112&e[2])==112&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||o6[14],a.cellDates&&(e[1].t="d",e[1].v=lU(e[1].v))),a.qpro&&e[3]>o&&(n["!ref"]=dP(f),l[s]=n,c.push(s),n=a.dense?[]:{},f={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var d=a.dense?(n[e[0].r]||[])[e[0].c]:n[d_(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[d_(e[0])]=e[1]}},a);else if(26==t[2]||14==t[2])a.Enum=h,14==t[2]&&(a.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(n["!ref"]=dP(f),l[s]=n,c.push(s),n=a.dense?[]:{},f={s:{r:0,c:0},e:{r:0,c:0}},s="Sheet"+((o=e[3])+1)),p>0&&e[0].r>=p)break;a.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[d_(e[0])]=e[1],f.e.c<e[0].c&&(f.e.c=e[0].c),f.e.r<e[0].r&&(f.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(s=e[1])}},a);else throw Error("Unrecognized LOTUS BOF "+t[2]);if(n["!ref"]=dP(f),l[i||s]=n,c.push(i||s),!d.length)return{SheetNames:c,Sheets:l};for(var m={},g=[],x=0;x<d.length;++x)l[c[x]]?(g.push(d[x]||c[x]),m[d[x]]=l[d[x]]||l[c[x]]):(g.push(d[x]),m[d[x]]={"!ref":"A1"});return{SheetNames:g,Sheets:m}}function r(e,t,r){var a=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(a[0].c=e.read_shift(1),a[3]=e.read_shift(1),a[0].r=e.read_shift(2),e.l+=2):(a[2]=e.read_shift(1),a[0].c=e.read_shift(2),a[0].r=e.read_shift(2)),a}function a(e,t,a){var n=e.l+t,s=r(e,t,a);if(s[1].t="s",20768==a.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return a.qpro&&e.l++,s[1].v=e.read_shift(n-e.l,"cstr"),s}function n(e,t,r){var a=32768&t;return t&=-32769,t=(a?e:0)+(t>=8192?t-16384:t),(a?"":"$")+(r?dT(t):dE(t))}var s={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},i=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function o(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function l(e,t){var r=o(e,t),a=e.read_shift(4),n=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===a&&0xc0000000===n?(r[1].t="e",r[1].v=15):0===a&&0xd0000000===n?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(n*Math.pow(2,s+32)+a*Math.pow(2,s)),r}function c(e,t){var r=o(e,t),a=e.read_shift(8,"f");return r[1].v=a,r}function d(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}var u={0:{n:"BOF",f:u2},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var a={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(a.s.c=e.read_shift(1),e.l++,a.s.r=e.read_shift(2),a.e.c=e.read_shift(1),e.l++,a.e.r=e.read_shift(2)):(a.s.c=e.read_shift(2),a.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),a.e.c=e.read_shift(2),a.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==a.s.c&&(a.s.c=a.e.c=a.s.r=a.e.r=0)),a}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,a){var n=r(e,t,a);return n[1].v=e.read_shift(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,a){var n=r(e,t,a);return n[1].v=e.read_shift(8,"f"),n}},15:{n:"LABEL",f:a},16:{n:"FORMULA",f:function(e,t,a){var o=e.l+t,l=r(e,t,a);if(l[1].v=e.read_shift(8,"f"),a.qpro)e.l=o;else{var c=e.read_shift(2);(function(e,t){dm(e,0);for(var r=[],a=0,o="",l="",c="",d="";e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:l=n(t[0].c,e.read_shift(2),!0),o=n(t[0].r,e.read_shift(2),!1),r.push(l+o);break;case 2:var h=n(t[0].c,e.read_shift(2),!0),f=n(t[0].r,e.read_shift(2),!1);l=n(t[0].c,e.read_shift(2),!0),o=n(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+l+o);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var p="";u=e[e.l++];)p+=String.fromCharCode(u);r.push('"'+p.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),c=r.pop(),r.push(["AND","OR"][u-20]+"("+c+","+d+")");break;default:if(u<32&&i[u])d=r.pop(),c=r.pop(),r.push(c+i[u]+d);else if(s[u]){if(69==(a=s[u][1])&&(a=e[e.l++]),a>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var m=r.slice(-a);r.length-=a,r.push(s[u][0]+"("+m.join(",")+")")}else if(u<=7)return console.error("WK1 invalid opcode "+u.toString(16));else if(u<=24)return console.error("WK1 unsupported op "+u.toString(16));else if(u<=30)return console.error("WK1 invalid opcode "+u.toString(16));else if(u<=115)return console.error("WK1 unsupported function opcode "+u.toString(16));else return console.error("WK1 unrecognized opcode "+u.toString(16))}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")})(e.slice(e.l,e.l+c),l),e.l+=c}return l}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:a},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:d},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var a="";a.length<r;)a+=String.fromCharCode(e[e.l++]);return a}},65535:{n:""}},h={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=o(e,t);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:l},24:{n:"NUMBER18",f:function(e,t){var r=o(e,t);r[1].v=e.read_shift(2);var a=r[1].v>>1;if(1&r[1].v)switch(7&a){case 0:a=(a>>3)*5e3;break;case 1:a=(a>>3)*500;break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64}return r[1].v=a,r}},25:{n:"FORMULA19",f:function(e,t){var r=l(e,14);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},a=e.l+t;e.l<a;){var n=e.read_shift(2);if(14e3==n){for(r[n]=[0,""],r[n][0]=e.read_shift(2);e[e.l];)r[n][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=o(e,t),a=e.read_shift(4);return r[1].v=a>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:c},40:{n:"FORMULA28",f:function(e,t){var r=c(e,14);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:d},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var a=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[a,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r,a,n,s,i=t||{};if(+i.codepage>=0&&oO(+i.codepage),"string"==i.type)throw Error("Cannot write WK1 to JS string");var o=dy(),l=dD(e["!ref"]),c=Array.isArray(e),d=[];pX(o,0,(r=1030,(a=dx(2)).write_shift(2,1030),a)),pX(o,6,(n=l,(s=dx(8)).write_shift(2,n.s.c),s.write_shift(2,n.s.r),s.write_shift(2,n.e.c),s.write_shift(2,n.e.r),s));for(var u=Math.min(l.e.r,8191),h=l.s.r;h<=u;++h)for(var f=dE(h),p=l.s.c;p<=l.e.c;++p){h===l.s.r&&(d[p]=dT(p));var m=d[p]+f,g=c?(e[h]||[])[p]:e[m];g&&"z"!=g.t&&("n"==g.t?(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?pX(o,13,function(e,t,r){var a=dx(7);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r,"i"),a}(h,p,g.v)):pX(o,14,function(e,t,r){var a=dx(13);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(8,r,"f"),a}(h,p,g.v)):pX(o,15,function(e,t,r){var a=dx(7+r.length);a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(1,39);for(var n=0;n<a.length;++n){var s=r.charCodeAt(n);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}(h,p,dM(g).slice(0,239))))}return pX(o,1),o.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&oO(+r.codepage),"string"==r.type)throw Error("Cannot write WK3 to JS string");var a=dy();pX(a,0,function(e){var t=dx(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,a=0,n=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++n;var l=dO(o["!ref"]);r<l.e.r&&(r=l.e.r),a<l.e.c&&(a=l.e.c)}}return r>8191&&(r=8191),t.write_shift(2,r),t.write_shift(1,n),t.write_shift(1,a),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var n=0,s=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&pX(a,27,function(e,t){var r=dx(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var a=0;a<e.length;++a){var n=e.charCodeAt(a);r[r.l++]=n>127?95:n}return r[r.l++]=0,r}(e.SheetNames[n],s++));var i=0;for(n=0;n<e.SheetNames.length;++n){var o=e.Sheets[e.SheetNames[n]];if(o&&o["!ref"]){for(var l=dD(o["!ref"]),c=Array.isArray(o),d=[],u=Math.min(l.e.r,8191),h=l.s.r;h<=u;++h)for(var f=dE(h),p=l.s.c;p<=l.e.c;++p){h===l.s.r&&(d[p]=dT(p));var m=d[p]+f,g=c?(o[h]||[])[p]:o[m];g&&"z"!=g.t&&("n"==g.t?pX(a,23,function(e,t,r,a){var n=dx(14);if(n.write_shift(2,e),n.write_shift(1,r),n.write_shift(1,t),0==a)return n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,65535),n;var s=0,i=0,o=0,l=0;return a<0&&(s=1,a=-a),i=0|Math.log2(a),a/=Math.pow(2,i-31),(0x80000000&(l=a>>>0))==0&&(a/=2,++i,l=a>>>0),a-=l,l|=0x80000000,l>>>=0,a*=0x100000000,o=a>>>0,n.write_shift(4,o),n.write_shift(4,l),i+=16383+32768*!!s,n.write_shift(2,i),n}(h,p,i,g.v)):pX(a,22,function(e,t,r,a){var n=dx(6+a.length);n.write_shift(2,e),n.write_shift(1,r),n.write_shift(1,t),n.write_shift(1,39);for(var s=0;s<a.length;++s){var i=a.charCodeAt(s);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}(h,p,i,dM(g).slice(0,239))))}++i}}return pX(a,1),a.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(oW(oU(e)),r);case"binary":return t(oW(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}(),hM=function(){var e=cN("t"),t=cN("rPr");function r(r){var a=r.match(e);if(!a)return{t:"s",v:""};var n={t:"s",v:cc(a[1])},s=r.match(t);return s&&(n.s=function(e){var t={},r=e.match(cr),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=cs(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=oA[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":case"<color>":case"<color/>":case"</color>":case"<family>":case"<family/>":case"</family>":case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<family":t.family=s.val;break;case"<vertAlign":t.valign=s.val;break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==s[0].charCodeAt(1)&&!n)throw Error("Unrecognized rich format "+s[0])}}return t}(s[1])),n}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(e){return e.replace(a,"").split(n).map(r).filter(function(e){return e.v})}}(),hI=function(){var e=/(\r\n|\n)/g;function t(t){var r,a,n,s,i,o=[[],t.v,[]];return t.v?(t.s&&(r=t.s,a=o[0],n=o[2],s=[],r.u&&s.push("text-decoration: underline;"),r.uval&&s.push("text-underline-style:"+r.uval+";"),r.sz&&s.push("font-size:"+r.sz+"pt;"),r.outline&&s.push("text-effect: outline;"),r.shadow&&s.push("text-shadow: auto;"),a.push('<span style="'+s.join("")+'">'),r.b&&(a.push("<b>"),n.push("</b>")),r.i&&(a.push("<i>"),n.push("</i>")),r.strike&&(a.push("<s>"),n.push("</s>")),"superscript"==(i=r.valign||"")||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(a.push("<"+i+">"),n.push("</"+i+">")),n.push("</span>")),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(e){return e.map(t).join("")}}(),hL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,hF=/<(?:\w+:)?r>/,hB=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hU(e,t){var r=!t||t.cellHTML,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=cc(ck(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=ck(e),r&&(a.h=cm(a.t))):e.match(hF)&&(a.r=ck(e),a.t=cc(ck((e.replace(hB,"").match(hL)||[]).join("").replace(cr,""))),r&&(a.h=hI(hM(a.r)))),a):{t:""}}var hz=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hV=/<(?:\w+:)?(?:si|sstItem)>/g,h$=/<\/(?:\w+:)?(?:si|sstItem)>/,hH=/^\s|\s$|[\t\n\r]/;function hW(e,t){if(!t.bookSST)return"";var r=[l9];r[r.length]=cD("sst",null,{xmlns:cV[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(null!=e[a]){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(hH)&&(s+=' xml:space="preserve"'),s+=">"+ch(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var hq=function(e,t){var r=!1;return null==t&&(r=!0,t=dx(15+4*e.t.length)),t.write_shift(1,0),dU(e.t,t),r?t.slice(0,t.l):t};function hG(e){if(void 0!==ee)return ee.utils.encode(oC,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function hK(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function hX(e,t){var r=e.l+t,a={};a.Flags=63&e.read_shift(4),e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=36==a.Flags;break;case 26625:n=4==a.Flags;break;case 0:n=16==a.Flags||4==a.Flags||36==a.Flags;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function hY(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function hQ(e){var t,r,a=0,n=hG(e),s=n.length+1;for(r=1,(t=o$(s))[0]=n.length;r!=s;++r)t[r]=n[r-1];for(r=s-1;r>=0;--r)a=((16384&a)!=0|a<<1&32767)^t[r];return 52811^a}var hJ=(O=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],P=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],D=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],R=function(e,t){var r;return((r=e^t)/2|128*r)&255},M=function(e){for(var t=P[e.length-1],r=104,a=e.length-1;a>=0;--a)for(var n=e[a],s=0;7!=s;++s)64&n&&(t^=D[r]),n*=2,--r;return t},function(e){for(var t,r,a,n=hG(e),s=M(n),i=n.length,o=o$(16),l=0;16!=l;++l)o[l]=0;for((1&i)==1&&(t=s>>8,o[i]=R(O[0],t),--i,t=255&s,r=n[n.length-1],o[i]=R(r,t));i>0;)--i,t=s>>8,o[i]=R(n[i],t),--i,t=255&s,o[i]=R(n[i],t);for(i=15,a=15-n.length;a>0;)t=s>>8,o[i]=R(O[a],t),--i,--a,t=255&s,o[i]=R(n[i],t),--i,--a;return o}),hZ=function(e,t,r,a,n){var s,i;for(n||(n=t),a||(a=hJ(e)),s=0;s!=t.length;++s)i=((i=t[s]^a[r])>>5|i<<3)&255,n[s]=i,++r;return[n,r,a]},h0=function(e){var t=0,r=hJ(e);return function(e){var a=hZ("",e,t,r);return t=a[1],a[0]}},h1=function(){function e(e,r){switch(r.type){case"base64":return t(oU(e),r);case"binary":return t(e,r);case"buffer":return t(oz&&oN.Buffer.isBuffer(e)?e.toString("binary"):oG(e),r);case"array":return t(lW(e),r)}throw Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},a=e.match(/\\trowd.*?\\row\b/g);if(!a.length)throw Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var a,s=/\\\w+\b/g,i=0,o=-1;a=s.exec(e);){if("\\cell"===a[0]){var l=e.slice(i,s.lastIndex-a[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[d_({r:t,c:o})]=c}}i=s.lastIndex}o>n.e.c&&(n.e.c=o)}),r["!ref"]=dP(n),r}return{to_workbook:function(t,r){return dI(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],a=dD(e["!ref"]),n=Array.isArray(e),s=a.s.r;s<=a.e.r;++s){r.push("\\trowd\\trautofit1");for(var i=a.s.c;i<=a.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=a.s.c;i<=a.e.c;++i){var o=d_({r:s,c:i});(t=n?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(dM(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function h2(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function h5(e,t){if(0===t)return e;var r,a=function(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),i=n-s;if(0===i)return[0,0,t];var o=0,l=0,c=n+s;switch(l=i/(c>1?2-c:c),n){case t:o=((r-a)/i+6)%6;break;case r:o=(a-t)/i+2;break;case a:o=(t-r)/i+4}return[o/6,l,c/2]}([parseInt((r=e.slice(+("#"===e[0])).slice(0,6)).slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]);return t<0?a[2]=a[2]*(1+t):a[2]=1-(1-a[2])*(1-t),h2(function(e){var t,r=e[0],a=e[1],n=e[2],s=2*a*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],l=6*r;if(0!==a)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(a))}var h4=6;function h3(e){return Math.floor((e+Math.round(128/h4)/256)*h4)}function h6(e){return Math.floor((e-5)/h4*100+.5)/100}function h8(e){return Math.round((e*h4+5)/h4*256)/256}function h7(e){return h8(h6(h3(e)))}function h9(e){var t=Math.abs(e-h7(e)),r=h4;if(t>.005)for(h4=1;h4<15;++h4)Math.abs(e-h7(e))<=t&&(t=Math.abs(e-h7(e)),r=h4);h4=r}function fe(e){e.width?(e.wpx=h3(e.width),e.wch=h6(e.wpx),e.MDW=h4):e.wpx?(e.wch=h6(e.wpx),e.width=h8(e.wch),e.MDW=h4):"number"==typeof e.wch&&(e.width=h8(e.wch),e.wpx=h3(e.width),e.MDW=h4),e.customWidth&&delete e.customWidth}function ft(e){return 96*e/96}function fr(e){return 96*e/96}var fa={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},fn=["numFmtId","fillId","fontId","borderId","xfId"],fs=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],fi=(I=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,L=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,F=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,B=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,U=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(e,t,r){var a,n,s,i,o,l,c,d,u,h,f,p,m,g={};return e?((m=(e=e.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(I))&&function(e,t,r){t.NumberFmt=[];for(var a=lO(o6),n=0;n<a.length;++n)t.NumberFmt[a[n]]=o6[a[n]];var s=e[0].match(cr);if(s)for(n=0;n<s.length;++n){var i=cs(s[n]);switch(ci(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=cc(ck(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}lj(o,l)}break;default:if(r.WTF)throw Error("unrecognized "+i[0]+" in numFmts")}}}(m,g,r),(m=e.match(B))&&(a=m,g.Fonts=[],n={},s=!1,(a[0].match(cr)||[]).forEach(function(e){var a=cs(e);switch(ci(a[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":g.Fonts.push(n),n={};break;case"<name":a.val&&(n.name=ck(a.val));break;case"<b":n.bold=a.val?cx(a.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=a.val?cx(a.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(a.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=a.val?cx(a.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=a.val?cx(a.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=a.val?cx(a.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=a.val?cx(a.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=a.val?cx(a.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":a.val&&(n.sz=+a.val);break;case"<vertAlign":a.val&&(n.vertAlign=a.val);break;case"<family":a.val&&(n.family=parseInt(a.val,10));break;case"<scheme":a.val&&(n.scheme=a.val);break;case"<charset":if("1"==a.val)break;a.codepage=oA[parseInt(a.val,10)];break;case"<color":if(n.color||(n.color={}),a.auto&&(n.color.auto=cx(a.auto)),a.rgb)n.color.rgb=a.rgb.slice(-6);else if(a.indexed){n.color.index=parseInt(a.indexed,10);var i=d8[n.color.index];81==n.color.index&&(i=d8[1]),i||(i=d8[1]),n.color.rgb=i[0].toString(16)+i[1].toString(16)+i[2].toString(16)}else a.theme&&(n.color.theme=parseInt(a.theme,10),a.tint&&(n.color.tint=parseFloat(a.tint)),a.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=h5(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw Error("unrecognized "+a[0]+" in fonts")}})),(m=e.match(F))&&(i=m,g.Fills=[],o={},l=!1,(i[0].match(cr)||[]).forEach(function(e){var t=cs(e);switch(ci(t[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":o={},g.Fills.push(o);break;case"<gradientFill":case"</gradientFill>":g.Fills.push(o),o={};break;case"<patternFill":case"<patternFill>":t.patternType&&(o.patternType=t.patternType);break;case"<bgColor":o.bgColor||(o.bgColor={}),t.indexed&&(o.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(o.bgColor.theme=parseInt(t.theme,10)),t.tint&&(o.bgColor.tint=parseFloat(t.tint)),t.rgb&&(o.bgColor.rgb=t.rgb.slice(-6));break;case"<fgColor":o.fgColor||(o.fgColor={}),t.theme&&(o.fgColor.theme=parseInt(t.theme,10)),t.tint&&(o.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(o.fgColor.rgb=t.rgb.slice(-6));break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(r&&r.WTF&&!l)throw Error("unrecognized "+t[0]+" in fills")}})),(m=e.match(U))&&(c=m,g.Borders=[],d={},u=!1,(c[0].match(cr)||[]).forEach(function(e){var t=cs(e);switch(ci(t[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":d={},t.diagonalUp&&(d.diagonalUp=cx(t.diagonalUp)),t.diagonalDown&&(d.diagonalDown=cx(t.diagonalDown)),g.Borders.push(d);break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(r&&r.WTF&&!u)throw Error("unrecognized "+t[0]+" in borders")}})),(m=e.match(L))&&(h=m,g.CellXf=[],p=!1,(h[0].match(cr)||[]).forEach(function(e){var t=cs(e),a=0;switch(ci(t[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(f=t,delete f[0],a=0;a<fn.length;++a)f[fn[a]]&&(f[fn[a]]=parseInt(f[fn[a]],10));for(a=0;a<fs.length;++a)f[fs[a]]&&(f[fs[a]]=cx(f[fs[a]]));if(g.NumberFmt&&f.numFmtId>392){for(a=392;a>60;--a)if(g.NumberFmt[f.numFmtId]==g.NumberFmt[a]){f.numFmtId=a;break}}g.CellXf.push(f);break;case"<alignment":case"<alignment/>":var n={};t.vertical&&(n.vertical=t.vertical),t.horizontal&&(n.horizontal=t.horizontal),null!=t.textRotation&&(n.textRotation=t.textRotation),t.indent&&(n.indent=t.indent),t.wrapText&&(n.wrapText=cx(t.wrapText)),f.alignment=n;break;case"<AlternateContent":case"<ext":p=!0;break;case"</AlternateContent>":case"</ext>":p=!1;break;default:if(r&&r.WTF&&!p)throw Error("unrecognized "+t[0]+" in cellXfs")}})),g):g});function fo(e,t){var r,a,n,s,i,o=[l9,cD("styleSheet",null,{xmlns:cV[0],"xmlns:vt":cU})];return e.SSF&&null!=(r=e.SSF,a=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=r[t]&&(a[a.length]=cD("numFmt",null,{numFmtId:t,formatCode:ch(r[t])}))}),i=1===a.length?"":(a[a.length]="</numFmts>",a[0]=cD("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join("")))&&(o[o.length]=i),o[o.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',o[o.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',o[o.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',o[o.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',n=t.cellXfs,(s=[])[s.length]=cD("cellXfs",null),n.forEach(function(e){s[s.length]=cD("xf",null,e)}),s[s.length]="</cellXfs>",(i=2===s.length?"":(s[0]=cD("cellXfs",null,{count:s.length-2}).replace("/>",">"),s.join("")))&&(o[o.length]=i),o[o.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',o[o.length]='<dxfs count="0"/>',o[o.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',o.length>2&&(o[o.length]="</styleSheet>",o[1]=o[1].replace("/>",">")),o.join("")}var fl=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fc(e,t){t||(t=dx(84)),er||(er=lD(fl));var r=er[e.patternType];null==r&&(r=40),t.write_shift(4,r);var a=0;if(40!=r)for(d0({auto:1},t),d0({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function fd(e,t,r){return r||(r=dx(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function fu(e,t){return t||(t=dx(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var fh=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ff(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(cr)||[]).forEach(function(e){var n=cs(e);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===n[0].charAt(1)?(t.themeElements.clrScheme[fh.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw Error("Unrecognized "+n[0]+" in clrScheme")}})}function fp(){}function fm(){}var fg=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fx=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fb=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,fy=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fv(e,t){e&&0!==e.length||(e=fw());var r,a,n,s={};if(!(n=e.match(fy)))throw Error("themeElements not found in theme");return r=n[0],s.themeElements={},[["clrScheme",fg,ff],["fontScheme",fx,fp],["fmtScheme",fb,fm]].forEach(function(e){if(!(a=r.match(e[1])))throw Error(e[0]+" not found in themeElements");e[2](a,s,t)}),s.raw=e,s}function fw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[l9];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function fk(){var e=[l9];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var fj=1024;function fN(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[cD("xml",null,{"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":c$,"xmlns:x":cH,"xmlns:mv":"http://macVmlSchemaUri"}).replace(/\/>/,">"),cD("o:shapelayout",cD("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),cD("v:shapetype",[cD("v:stroke",null,{joinstyle:"miter"}),cD("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];fj<1e3*e;)fj+=1e3;return t.forEach(function(e){var t=dA(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var a="gradient"==r.type?cD("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=cD("v:fill",a,r);++fj,n=n.concat(["<v:shape"+cP({id:"_x0000_s"+fj,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,cD("v:shadow",null,{on:"t",obscured:"t"}),cD("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cO("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),cO("x:AutoFill","False"),cO("x:Row",String(t.r)),cO("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function fS(e,t,r,a){var n,s=Array.isArray(e);t.forEach(function(t){var i=dA(t.ref);if(s?(e[i.r]||(e[i.r]=[]),n=e[i.r][i.c]):n=e[t.ref],!n){n={t:"z"},s?e[i.r][i.c]=n:e[t.ref]=n;var o=dD(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=dP(o);l!==e["!ref"]&&(e["!ref"]=l)}n.c||(n.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=n.c.length-1;d>=0;--d){if(!r&&n.c[d].T)return;r&&!n.c[d].T&&n.c.splice(d,1)}if(r&&a){for(d=0;d<a.length;++d)if(c.a==a[d].id){c.a=a[d].name||c.a;break}}n.c.push(c)})}function fE(e){var t=[l9,cD("comments",null,{xmlns:cV[0]})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var a=ch(e.a);-1==r.indexOf(a)&&(r.push(a),t.push("<author>"+a+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var a=0,n=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?a=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(a=r.indexOf(ch(e.a))),n.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+a+'"><text>'),n.length<=1)t.push(cO("t",ch(n[0]||"")));else{for(var s="Comment:\n    "+n[0]+"\n",i=1;i<n.length;++i)s+="Reply:\n    "+n[i]+"\n";t.push(cO("t",ch(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}var fC=["xlsb","xlsm","xlam","biff8","xla"],fT=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,a,n){var s=!1,i=!1;0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1)),0==n.length?s=!0:"["==n.charAt(0)&&(s=!0,n=n.slice(1,-1));var o=a.length>0?0|parseInt(a,10):0,l=n.length>0?0|parseInt(n,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,r+(s?"":"$")+dT(l)+(i?"":"$")+dE(o)}return function(a,n){return t=n,a.replace(e,r)}}(),fA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,f_=function(e,t){return e.replace(fA,function(e,r,a,n,s,i){var o=dC(n)-(a?0:t.c),l=dS(i)-(s?0:t.r);return r+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":a?o+1:"["+o+"]")})};function fO(e,t){return e.replace(fA,function(e,r,a,n,s,i){return r+("$"==a?a+n:dT(dC(n)+t.c))+("$"==s?s+i:dE(dS(i)+t.r))})}function fP(e){return e.replace(/_xlfn\./g,"")}function fD(e){e.l+=1}function fR(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function fM(e,t,r){var a=2;if(r)if(r.biff>=2&&r.biff<=5)return fI(e,t,r);else 12==r.biff&&(a=4);var n=e.read_shift(a),s=e.read_shift(a),i=fR(e,2),o=fR(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function fI(e){var t=fR(e,2),r=fR(e,2),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function fL(e,t,r){if(r&&r.biff>=2&&r.biff<=5){var a,n,s;return n=fR(a=e,2),s=a.read_shift(1),{r:n[0],c:s,cRel:n[1],rRel:n[2]}}var i=e.read_shift(r&&12==r.biff?4:2),o=fR(e,2);return{r:i,c:o[0],cRel:o[1],rRel:o[2]}}function fF(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function fB(e){return[e.read_shift(1),e.read_shift(1)]}function fU(e,t,r){var a;return e.l+=2,[{r:e.read_shift(2),c:255&(a=e.read_shift(2)),fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}]}function fz(e){return e.l+=6,[]}function fV(e){return e.l+=2,[u2(e),1&e.read_shift(2)]}var f$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],fH={1:{n:"PtgExp",f:function(e,t,r){return(e.l++,r&&12==r.biff)?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:dg},3:{n:"PtgAdd",f:fD},4:{n:"PtgSub",f:fD},5:{n:"PtgMul",f:fD},6:{n:"PtgDiv",f:fD},7:{n:"PtgPower",f:fD},8:{n:"PtgConcat",f:fD},9:{n:"PtgLt",f:fD},10:{n:"PtgLe",f:fD},11:{n:"PtgEq",f:fD},12:{n:"PtgGe",f:fD},13:{n:"PtgGt",f:fD},14:{n:"PtgNe",f:fD},15:{n:"PtgIsect",f:fD},16:{n:"PtgUnion",f:fD},17:{n:"PtgRange",f:fD},18:{n:"PtgUplus",f:fD},19:{n:"PtgUminus",f:fD},20:{n:"PtgPercent",f:fD},21:{n:"PtgParen",f:fD},22:{n:"PtgMissArg",f:fD},23:{n:"PtgStr",f:function(e,t,r){return e.l++,u6(e,t-1,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,d7[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,dJ(e,8)}},32:{n:"PtgArray",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[a]}},33:{n:"PtgFunc",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[f4[n],f5[n],a]}},34:{n:"PtgFuncVar",f:function(e,t,r){var a,n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:[(a=e)[a.l+1]>>7,32767&a.read_shift(2)];return[s,(0===i[0]?f5:f2)[i[1]]]}},35:{n:"PtgName",f:function(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,fL(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,fM(e,r.biff>=2&&r.biff<=5?6:8,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[a,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:dg},40:{n:"PtgMemNoMem",f:dg},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[a]}},43:{n:"PtgAreaErr",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}},44:{n:"PtgRefN",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,function(e,t,r){var a,n,s,i,o,l=r&&r.biff?r.biff:8;if(l>=2&&l<=5){return n=(a=e).read_shift(2),s=a.read_shift(1),i=(32768&n)>>15,o=(16384&n)>>14,n&=16383,1==i&&n>=8192&&(n-=16384),1==o&&s>=128&&(s-=256),{r:n,c:s,cRel:o,rRel:i}}var c=e.read_shift(l>=12?4:2),d=e.read_shift(2),u=(16384&d)>>14,h=(32768&d)>>15;if(d&=16383,1==h)for(;c>524287;)c-=1048576;if(1==u)for(;d>8191;)d-=16384;return{r:c,c:d,cRel:u,rRel:h}}(e,0,r)]}},45:{n:"PtgAreaN",f:function(e,t,r){return[(96&e[e.l++])>>5,function(e,t,r){if(r.biff<8)return fI(e,t,r);var a=e.read_shift(12==r.biff?4:2),n=e.read_shift(12==r.biff?4:2),s=fR(e,2),i=fR(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}(e,t-1,r)]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){var a,n,s,i;return 5==r.biff?(n=(a=e).read_shift(1)>>>5&3,s=a.read_shift(2,"i"),a.l+=8,i=a.read_shift(2),a.l+=12,[n,s,i]):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[a,n,fL(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return[a,n,fM(e,s,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[a,n]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[a,n]}},255:{}},fW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fq={1:{n:"PtgElfLel",f:fV},2:{n:"PtgElfRw",f:fU},3:{n:"PtgElfCol",f:fU},6:{n:"PtgElfRwV",f:fU},7:{n:"PtgElfColV",f:fU},10:{n:"PtgElfRadical",f:fU},11:{n:"PtgElfRadicalS",f:fz},13:{n:"PtgElfColS",f:fz},15:{n:"PtgElfColSV",f:fz},16:{n:"PtgElfRadicalLel",f:fV},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=f$[r>>2&31];return{ixti:t,coltype:3&r,rt:i,idx:a,c:n,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},fG={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[a]}},2:{n:"PtgAttrIf",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var a=e.read_shift(r&&2==r.biff?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&2==r.biff?1:2));return n}},8:{n:"PtgAttrGoto",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:fF},33:{n:"PtgAttrBaxcel",f:fF},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),fB(e,2)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),fB(e,2)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function fK(e,t,r,a){if(a.biff<8)return n=t,void(e.l+=n);for(var n,s,i=e.l+t,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=function(e,t,r){var a=0,n=0;12==r.biff?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,0==--n&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var o=0;o!=n;++o)i[s][o]=function(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=u0(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=d7[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=dJ(e,8);break;case 2:r[1]=u9(e,0,{biff:t>0&&t<8?2:t});break;default:throw Error("Bad SerAr: "+r[0])}return r}(e,r.biff);return i}(e,0,a),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=function(e,t,r){for(var a=e.read_shift(12==r.biff?4:2),n=[],s=0;s!=a;++s)n.push((12==r.biff?dY:hl)(e,8));return n}(e,r[l][1],a),o.push(r[l][2]);break;case"PtgExp":a&&12==a.biff&&(r[l][1][1]=e.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return 0!=(t=i-e.l)&&o.push((s=t,void(e.l+=s))),o}function fX(e,t,r){for(var a,n,s,i=e.l+t,o=[];i!=e.l;)(t=i-e.l,n=fH[s=e[e.l]]||fH[fW[s]],(24===s||25===s)&&(n=(24===s?fq:fG)[e[e.l+1]]),n&&n.f)?o.push([n.n,n.f(e,t,r)]):(a=t,e.l+=a);return o}var fY={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fQ(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:if(null!=r.SID)return e.SheetNames[r.SID];return"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(";;");default:if(!e[a[0]][0][3])return"SH33TJSERR2";return n=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]}}function fJ(e,t,r){var a=fQ(e,t,r);return"#REF"==a?a:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(a,r)}function fZ(e,t,r,a,n){var s,i,o,l,c=n&&n.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",x=0,b=e[0].length;x<b;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=u.pop(),i=u.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=lG(" ",e[0][m][1][1]);break;case 1:g=lG("\r",e[0][m][1][1]);break;default:if(g="",n.WTF)throw Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}i+=g,m=-1}u.push(i+fY[y[0]]+s);break;case"PtgIsect":s=u.pop(),i=u.pop(),u.push(i+" "+s);break;case"PtgUnion":s=u.pop(),i=u.pop(),u.push(i+","+s);break;case"PtgRange":s=u.pop(),i=u.pop(),u.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=dw(y[1][1],d,n),u.push(dj(o,c));break;case"PtgRefN":o=r?dw(y[1][1],r,n):y[1][1],u.push(dj(o,c));break;case"PtgRef3d":h=y[1][1],o=dw(y[1][2],d,n),p=fJ(a,h,n),u.push(p+"!"+dj(o,c));break;case"PtgFunc":case"PtgFuncVar":var v=y[1][0],w=y[1][1];v||(v=0);var k=0==(v&=127)?[]:u.slice(-v);u.length-=v,"User"===w&&(w=k.shift()),u.push(w+"("+k.join(",")+")");break;case"PtgBool":u.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(y[1]);break;case"PtgNum":u.push(String(y[1]));break;case"PtgStr":u.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=dk(y[1][1],r?{s:r}:d,n),u.push(dN(l,n));break;case"PtgArea":l=dk(y[1][1],d,n),u.push(dN(l,n));break;case"PtgArea3d":h=y[1][1],l=y[1][2],p=fJ(a,h,n),u.push(p+"!"+dN(l,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=y[1][2];var j=(a.names||[])[f-1]||(a[0]||[])[f],N=j?j.Name:"SH33TJSNAME"+String(f);N&&"_xlfn."==N.slice(0,6)&&!n.xlfn&&(N=N.slice(6)),u.push(N);break;case"PtgNameX":var S,E=y[1][1];if(f=y[1][2],n.biff<=5)E<0&&(E=-E),a[E]&&(S=a[E][f]);else{var C="";if(14849==((a[E]||[])[0]||[])[0]||(1025==((a[E]||[])[0]||[])[0]?a[E][f]&&a[E][f].itab>0&&(C=a.SheetNames[a[E][f].itab-1]+"!"):C=a.SheetNames[f-1]+"!"),a[E]&&a[E][f])C+=a[E][f].Name;else if(a[0]&&a[0][f])C+=a[0][f].Name;else{var T=(fQ(a,E,n)||"").split(";;");T[f-1]?C=T[f-1]:C+="SH33TJSERRX"}u.push(C);break}S||(S={Name:"SH33TJSERRY"}),u.push(S.Name);break;case"PtgParen":var A="(",_=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:A=lG(" ",e[0][m][1][1])+A;break;case 3:A=lG("\r",e[0][m][1][1])+A;break;case 4:_=lG(" ",e[0][m][1][1])+_;break;case 5:_=lG("\r",e[0][m][1][1])+_;break;default:if(n.WTF)throw Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}u.push(A+u.pop()+_);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var O={c:r.c,r:r.r};if(a.sharedf[d_(o)]){var P=a.sharedf[d_(o)];u.push(fZ(P,d,O,a,n))}else{var D=!1;for(s=0;s!=a.arrayf.length;++s)if((i=a.arrayf[s],!(o.c<i[0].s.c)&&!(o.c>i[0].e.c))&&!(o.r<i[0].s.r)&&!(o.r>i[0].e.r)){u.push(fZ(i[1],d,O,a,n)),D=!0;break}D||u.push(y[1])}break;case"PtgArray":u.push("{"+function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var i=a[s];i?2===i[0]?n.push('"'+i[1].replace(/"/g,'""')+'"'):n.push(i[1]):n.push("")}t.push(n.join(","))}return t.join(";")}(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw Error("Unsupported ELFs");default:throw Error("Unrecognized Formula Token: "+String(y))}var R=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(3!=n.biff&&m>=0&&-1==R.indexOf(e[0][x][0])){y=e[0][m];var M=!0;switch(y[1][0]){case 4:M=!1;case 0:g=lG(" ",y[1][1]);break;case 5:M=!1;case 1:g=lG("\r",y[1][1]);break;default:if(g="",n.WTF)throw Error("Unexpected PtgAttrSpaceType "+y[1][0])}u.push((M?g:"")+u.pop()+(M?"":g)),m=-1}}if(u.length>1&&n.WTF)throw Error("bad formula stack");return u[0]}function f0(e,t,r){var a=e.l+t,n=hs(e,6);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==dn(e,e.l+6))return[dJ(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e,8),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=function(e,t,r){var a,n,s=e.l+t,i=2==r.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],(a=t-2,void(e.l+=a))];var l=fX(e,o,r);return t!==o+i&&(n=fK(e,t-o-i,l,r)),e.l=s,[l,n]}(e,a-e.l,r);return{cell:n,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function f1(e,t,r){var a=e.read_shift(4),n=fX(e,a,r),s=e.read_shift(4),i=s>0?fK(e,s,n,r):null;return[n,i]}var f2={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},f5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},f4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function f3(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function f6(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var f8={},f7={},f9="undefined"!=typeof Map;function pe(e,t,r){var a=0,n=e.length;if(r){if(f9?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=f9?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t:t},e.Count++,e.Unique++,r&&(f9?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function pt(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(h4=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?a=h6(t.wpx):null!=t.wch&&(a=t.wch),a>-1?(r.width=h8(a),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function pr(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function pa(e,t,r){var a=r.revssf[null!=t.z?t.z:"General"],n=60,s=e.length;if(null==a&&r.ssf){for(;n<392;++n)if(null==r.ssf[n]){lj(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function pn(e,t,r,a,n,s){try{a.cellNF&&(e.z=o6[t])}catch(e){if(a.WTF)throw e}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=lH(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==o6[t]&&lj(lE[t]||"General",t),"e"===e.t)e.w=e.w||d7[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=li(e.v);else if("d"===e.t){var i=lI(e.v);(0|i)===i?e.w=i.toString(10):e.w=li(i)}else{if(void 0===e.v)return"";e.w=lo(e.v,f7)}else"d"===e.t?e.w=lk(t,lI(e.v),f7):e.w=lk(t,e.v,f7)}catch(e){if(a.WTF)throw e}if(a.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=h5(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=h5(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(e){if(a.WTF&&s.Fills)throw e}}}var ps=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pi=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,po=/<(?:\w:)?hyperlink [^>]*>/mg,pl=/"(\w*:\w*)"/,pc=/<(?:\w:)?col\b[^>]*[\/]?>/g,pd=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pu=/<(?:\w:)?pageMargins[^>]*\/>/g,ph=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,pf=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,pp=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pm(e,t,r,a){var n=cs(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=cc(ck(n.codeName)))}var pg=["objects","scenarios","selectLockedCells","selectUnlockedCells"],px=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],pb=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,py=(z=/<(?:\w+:)?c[ \/>]/,V=/<\/(?:\w+:)?row>/,H=/r=["']([^"']*)["']/,W=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,q=/ref=["']([^"']*)["']/,G=cN("v"),K=cN("f"),function(e,t,r,a,n,s){for(var i,o,l,c,d,u=0,h="",f=[],p=[],m=0,g=0,x=0,b="",y=0,v=0,w=0,k=0,j=Array.isArray(s.CellXf),N=[],S=[],E=Array.isArray(t),C=[],T={},A=!1,_=!!r.sheetStubs,O=e.split(V),P=0,D=O.length;P!=D;++P){var R=(h=O[P].trim()).length;if(0!==R){var M=0;t:for(u=0;u<R;++u)switch(h[u]){case">":if("/"!=h[u-1]){++u;break t}if(r&&r.cellStyles){if(y=null!=(o=cs(h.slice(M,u),!0)).r?parseInt(o.r,10):y+1,v=-1,r.sheetRows&&r.sheetRows<y)continue;T={},A=!1,o.ht&&(A=!0,T.hpt=parseFloat(o.ht),T.hpx=fr(T.hpt)),"1"==o.hidden&&(A=!0,T.hidden=!0),null!=o.outlineLevel&&(A=!0,T.level=+o.outlineLevel),A&&(C[y-1]=T)}break;case"<":M=u}if(M>=u)break;if(y=null!=(o=cs(h.slice(M,u),!0)).r?parseInt(o.r,10):y+1,v=-1,!r.sheetRows||!(r.sheetRows<y)){a.s.r>y-1&&(a.s.r=y-1),a.e.r<y-1&&(a.e.r=y-1),r&&r.cellStyles&&(T={},A=!1,o.ht&&(A=!0,T.hpt=parseFloat(o.ht),T.hpx=fr(T.hpt)),"1"==o.hidden&&(A=!0,T.hidden=!0),null!=o.outlineLevel&&(A=!0,T.level=+o.outlineLevel),A&&(C[y-1]=T)),f=h.slice(u).split(z);for(var I=0;I!=f.length&&"<"==f[I].trim().charAt(0);++I);for(u=0,f=f.slice(I);u!=f.length;++u)if(0!==(h=f[u].trim()).length){if(p=h.match(H),m=u,g=0,x=0,h="<c "+("<"==h.slice(0,1)?">":"")+h,null!=p&&2===p.length){for(g=0,m=0,b=p[1];g!=b.length&&!((x=b.charCodeAt(g)-64)<1)&&!(x>26);++g)m=26*m+x;v=--m}else++v;for(g=0;g!=h.length&&62!==h.charCodeAt(g);++g);if(++g,(o=cs(h.slice(0,g),!0)).r||(o.r=d_({r:y-1,c:v})),b=h.slice(g),i={t:""},null!=(p=b.match(G))&&""!==p[1]&&(i.v=cc(p[1])),r.cellFormula){if(null!=(p=b.match(K))&&""!==p[1]){if(i.f=cc(ck(p[1])).replace(/\r\n/g,"\n"),r.xlfn||(i.f=fP(i.f)),p[0].indexOf('t="array"')>-1)i.F=(b.match(q)||[])[1],i.F.indexOf(":")>-1&&N.push([dD(i.F),i.F]);else if(p[0].indexOf('t="shared"')>-1){c=cs(p[0]);var L=cc(ck(p[1]));r.xlfn||(L=fP(L)),S[parseInt(c.si,10)]=[c,L,o.r]}}else(p=b.match(/<f[^>]*\/>/))&&S[(c=cs(p[0])).si]&&(i.f=function(e,t,r){var a=dO(t).s,n=dA(r);return fO(e,{r:n.r-a.r,c:n.c-a.c})}(S[c.si][1],S[c.si][2],o.r));var F=dA(o.r);for(g=0;g<N.length;++g)F.r>=N[g][0].s.r&&F.r<=N[g][0].e.r&&F.c>=N[g][0].s.c&&F.c<=N[g][0].e.c&&(i.F=N[g][1])}if(null==o.t&&void 0===i.v)if(i.f||i.F)i.v=0,i.t="n";else{if(!_)continue;i.t="z"}else i.t=o.t||"n";switch(a.s.c>v&&(a.s.c=v),a.e.c<v&&(a.e.c=v),i.t){case"n":if(""==i.v||null==i.v){if(!_)continue;i.t="z"}else i.v=parseFloat(i.v);break;case"s":if(void 0===i.v){if(!_)continue;i.t="z"}else l=f8[parseInt(i.v,10)],i.v=l.t,i.r=l.r,r.cellHTML&&(i.h=l.h);break;case"str":i.t="s",i.v=null!=i.v?ck(i.v):"",r.cellHTML&&(i.h=cm(i.v));break;case"inlineStr":p=b.match(W),i.t="s",null!=p&&(l=hU(p[1]))?(i.v=l.t,r.cellHTML&&(i.h=l.h)):i.v="";break;case"b":i.v=cx(i.v);break;case"d":r.cellDates?i.v=lH(i.v,1):(i.v=lI(lH(i.v,1)),i.t="n");break;case"e":r&&!1===r.cellText||(i.w=i.v),i.v=d9[i.v]}if(w=k=0,d=null,j&&void 0!==o.s&&null!=(d=s.CellXf[o.s])&&(null!=d.numFmtId&&(w=d.numFmtId),r.cellStyles&&null!=d.fillId&&(k=d.fillId)),pn(i,w,k,r,n,s),r.cellDates&&j&&"n"==i.t&&ly(o6[w])&&(i.t="d",i.v=lU(i.v)),o.cm&&r.xlmeta){var B=(r.xlmeta.Cell||[])[o.cm-1];B&&"XLDAPR"==B.type&&(i.D=!0)}if(E){var U=dA(o.r);t[U.r]||(t[U.r]=[]),t[U.r][U.c]=i}else t[o.r]=i}}}}C.length>0&&(t["!rows"]=C)});function pv(e,t,r,a){var n,s=[l9,cD("worksheet",null,{xmlns:cV[0],"xmlns:r":cB})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];null==c&&(c={});var d=c["!ref"]||"A1",u=dD(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=dP(u)}a||(a={}),c["!comments"]=[];var h=[];!function(e,t,r,a,n){var s=!1,i={},o=null;if("xlsx"!==a.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(e){}s=!0,i.codeName=cj(ch(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+cD("outlinePr",null,c)}(s||o)&&(n[n.length]=cD("sheetPr",o,i))}(c,r,e,t,s),s[s.length]=cD("dimension",null,{ref:d}),s[s.length]=(f={workbookViewId:"0"},(((r||{}).Workbook||{}).Views||[])[0]&&(f.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),cD("sheetViews",cD("sheetView",null,f),{})),t.sheetFormat&&(s[s.length]=cD("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=c["!cols"]&&c["!cols"].length>0&&(s[s.length]=function(e,t){for(var r,a=["<cols>"],n=0;n!=t.length;++n)(r=t[n])&&(a[a.length]=cD("col",null,pt(n,r)));return a[a.length]="</cols>",a.join("")}(0,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],null!=c["!ref"]&&(l=function(e,t,r,a){var n,s,i=[],o=[],l=dD(e["!ref"]),c="",d="",u=[],h=0,f=0,p=e["!rows"],m=Array.isArray(e),g={r:d},x=-1;for(f=l.s.c;f<=l.e.c;++f)u[f]=dT(f);for(h=l.s.r;h<=l.e.r;++h){for(o=[],d=dE(h),f=l.s.c;f<=l.e.c;++f){n=u[f]+d;var b=m?(e[h]||[])[f]:e[n];void 0!==b&&null!=(c=function(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var n="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=d7[e.v];break;case"d":a&&a.cellDates?n=lH(e.v,-1).toISOString():((e=lq(e)).t="n",n=""+(e.v=lI(lH(e.v)))),void 0===e.z&&(e.z=o6[14]);break;default:n=e.v}var o=cO("v",ch(n)),l={r:t},c=pa(a.cellXfs,e,a);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=cO("v",""+pe(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str"}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=cD("f",ch(e.f),d)+(null!=e.v?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),cD("c",o,l)}(b,n,e,t,r,a))&&o.push(c)}(o.length>0||p&&p[h])&&(g={r:d},p&&p[h]&&((s=p[h]).hidden&&(g.hidden=1),x=-1,s.hpx?x=ft(s.hpx):s.hpt&&(x=s.hpt),x>-1&&(g.ht=x,g.customHeight=1),s.level&&(g.outlineLevel=s.level)),i[i.length]=cD("row",o.join(""),g))}if(p)for(;h<p.length;++h)p&&p[h]&&(g={r:h+1},(s=p[h]).hidden&&(g.hidden=1),x=-1,s.hpx?x=ft(s.hpx):s.hpt&&(x=s.hpt),x>-1&&(g.ht=x,g.customHeight=1),s.level&&(g.outlineLevel=s.level),i[i.length]=cD("row","",g));return i.join("")}(c,t,e,r,a)).length>0&&(s[s.length]=l),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=(p=c["!protect"],m={sheet:1},pg.forEach(function(e){null!=p[e]&&p[e]&&(m[e]="1")}),px.forEach(function(e){null==p[e]||p[e]||(m[e]="0")}),p.password&&(m.password=hQ(p.password).toString(16).toUpperCase()),cD("sheetProtection",null,m))),null!=c["!autofilter"]&&(s[s.length]=function(e,t,r,a){var n="string"==typeof e.ref?e.ref:dP(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=dO(n);i.s.r==i.e.r&&(i.e.r=dO(t["!ref"]).e.r,n=dP(i));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),cD("autoFilter",null,{ref:n})}(c["!autofilter"],c,r,e)),null!=c["!merges"]&&c["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dP(e[r])+'"/>';return t+"</mergeCells>"}(c["!merges"]));var f,p,m,g,x=-1,b=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(e){e[1].Target&&(g={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(b=uN(a,-1,ch(e[1].Target).replace(/#.*$/,""),us),g["r:id"]="rId"+b),(x=e[1].Target.indexOf("#"))>-1&&(g.location=ch(e[1].Target.slice(x+1))),e[1].Tooltip&&(g.tooltip=ch(e[1].Tooltip)),s[s.length]=cD("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete c["!links"],null!=c["!margins"]&&(s[s.length]=(pr(n=c["!margins"]),cD("pageMargins",null,n))),(!t||t.ignoreEC||void 0==t.ignoreEC)&&(s[s.length]=cO("ignoredErrors",cD("ignoredError",null,{numberStoredAsText:1,sqref:d}))),h.length>0&&(b=uN(a,-1,"../drawings/drawing"+(e+1)+".xml","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),s[s.length]=cD("drawing",null,{"r:id":"rId"+b}),c["!drawing"]=h),c["!comments"].length>0&&(b=uN(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ui),s[s.length]=cD("legacyDrawing",null,{"r:id":"rId"+b}),c["!legacy"]=b),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function pw(e){return[dH(e),dJ(e),"n"]}var pk=["left","right","top","bottom","header","footer"],pj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pS=[],pE=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function pC(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(null==a[s[0]])a[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof a[s[0]]&&(a[s[0]]=cx(a[s[0]]));break;case"int":"string"==typeof a[s[0]]&&(a[s[0]]=parseInt(a[s[0]],10))}}}function pT(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=cx(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}function pA(e){pT(e.WBProps,pj),pT(e.CalcPr,pE),pC(e.WBView,pN),pC(e.Sheets,pS),f7.date1904=cx(e.WBProps.date1904)}var p_="][*?/\\".split("");function pO(e,t){if(e.length>31){if(t)return!1;throw Error("Sheet names cannot exceed 31 chars")}var r=!0;return p_.forEach(function(a){if(-1!=e.indexOf(a)){if(!t)throw Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var pP=/<\w+:workbook/;function pD(e){var t=[l9];t[t.length]=cD("workbook",null,{xmlns:cV[0],"xmlns:r":cB});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(pj.forEach(function(t){null==e.Workbook.WBProps[t[0]]||e.Workbook.WBProps[t[0]]!=t[1]&&(a[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=cD("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(s=0,t[t.length]="<bookViews>";s!=e.SheetNames.length&&n[s]&&n[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(s=0,t[t.length]="<sheets>";s!=e.SheetNames.length;++s){var i={name:ch(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=cD("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=cD("definedName",ch(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function pR(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}var pM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,pI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pL(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),1===r.length)return a;var n,s,i,o=e.match(pM);if(o)for(i=0;i!=o.length;++i)-1===(s=(n=o[i].match(pI))[1].indexOf(":"))?a[n[1]]=n[2].slice(1,n[2].length-1):a["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(s+1)]=n[2].slice(1,n[2].length-1);return a}function pF(e,t){var r,a,n,s=t||{};lS();var i=oM(cM(e));("binary"==s.type||"array"==s.type||"base64"==s.type)&&(i=void 0!==ee?ee.utils.decode(65001,oD(i)):ck(i));var o=i.slice(0,1024).toLowerCase(),l=!1;if((1023&(o=o.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&o.indexOf(","),1023&o.indexOf(";"))){var c=lq(s);return c.type="string",hD.to_workbook(i,c)}if(-1==o.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){o.indexOf("<"+e)>=0&&(l=!0)}),l){var d=i,u=s,h=d.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!h||0==h.length)throw Error("Invalid HTML: could not find <table>");if(1==h.length)return dI(pJ(h[0],u),u);var f=mC();return h.forEach(function(e,t){mT(f,pJ(e,u),"Sheet"+(t+1))}),f}ea={"General Number":"General","General Date":o6[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":o6[15],"Short Date":o6[14],"Long Time":o6[19],"Medium Time":o6[18],"Short Time":o6[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:o6[2],Standard:o6[4],Percent:o6[10],Scientific:o6[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var p,m,g,x=[],b={},y=[],v=s.dense?[]:{},w="",k={},j={},N=pL('<Data ss:Type="String">'),S=0,E=0,C=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},_={},O="",P=0,D=[],R={},M={},I=0,L=[],F=[],B={},U=[],z=!1,V=[],H=[],W={},q=0,G=0,K={Sheets:[],WBProps:{date1904:!1}},X={};cI.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";p=cI.exec(i);)switch(p[3]=(Y=p[3]).toLowerCase()){case"data":if("data"==Y){if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"))}else"/"!==p[0].charAt(p[0].length-2)&&x.push([p[3],!0]);break}if(x[x.length-1][1])break;"/"===p[1]?function(e,t,r,a,n,s,i,o,l,c){var d="General",u=a.StyleID,h={};c=c||{};var f=[],p=0;for(void 0===u&&o&&(u=o.StyleID),void 0===u&&i&&(u=i.StyleID);void 0!==s[u]&&(s[u].nf&&(d=s[u].nf),s[u].Interior&&f.push(s[u].Interior),s[u].Parent);)u=s[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=cx(e);break;case"String":a.t="s",a.r=cg(cc(e)),a.v=e.indexOf("<")>-1?cc(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),a.v=(lH(e)-new Date(Date.UTC(1899,11,30)))/864e5,a.v!=a.v?a.v=cc(e):a.v<60&&(a.v=a.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===a.v&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=d9[e],!1!==c.cellText&&(a.w=e);break;default:""==e&&""==t?a.t="z":(a.t="s",a.v=cg(t||e))}if(!function(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{if("e"===e.t)e.w=e.w||d7[e.v];else if("General"===t)"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=li(e.v):e.w=lo(e.v);else{var a,n,s;a=t||"General",n=e.v,s=ea[a]||cc(a),e.w="General"===s?lo(n):lk(s,n)}}catch(e){if(r.WTF)throw e}try{var i=ea[t]||t||"General";if(r.cellNF&&(e.z=i),r.cellDates&&"n"==e.t&&ly(i)){var o=le(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(e){if(r.WTF)throw e}}}(a,d,c),!1!==c.cellFormula)if(a.Formula){var m=cc(a.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),a.f=fT(m,n),delete a.Formula,"RC"==a.ArrayRange?a.F=fT("RC:RC",n):a.ArrayRange&&(a.F=fT(a.ArrayRange,n),l.push([dD(a.F),a.F]))}else for(p=0;p<l.length;++p)n.r>=l[p][0].s.r&&n.r<=l[p][0].e.r&&n.c>=l[p][0].s.c&&n.c<=l[p][0].e.c&&(a.F=l[p][1]);c.cellStyles&&(f.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),a.s=h),void 0!==a.StyleID&&(a.ixfe=a.StyleID)}(i.slice(S,p.index),O,N,"comment"==x[x.length-1][0]?B:k,{c:E,r:C},A,U[E],j,V,s):(O="",N=pL(p[0]),S=p.index+p[0].length);break;case"cell":if("/"===p[1])if(F.length>0&&(k.c=F),(!s.sheetRows||s.sheetRows>C)&&void 0!==k.v&&(s.dense?(v[C]||(v[C]=[]),v[C][E]=k):v[dT(E)+dE(C)]=k),k.HRef&&(k.l={Target:cc(k.HRef)},k.HRefScreenTip&&(k.l.Tooltip=k.HRefScreenTip),delete k.HRef,delete k.HRefScreenTip),(k.MergeAcross||k.MergeDown)&&(q=E+(0|parseInt(k.MergeAcross,10)),G=C+(0|parseInt(k.MergeDown,10)),D.push({s:{c:E,r:C},e:{c:q,r:G}})),s.sheetStubs)if(k.MergeAcross||k.MergeDown){for(var Q=E;Q<=q;++Q)for(var J=C;J<=G;++J)(Q>E||J>C)&&(s.dense?(v[J]||(v[J]=[]),v[J][Q]={t:"z"}):v[dT(Q)+dE(J)]={t:"z"});E=q+1}else++E;else k.MergeAcross?E=q+1:++E;else(k=function(e){var t=e.split(/\s+/),r={};if(1===t.length)return r;var a,n,s,i=e.match(pM);if(i)for(s=0;s!=i.length;++s)-1===(n=(a=i[s].match(pI))[1].indexOf(":"))?r[a[1]]=a[2].slice(1,a[2].length-1):r["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(n+1)]=a[2].slice(1,a[2].length-1);return r}(p[0])).Index&&(E=k.Index-1),E<T.s.c&&(T.s.c=E),E>T.e.c&&(T.e.c=E),"/>"===p[0].slice(-2)&&++E,F=[];break;case"row":"/"===p[1]||"/>"===p[0].slice(-2)?(C<T.s.r&&(T.s.r=C),C>T.e.r&&(T.e.r=C),"/>"===p[0].slice(-2)&&(j=pL(p[0])).Index&&(C=j.Index-1),E=0,++C):((j=pL(p[0])).Index&&(C=j.Index-1),W={},("0"==j.AutoFitHeight||j.Height)&&(W.hpx=parseInt(j.Height,10),W.hpt=ft(W.hpx),H[C]=W),"1"==j.Hidden&&(W.hidden=!0,H[C]=W));break;case"worksheet":if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"));y.push(w),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(v["!ref"]=dP(T),s.sheetRows&&s.sheetRows<=T.e.r&&(v["!fullref"]=v["!ref"],T.e.r=s.sheetRows-1,v["!ref"]=dP(T))),D.length&&(v["!merges"]=D),U.length>0&&(v["!cols"]=U),H.length>0&&(v["!rows"]=H),b[w]=v}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=E=0,x.push([p[3],!1]),w=cc((m=pL(p[0])).Name),v=s.dense?[]:{},D=[],V=[],H=[],X={name:w,Hidden:0},K.Sheets.push(X);break;case"table":if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"))}else"/>"==p[0].slice(-2)||(x.push([p[3],!1]),U=[],z=!1);break;case"style":"/"===p[1]?function(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=fa[a.Pattern]||a.Pattern)}e[t.ID]=t}(A,_,s):_=pL(p[0]);break;case"numberformat":_.nf=cc(pL(p[0]).Format||"General"),ea[_.nf]&&(_.nf=ea[_.nf]);for(var Z=0;392!=Z&&o6[Z]!=_.nf;++Z);if(392==Z){for(Z=57;392!=Z;++Z)if(null==o6[Z]){lj(_.nf,Z);break}}break;case"column":if("table"!==x[x.length-1][0])break;if((g=pL(p[0])).Hidden&&(g.hidden=!0,delete g.Hidden),g.Width&&(g.wpx=parseInt(g.Width,10)),!z&&g.wpx>10){z=!0,h4=6;for(var er=0;er<U.length;++er)U[er]&&fe(U[er])}z&&fe(g),U[g.Index-1||U.length]=g;for(var en=0;en<+g.Span;++en)U[U.length]=lq(g);break;case"namedrange":if("/"===p[1])break;K.Names||(K.Names=[]);var es=cs(p[0]),ei={Name:es.Name,Ref:fT(es.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(ei.Sheet=K.Sheets.length-1),K.Names.push(ei);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":"/>"===p[0].slice(-2)||("/"===p[1]?O+=i.slice(P,p.index):P=p.index+p[0].length);break;case"interior":if(!s.cellStyles)break;_.Interior=pL(p[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":"/>"===p[0].slice(-2)||("/"===p[1]?(r=Y,a=i.slice(I,p.index),et||(et=lD(uF)),R[r=et[r]||r]=a):I=p.index+p[0].length);break;case"styles":case"workbook":if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"))}else x.push([p[3],!1]);break;case"comment":if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"));(n=B).t=n.v||"",n.t=n.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),n.v=n.w=n.ixfe=void 0,F.push(B)}else x.push([p[3],!1]),B={a:(m=pL(p[0])).Author};break;case"autofilter":if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"))}else if("/"!==p[0].charAt(p[0].length-2)){var eo=pL(p[0]);v["!autofilter"]={ref:fT(eo.Range).replace(/\$/g,"")},x.push([p[3],!0])}break;case"datavalidation":case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===p[1]){if((m=x.pop())[0]!==p[3])throw Error("Bad state: "+m.join("|"))}else"/"!==p[0].charAt(p[0].length-2)&&x.push([p[3],!0]);break;default:if(0==x.length&&"document"==p[3]||0==x.length&&"uof"==p[3])return p0(i,s);var el=!0;switch(x[x.length-1][0]){case"officedocumentsettings":switch(p[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:el=!1}break;case"componentoptions":switch(p[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:el=!1}break;case"excelworkbook":switch(p[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:el=!1}break;case"workbookoptions":switch(p[3]){case"owcversion":case"height":case"width":break;default:el=!1}break;case"worksheetoptions":switch(p[3]){case"visible":if("/>"===p[0].slice(-2));else if("/"===p[1])switch(i.slice(I,p.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2}else I=p.index+p[0].length;break;case"header":v["!margins"]||pr(v["!margins"]={},"xlml"),isNaN(+cs(p[0]).Margin)||(v["!margins"].header=+cs(p[0]).Margin);break;case"footer":v["!margins"]||pr(v["!margins"]={},"xlml"),isNaN(+cs(p[0]).Margin)||(v["!margins"].footer=+cs(p[0]).Margin);break;case"pagemargins":var ec=cs(p[0]);v["!margins"]||pr(v["!margins"]={},"xlml"),isNaN(+ec.Top)||(v["!margins"].top=+ec.Top),isNaN(+ec.Left)||(v["!margins"].left=+ec.Left),isNaN(+ec.Right)||(v["!margins"].right=+ec.Right),isNaN(+ec.Bottom)||(v["!margins"].bottom=+ec.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;default:el=!1}break;case"pivottable":case"pivotcache":switch(p[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:el=!1}break;case"pagebreaks":switch(p[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:el=!1}break;case"autofilter":switch(p[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:el=!1}break;case"querytable":switch(p[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:el=!1}break;case"datavalidation":switch(p[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:el=!1}break;case"sorting":case"conditionalformatting":switch(p[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:el=!1}break;case"mapinfo":case"schema":case"data":switch(p[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:el=!1}break;case"smarttags":break;default:el=!1}if(el||p[3].match(/!\[CDATA/))break;if(!x[x.length-1][1])throw"Unrecognized tag: "+p[3]+"|"+x.join("|");if("customdocumentproperties"===x[x.length-1][0]){"/>"===p[0].slice(-2)||("/"===p[1]?function(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=cx(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=lH(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw Error("bad custprop:"+r[0])}e[cc(t)]=n}(M,Y,L,i.slice(I,p.index)):(L=p,I=p.index+p[0].length));break}if(s.WTF)throw"Unrecognized tag: "+p[3]+"|"+x.join("|")}var ed={};return s.bookSheets||s.bookProps||(ed.Sheets=b),ed.SheetNames=y,ed.Workbook=K,ed.SSF=lq(o6),ed.Props=R,ed.Custprops=M,ed}function pB(e,t){switch(mp(t=t||{}),t.type||"base64"){case"base64":return pF(oU(e),t);case"binary":case"buffer":case"file":return pF(e,t);case"array":return pF(oG(e),t)}}function pU(e){return cD("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+f_(e.Ref,{r:0,c:0})})}var pz=[60,1084,2066,2165,2175];function pV(e,t,r){if("z"!==e.t&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=o6[a])}catch(e){if(t.WTF)throw e}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||d7[e.v]:0===a||"General"==a?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=li(e.v):e.w=lo(e.v):e.w=lk(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(e){if(t.WTF)throw e}if(t.cellDates&&a&&"n"==e.t&&ly(o6[a]||String(a))){var n=le(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function p$(e,t,r){return{v:e,ixfe:t,t:r}}var pH="e0859ff2f94f6810ab9108002b27b3d9",pW="02d5cdd59c2e1b10939708002b2cf9ae";function pq(e,t){if(t||(t={}),mp(t),oP(),t.codepage&&o_(t.codepage),e.FullPaths){if(lA.find(e,"/encryption"))throw Error("File is password-protected");n=lA.find(e,"!CompObj"),s=lA.find(e,"/Workbook")||lA.find(e,"/Book")}else{switch(t.type){case"base64":e=oW(oU(e));break;case"binary":e=oW(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}dm(e,0),s={content:e}}if(n&&function(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=d1(r,1),!(r.length-r.l<=4)){var a=r.read_shift(4);0==a||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||0x71b239f4!==(a=r.read_shift(4)))||(t.UnicodeClipboardFormat=d1(r,2),0==(a=r.read_shift(4))||a>40)||(r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr"))}}(n),t.bookProps&&!t.bookSheets)i={};else{var r,a,n,s,i,o,l=oz?"buffer":"array";if(s&&s.content)i=function(e,t){var r,a,n,s,i={opts:{}},o={},l,c,d,u,h,f=t.dense?[]:{},p={},m={},g=null,x=[],b="",y={},v="",w={},k=[],j=[],N=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},C=function(e){return e<8?d8[e]:e<64&&N[e-8]||d8[e]},T=function(e,t,r){var a,n=t.XF.data;n&&n.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=n.patternType,(a=h2(C(n.icvFore)))&&(t.s.fgColor={rgb:a}),(a=h2(C(n.icvBack)))&&(t.s.bgColor={rgb:a}))},A=function(e,t,r){if(!(F>1)&&(!r.sheetRows||!(e.r>=r.sheetRows))){if(r.cellStyles&&t.XF&&t.XF.data&&T(e,t,r),delete t.ixfe,delete t.XF,l=e,v=d_(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),r.cellFormula&&t.f){for(var a=0;a<k.length;++a)if(!(k[a][0].s.c>e.c)&&!(k[a][0].s.r>e.r)&&!(k[a][0].e.c<e.c)&&!(k[a][0].e.r<e.r)){t.F=dP(k[a][0]),(k[a][0].s.c!=e.c||k[a][0].s.r!=e.r)&&delete t.f,t.f&&(t.f=""+fZ(k[a][1],m,e,I,_));break}}r.dense?(f[e.r]||(f[e.r]=[]),f[e.r][e.c]=t):f[v]=t}},_={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(_.password=t.password);var O=[],P=[],D=[],R=[],M=!1,I=[];I.SheetNames=_.snames,I.sharedf=_.sharedf,I.arrayf=_.arrayf,I.names=[],I.XTI=[];var L=0,F=0,B=0,U=[],z=[];_.codepage=1200,oO(1200);for(var V=!1;e.l<e.length-1;){var H=e.l,W=e.read_shift(2);if(0===W&&10===L)break;var q=e.l===e.length?0:e.read_shift(2),G=pK[W];if(G&&G.f){if(t.bookSheets&&133===L&&133!==W)break;if(L=W,2===G.r||12==G.r){var K=e.read_shift(2);if(q-=2,!_.enc&&K!==W&&((255&K)<<8|K>>8)!==W)throw Error("rt mismatch: "+K+"!="+W);12==G.r&&(e.l+=10,q-=10)}var X={};if(X=10===W?G.f(e,q,_):function(e,t,r,a,n){var s=a,i=[],o=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:n.enc.insitu(o)}i.push(o),r.l+=s;for(var l=dn(r,r.l),c=pK[l],d=0;null!=c&&pz.indexOf(l)>-1;)s=dn(r,r.l+2),d=r.l+4,2066==l?d+=4:(2165==l||2175==l)&&(d+=12),o=r.slice(d,r.l+4+s),i.push(o),r.l+=4+s,c=pK[l=dn(r,r.l)];var u=oX(i);dm(u,0);var h=0;u.lens=[];for(var f=0;f<i.length;++f)u.lens.push(h),h+=i[f].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,n)}(W,G,e,q,_),0==F&&-1===[9,521,1033,2057].indexOf(L))continue;switch(W){case 34:i.opts.Date1904=S.WBProps.date1904=X;break;case 134:i.opts.WriteProtect=!0;break;case 47:if(_.enc||(e.l=0),_.enc=X,!t.password)throw Error("File is password-protected");if(null==X.valid)throw Error("Encryption scheme unsupported");if(!X.valid)throw Error("Password is incorrect");break;case 92:_.lastuser=X;break;case 66:var Y=Number(X);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}oO(_.codepage=Y),V=!0;break;case 317:_.rrtabid=X;break;case 25:_.winlocked=X;break;case 439:i.opts.RefreshAll=X;break;case 12:i.opts.CalcCount=X;break;case 16:i.opts.CalcDelta=X;break;case 17:i.opts.CalcIter=X;break;case 13:i.opts.CalcMode=X;break;case 14:i.opts.CalcPrecision=X;break;case 95:i.opts.CalcSaveRecalc=X;break;case 15:_.CalcRefMode=X;break;case 2211:i.opts.FullCalc=X;break;case 129:X.fDialog&&(f["!type"]="dialog"),X.fBelow||((f["!outline"]||(f["!outline"]={})).above=!0),X.fRight||((f["!outline"]||(f["!outline"]={})).left=!0);break;case 224:j.push(X);break;case 430:I.push([X]),I[I.length-1].XTI=[];break;case 35:case 547:I[I.length-1].push(X);break;case 24:case 536:s={Name:X.Name,Ref:fZ(X.rgce,m,null,I,_)},X.itab>0&&(s.Sheet=X.itab-1),I.names.push(s),I[0]||(I[0]=[],I[0].XTI=[]),I[I.length-1].push(X),"_xlnm._FilterDatabase"==X.Name&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&"PtgArea3d"==X.rgce[0][0][0]&&(z[X.itab-1]={ref:dP(X.rgce[0][0][1][2])});break;case 22:_.ExternCount=X;break;case 23:0==I.length&&(I[0]=[],I[0].XTI=[]),I[I.length-1].XTI=I[I.length-1].XTI.concat(X),I.XTI=I.XTI.concat(X);break;case 2196:if(_.biff<8)break;null!=s&&(s.Comment=X[1]);break;case 18:f["!protect"]=X;break;case 19:0!==X&&_.WTF&&console.error("Password verifier: "+X);break;case 133:p[X.pos]=X,_.snames.push(X.name);break;case 10:if(--F)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,f["!ref"]=dP(m),t.sheetRows&&t.sheetRows<=m.e.r){var Q=m.e.r;m.e.r=t.sheetRows-1,f["!fullref"]=f["!ref"],f["!ref"]=dP(m),m.e.r=Q}m.e.r++,m.e.c++}O.length>0&&(f["!merges"]=O),P.length>0&&(f["!objects"]=P),D.length>0&&(f["!cols"]=D),R.length>0&&(f["!rows"]=R),S.Sheets.push(E)}""===b?y=f:o[b]=f,f=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===_.biff&&(_.biff=({9:2,521:3,1033:4})[W]||({512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2})[X.BIFFVer]||8),_.biffguess=0==X.BIFFVer,0==X.BIFFVer&&4096==X.dt&&(_.biff=5,V=!0,oO(_.codepage=28591)),8==_.biff&&0==X.BIFFVer&&16==X.dt&&(_.biff=2),F++)break;if(f=t.dense?[]:{},_.biff<8&&!V&&(V=!0,oO(_.codepage=t.codepage||1252)),_.biff<5||0==X.BIFFVer&&4096==X.dt){""===b&&(b="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-q,name:b};p[J.pos]=J,_.snames.push(b)}else b=(p[H]||{name:""}).name;32==X.dt&&(f["!type"]="chart"),64==X.dt&&(f["!type"]="macro"),O=[],P=[],_.arrayf=k=[],D=[],R=[],M=!1,E={Hidden:(p[H]||{hs:0}).hs,name:b};break;case 515:case 3:case 2:"chart"==f["!type"]&&(t.dense?(f[X.r]||[])[X.c]:f[d_({c:X.c,r:X.r})])&&++X.c,r={ixfe:X.ixfe,XF:j[X.ixfe]||{},v:X.val,t:"n"},B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:X.c,r:X.r},r,t);break;case 5:case 517:r={ixfe:X.ixfe,XF:j[X.ixfe],v:X.val,t:X.t},B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:X.c,r:X.r},r,t);break;case 638:r={ixfe:X.ixfe,XF:j[X.ixfe],v:X.rknum,t:"n"},B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:X.c,r:X.r},r,t);break;case 189:for(var Z=X.c;Z<=X.C;++Z){var ee=X.rkrec[Z-X.c][0];r={ixfe:ee,XF:j[ee],v:X.rkrec[Z-X.c][1],t:"n"},B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:Z,r:X.r},r,t)}break;case 6:case 518:case 1030:if("String"==X.val){g=X;break}if((r=p$(X.val,X.cell.ixfe,X.tt)).XF=j[r.ixfe],t.cellFormula){var et=X.formula;if(et&&et[0]&&et[0][0]&&"PtgExp"==et[0][0][0]){var er=et[0][0][1][0],ea=et[0][0][1][1],en=d_({r:er,c:ea});w[en]?r.f=""+fZ(X.formula,m,X.cell,I,_):r.F=((t.dense?(f[er]||[])[ea]:f[en])||{}).F}else r.f=""+fZ(X.formula,m,X.cell,I,_)}B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A(X.cell,r,t),g=X;break;case 7:case 519:if(g)g.val=X,(r=p$(X,g.cell.ixfe,"s")).XF=j[r.ixfe],t.cellFormula&&(r.f=""+fZ(g.formula,m,g.cell,I,_)),B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A(g.cell,r,t),g=null;else throw Error("String record expects Formula");break;case 33:case 545:k.push(X);var es=d_(X[0].s);if(c=t.dense?(f[X[0].s.r]||[])[X[0].s.c]:f[es],t.cellFormula&&c){if(!g||!es||!c)break;c.f=""+fZ(X[1],m,X[0],I,_),c.F=dP(X[0])}break;case 1212:if(!t.cellFormula)break;if(v){if(!g)break;w[d_(g.cell)]=X[0],((c=t.dense?(f[g.cell.r]||[])[g.cell.c]:f[d_(g.cell)])||{}).f=""+fZ(X[0],m,l,I,_)}break;case 253:r=p$(x[X.isst].t,X.ixfe,"s"),x[X.isst].h&&(r.h=x[X.isst].h),r.XF=j[r.ixfe],B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:X.c,r:X.r},r,t);break;case 513:t.sheetStubs&&(r={ixfe:X.ixfe,XF:j[X.ixfe],t:"z"},B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:X.c,r:X.r},r,t));break;case 190:if(t.sheetStubs)for(var ei=X.c;ei<=X.C;++ei){var eo=X.ixfe[ei-X.c];r={ixfe:eo,XF:j[eo],t:"z"},B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:ei,r:X.r},r,t)}break;case 214:case 516:case 4:(r=p$(X.val,X.ixfe,"s")).XF=j[r.ixfe],B>0&&(r.z=U[r.ixfe>>8&63]),pV(r,t,i.opts.Date1904),A({c:X.c,r:X.r},r,t);break;case 0:case 512:1===F&&(m=X);break;case 252:x=X;break;case 1054:if(4==_.biff){U[B++]=X[1];for(var el=0;el<B+163&&o6[el]!=X[1];++el);el>=163&&lj(X[1],B+163)}else lj(X[1],X[0]);break;case 30:U[B++]=X;for(var ec=0;ec<B+163&&o6[ec]!=X;++ec);ec>=163&&lj(X,B+163);break;case 229:O=O.concat(X);break;case 93:P[X.cmo[0]]=_.lastobj=X;break;case 438:_.lastobj.TxO=X;break;case 127:_.lastobj.ImData=X;break;case 440:for(h=X[0].s.r;h<=X[0].e.r;++h)for(u=X[0].s.c;u<=X[0].e.c;++u)(c=t.dense?(f[h]||[])[u]:f[d_({c:u,r:h})])&&(c.l=X[1]);break;case 2048:for(h=X[0].s.r;h<=X[0].e.r;++h)for(u=X[0].s.c;u<=X[0].e.c;++u)(c=t.dense?(f[h]||[])[u]:f[d_({c:u,r:h})])&&c.l&&(c.l.Tooltip=X[1]);break;case 28:if(_.biff<=5&&_.biff>=2)break;c=t.dense?(f[X[0].r]||[])[X[0].c]:f[d_(X[0])];var ed=P[X[2]];c||(t.dense?(f[X[0].r]||(f[X[0].r]=[]),c=f[X[0].r][X[0].c]={t:"z"}):c=f[d_(X[0])]={t:"z"},m.e.r=Math.max(m.e.r,X[0].r),m.s.r=Math.min(m.s.r,X[0].r),m.e.c=Math.max(m.e.c,X[0].c),m.s.c=Math.min(m.s.c,X[0].c)),c.c||(c.c=[]),d={a:X[1],t:ed.TxO.t},c.c.push(d);break;case 2173:j[X.ixfe],X.ext.forEach(function(e){e[0]});break;case 125:if(!_.cellStyles)break;for(;X.e>=X.s;)D[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(1&X.flags)},M||(M=!0,h9(X.w/256)),fe(D[X.e+1]);break;case 520:var eu={};null!=X.level&&(R[X.r]=eu,eu.level=X.level),X.hidden&&(R[X.r]=eu,eu.hidden=!0),X.hpt&&(R[X.r]=eu,eu.hpt=X.hpt,eu.hpx=fr(X.hpt));break;case 38:case 39:case 40:case 41:f["!margins"]||pr(f["!margins"]={}),f["!margins"][({38:"left",39:"right",40:"top",41:"bottom"})[W]]=X;break;case 161:f["!margins"]||pr(f["!margins"]={}),f["!margins"].header=X.header,f["!margins"].footer=X.footer;break;case 574:X.RTL&&(S.Views[0].RTL=!0);break;case 146:N=X;break;case 2198:n=X;break;case 140:a=X;break;case 442:b?E.CodeName=X||E.name:S.WBProps.CodeName=X||"ThisWorkbook"}}else G||console.error("Missing Info for XLS Record 0x"+W.toString(16)),e.l+=q}return i.SheetNames=lO(p).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return p[e].name}),t.bookSheets||(i.Sheets=o),!i.SheetNames.length&&y["!ref"]?(i.SheetNames.push("Sheet1"),i.Sheets&&(i.Sheets.Sheet1=y)):i.Preamble=y,i.Sheets&&z.forEach(function(e,t){i.Sheets[i.SheetNames[t]]["!autofilter"]=e}),i.Strings=x,i.SSF=lq(o6),_.enc&&(i.Encryption=_.enc),n&&(i.Themes=n),i.Metadata={},void 0!==a&&(i.Metadata.Country=a),I.names.length>0&&(S.Names=I.names),i.Workbook=S,i}(s.content,t);else if((o=lA.find(e,"PerfectOffice_MAIN"))&&o.content)i=hR.to_workbook(o.content,(t.type=l,t));else if((o=lA.find(e,"NativeContent_MAIN"))&&o.content)i=hR.to_workbook(o.content,(t.type=l,t));else if((o=lA.find(e,"MN0"))&&o.content)throw Error("Unsupported Works 4 for Mac file");else throw Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&lA.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=(r=e,a=lA.utils.cfb_new({root:"R"}),r.FullPaths.forEach(function(e,t){if("/"!==e.slice(-1)&&e.match(/_VBA_PROJECT_CUR/)){var n=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lA.utils.cfb_add(a,n,r.FileIndex[t].content)}}),lA.write(a)))}var c={};return e.FullPaths&&function(e,t,r){var a=lA.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=uQ(a,d5,pW);for(var s in n)t[s]=n[s]}catch(e){if(r.WTF)throw e}var i=lA.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=uQ(i,d4,pH);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(e){if(r.WTF)throw e}t.HeadingPairs&&t.TitlesOfParts&&(uR(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,c,t),i.Props=i.Custprops=c,t.bookFiles&&(i.cfb=e),i}var pG={0:{f:function(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=n/20),r}},1:{f:function(e){return[dV(e)]}},2:{f:function(e){return[dV(e),dK(e),"n"]}},3:{f:function(e){return[dV(e),e.read_shift(1),"e"]}},4:{f:function(e){return[dV(e),e.read_shift(1),"b"]}},5:{f:function(e){return[dV(e),dJ(e),"n"]}},6:{f:function(e){return[dV(e),dB(e),"str"]}},7:{f:function(e){return[dV(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var a=e.l+t,n=dV(e);n.r=r["!row"];var s=[n,dB(e),"str"];if(r.cellFormula){e.l+=2;var i=f1(e,a-e.l,r);s[3]=fZ(i,null,n,r.supbooks,r)}else e.l=a;return s}},9:{f:function(e,t,r){var a=e.l+t,n=dV(e);n.r=r["!row"];var s=[n,dJ(e),"n"];if(r.cellFormula){e.l+=2;var i=f1(e,a-e.l,r);s[3]=fZ(i,null,n,r.supbooks,r)}else e.l=a;return s}},10:{f:function(e,t,r){var a=e.l+t,n=dV(e);n.r=r["!row"];var s=[n,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=f1(e,a-e.l,r);s[3]=fZ(i,null,n,r.supbooks,r)}else e.l=a;return s}},11:{f:function(e,t,r){var a=e.l+t,n=dV(e);n.r=r["!row"];var s=[n,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=f1(e,a-e.l,r);s[3]=fZ(i,null,n,r.supbooks,r)}else e.l=a;return s}},12:{f:function(e){return[dH(e)]}},13:{f:function(e){return[dH(e),dK(e),"n"]}},14:{f:function(e){return[dH(e),e.read_shift(1),"e"]}},15:{f:function(e){return[dH(e),e.read_shift(1),"b"]}},16:{f:pw},17:{f:function(e){return[dH(e),dB(e),"str"]}},18:{f:function(e){return[dH(e),e.read_shift(4),"s"]}},19:{f:dz},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=dB(e),i=f1(e,0,r),o=dq(e);e.l=a;var l={Name:s,Ptg:i};return n<0xfffffff&&(l.Sheet=n),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var a,n={};n.sz=e.read_shift(2)/20;var s=(a=e.read_shift(1),e.l++,{fBold:1&a,fItalic:2&a,fUnderline:4&a,fStrikeout:8&a,fOutline:16&a,fShadow:32&a,fCondense:64&a,fExtend:128&a});switch(s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=function(e){var t={},r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r>>>1){case 0:t.auto=1;break;case 1:t.index=a;var l=d8[a];l&&(t.rgb=h2(l));break;case 2:t.rgb=h2([s,i,o]);break;case 3:t.theme=a}return 0!=n&&(t.tint=n>0?n/32767:n/32768),t}(e,8),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=dB(e,t-21),n}},44:{f:function(e,t){return[e.read_shift(2),dB(e,t-2)]}},45:{f:dg},46:{f:dg},47:{f:function(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:hC},62:{f:function(e){return[dV(e),dz(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=d_(r);var a=e.read_shift(1);return 2&a&&(t.l="1"),8&a&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dg,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},a=e[e.l];return++e.l,r.above=!(64&a),r.left=!(128&a),e.l+=18,r.name=dB(e,t-19),r}},148:{f:dY,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?dB(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(65536&a),r.backupFile=!!(64&a),r.checkCompatibility=!!(4096&a),r.date1904=!!(1&a),r.filterPrivacy=!!(8&a),r.hidePivotFieldList=!!(1024&a),r.promptedSolutions=!!(16&a),r.publishItems=!!(2048&a),r.refreshAllConnections=!!(262144&a),r.saveExternalLinkValues=!!(128&a),r.showBorderUnselectedTables=!!(4&a),r.showInkAnnotation=!!(32&a),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(32768&a),r.updateLinks=["userSet","never","always"][a>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=dq(e,t-8),r.name=dB(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:dY},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:dB(e,t-8)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:dq},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var a=e.l+t,n=dY(e,16),s=e.read_shift(1),i=[n];if(i[2]=s,r.cellFormula){var o=f1(e,a-e.l,r);i[1]=o}else e.l=a;return i}},427:{f:function(e,t,r){var a=e.l+t,n=[dY(e,16)];if(r.cellFormula){var s=f1(e,a-e.l,r);n[1]=s,e.l=a}else e.l=a;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return pk.forEach(function(r){t[r]=dJ(e,8)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,a=dY(e,16),n=dq(e),s=dB(e),i=dB(e),o=dB(e);e.l=r;var l={rfx:a,relId:n,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:dq},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:dB},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=dY(e,16);return t.rfx=r.s,t.ref=d_(r.s),e.l+=16,t}},636:{T:-1},637:{f:dz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:dB(e,t-10)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},pK={6:{f:f0},10:{f:uZ},12:{f:u2},13:{f:u2},14:{f:u0},15:{f:u0},16:{f:dJ},17:{f:u0},18:{f:u0},19:{f:u2},20:{f:hv},21:{f:hv},23:{f:hN},24:{f:hj},25:{f:u0},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=u9(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},o,i,s]}}(e,0,r)}},29:{},34:{f:u0},35:{f:hw},38:{f:dJ},39:{f:dJ},40:{f:dJ},41:{f:dJ},42:{f:u0},43:{f:u0},47:{f:function(e,t,r){var a,n,s,i={Type:r.biff>=8?e.read_shift(2):0};return i.Type?(a=t-2,(n=i||{}).Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=hK(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e,a):n.Data=function(e,t){var r={},a=r.EncryptionVersionInfo=hK(e,4);if(t-=4,2!=a.Minor)throw Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=hX(e,n),r.EncryptionVerifier=hY(e,t-=n),r}(e,a)):(r.biff,s={key:u2(e),verificationBytes:u2(e)},r.password&&(s.verifier=hQ(r.password)),i.valid=s.verificationBytes===s.verifier,i.valid&&(i.insitu=h0(r.password))),i}},49:{f:function(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return a.name=u6(e,0,r),a}},51:{f:u2},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:u0},65:{f:function(){}},66:{f:u2},77:{},80:{},81:{},82:{},85:{f:u2},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=u9(e,0,r);return e.read_shift(t+a-e.l),n}},93:{f:function(e,t,r){if(r&&r.biff<8){var a,n,s,i,o,l,c;return a=e,n=t,s=r,a.l+=4,i=a.read_shift(2),o=a.read_shift(2),l=a.read_shift(2),a.l+=2,a.l+=2,a.l+=2,a.l+=2,a.l+=2,a.l+=2,a.l+=2,a.l+=2,a.l+=2,a.l+=6,n-=36,(c=[]).push((hE[i]||dg)(a,n,s)),{cmo:[o,i,l],ft:c}}var d=hu(e,22),u=function(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(hf[n](e,r-e.l))}catch(t){return e.l=r,a}}return e.l!=r&&(e.l=r),a}(e,t-22,d[1]);return{cmo:d,ft:u}}},94:{},95:{f:u0},96:{},97:{},99:{f:u0},125:{f:hC},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var a=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&a,fBelow:64&a,fRight:128&a}}},130:{f:u2},131:{f:u0},132:{f:u0},133:{f:function(e,t,r){var a=e.read_shift(4),n=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=u6(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=d3[t]||t,t=e.read_shift(2),r[1]=d3[t]||t,r}},141:{f:u2},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(hn(e,8));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:u2},157:{},158:{},160:{f:u4},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=dJ(e,8),r.footer=dJ(e,8),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(ho(e));if(e.l!==r)throw Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}},193:{f:uZ},197:{},198:{},199:{},200:{},201:{},202:{f:u0},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:u2},220:{},221:{f:u0},222:{},224:{f:function(e,t,r){var a,n,s,i,o,l={};return l.ifnt=e.read_shift(2),l.numFmtId=e.read_shift(2),l.flags=e.read_shift(2),l.fStyle=l.flags>>2&1,t-=6,l.fStyle,a={},n=e.read_shift(4),s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(2),a.patternType=d6[i>>26],r.cellStyles&&(a.alc=7&n,a.fWrap=n>>3&1,a.alcV=n>>4&7,a.fJustLast=n>>7&1,a.trot=n>>8&255,a.cIndent=n>>16&15,a.fShrinkToFit=n>>20&1,a.iReadOrder=n>>22&2,a.fAtrNum=n>>26&1,a.fAtrFnt=n>>27&1,a.fAtrAlc=n>>28&1,a.fAtrBdr=n>>29&1,a.fAtrPat=n>>30&1,a.fAtrProt=n>>31&1,a.dgLeft=15&s,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=127&i,a.icvBottom=i>>7&127,a.icvDiag=i>>14&127,a.dgDiag=i>>21&15,a.icvFore=127&o,a.icvBack=o>>7&127,a.fsxButton=o>>14&1),l.data=a,l}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:uZ},227:{},229:{f:function(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(hl(e,t));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<r;++i)s.push(function(e){var t=oE;oE=1200;var r,a=e.read_shift(2),n=e.read_shift(1),s=4&n,i=8&n,o=0,l={};i&&(o=e.read_shift(2)),s&&(r=e.read_shift(4));var c=0===a?"":e.read_shift(a,2==1+(1&n)?"dbcs-cont":"sbcs-cont");return i&&(e.l+=4*o),s&&(e.l+=r),l.t=c,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),oE=t,l}(e));return s.Count=a,s.Unique=n,s}},253:{f:function(e){var t=hs(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:u4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:u0},353:{f:uZ},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,n];if(s<1||s>255)throw Error("Unexpected SupBook type: "+s);for(var i=u8(e,s),o=[];a>e.l;)o.push(u7(e));return[s,n,i,o]}},431:{f:u0},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:(e.read_shift(1),e.l++,e.read_shift(2),e.l+=2);var i=e.read_shift(2);e.read_shift(2),u2(e,2);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw Error("TxO: bad continue record");var c=e[e.l],d=u8(e,e.lens[l+1]-e.lens[l]-1);if((n+=d).length>=(c?i:2*i))break}if(n.length!==i&&n.length!==2*i)throw Error("cchText: "+i+" != "+n.length);return e.l=a+t,{t:n}}catch(r){return e.l=a+t,{t:n}}}},439:{f:u0},440:{f:function(e,t){var r=hl(e,8);return e.l+=16,[r,function(e,t){var r=e.l+t,a=e.read_shift(4);if(2!==a)throw Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,o,l,c,d,u="";16&n&&(s=ht(e,r-e.l)),128&n&&(i=ht(e,r-e.l)),(257&n)==257&&(o=ht(e,r-e.l)),(257&n)==1&&(l=function(e,t){var r,a,n,s,i=e.read_shift(16);switch(t-=16,i){case"e0c9ea79f9bace118c8200aa004ba90b":return r=e.read_shift(4),a=e.l,n=!1,r>24&&(e.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=a),s=e.read_shift((n?r-24:r)>>1,"utf16le").replace(oY,""),n&&(e.l+=24),s;case"0303000000000000c000000000000046":for(var o=e.read_shift(2),l="";o-- >0;)l+="../";var c=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw Error("Bad FileMoniker");if(0===e.read_shift(4))return l+c.replace(/\\/g,"/");var d=e.read_shift(4);if(3!=e.read_shift(2))throw Error("Bad FileMoniker");return l+e.read_shift(d>>1,"utf16le").replace(oY,"");default:throw Error("Unsupported Moniker "+i)}}(e,r-e.l)),8&n&&(u=ht(e,r-e.l)),32&n&&(c=e.read_shift(16)),64&n&&(d=uB(e)),e.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),2&n&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),d&&(f.time=d),s&&(f.Tooltip=s),f}(e,t-24)]}},441:{},442:{f:u7},443:{},444:{f:u2},445:{},446:{},448:{f:uZ},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:uZ},512:{f:hx},513:{f:hs},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var a=hs(e,6);return a.val=dJ(e,8),a}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var a=e.l+t,n=hs(e,6);return 2==r.biff&&e.l++,n.val=u7(e,a-e.l,r),n}},517:{f:hy},519:{f:u7},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,7&a&&(t.level=7&a),32&a&&(t.hidden=!0),64&a&&(t.hpt=r/20),t}},523:{},545:{f:hS},549:{f:hg},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=ho(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),u9(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var a=hd(e,6);e.l++;var n=e.read_shift(1);return[function(e,t,r){var a,n,s=e.l+t,i=e.read_shift(2),o=fX(e,i,r);return 65535==i?[[],(a=t-2,void(e.l+=a))]:(t!==i+2&&(n=fK(e,s-i-2,o,r)),[o,n])}(e,t-=8,r),n,a]}},2048:{f:function(e,t){e.read_shift(2);var r=hl(e,8),a=e.read_shift((t-10)/2,"dbcs-cont");return[r,a=a.replace(oY,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:hp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:uZ},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(function(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=function(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){e.l+=4}(e,4);break;case 2:t.xclrValue=ha(e,4);break;case 3:t.xclrValue=e.read_shift(4)}return e.l+=8,t}(e,r);break;case 6:a[1]=void(e.l+=r);break;case 14:case 15:a[1]=e.read_shift(1===r?1:2);break;default:throw Error("Unrecognized ExtProp type: "+t+" "+r)}return a}(e,r-e.l));return{ixfe:a,ext:s}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:u0,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2);return[u8(e,a,r),u8(e,n,r)]},r:12},2197:{},2198:{f:function(e,t,r){var a,n=e.l+t;if(124226!==e.read_shift(4)){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;try{a=l8(s,{type:"array"})}catch(e){return}var i=l5(a,"theme/theme/theme1.xml",!0);if(i)return fv(i,r)}},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:uZ},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t,r,a=(t=e.read_shift(2),r=e.read_shift(2),e.l+=8,{type:t,flags:r});if(2211!=a.type)throw Error("Invalid Future Record "+a.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:u2},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var a={area:!1};if(5!=r.biff)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,16&n&&(a.area=!0),a}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(hn(e,8));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hx},1:{},2:{f:function(e){var t=hs(e,6);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=hs(e,6);++e.l;var r=dJ(e,8);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var a=hs(e,6);++e.l;var n=u9(e,t-7,r);return a.t="str",a.val=n,a}},5:{f:hy},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:hp},11:{},22:{f:u2},30:{f:u9},31:{},32:{},33:{f:hS},36:{},37:{f:hg},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:u2},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var a=e.l+t,n=hs(e,6),s=e.read_shift(2),i=u8(e,s,r);return e.l=a,n.t="str",n.val=i,n}},223:{},234:{},354:{},421:{},518:{f:f0},521:{f:hp},536:{f:hj},547:{f:hw},561:{},579:{},1030:{f:f0},1033:{f:hp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function pX(e,t,r,a){if(!isNaN(t)){var n=a||(r||[]).length||0,s=e.next(4);s.write_shift(2,t),s.write_shift(2,n),n>0&&dr(r)&&e.push(r)}}function pY(e,t,r){return e||(e=dx(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function pQ(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];a&&a["!ref"]&&dO(a["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var n=t||{};switch(n.biff||2){case 8:case 5:var s=t||{},i=[];e&&!e.SSF&&(e.SSF=lq(o6)),e&&e.SSF&&(lS(),lN(e.SSF),s.revssf=lR(e.SSF),s.revssf[e.SSF[65535]]=0,s.ssf=e.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,mm(s),s.cellXfs=[],pa(s.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)i[i.length]=function(e,t,r){var a,n,s,i,o,l,c,d,u,h=dy(),f=r.SheetNames[e],p=r.Sheets[f]||{},m=(r||{}).Workbook||{},g=(m.Sheets||[])[e]||{},x=Array.isArray(p),b=8==t.biff,y="",v=[],w=dD(p["!ref"]||"A1"),k=b?65536:16384;if(w.e.c>255||w.e.r>=k){if(t.WTF)throw Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,k-1)}pX(h,2057,hm(r,16,t)),pX(h,13,u5(1)),pX(h,12,u5(100)),pX(h,15,u1(!0)),pX(h,17,u1(!1)),pX(h,16,dZ(.001)),pX(h,95,u1(!0)),pX(h,42,u1(!1)),pX(h,43,u1(!1)),pX(h,130,u5(1)),pX(h,128,(a=[0,0],(n=dx(8)).write_shift(4,0),n.write_shift(2,a[0]?a[0]+1:0),n.write_shift(2,a[1]?a[1]+1:0),n)),pX(h,131,u1(!1)),pX(h,132,u1(!1)),b&&function(e,t){if(t){var r=0;t.forEach(function(t,a){var n,s,i;++r<=256&&t&&pX(e,125,(n=pt(a,t),(s=dx(12)).write_shift(2,a),s.write_shift(2,a),s.write_shift(2,256*n.width),s.write_shift(2,0),i=0,n.hidden&&(i|=1),s.write_shift(1,i),i=n.level||0,s.write_shift(1,i),s.write_shift(2,0),s))})}}(h,p["!cols"]),pX(h,512,((i=dx(2*(s=8!=t.biff&&t.biff?2:4)+6)).write_shift(s,w.s.r),i.write_shift(s,w.e.r+1),i.write_shift(2,w.s.c),i.write_shift(2,w.e.c+1),i.write_shift(2,0),i)),b&&(p["!links"]=[]);for(var j=w.s.r;j<=w.e.r;++j){y=dE(j);for(var N=w.s.c;N<=w.e.c;++N){j===w.s.r&&(v[N]=dT(N)),u=v[N]+y;var S=x?(p[j]||[])[N]:p[u];S&&(!function(e,t,r,a,n){var s=16+pa(n.cellXfs,t,n);if(null==t.v&&!t.bf)return pX(e,513,hi(r,a,s));if(t.bf)pX(e,6,function(e,t,r,a,n){var s=hi(t,r,n),i=function(e){if(null==e){var t=dx(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return"number"==typeof e?dZ(e):dZ(0)}(e.v),o=dx(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=dx(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return oX([s,i,o,l])}(t,r,a,0,s));else switch(t.t){case"d":case"n":var i,o="d"==t.t?lI(lH(t.v)):t.v;pX(e,515,(hi(r,a,s,i=dx(14)),dZ(o,i),i));break;case"b":case"e":pX(e,517,(l=t.v,c=t.t,hi(r,a,s,d=dx(8)),u3(l,c,d),d));break;case"s":case"str":if(n.bookSST){var l,c,d,u,h,f,p,m=pe(n.Strings,t.v,n.revStrings);pX(e,253,(hi(r,a,s,p=dx(10)),p.write_shift(4,m),p))}else pX(e,516,(u=(t.v||"").slice(0,255),hi(r,a,s,f=dx(8+ +(h=!n||8==n.biff)+(1+h)*u.length)),f.write_shift(2,u.length),h&&f.write_shift(1,1),f.write_shift((1+h)*u.length,u,h?"utf16le":"sbcs"),f));break;default:pX(e,513,hi(r,a,s))}}(h,S,j,N,t),b&&S.l&&p["!links"].push([u,S.l]))}}var E=g.CodeName||g.name||f;return b&&pX(h,574,(o=(m.Views||[])[0],l=dx(18),c=1718,o&&o.RTL&&(c|=64),l.write_shift(2,c),l.write_shift(4,0),l.write_shift(4,64),l.write_shift(4,0),l.write_shift(4,0),l)),b&&(p["!merges"]||[]).length&&pX(h,229,function(e){var t=dx(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)hc(e[r],t);return t}(p["!merges"])),b&&function(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];pX(e,440,function(e){var t=dx(24),r=dA(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return oX([t,function(e){var t=dx(512),r=0,a=e.Target;"file://"==a.slice(0,7)&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==s)hr(a=a.slice(1),t);else if(2&s){for(r=0,i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&s&&hr(n>-1?a.slice(n+1):"",t)}else{for(r=0,i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" ");r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;"../"==a.slice(3*l,3*l+3)||"..\\"==a.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,a.length-3*l+1),r=0;r<a.length-3*l;++r)t.write_shift(1,255&a.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}(e[1])])}(a)),a[1].Tooltip&&pX(e,2048,function(e){var t=e[1].Tooltip,r=dx(10+2*(t.length+1));r.write_shift(2,2048);var a=dA(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}(a))}delete t["!links"]}(h,p),pX(h,442,he(E,t)),b&&((d=dx(19)).write_shift(4,2151),d.write_shift(4,0),d.write_shift(4,0),d.write_shift(2,3),d.write_shift(1,1),d.write_shift(4,0),pX(h,2151,d),(d=dx(39)).write_shift(4,2152),d.write_shift(4,0),d.write_shift(4,0),d.write_shift(2,3),d.write_shift(1,0),d.write_shift(4,0),d.write_shift(2,1),d.write_shift(4,4),d.write_shift(2,0),hc(dD(p["!ref"]||"A1"),d),d.write_shift(4,4),pX(h,2152,d)),pX(h,10),h.end()}(o,s,e);return i.unshift(function(e,t,r){var a,n,s,i,o,l,c,d=dy(),u=(e||{}).Workbook||{},h=u.Sheets||[],f=u.WBProps||{},p=8==r.biff,m=5==r.biff;pX(d,2057,hm(e,5,r)),"xla"==r.bookType&&pX(d,135),pX(d,225,p?u5(1200):null),pX(d,193,function(e,t){t||(t=dx(2));for(var r=0;r<2;++r)t.write_shift(1,0);return t}(0)),m&&pX(d,191),m&&pX(d,192),pX(d,226),pX(d,92,function(e,t){var r=!t||8==t.biff,a=dx(r?112:54);for(a.write_shift(8==t.biff?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,0x33336853),a.write_shift(4,5458548|0x20000000*!r);a.l<a.length;)a.write_shift(1,32*!r);return a}(0,r)),pX(d,66,u5(p?1200:1252)),p&&pX(d,353,u5(0)),p&&pX(d,448),pX(d,317,function(e){for(var t=dx(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),p&&e.vbaraw&&pX(d,211),p&&e.vbaraw&&pX(d,442,he(f.CodeName||"ThisWorkbook",r)),pX(d,156,u5(17)),pX(d,25,u1(!1)),pX(d,18,u1(!1)),pX(d,19,u5(0)),p&&pX(d,431,u1(!1)),p&&pX(d,444,u5(0)),pX(d,61,((a=dx(18)).write_shift(2,0),a.write_shift(2,0),a.write_shift(2,29280),a.write_shift(2,17600),a.write_shift(2,56),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,1),a.write_shift(2,500),a)),pX(d,64,u1(!1)),pX(d,141,u5(0)),pX(d,34,u1("true"==(e.Workbook&&e.Workbook.WBProps&&cx(e.Workbook.WBProps.date1904)?"true":"false"))),pX(d,14,u1(!0)),p&&pX(d,439,u1(!1)),pX(d,218,u5(0)),pX(d,49,(s=(n={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(o=dx((i=r&&5==r.biff)?15+s.length:16+2*s.length)).write_shift(2,20*(n.sz||12)),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,s.length),i||o.write_shift(1,1),o.write_shift((i?1:2)*s.length,s,i?"sbcs":"utf16le"),o)),l=e.SSF,l&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=l[t]&&pX(d,1054,function(e,t,r,a){var n=r&&5==r.biff;a||(a=dx(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return null==s.l&&(s.l=s.length),s}(t,l[t],r))});for(var g=0;g<16;++g)pX(d,224,hb({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(e){pX(d,224,hb(e,0,r))}),p&&pX(d,352,u1(!1));var x=d.end(),b=dy();p&&pX(b,140,(c||(c=dx(4)),c.write_shift(2,1),c.write_shift(2,1),c)),p&&r.Strings&&function(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return pX(e,252,r,n);if(!isNaN(252)){for(var s=r.parts||[],i=0,o=0,l=0;l+(s[i]||8224)<=8224;)l+=s[i]||8224,i++;var c=e.next(4);for(c.write_shift(2,252),c.write_shift(2,l),e.push(r.slice(o,o+l)),o+=l;o<n;){for((c=e.next(4)).write_shift(2,60),l=0;l+(s[i]||8224)<=8224;)l+=s[i]||8224,i++;c.write_shift(2,l),e.push(r.slice(o,o+l)),o+=l}}}(b,0,function(e,t){var r=dx(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=function(e){var t=e.t||"",r=dx(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=dx(2*t.length);return a.write_shift(2*t.length,t,"utf16le"),oX([r,a])}(e[n],t);var s=oX([r].concat(a));return s.parts=[r.length].concat(a.map(function(e){return e.length})),s}(r.Strings,r)),pX(b,10);var y=b.end(),v=dy(),w=0,k=0;for(k=0;k<e.SheetNames.length;++k)w+=(p?12:11)+(p?2:1)*e.SheetNames[k].length;var j=x.length+w+y.length;for(k=0;k<e.SheetNames.length;++k)pX(v,133,function(e,t){var r=!t||t.biff>=8?2:1,a=dx(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}({pos:j,hs:(h[k]||{}).Hidden||0,dt:0,name:e.SheetNames[k]},r)),j+=t[k].length;var N=v.end();if(w!=N.length)throw Error("BS8 "+w+" != "+N.length);var S=[];return x.length&&S.push(x),N.length&&S.push(N),y.length&&S.push(y),oX(S)}(e,i,s)),oX(i);case 4:case 3:case 2:for(var l=t||{},c=dy(),d=0,u=0;u<e.SheetNames.length;++u)e.SheetNames[u]==l.sheet&&(d=u);if(0==d&&l.sheet&&e.SheetNames[0]!=l.sheet)throw Error("Sheet not found: "+l.sheet);return pX(c,4==l.biff?1033:3==l.biff?521:9,hm(e,16,l)),!function(e,t,r,a){var n,s=Array.isArray(t),i=dD(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),n=dP(i)}for(var c=i.s.r;c<=i.e.r;++c){o=dE(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(l[d]=dT(d)),n=l[d]+o;var u=s?(t[c]||[])[d]:t[n];u&&function(e,t,r,a){if(null!=t.v)switch(t.t){case"d":case"n":var n,s,i,o,l,c,d,u="d"==t.t?lI(lH(t.v)):t.v;u==(0|u)&&u>=0&&u<65536?pX(e,2,(pY(c=dx(9),r,a),c.write_shift(2,u),c)):pX(e,3,(pY(d=dx(15),r,a),d.write_shift(8,u,"f"),d));return;case"b":case"e":pX(e,5,(n=t.v,s=t.t,pY(i=dx(9),r,a),u3(n,s||"b",i),i));return;case"s":case"str":pX(e,4,(pY(l=dx(8+2*(o=(t.v||"").slice(0,255)).length),r,a),l.write_shift(1,o.length),l.write_shift(o.length,o,"sbcs"),l.l<l.length?l.slice(0,l.l):l));return}pX(e,1,pY(null,r,a))}(e,u,c,d,a)}}}(c,e.Sheets[e.SheetNames[d]],0,l,e),pX(c,10),c.end()}throw Error("invalid type "+n.bookType+" for BIFF")}function pJ(e,t){var r=t||{},a=r.dense?[]:{},n=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!n)throw Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,o=s&&s.index||e.length,l=lQ(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<l.length;++i){var m=l[i].trim(),g=m.slice(0,3).toLowerCase();if("<tr"==g){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0;continue}if("<td"==g||"<th"==g){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var b=x[o].trim();if(b.match(/<t[dh]/i)){for(var y=b,v=0;"<"==y.charAt(0)&&(v=y.indexOf(">"))>-1;)y=y.slice(v+1);for(var w=0;w<p.length;++w){var k=p[w];k.s.c==d&&k.s.r<c&&c<=k.e.r&&(d=k.e.c+1,w=-1)}var j=cs(b.slice(0,b.indexOf(">")));h=j.colspan?+j.colspan:1,((u=+j.rowspan)>1||h>1)&&p.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+h-1}});var N=j.t||j["data-t"]||"";if(!y.length||(y=cS(y),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>d&&(f.s.c=d),f.e.c<d&&(f.e.c=d),!y.length)){d+=h;continue}var S={t:"s",v:y};r.raw||!y.trim().length||"s"==N||("TRUE"===y?S={t:"b",v:!0}:"FALSE"===y?S={t:"b",v:!1}:isNaN(lK(y))?isNaN(lY(y).getDate())||(S={t:"d",v:lH(y)},r.cellDates||(S={t:"n",v:lI(S.v)}),S.z=r.dateNF||o6[14]):S={t:"n",v:lK(y)}),r.dense?(a[c]||(a[c]=[]),a[c][d]=S):a[d_({r:c,c:d})]=S,d+=h}}}}return a["!ref"]=dP(f),p.length&&(a["!merges"]=p),a}var pZ={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function p0(e,t){var r=t||{},a,n,s,i,o,l,c=cM(e),d=[],u={name:""},h="",f=0,p={},m=[],g=r.dense?[]:{},x={value:""},b="",y=0,v=[],w=-1,k=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,S={},E=[],C={},T=0,A=[],_=1,O=1,P=[],D={Names:[]},R={},M=["",""],I=[],L={},F="",B=0,U=!1,z=!1,V=0;for(cI.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=cI.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"":"/"===o[1]?(j.e.c>=j.s.c&&j.e.r>=j.s.r?g["!ref"]=dP(j):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(g["!fullref"]=g["!ref"],j.e.r=r.sheetRows-1,g["!ref"]=dP(j)),E.length&&(g["!merges"]=E),A.length&&(g["!rows"]=A),s.name=s[""]||s.name,"undefined"!=typeof JSON&&JSON.stringify(s),m.push(s.name),p[s.name]=g,z=!1):"/"!==o[0].charAt(o[0].length-2)&&(s=cs(o[0],!1),w=k=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,g=r.dense?[]:{},E=[],A=[],z=!0);break;case"table-row-group":"/"===o[1]?--N:++N;break;case"table-row":case"":if("/"===o[1]){w+=_,_=1;break}if((i=cs(o[0],!1))[""]?w=i[""]-1:-1==w&&(w=0),(_=+i["number-rows-repeated"]||1)<10)for(V=0;V<_;++V)N>0&&(A[w+V]={level:N});k=-1;break;case"covered-table-cell":"/"!==o[1]&&++k,r.sheetStubs&&(r.dense?(g[w]||(g[w]=[]),g[w][k]={t:"z"}):g[d_({r:w,c:k})]={t:"z"}),b="",v=[];break;case"table-cell":case"":if("/"===o[0].charAt(o[0].length-2))++k,O=parseInt((x=cs(o[0],!1))["number-columns-repeated"]||"1",10),l={t:"z",v:null},x.formula&&!1!=r.cellFormula&&(l.f=f3(cc(x.formula))),"string"==(x[""]||x["value-type"])&&(l.t="s",l.v=cc(x["string-value"]||""),r.dense?(g[w]||(g[w]=[]),g[w][k]=l):g[d_({r:w,c:k})]=l),k+=O-1;else if("/"!==o[1]){b="",y=0,v=[],O=1;var H=_?w+_-1:w;if(++k>j.e.c&&(j.e.c=k),k<j.s.c&&(j.s.c=k),w<j.s.r&&(j.s.r=w),H>j.e.r&&(j.e.r=H),x=cs(o[0],!1),I=[],L={},l={t:x[""]||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=cc(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(C={s:{r:w,c:k},e:{r:w+(T=parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:k+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},l.F=dP(C),P.push([C,l.F])),x.formula)l.f=f3(x.formula);else for(V=0;V<P.length;++V)w>=P[V][0].s.r&&w<=P[V][0].e.r&&k>=P[V][0].s.c&&k<=P[V][0].e.c&&(l.F=P[V][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(C={s:{r:w,c:k},e:{r:w+(T=parseInt(x["number-rows-spanned"],10)||0)-1,c:k+(parseInt(x["number-columns-spanned"],10)||0)-1}},E.push(C)),x["number-columns-repeated"]&&(O=parseInt(x["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=cx(x["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(x.value);break;case"date":l.t="d",l.v=lH(x["date-value"]),r.cellDates||(l.t="n",l.v=lI(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=function(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}(x["time-value"])/86400,r.cellDates&&(l.t="d",l.v=lU(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(x[""]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw Error("Unsupported value type "+l.t);l.t="s",null!=x["string-value"]&&(b=cc(x["string-value"]),v=[])}}else{if(U=!1,"s"===l.t&&(l.v=b||"",v.length&&(l.R=v),U=0==y),R.Target&&(l.l=R),I.length>0&&(l.c=I,I=[]),b&&!1!==r.cellText&&(l.w=b),U&&(l.t="z",delete l.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var W=0;W<_;++W){if(O=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[w+W]||(g[w+W]=[]),g[w+W][k]=0==W?l:lq(l);--O>0;)g[w+W][k+O]=lq(l);else for(g[d_({r:w+W,c:k})]=l;--O>0;)g[d_({r:w+W,c:k+O})]=lq(l);j.e.c<=k&&(j.e.c=k)}k+=(O=parseInt(x["number-columns-repeated"]||"1",10))-1,O=0,l={},b="",v=[]}R={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((a=d.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((a=d.pop())[0]!==o[3])throw"Bad state: "+a;L.t=b,v.length&&(L.R=v),L.a=F,I.push(L)}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);F="",B=0,b="",y=0,v=[];break;case"creator":"/"===o[1]?F=c.slice(B,o.index):B=o.index+o[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((a=d.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&d.push([o[3],!1]);b="",y=0,v=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(S[u.name]=h,(a=d.pop())[0]!==o[3])throw"Bad state: "+a}else"/"!==o[0].charAt(o[0].length-2)&&(h="",u=cs(o[0],!1),d.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":n=cs(o[0],!1),h+=pZ[o[3]][+("long"===n.style)]}break;case"text":if("/>"===o[0].slice(-2));else if("/"===o[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(f,o.index)}else f=o.index+o[0].length;break;case"named-range":M=f6((n=cs(o[0],!1))["cell-range-address"]);var q={Name:n.name,Ref:M[0]+"!"+M[1]};z&&(q.Sheet=m.length),D.Names.push(q);break;case"p":case"":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==o[1]||x&&x["string-value"])cs(o[0],!1),y=o.index+o[0].length;else{var G=[cc(c.slice(y,o.index).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,"\n").replace(/<[^>]*>/g,""))];b=(b.length>0?b+"\n":"")+G[0]}break;case"database-range":if("/"===o[1])break;try{p[(M=f6(cs(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:M[1]}}catch(e){}break;case"a":if("/"!==o[1]){if(!(R=cs(o[0],!1)).href)break;R.Target=cc(R.href),delete R.href,"#"==R.Target.charAt(0)&&R.Target.indexOf(".")>-1?(M=f6(R.Target.slice(1)),R.Target="#"+M[0]+"!"+M[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw Error(o)}}var K={Sheets:p,SheetNames:m,Workbook:D};return r.bookSheets&&delete K.Sheets,K}var p1=(X="<office:document-styles "+cP({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+'><office:master-styles><style:master-page style:name="mp1" style:page-layout-name="mp1"><style:header/><style:header-left style:display="false"/><style:footer/><style:footer-left style:display="false"/></style:master-page></office:master-styles></office:document-styles>',function(){return l9+X}),p2=(Y="          <table:table-cell />\n",Q=function(e,t,r){var a=[];a.push('      <table:table table:name="'+ch(t.SheetNames[r])+'" table:style-name="ta1">\n');var n=0,s=0,i=dO(e["!ref"]||"A1"),o=e["!merges"]||[],l=0,c=Array.isArray(e);if(e["!cols"])for(s=0;s<=i.e.c;++s)a.push("        <table:table-column"+(e["!cols"][s]?' table:style-name="co'+e["!cols"][s].ods+'"':"")+"></table:table-column>\n");var d="",u=e["!rows"]||[];for(n=0;n<i.s.r;++n)d=u[n]?' table:style-name="ro'+u[n].ods+'"':"",a.push("        <table:table-row"+d+"></table:table-row>\n");for(;n<=i.e.r;++n){for(d=u[n]?' table:style-name="ro'+u[n].ods+'"':"",a.push("        <table:table-row"+d+">\n"),s=0;s<i.s.c;++s)a.push(Y);for(;s<=i.e.c;++s){var h=!1,f={},p="";for(l=0;l!=o.length;++l)if(!(o[l].s.c>s)&&!(o[l].s.r>n)&&!(o[l].e.c<s)&&!(o[l].e.r<n)){(o[l].s.c!=s||o[l].s.r!=n)&&(h=!0),f["table:number-columns-spanned"]=o[l].e.c-o[l].s.c+1,f["table:number-rows-spanned"]=o[l].e.r-o[l].s.r+1;break}if(h){a.push("          <table:covered-table-cell/>\n");continue}var m=d_({r:n,c:s}),g=c?(e[n]||[])[s]:e[m];if(g&&g.f&&(f["table:formula"]=ch(("of:="+g.f.replace(fA,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),g.F&&g.F.slice(0,m.length)==m)){var x=dO(g.F);f["table:number-matrix-columns-spanned"]=x.e.c-x.s.c+1,f["table:number-matrix-rows-spanned"]=x.e.r-x.s.r+1}if(!g){a.push(Y);continue}switch(g.t){case"b":p=g.v?"TRUE":"FALSE",f["office:value-type"]="boolean",f["office:boolean-value"]=g.v?"true":"false";break;case"n":p=g.w||String(g.v||0),f["office:value-type"]="float",f["office:value"]=g.v||0;break;case"s":case"str":p=null==g.v?"":g.v,f["office:value-type"]="string";break;case"d":p=g.w||lH(g.v).toISOString(),f["office:value-type"]="date",f["office:date-value"]=lH(g.v).toISOString(),f["table:style-name"]="ce1";break;default:a.push(Y);continue}var b=ch(p).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(g.l&&g.l.Target){var y=g.l.Target;"#"==(y="#"==y.charAt(0)?"#"+y.slice(1).replace(/\./,"!"):y).charAt(0)||y.match(/^\w+:/)||(y="../"+y),b=cD("text:a",b,{"xlink:href":y.replace(/&/g,"&amp;")})}a.push("          "+cD("table:table-cell",cD("text:p",b,{}),f)+"\n")}a.push("        </table:table-row>\n")}return a.push("      </table:table>\n"),a.join("")},J=function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"]){for(var a=0;a<t["!cols"].length;++a)if(t["!cols"][a]){var n=t["!cols"][a];if(null==n.width&&null==n.wpx&&null==n.wch)continue;fe(n),n.ods=r;var s=t["!cols"][a].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++r}}});var a=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"]){for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=a;var n=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+a+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+n+'"/>\n'),e.push("  </style:style>\n"),++a}}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")},function(e,t){var r=[l9],a=cP({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),n=cP({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+n+">\n"),r.push(uE().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),J(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(Q(e.Sheets[e.SheetNames[s]],e,s,t));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")});function p5(e,t){if("fods"==t.bookType)return p2(e,t);var r=l6(),a="",n=[],s=[];return l3(r,a="mimetype","application/vnd.oasis.opendocument.spreadsheet"),l3(r,a="content.xml",p2(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),l3(r,a="styles.xml",p1(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),l3(r,a="meta.xml",l9+uE()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),l3(r,a="manifest.rdf",function(e){var t=[l9];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(uS(e[r][0],e[r][1])),t.push('  <rdf:Description rdf:about="">\n    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[r][0]+'"/>\n  </rdf:Description>\n');return t.push(uS("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),n.push([a,"application/rdf+xml"]),l3(r,a="META-INF/manifest.xml",function(e){var t=[l9];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(n)),r}function p4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function p3(e){return"undefined"!=typeof TextDecoder?new TextDecoder().decode(e):ck(oG(e))}function p6(e){var t=new Uint8Array(e.reduce(function(e,t){return e+t.length},0)),r=0;return e.forEach(function(e){t.set(e,r),r+=e.length}),t}function p8(e){return e-=e>>1&0x55555555,((e=(0x33333333&e)+(e>>2&0x33333333))+(e>>4)&0xf0f0f0f)*0x1010101>>>24}function p7(e,t){var r=t?t[0]:0,a=127&e[r];r:if(e[r++]>=128&&(a|=(127&e[r])<<7,e[r++]<128||(a|=(127&e[r])<<14,e[r++]<128)||(a|=(127&e[r])<<21,e[r++]<128)||(a+=(127&e[r])*0x10000000,++r,e[r++]<128)||(a+=(127&e[r])*0x800000000,++r,e[r++]<128)||(a+=(127&e[r])*0x40000000000,++r,e[r++]<128)))break r;return t&&(t[0]=r),a}function p9(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;a:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=0xfffffff)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=0x7ffffffff)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=0x3ffffffffff))break a;t[r-1]|=128,t[r]=e/0x1000000>>>21&127,++r}return t.slice(0,r)}function me(e){var t=0,r=127&e[0];r:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128||(r|=(127&e[t])<<14,e[t++]<128)||(r|=(127&e[t])<<21,e[t++]<128))break r;r|=(127&e[t])<<28}return r}function mt(e){for(var t=[],r=[0];r[0]<e.length;){var a,n=r[0],s=p7(e,r),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0]);break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=p7(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:a,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function mr(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(p9(8*r+e.type)),2==e.type&&t.push(p9(e.data.length)),t.push(e.data))})}),p6(t)}function ma(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function mn(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=p7(e,a),s=mt(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:me(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=mt(t.data),n=me(r[3][0].data);i.messages.push({meta:r,data:e.slice(a[0],a[0]+n)}),a[0]+=n}),(null==(t=s[3])?void 0:t[0])&&(i.merge=me(s[3][0].data)>>>0>0),r.push(i)}return r}function ms(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:p9(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:p9(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(e){a.push(e.data),e.meta[3]=[{type:0,data:p9(e.data.length)}],r[2].push({data:mr(e.meta),type:2})});var n=mr(r);t.push(p9(n.length)),t.push(n),a.forEach(function(e){return t.push(e)})}),p6(t)}function mi(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(function(e,t){if(0!=e)throw Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=p7(t,r),n=[];r[0]<t.length;){var s=3&t[r[0]];if(0==s){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}n.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}var l=0,c=0;if(1==s?(c=(t[r[0]]>>2&7)+4,l=(224&t[r[0]++])<<3|t[r[0]++]):(c=(t[r[0]++]>>2)+1,2==s?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[p6(n)],0==l)throw Error("Invalid offset 0");if(l>n[0].length)throw Error("Invalid offset beyond length");if(c>=l)for(n.push(n[0].slice(-l)),c-=l;c>=n[n.length-1].length;)n.push(n[n.length-1]),c-=n[n.length-1].length;n.push(n[0].slice(-l,-l+c))}var d=p6(n);if(d.length!=a)throw Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw Error("data is not a valid framed stream!");return p6(t)}function mo(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,0xfffffff),n=new Uint8Array(4);t.push(n);var s=p9(a),i=s.length;t.push(s),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=0x1000000?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=0x100000000&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,n[0]=0,n[1]=255&i,n[2]=i>>8&255,n[3]=i>>16&255,r+=a}return p6(t)}function ml(e,t){var r=new Uint8Array(32),a=p4(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var a=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(127&a)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=255&n;e[t+15]|=r>=0?0:128}(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,+!!e.v,!0),s|=2,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function mc(e,t){var r=new Uint8Array(32),a=p4(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,+!!e.v,!0),s|=32,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function md(e){return p7(mt(e)[1][0].data)}function mu(e,t){var r=mt(t.data),a=me(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(t){var r=mt(t.data),n=me(r[1][0].data)>>>0;switch(a){case 1:s[n]=p3(r[3][0].data);break;case 8:var i=mt(e[md(r[9][0].data)][0].data),o=e[md(i[1][0].data)][0],l=me(o.meta[1][0].data);if(2001!=l)throw Error("2000 unexpected reference to ".concat(l));var c=mt(o.data);s[n]=c[3].map(function(e){return p3(e.data)}).join("")}}),s}function mh(e){var t,r,a,n,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){var t,r;if(e.name.match(/\.iwa$/)){try{t=mi(e.content)}catch(t){return console.log("?? "+e.content.length+" "+(t.message||t))}try{r=mn(t)}catch(e){return console.log("## "+(e.message||e))}r.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw Error("File has no messages");var o=(null==(n=null==(a=null==(r=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:r.meta)?void 0:a[1])?void 0:n[0].data)&&1==me(s[1][0].meta[1][0].data)&&s[1][0];if(o||i.forEach(function(e){s[e].forEach(function(e){if(1==me(e.meta[1][0].data)>>>0)if(o)throw Error("Document has multiple roots");else o=e})}),!o)throw Error("Cannot find Document root");var l=o,c=mC();if(ma(mt(l.data)[1],md).forEach(function(e){s[e].forEach(function(e){if(2==me(e.meta[1][0].data)){var t,r,a,n=(a={name:(null==(t=(r=mt(e.data))[1])?void 0:t[0])?p3(r[1][0].data):"",sheets:[]},ma(r[2],md).forEach(function(e){s[e].forEach(function(e){6e3==me(e.meta[1][0].data)&&a.sheets.push(function(e,t){var r=mt(t.data),a={"!ref":"A1"},n=e[md(r[2][0].data)],s=me(n[0].meta[1][0].data);if(6001!=s)throw Error("6000 unexpected reference to ".concat(s));return!function(e,t,r){var a,n=mt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(me(n[6][0].data)>>>0)-1,s.e.r<0)throw Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(me(n[7][0].data)>>>0)-1,s.e.c<0)throw Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=dP(s);var i=mt(n[4][0].data),o=mu(e,e[md(i[4][0].data)][0]),l=(null==(a=i[17])?void 0:a[0])?mu(e,e[md(i[17][0].data)][0]):[],c=mt(i[3][0].data),d=0;c[1].forEach(function(t){var a,n,s,i,c=e[md(mt(t.data)[2][0].data)][0],u=me(c.meta[1][0].data);if(6002!=u)throw Error("6001 unexpected reference to ".concat(u));var h=(s=(null==(a=null==(n=mt(c.data))?void 0:n[7])?void 0:a[0])?+(me(n[7][0].data)>>>0>0):-1,i=ma(n[5],function(e){return function(e,t){var r,a,n,s,i,o,l,c,d,u,h,f,p,m,g,x,b=mt(e),y=me(b[1][0].data)>>>0,v=me(b[2][0].data)>>>0,w=(null==(a=null==(r=b[8])?void 0:r[0])?void 0:a.data)&&me(b[8][0].data)>0||!1;if((null==(s=null==(n=b[7])?void 0:n[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=b[7])?void 0:i[0])?void 0:o.data,x=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else if((null==(u=null==(d=b[4])?void 0:d[0])?void 0:u.data)&&1!=t)g=null==(f=null==(h=b[4])?void 0:h[0])?void 0:f.data,x=null==(m=null==(p=b[3])?void 0:p[0])?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=w?4:1,j=p4(g),N=[],S=0;S<g.length/2;++S){var E=j.getUint16(2*S,!0);E<65535&&N.push([S,E])}if(N.length!=v)throw"Expected ".concat(v," cells, found ").concat(N.length);var C=[];for(S=0;S<N.length-1;++S)C[N[S][0]]=x.subarray(N[S][1]*k,N[S+1][1]*k);return N.length>=1&&(C[N[N.length-1][0]]=x.subarray(N[N.length-1][1]*k)),{R:y,cells:C}}(e,s)}),{nrows:me(n[4][0].data)>>>0,data:i.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,a){if(e[t.R][a])throw Error("Duplicate cell r=".concat(t.R," c=").concat(a));e[t.R][a]=r}),e},[])});h.data.forEach(function(e,t){e.forEach(function(e,a){var n=d_({r:d+t,c:a}),s=function(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,a){var n,s=p4(e),i=s.getUint32(4,!0),o=(a>1?12:8)+4*p8(i&(a>1?3470:398)),l=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&i&&(l=s.getUint32(o,!0),o+=4),o+=4*p8(i&(a>1?12288:4096)),16&i&&(c=s.getUint32(o,!0),o+=4),32&i&&(d=s.getFloat64(o,!0),o+=8),64&i&&(u.setTime(u.getTime()+1e3*s.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:n={t:"n",v:d};break;case 3:n={t:"s",v:t[c]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:d>0};break;case 7:n={t:"n",v:d/86400};break;case 8:n={t:"e",v:0};break;case 9:if(l>-1)n={t:"s",v:r[l]};else if(c>-1)n={t:"s",v:t[c]};else if(isNaN(d))throw Error("Unsupported cell type ".concat(e.slice(0,4)));else n={t:"n",v:d};break;default:throw Error("Unsupported cell type ".concat(e.slice(0,4)))}return n}(e,t,r,e[0]);case 5:return function(e,t,r){var a,n=p4(e),s=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,a=1&e[t+14],n=t+13;n>=t;--n)a=256*a+e[n];return(128&e[t+15]?-a:a)*Math.pow(10,r-6176)}(e,i),i+=16),2&s&&(d=n.getFloat64(i,!0),i+=8),4&s&&(u.setTime(u.getTime()+1e3*n.getFloat64(i,!0)),i+=8),8&s&&(l=n.getUint32(i,!0),i+=4),16&s&&(o=n.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:a={t:"n",v:c};break;case 3:a={t:"s",v:t[l]};break;case 5:a={t:"d",v:u};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(o>-1)a={t:"s",v:r[o]};else throw Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));break;default:throw Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return a}(e,t,r);default:throw Error("Unsupported payload version ".concat(e[0]))}}(e,o,l);s&&(r[n]=s)})}),d+=h.nrows})}(e,n[0],a),a}(s,e))})}),a);n.sheets.forEach(function(e,t){mT(c,e,0==t?n.name:n.name+"_"+t,!0)})}})}),0==c.SheetNames.length)throw Error("Empty NUMBERS file");return c}function mf(e){return function(t){for(var r=0;r!=e.length;++r){var a=e[r];void 0===t[a[0]]&&(t[a[0]]=a[1]),"n"===a[2]&&(t[a[0]]=Number(t[a[0]]))}}}function mp(e){mf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function mm(e){mf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function mg(e){return"/"==e.charAt(0)?e.slice(1):e}function mx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=oU(e.slice(0,12));break;case"binary":r=e;break;default:throw Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function mb(e,t){var r=0;n:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return pB(e.slice(r),t);default:break n}return hD.to_workbook(e,t)}function my(e,t,r,a){return a?(r.type="string",hD.to_workbook(e,r)):hD.to_workbook(t,r)}function mv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return l_(t.file,lA.write(e,{type:oz?"buffer":""}));case"string":throw Error("'string' output type invalid for '"+t.bookType+"' files");default:throw Error("Unrecognized type "+t.type)}return lA.write(e,t)}function mw(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return oB(cj(a));case"binary":return cj(a);case"string":return e;case"file":return l_(t.file,a,"utf8");case"buffer":if(oz)return oV(a,"utf8");if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(a);return mw(a,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw Error("Unrecognized type "+t.type)}function mk(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return"base64"==t.type?oB(r):"string"==t.type?ck(r):r;case"file":return l_(t.file,e);case"buffer":return e;default:throw Error("Unrecognized type "+t.type)}}function mj(e,t,r){var a=r||{};a.type="file",a.file=t;if(!a.bookType){var n=a.file.slice(a.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(a.bookType=n.slice(1)),a.bookType=({xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"})[a.bookType]||a.bookType}return function e(t,r){oP(),function(e){if(!e||!e.SheetNames||!e.Sheets)throw Error("Invalid Workbook");if(!e.SheetNames.length)throw Error("Workbook is empty");var t,r,a=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=!!e.vbaraw,t.forEach(function(e,n){pO(e);for(var s=0;s<n;++s)if(e==t[s])throw Error("Duplicate Sheet Name: "+e);if(r){var i=a&&a[n]&&a[n].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw Error("Bad Code Name: Worksheet"+i)}});for(var n=0;n<e.SheetNames.length;++n)!function(e,t,r){if(e&&e["!ref"]){var a=dD(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw Error("Bad range ("+r+"): "+e["!ref"])}}(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}(t);var a,n,s=lq(r||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),"array"==s.type){s.type="binary";var i=e(t,s);return s.type="array",oq(i)}var o=0;if(s.sheet&&(o="number"==typeof s.sheet?s.sheet:t.SheetNames.indexOf(s.sheet),!t.SheetNames[o]))throw Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return mw(function(e,t){t||(t={}),e.SSF||(e.SSF=lq(o6)),e.SSF&&(lS(),lN(e.SSF),t.revssf=lR(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],pa(t.cellXfs,{},{revssf:{General:0}}));var r,a,n,s,i,o,l,c,d,u,h=[];h.push((r=t,a=[],e.Props&&a.push((n=e.Props,s=[],lO(uF).map(function(e){for(var t=0;t<uC.length;++t)if(uC[t][1]==e)return uC[t];for(t=0;t<uP.length;++t)if(uP[t][1]==e)return uP[t];throw e}).forEach(function(e){if(null!=n[e[1]]){var t=r&&r.Props&&null!=r.Props[e[1]]?r.Props[e[1]]:n[e[1]];"date"===e[2]&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof t?t=String(t):!0===t||!1===t?t=t?"1":"0":t instanceof Date&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"")),s.push(cO(uF[e[1]]||e[1],t))}}),cD("DocumentProperties",s.join(""),{xmlns:c$}))),e.Custprops&&a.push((i=e.Props,o=e.Custprops,l=["Worksheets","SheetNames"],c="CustomDocumentProperties",d=[],i&&lO(i).forEach(function(e){if(Object.prototype.hasOwnProperty.call(i,e)){for(var t=0;t<uC.length;++t)if(e==uC[t][1])return;for(t=0;t<uP.length;++t)if(e==uP[t][1])return;for(t=0;t<l.length;++t)if(e==l[t])return;var r=i[e],a="string";"number"==typeof r?(a="float",r=String(r)):!0===r||!1===r?(a="boolean",r=r?"1":"0"):r=String(r),d.push(cD(cf(e),r,{"dt:dt":a}))}}),o&&lO(o).forEach(function(e){if(Object.prototype.hasOwnProperty.call(o,e)&&!(i&&Object.prototype.hasOwnProperty.call(i,e))){var t=o[e],r="string";"number"==typeof t?(r="float",t=String(t)):!0===t||!1===t?(r="boolean",t=t?"1":"0"):t instanceof Date?(r="dateTime.tz",t=t.toISOString()):t=String(t),d.push(cD(cf(e),t,{"dt:dt":r}))}}),"<"+c+' xmlns="'+c$+'">'+d.join("")+"</"+c+">")),a.join(""))),h.push(""),h.push(""),h.push("");for(var f=0;f<e.SheetNames.length;++f)h.push(cD("Worksheet",function(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],i=s?function(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],i=0;i<n.length;++i){var o=n[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(pU(o)))}return s.join("")}(s,0,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),(i=s?function(e,t,r,a){if(!e["!ref"])return"";var n=dD(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(e,t){fe(e);var r=!!e.width,a=pt(t,e),n={"ss:Index":t+1};r&&(n["ss:Width"]=h3(a.width)),e.hidden&&(n["ss:Hidden"]="1"),o.push(cD("Column",null,n))});for(var l=Array.isArray(e),c=n.s.r;c<=n.e.r;++c){for(var d=[function(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=fr(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}(c,(e["!rows"]||[])[c])],u=n.s.c;u<=n.e.c;++u){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>u)&&!(s[i].s.r>c)&&!(s[i].e.c<u)&&!(s[i].e.r<c)){(s[i].s.c!=u||s[i].s.r!=c)&&(h=!0);break}if(!h){var f={r:c,c:u},p=d_(f),m=l?(e[c]||[])[u]:e[p];d.push(function(e,t,r,a,n,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ch(f_(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=dA(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ch(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ch(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var u="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=d7[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||o6[14]);break;case"s":u="String",h=((e.v||"")+"").replace(cd,function(e){return cl[e]}).replace(cp,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var f=pa(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=i.c+1;var p=null!=e.v?h:"",m="z"==e.t?"":'<Data ss:Type="'+u+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map(function(e){var t=cD("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return cD("Comment",t,{"ss:Author":e.a})}).join("")),cD("Cell",m,o)}(m,p,e,t,0,0,f))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}(s,t,0,0):"").length>0&&a.push("<Table>"+i+"</Table>"),a.push(function(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(cD("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(cD("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(cD("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(cD("Visible",1==a.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&(!a.Workbook.Sheets[s]||a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return(((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(cO("ProtectContents","True")),e["!protect"].objects&&n.push(cO("ProtectObjects","True")),e["!protect"].scenarios&&n.push(cO("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||n.push(cO("EnableSelection","UnlockedCells")):n.push(cO("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&n.push("<"+t[1]+"/>")})),0==n.length)?"":cD("WorksheetOptions",n.join(""),{xmlns:cH})}(s,0,e,r)),a.join("")}(f,t,e),{"ss:Name":ch(e.SheetNames[f])}));return h[2]=(u=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],t.cellXfs.forEach(function(e,t){var r=[];r.push(cD("NumberFormat",null,{"ss:Format":ch(o6[e.numFmtId])})),u.push(cD("Style",r.join(""),{"ss:ID":"s"+(21+t)}))}),cD("Styles",u.join(""))),h[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];null==n.Sheet&&(n.Name.match(/^_xlfn\./)||r.push(pU(n)))}return cD("Names",r.join(""))}(e,t),l9+cD("Workbook",h.join(""),{xmlns:cW,"xmlns:o":c$,"xmlns:x":cH,"xmlns:ss":cW,"xmlns:dt":"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882","xmlns:html":"http://www.w3.org/TR/REC-html40"})}(t,s),s);case"slk":case"sylk":return mw(h_.from_sheet(t.Sheets[t.SheetNames[o]],s),s);case"htm":case"html":return mw(function(e,t){var r=t||{},a=null!=r.header?r.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',n=null!=r.footer?r.footer:"</body></html>",s=[a],i=dO(e["!ref"]);r.dense=Array.isArray(e),s.push("<table"+(r&&r.id?' id="'+r.id+'"':"")+">");for(var o=i.s.r;o<=i.e.r;++o)s.push(function(e,t,r,a){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<n.length;++c)if(!(n[c].s.r>r)&&!(n[c].s.c>i)&&!(n[c].e.r<r)&&!(n[c].e.c<i)){if(n[c].s.r<r||n[c].s.c<i){o=-1;break}o=n[c].e.r-n[c].s.r+1,l=n[c].e.c-n[c].s.c+1;break}if(!(o<0)){var d=d_({r:r,c:i}),u=a.dense?(e[r]||[])[i]:e[d],h=u&&null!=u.v&&(u.h||cm(u.w||(dM(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),a.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(a.id||"sjs")+"-"+d,s.push(cD("td",h,f))}}return"<tr>"+s.join("")+"</tr>"}(e,i,o,r));return s.push("</table>"+n),s.join("")}(t.Sheets[t.SheetNames[o]],s),s);case"txt":var l=function(e,t){t||(t={}),t.FS="	",t.RS="\n";var r=mE(e,t);if(void 0===ee||"string"==t.type)return r;var a=ee.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}(t.Sheets[t.SheetNames[o]],s);switch(s.type){case"base64":return oB(l);case"binary":case"string":return l;case"file":return l_(s.file,l,"binary");case"buffer":if(oz)return oV(l,"binary");return l.split("").map(function(e){return e.charCodeAt(0)})}throw Error("Unrecognized type "+s.type);case"csv":return mw(mE(t.Sheets[t.SheetNames[o]],s),s,"\uFEFF");case"dif":return mw(hO.from_sheet(t.Sheets[t.SheetNames[o]],s),s);case"dbf":return mk(hA.from_sheet(t.Sheets[t.SheetNames[o]],s),s);case"prn":return mw(hD.from_sheet(t.Sheets[t.SheetNames[o]],s),s);case"rtf":return mw(h1.from_sheet(t.Sheets[t.SheetNames[o]],s),s);case"eth":return mw(hP.from_sheet(t.Sheets[t.SheetNames[o]],s),s);case"fods":return mw(p5(t,s),s);case"wk1":return mk(hR.sheet_to_wk1(t.Sheets[t.SheetNames[o]],s),s);case"wk3":return mk(hR.book_to_wk3(t,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),mk(pQ(t,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),mv(function(e,t){var r,a=t||{},n=lA.utils.cfb_new({root:"R"}),s="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":s="/Workbook",a.biff=8;break;case"biff5":s="/Book",a.biff=5;break;default:throw Error("invalid type "+a.bookType+" for XLS CFB")}return lA.utils.cfb_add(n,s,pQ(e,a)),8==a.biff&&(e.Props||e.Custprops)&&function(e,t){var r,a=[],n=[],s=[],i=0,o=lP(d5,"n"),l=lP(d4,"n");if(e.Props)for(i=0,r=lO(e.Props);i<r.length;++i)(Object.prototype.hasOwnProperty.call(o,r[i])?a:Object.prototype.hasOwnProperty.call(l,r[i])?n:s).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(i=0,r=lO(e.Custprops);i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(o,r[i])?a:Object.prototype.hasOwnProperty.call(l,r[i])?n:s).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<s.length;++i)uX.indexOf(s[i][0])>-1||uD.indexOf(s[i][0])>-1||null!=s[i][1]&&c.push(s[i]);n.length&&lA.utils.cfb_add(t,"/\x05SummaryInformation",uJ(n,pH,l,d4)),(a.length||c.length)&&lA.utils.cfb_add(t,"/\x05DocumentSummaryInformation",uJ(a,pW,o,d5,c.length?c:null,"05d5cdd59c2e1b10939708002b2cf9ae"))}(e,n),8==a.biff&&e.vbaraw&&(r=lA.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})).FullPaths.forEach(function(e,t){if(0!=t){var a=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&lA.utils.cfb_add(n,a,r.FileIndex[t].content)}}),n}(t,a=s||{}),a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r={},a=oz?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw Error("Unrecognized type "+t.type)}var n=e.FullPaths?lA.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!=typeof Deno&&"string"==typeof n){if("binary"==t.type||"base64"==t.type)return n;n=new Uint8Array(oq(n))}return t.password&&"undefined"!=typeof encrypt_agile?mv(encrypt_agile(n,t.password),t):"file"===t.type?l_(t.file,n):"string"==t.type?ck(n):n}("ods"==(n=lq(s||{})).bookType?p5(t,n):"numbers"==n.bookType?function(e,t){if(!t||!t.numbers)throw Error("Must pass a `numbers` option -- check the README");var r,a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=dO(a["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(dP(n)));var i=mN(a,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&o.push(e)})});var l={},c=[],d=lA.read(t.numbers,{type:"base64"});d.FileIndex.map(function(e,t){return[e,d.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2!=t.type||t.name.match(/\.iwa/)&&mn(mi(t.content)).forEach(function(e){c.push(e.id),l[e.id]={deps:[],location:r,type:me(e.messages[0].meta[1][0].data)}})}),c.sort(function(e,t){return e-t});var u=c.filter(function(e){return e>1}).map(function(e){return[e,p9(e)]});d.FileIndex.map(function(e,t){return[e,d.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&mn(mi(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=me(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}(e.data,t[1])})&&l[t[0]].deps.push(e.id)})})})});for(var h=lA.find(d,l[1].location),f=mn(mi(h.content)),p=0;p<f.length;++p){var m=f[p];1==m.id&&(r=m)}var g=md(mt(r.messages[0].data)[1][0].data);for(p=0,f=mn(mi((h=lA.find(d,l[g].location)).content));p<f.length;++p)(m=f[p]).id==g&&(r=m);for(p=0,g=md(mt(r.messages[0].data)[2][0].data),f=mn(mi((h=lA.find(d,l[g].location)).content));p<f.length;++p)(m=f[p]).id==g&&(r=m);for(p=0,g=md(mt(r.messages[0].data)[2][0].data),f=mn(mi((h=lA.find(d,l[g].location)).content));p<f.length;++p)(m=f[p]).id==g&&(r=m);var x=mt(r.messages[0].data);x[6][0].data=p9(n.e.r+1),x[7][0].data=p9(n.e.c+1);for(var b=md(x[46][0].data),y=lA.find(d,l[b].location),v=mn(mi(y.content)),w=0;w<v.length&&v[w].id!=b;++w);if(v[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var k=mt(v[w].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var j=0;j<=n.e.c;++j){var N=[];N[1]=N[2]=[{type:0,data:p9(j+420690)}],k[1].push({type:2,data:mr(N)}),k[2].push({type:0,data:p9(j)}),k[3].push({type:0,data:p9(j)})}k[4]=[],k[5]=[],k[6]=[];for(var S=0;S<=n.e.r;++S)(N=[])[1]=N[2]=[{type:0,data:p9(S+726270)}],k[4].push({type:2,data:mr(N)}),k[5].push({type:0,data:p9(S)}),k[6].push({type:0,data:p9(S)});v[w].messages[0].data=mr(k),y.content=mo(ms(v)),y.size=y.content.length,delete x[46];var E=mt(x[4][0].data);E[7][0].data=p9(n.e.r+1);var C=md(mt(E[1][0].data)[2][0].data);if((v=mn(mi((y=lA.find(d,l[C].location)).content)))[0].id!=C)throw"Bad HeaderStorageBucket";var T=mt(v[0].messages[0].data);for(S=0;S<i.length;++S){var A=mt(T[2][0].data);A[1][0].data=p9(S),A[4][0].data=p9(i[S].length),T[2][S]={type:T[2][0].type,data:mr(A)}}v[0].messages[0].data=mr(T),y.content=mo(ms(v)),y.size=y.content.length;var _=md(E[2][0].data);if((v=mn(mi((y=lA.find(d,l[_].location)).content)))[0].id!=_)throw"Bad HeaderStorageBucket";for(j=0,T=mt(v[0].messages[0].data);j<=n.e.c;++j)(A=mt(T[2][0].data))[1][0].data=p9(j),A[4][0].data=p9(n.e.r+1),T[2][j]={type:T[2][0].type,data:mr(A)};v[0].messages[0].data=mr(T),y.content=mo(ms(v)),y.size=y.content.length;var O=md(E[4][0].data);!function(){for(var e,t=lA.find(d,l[O].location),r=mn(mi(t.content)),a=0;a<r.length;++a){var n=r[a];n.id==O&&(e=n)}var s=mt(e.messages[0].data);s[3]=[];var i=[];o.forEach(function(e,t){i[1]=[{type:0,data:p9(t)}],i[2]=[{type:0,data:p9(1)}],i[3]=[{type:2,data:"undefined"!=typeof TextEncoder?new TextEncoder().encode(e):oW(cj(e))}],s[3].push({type:2,data:mr(i)})}),e.messages[0].data=mr(s),t.content=mo(ms(r)),t.size=t.content.length}();var P=mt(E[3][0].data),D=P[1][0];delete P[2];var R=mt(D.data),M=md(R[2][0].data);!function(){for(var e,t=lA.find(d,l[M].location),r=mn(mi(t.content)),a=0;a<r.length;++a){var s=r[a];s.id==M&&(e=s)}var c=mt(e.messages[0].data);delete c[6],delete P[7];var u=new Uint8Array(c[5][0].data);c[5]=[];for(var h=0,f=0;f<=n.e.r;++f){var p=mt(u);h+=function(e,t,r){if(!(null==(a=e[6])?void 0:a[0])||!(null==(n=e[7])?void 0:n[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(s=e[8])?void 0:s[0])?void 0:i.data)&&me(e[8][0].data)>0)throw"Math only works with normal offsets";for(var a,n,s,i,o,l,c=0,d=p4(e[7][0].data),u=0,h=[],f=p4(e[4][0].data),p=0,m=[],g=0;g<t.length;++g){if(null==t[g]){d.setUint16(2*g,65535,!0),f.setUint16(2*g,65535);continue}switch(d.setUint16(2*g,u,!0),f.setUint16(2*g,p,!0),typeof t[g]){case"string":o=ml({t:"s",v:t[g]},r),l=mc({t:"s",v:t[g]},r);break;case"number":o=ml({t:"n",v:t[g]},r),l=mc({t:"n",v:t[g]},r);break;case"boolean":o=ml({t:"b",v:t[g]},r),l=mc({t:"b",v:t[g]},r);break;default:throw Error("Unsupported value "+t[g])}h.push(o),u+=o.length,m.push(l),p+=l.length,++c}for(e[2][0].data=p9(c);g<e[7][0].data.length/2;++g)d.setUint16(2*g,65535,!0),f.setUint16(2*g,65535,!0);return e[6][0].data=p6(h),e[3][0].data=p6(m),c}(p,i[f],o),p[1][0].data=p9(f),c[5].push({data:mr(p),type:2})}c[1]=[{type:0,data:p9(n.e.c+1)}],c[2]=[{type:0,data:p9(n.e.r+1)}],c[3]=[{type:0,data:p9(h)}],c[4]=[{type:0,data:p9(n.e.r+1)}],e.messages[0].data=mr(c),t.content=mo(ms(r)),t.size=t.content.length}(),D.data=mr(R),E[3][0].data=mr(P),x[4][0].data=mr(E),r.messages[0].data=mr(x);var I=mo(ms(f));return h.content=I,h.size=h.content.length,d}(t,n):"xlsb"==n.bookType?function(e,t){fj=1024,e&&!e.SSF&&(e.SSF=lq(o6)),e&&e.SSF&&(lS(),lN(e.SSF),t.revssf=lR(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,f9?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r,a,n,s,i,o,l,c="xlsb"==t.bookType?"bin":"xml",d=fC.indexOf(t.bookType)>-1,u=ur();mm(t=t||{});var h=l6(),f="",p=0;if(t.cellXfs=[],pa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l3(h,f="docProps/core.xml",uO(e.Props,t)),u.coreprops.push(f),uN(t.rels,2,f,ul),f="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var m=[],g=0;g<e.SheetNames.length;++g)2!=(e.Workbook.Sheets[g]||{}).Hidden&&m.push(e.SheetNames[g]);e.Props.SheetNames=m}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,l3(h,f,uM(e.Props,t)),u.extprops.push(f),uN(t.rels,3,f,uc),e.Custprops!==e.Props&&lO(e.Custprops||{}).length>0&&(l3(h,f="docProps/custom.xml",uL(e.Custprops,t)),u.custprops.push(f),uN(t.rels,4,f,ud)),p=1;p<=e.SheetNames.length;++p){var x={"!id":{}},b=e.Sheets[e.SheetNames[p-1]];if((b||{})["!type"],l3(h,f="xl/worksheets/sheet"+p+"."+c,(y=p-1,v=f,w=t,(".bin"===v.slice(-4)?function(e,t,r,a){var n,s,i,o,l,c,d,u,h,f=dy(),p=r.SheetNames[e],m=r.Sheets[p]||{},g=p;try{r&&r.Workbook&&(g=r.Workbook.Sheets[e].CodeName||g)}catch(e){}var x=dD(m["!ref"]||"A1");if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw Error("Range "+(m["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575)}m["!links"]=[],m["!comments"]=[],dv(f,129),(r.vbaraw||m["!outline"])&&dv(f,147,function(e,t,r){null==r&&(r=dx(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return d0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),dU(e,r),r.slice(0,r.l)}(g,m["!outline"])),dv(f,148,dQ(x)),n=r.Workbook,dv(f,133),dv(f,137,(null==s&&(s=dx(30)),i=924,(((n||{}).Views||[])[0]||{}).RTL&&(i|=32),s.write_shift(2,i),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s)),dv(f,138),dv(f,134),m&&m["!cols"]&&(dv(f,390),m["!cols"].forEach(function(e,t){var r,a,n;e&&dv(f,60,(null==r&&(r=dx(18)),a=pt(t,e),r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,256*(a.width||10)),r.write_shift(4,0),n=0,e.hidden&&(n|=1),"number"==typeof a.width&&(n|=2),e.level&&(n|=e.level<<8),r.write_shift(2,n),r))}),dv(f,391)),function(e,t,r,a){var n,s=dD(t["!ref"]||"A1"),i="",o=[];dv(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=c;++d){i=dE(d),function(e,t,r,a){var n=function(e,t,r){var a=dx(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=20*ft(n.hpx):n.hpt&&(s=20*n.hpt),a.write_shift(2,s),a.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var o=0,l=a.l;a.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10)&&!(t.e.c<d<<10)){for(var u=-1,h=-1,f=d<<10;f<d+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[d_(c)])&&(u<0&&(u=f),h=f);u<0||(++o,a.write_shift(4,u),a.write_shift(4,h))}var p=a.l;return a.l=l,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&dv(e,0,n)}(e,t,s,d);var u=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=dT(h)),n=o[h]+i;var f=l?(t[d]||[])[h]:t[n];if(!f){u=!1;continue}u=function(e,t,r,a,n,s,i){if(void 0===t.v)return!1;var o,l,c,d,u,h,f,p,m,g,x,b,y,v,w,k,j,N,S,E,C,T,A,_,O="";switch(t.t){case"b":O=t.v?"1":"0";break;case"d":(t=lq(t)).z=t.z||o6[14],t.v=lI(lH(t.v)),t.t="n";break;case"n":case"e":O=""+t.v;break;default:O=t.v}var P={r:r,c:a};switch(P.s=pa(n.cellXfs,t,n),t.l&&s["!links"].push([d_(P),t.l]),t.c&&s["!comments"].push([d_(P),t.c]),t.t){case"s":case"str":return n.bookSST?(O=pe(n.Strings,t.v,n.revStrings),P.t="s",P.v=O,i)?dv(e,18,(null==o&&(o=dx(8)),dW(P,o),o.write_shift(4,P.v),o)):dv(e,7,(null==l&&(l=dx(12)),d$(P,l),l.write_shift(4,P.v),l)):(P.t="str",i)?dv(e,17,(c=t,null==d&&(d=dx(8+4*c.v.length)),dW(P,d),dU(c.v,d),d.length>d.l?d.slice(0,d.l):d)):dv(e,6,(u=t,null==h&&(h=dx(12+4*u.v.length)),d$(P,h),dU(u.v,h),h.length>h.l?h.slice(0,h.l):h)),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?dv(e,13,(f=t,null==p&&(p=dx(8)),dW(P,p),dX(f.v,p),p)):dv(e,2,(m=t,null==g&&(g=dx(12)),d$(P,g),dX(m.v,g),g)):i?dv(e,16,(x=t,null==b&&(b=dx(12)),dW(P,b),dZ(x.v,b),b)):dv(e,5,(y=t,null==v&&(v=dx(16)),d$(P,v),dZ(y.v,v),v)),!0;case"b":return(P.t="b",i)?dv(e,15,(w=t,null==k&&(k=dx(5)),dW(P,k),k.write_shift(1,+!!w.v),k)):dv(e,4,(j=t,null==N&&(N=dx(9)),d$(P,N),N.write_shift(1,+!!j.v),N)),!0;case"e":return(P.t="e",i)?dv(e,14,(S=t,null==E&&(E=dx(8)),dW(P,E),E.write_shift(1,S.v),E.write_shift(2,0),E.write_shift(1,0),E)):dv(e,3,(C=t,null==T&&(T=dx(9)),d$(P,T),T.write_shift(1,C.v),T)),!0}return i?dv(e,12,(null==A&&(A=dx(4)),dW(P,A))):dv(e,1,(null==_&&(_=dx(8)),d$(P,_))),!0}(e,f,d,h,a,t,u)}}dv(e,146)}(f,m,0,t,r);m["!protect"]&&dv(f,535,(o=m["!protect"],null==l&&(l=dx(66)),l.write_shift(2,o.password?hQ(o.password):0),l.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?l.write_shift(4,+(null!=o[e[0]]&&!o[e[0]])):l.write_shift(4,null!=o[e[0]]&&o[e[0]]?0:1)}),l)),!function(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s="string"==typeof n.ref?n.ref:dP(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=dO(s);o.s.r==o.e.r&&(o.e.r=dO(t["!ref"]).e.r,s=dP(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),dv(e,161,dQ(dD(s))),dv(e,162)}}(f,m,r,e);m&&m["!merges"]&&(dv(f,177,(c=m["!merges"].length,null==d&&(d=dx(4)),d.write_shift(4,c),d)),m["!merges"].forEach(function(e){dv(f,176,dQ(e))}),dv(f,178)),m["!links"].forEach(function(e){if(e[1].Target){var t,r,n=uN(a,-1,e[1].Target.replace(/#.*$/,""),us);dv(f,494,(t=dx(50+4*(e[1].Target.length+(e[1].Tooltip||"").length)),dQ({s:dA(e[0]),e:dA(e[0])},t),dG("rId"+n,t),dU((-1==(r=e[1].Target.indexOf("#"))?"":e[1].Target.slice(r+1))||"",t),dU(e[1].Tooltip||"",t),dU("",t),t.slice(0,t.l)))}}),delete m["!links"],m["!margins"]&&dv(f,476,(u=m["!margins"],null==h&&(h=dx(48)),pr(u),pk.forEach(function(e){dZ(u[e],h)}),h)),(!t||t.ignoreEC||void 0==t.ignoreEC)&&function(e,t){if(t&&t["!ref"]){var r,a;dv(e,648),dv(e,649,(r=dD(t["!ref"]),(a=dx(24)).write_shift(4,4),a.write_shift(4,1),dQ(r,a),a)),dv(e,650)}}(f,m);if(m["!comments"].length>0){var b=uN(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ui);dv(f,551,dG("rId"+b)),m["!legacy"]=b}return dv(f,130),f.end()}:pv)(y,w,e,x))),u.sheets.push(f),uN(t.wbrels,-1,"worksheets/sheet"+p+"."+c,um[0]),b){var y,v,w,k,j,N=b["!comments"],S=!1,E="";N&&N.length>0&&(l3(h,E="xl/comments"+p+"."+c,(k=E,j=t,(".bin"===k.slice(-4)?function(e){var t=dy(),r=[];return dv(t,628),dv(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),dv(t,632,dU(e.a.slice(0,54))))})}),dv(t,631),dv(t,633),e.forEach(function(e){e[1].forEach(function(a){var n,s,i,o,l,c;a.iauthor=r.indexOf(a.a),dv(t,635,(n=[{s:dA(e[0]),e:dA(e[0])},a],null==s&&(s=dx(36)),s.write_shift(4,n[1].iauthor),dQ(n[0],s),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s)),a.t&&a.t.length>0&&dv(t,637,(o=!1,null==i&&(o=!0,i=dx(23+4*a.t.length)),i.write_shift(1,1),dU(a.t,i),i.write_shift(4,1),l={ich:0,ifnt:0},(c=i)||(c=dx(4)),c.write_shift(2,l.ich||0),c.write_shift(2,l.ifnt||0),o?i.slice(0,i.l):i)),dv(t,636),delete a.iauthor})}),dv(t,634),dv(t,629),t.end()}:fE)(N,j))),u.comments.push(E),uN(x,-1,"../comments"+p+"."+c,uo),S=!0),b["!legacy"]&&S&&l3(h,"xl/drawings/vmlDrawing"+p+".vml",fN(p,b["!comments"])),delete b["!comments"],delete b["!legacy"]}x["!id"].rId1&&l3(h,uw(f),uj(x))}return null!=t.Strings&&t.Strings.length>0&&(l3(h,f="xl/sharedStrings."+c,(r=t.Strings,a=f,n=t,(".bin"===a.slice(-4)?function(e){var t,r=dy();dv(r,159,(t||(t=dx(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t));for(var a=0;a<e.length;++a)dv(r,19,hq(e[a]));return dv(r,160),r.end()}:hW)(r,n))),u.strs.push(f),uN(t.wbrels,-1,"sharedStrings."+c,uu)),l3(h,f="xl/workbook."+c,(s=f,i=t,(".bin"===s.slice(-4)?function(e,t){var r=dy();dv(r,131),dv(r,128,function(e,t){t||(t=dx(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return dU("SheetJS",t),dU(oS.version,t),dU(oS.version,t),dU("7262",t),t.length>t.l?t.slice(0,t.l):t}()),dv(r,153,(n=e.Workbook&&e.Workbook.WBProps||null,s||(s=dx(72)),i=0,n&&n.filterPrivacy&&(i|=8),s.write_shift(4,i),s.write_shift(4,0),dU(n&&n.CodeName||"ThisWorkbook",s),s.slice(0,s.l))),function(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r,a,n=t.Workbook.Sheets,s=0,i=-1,o=-1;s<n.length;++s)n[s]&&(n[s].Hidden||-1!=i)?1==n[s].Hidden&&-1==o&&(o=s):i=s;o>i||(dv(e,135),dv(e,158,(r=i,a||(a=dx(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,r),a.write_shift(4,r),a.write_shift(1,120),a.length>a.l?a.slice(0,a.l):a)),dv(e,136))}}(r,e,t);dv(r,143);for(var a=0;a!=e.SheetNames.length;++a){var n,s,i,o={Hidden:e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[a]&&e.Workbook.Sheets[a].Hidden||0,iTabID:a+1,strRelID:"rId"+(a+1),name:e.SheetNames[a]},l=void 0;dv(r,156,(l||(l=dx(127)),l.write_shift(4,o.Hidden),l.write_shift(4,o.iTabID),dG(o.strRelID,l),dU(o.name.slice(0,31),l),l.length>l.l?l.slice(0,l.l):l))}return dv(r,144),dv(r,132),r.end()}:pD)(e,i))),u.workbooks.push(f),uN(t.rels,1,f,un),l3(h,f="xl/theme/theme1.xml",fw(e.Themes,t)),u.themes.push(f),uN(t.wbrels,-1,"theme/theme1.xml",uf),l3(h,f="xl/styles."+c,(o=f,l=t,(".bin"===o.slice(-4)?function(e,t){var r,a,n,s,i,o,l,c,d,u,h,f=dy();return dv(f,278),!function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var a=e[0];a<=e[1];++a)null!=t[a]&&++r}),0!=r&&(dv(e,615,dF(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&dv(e,44,function(e,t,r){r||(r=dx(6+4*t.length)),r.write_shift(2,e),dU(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),a}(a,t[a]))}),dv(e,616))}}(f,e.SSF),dv(f,611,dF(1)),dv(f,43,(r={sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"},a||(a=dx(153)),a.write_shift(2,20*r.sz),(n=a)||(n=dx(2)),s=2*!!r.italic|8*!!r.strike|16*!!r.outline|32*!!r.shadow|64*!!r.condense|128*!!r.extend,n.write_shift(1,s),n.write_shift(1,0),a.write_shift(2,r.bold?700:400),i=0,"superscript"==r.vertAlign?i=1:"subscript"==r.vertAlign&&(i=2),a.write_shift(2,i),a.write_shift(1,r.underline||0),a.write_shift(1,r.family||0),a.write_shift(1,r.charset||0),a.write_shift(1,0),d0(r.color,a),o=0,"major"==r.scheme&&(o=1),"minor"==r.scheme&&(o=2),a.write_shift(1,o),dU(r.name,a),a.length>a.l?a.slice(0,a.l):a)),dv(f,612),dv(f,603,dF(2)),dv(f,45,fc({patternType:"none"})),dv(f,45,fc({patternType:"gray125"})),dv(f,604),dv(f,613,dF(1)),dv(f,46,(l||(l=dx(51)),l.write_shift(1,0),fu(null,l),fu(null,l),fu(null,l),fu(null,l),fu(null,l),l.length>l.l?l.slice(0,l.l):l)),dv(f,614),dv(f,626,dF(1)),dv(f,47,fd({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),dv(f,627),dv(f,617,dF((c=t.cellXfs).length)),c.forEach(function(e){dv(f,47,fd(e,0))}),dv(f,618),dv(f,619,dF(1)),dv(f,48,(d={xfId:0,builtinId:0,name:"Normal"},u||(u=dx(52)),u.write_shift(4,d.xfId),u.write_shift(2,1),u.write_shift(1,+d.builtinId),u.write_shift(1,0),dG(d.name||"",u),u.length>u.l?u.slice(0,u.l):u)),dv(f,620),dv(f,505,dF(0)),dv(f,506),dv(f,508,((h=dx(2052)).write_shift(4,0),dG("TableStyleMedium9",h),dG("PivotStyleMedium4",h),h.length>h.l?h.slice(0,h.l):h)),dv(f,509),dv(f,279),f.end()}:fo)(e,l))),u.styles.push(f),uN(t.wbrels,-1,"styles."+c,uh),e.vbaraw&&d&&(l3(h,f="xl/vbaProject.bin",e.vbaraw),u.vba.push(f),uN(t.wbrels,-1,"vbaProject.bin",uv)),l3(h,f="xl/metadata."+c,(".bin"===f.slice(-4)?function(){var e,t,r,a,n=dy();return dv(n,332),dv(n,334,dF(1)),dv(n,335,((t=dx(12+2*(e={name:"XLDAPR",version:12e4,flags:0xd06ac0b0}).name.length)).write_shift(4,e.flags),t.write_shift(4,e.version),dU(e.name,t),t.slice(0,t.l))),dv(n,336),dv(n,339,((r=dx(20)).write_shift(4,1),dU("XLDAPR",r),r.slice(0,r.l))),dv(n,52),dv(n,35,dF(514)),dv(n,4096,dF(0)),dv(n,4097,u5(1)),dv(n,36),dv(n,53),dv(n,340),dv(n,337,((a=dx(8)).write_shift(4,1),a.write_shift(4,1),a)),dv(n,51,function(e){var t=dx(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),dv(n,338),dv(n,333),n.end()}:fk)()),u.metadata.push(f),uN(t.wbrels,-1,"metadata."+c,ub),l3(h,"[Content_Types].xml",ua(u,t)),l3(h,"_rels/.rels",uj(t.rels)),l3(h,"xl/_rels/workbook."+c+".rels",uj(t.wbrels)),delete t.revssf,delete t.ssf,h}(t,n):function(e,t){fj=1024,e&&!e.SSF&&(e.SSF=lq(o6)),e&&e.SSF&&(lS(),lN(e.SSF),t.revssf=lR(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,f9?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r,a=fC.indexOf(t.bookType)>-1,n=ur();mm(t=t||{});var s=l6(),i="",o=0;if(t.cellXfs=[],pa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l3(s,i="docProps/core.xml",uO(e.Props,t)),n.coreprops.push(i),uN(t.rels,2,i,ul),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,l3(s,i,uM(e.Props,t)),n.extprops.push(i),uN(t.rels,3,i,uc),e.Custprops!==e.Props&&lO(e.Custprops||{}).length>0&&(l3(s,i="docProps/custom.xml",uL(e.Custprops,t)),n.custprops.push(i),uN(t.rels,4,i,ud));var d=["SheetJ5"];for(o=1,t.tcid=0;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];if((h||{})["!type"],l3(s,i="xl/worksheets/sheet"+o+".xml",pv(o-1,t,e,u)),n.sheets.push(i),uN(t.wbrels,-1,"worksheets/sheet"+o+".xml",um[0]),h){var f=h["!comments"],p=!1,m="";if(f&&f.length>0){var g=!1;f.forEach(function(e){e[1].forEach(function(e){!0==e.T&&(g=!0)})}),g&&(l3(s,m="xl/threadedComments/threadedComment"+o+".xml",function(e,t,r){var a=[l9,cD("ThreadedComments",null,{xmlns:cF}).replace(/[\/]>/,">")];return e.forEach(function(e){var n="";(e[1]||[]).forEach(function(s,i){if(!s.T)return void delete s.ID;s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?n=o.id:o.parentId=n,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),a.push(cD("threadedComment",cO("text",s.t||""),o))})}),a.push("</ThreadedComments>"),a.join("")}(f,d,t)),n.threadedcomments.push(m),uN(u,-1,"../threadedComments/threadedComment"+o+".xml",uy)),l3(s,m="xl/comments"+o+".xml",fE(f,t)),n.comments.push(m),uN(u,-1,"../comments"+o+".xml",uo),p=!0}h["!legacy"]&&p&&l3(s,"xl/drawings/vmlDrawing"+o+".vml",fN(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&l3(s,uw(i),uj(u))}return null!=t.Strings&&t.Strings.length>0&&(l3(s,i="xl/sharedStrings.xml",hW(t.Strings,t)),n.strs.push(i),uN(t.wbrels,-1,"sharedStrings.xml",uu)),l3(s,i="xl/workbook.xml",pD(e,t)),n.workbooks.push(i),uN(t.rels,1,i,un),l3(s,i="xl/theme/theme1.xml",fw(e.Themes,t)),n.themes.push(i),uN(t.wbrels,-1,"theme/theme1.xml",uf),l3(s,i="xl/styles.xml",fo(e,t)),n.styles.push(i),uN(t.wbrels,-1,"styles.xml",uh),e.vbaraw&&a&&(l3(s,i="xl/vbaProject.bin",e.vbaraw),n.vba.push(i),uN(t.wbrels,-1,"vbaProject.bin",uv)),l3(s,i="xl/metadata.xml",fk()),n.metadata.push(i),uN(t.wbrels,-1,"metadata.xml",ub),d.length>1&&(l3(s,i="xl/persons/person.xml",(r=[l9,cD("personList",null,{xmlns:cF,"xmlns:x":cV[0]}).replace(/[\/]>/,">")],d.forEach(function(e,t){r.push(cD("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join(""))),n.people.push(i),uN(t.wbrels,-1,"persons/person.xml","http://schemas.microsoft.com/office/2017/10/relationships/person")),l3(s,"[Content_Types].xml",ua(n,t)),l3(s,"_rels/.rels",uj(t.rels)),l3(s,"xl/_rels/workbook.xml.rels",uj(t.wbrels)),delete t.revssf,delete t.ssf,s}(t,n),n);default:throw Error("Unrecognized bookType |"+s.bookType+"|")}}(e,a)}function mN(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},a=0,n=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?a=1:"A"===c.header?a=2:Array.isArray(c.header)?a=3:null==c.header&&(a=0),typeof d){case"string":l=dD(d);break;case"number":(l=dD(e["!ref"])).s.r=d;break;default:l=d}a>0&&(n=0);var u=dE(l.s.r),h=[],f=[],p=0,m=0,g=Array.isArray(e),x=l.s.r,b=0,y={};g&&!e[x]&&(e[x]=[]);var v=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(v[b]||{}).hidden)switch(h[b]=dT(b),r=g?e[x][b]:e[h[b]+u],a){case 1:s[b]=b-l.s.c;break;case 2:s[b]=h[b];break;case 3:s[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=dM(r,null,c),m=y[i]||0){do o=i+"_"+m++;while(y[o])y[i]=m,y[o]=1}else y[i]=1;s[b]=o}for(x=l.s.r+n;x<=l.e.r;++x)if(!(w[x]||{}).hidden){var k=function(e,t,r,a,n,s,i,o){var l=dE(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(e){h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var p=i?e[r][f]:e[a[f]+l];if(void 0===p||void 0===p.t){if(void 0===c)continue;null!=s[f]&&(h[s[f]]=c);continue}var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw Error("unrecognized type "+p.t)}if(null!=s[f]){if(null==m)if("e"==p.t&&null===m)h[s[f]]=null;else if(void 0!==c)h[s[f]]=c;else{if(!d||null!==m)continue;h[s[f]]=null}else h[s[f]]=d&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:dM(p,m,o);null!=m&&(u=!1)}}return{row:h,isempty:u}}(e,l,x,h,a,s,g,c);(!1===k.isempty||(1===a?!1!==c.blankrows:c.blankrows))&&(f[p++]=k.row)}return f.length=p,f}var mS=/"/g;function mE(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";var n=dD(e["!ref"]),s=void 0!==a.FS?a.FS:",",i=s.charCodeAt(0),o=void 0!==a.RS?a.RS:"\n",l=o.charCodeAt(0),c=RegExp(("|"==s?"\\|":s)+"+$"),d="",u=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],f=a.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(h[p]||{}).hidden||(u[p]=dT(p));for(var m=0,g=n.s.r;g<=n.e.r;++g)!(f[g]||{}).hidden&&null!=(d=function(e,t,r,a,n,s,i,o){for(var l=!0,c=[],d="",u=dE(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var f=o.dense?(e[r]||[])[h]:e[a[h]+u];if(null==f)d="";else if(null!=f.v){l=!1,d=""+(o.rawNumbers&&"n"==f.t?f.v:dM(f,null,o));for(var p=0,m=0;p!==d.length;++p)if((m=d.charCodeAt(p))===n||m===s||34===m||o.forceQuotes){d='"'+d.replace(mS,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(mS,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}(e,n,g,u,i,l,s,a))&&(a.strip&&(d=d.replace(c,"")),(d||!1!==a.blankrows)&&r.push((m++?o:"")+d));return delete a.dense,r.join("")}function mC(){return{SheetNames:[],Sheets:{}}}function mT(e,t,r,a){var n=1;if(!r)for(;n<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+n);++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||r;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(r=i+n);++n);}if(pO(r),e.SheetNames.indexOf(r)>=0)throw Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}var mA=function(e,t){return function(e,t,r){var a,n=r||{},s=+!n.skipHeader,i={},o=0,l=0;if(i&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?dA(n.origin):n.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var u=dD(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+s)}else -1==o&&(o=0,d.e.r=t.length-1+s);var h=n.header||[],f=0;t.forEach(function(e,t){lO(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],d="z",u="",p=d_({c:l+f,r:o+t+s});a=function e(t,r,a){if("string"==typeof r){if(Array.isArray(t)){var n=dA(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return"number"!=typeof r?e(t,d_(r)):e(t,d_({r:r,c:a||0}))}(i,p),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",n.cellDates||(d="n",c=lI(c)),u=n.dateNF||o6[14]):null===c&&n.nullError&&(d="e",c=0),a?(a.t=d,a.v=c,delete a.w,delete a.R,u&&(a.z=u)):i[p]=a={t:d,v:c},u&&(a.z=u)):i[p]=c})}),d.e.c=Math.max(d.e.c,l+h.length-1);var p=dE(o);if(s)for(f=0;f<h.length;++f)i[dT(f+l)+p]={t:"s",v:h[f]};return i["!ref"]=dP(d),i}(null,e,t)},m_=mC,mO=mT;oS.version;let mP=e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`},mD=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-";function mR(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),[r,a]=(0,em.useState)([]),[n,s]=(0,em.useState)(!1),[i,o]=(0,em.useState)(!0),[l,c]=(0,em.useState)({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),[d,u]=(0,em.useState)(!1),[h,f]=(0,em.useState)(!1),[p,m]=(0,em.useState)([]),[g,x]=(0,em.useState)([]),[b,y]=(0,em.useState)(!1),[v,w]=(0,em.useState)(!1),[k,j]=(0,em.useState)([]),[N,S]=(0,em.useState)([]),[E,C]=(0,em.useState)(!1),T=(0,em.useRef)(null),A=(0,em.useRef)(null);(0,em.useEffect)(()=>{console.log("BaseAfiliadosExitosas: Component mounted"),_(),O()},[]),(0,em.useEffect)(()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&u(!1),A.current&&!A.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let _=async()=>{console.log("BaseAfiliadosExitosas: fetchFilterOptions started");try{let e=await e_.api.users.list(),t=Array.isArray(e.data)?e.data:[];console.log("BaseAfiliadosExitosas: users loaded",t.length);let r=t.filter(e=>!1!==e.active&&("asesor"===e.role||"Asesor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));m(r);let a=t.filter(e=>!1!==e.active&&("supervisor"===e.role||"Supervisor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));x(a)}catch(e){console.error("Error loading filter options:",e)}},O=async()=>{console.log("BaseAfiliadosExitosas: fetchAudits started");try{s(!0);let e={estado:"QR hecho",ignoreDate:"true"};l.asesor&&(e.asesor=l.asesor),l.supervisor&&(e.supervisor=l.supervisor),l.cuil&&(e.cuil=l.cuil),l.dateFrom&&l.dateTo&&(e.dateFrom=l.dateFrom,e.dateTo=l.dateTo,e.dateField="fechaCreacionQR",delete e.ignoreDate),console.log("BaseAfiliadosExitosas: fetching with params",e);let{data:t}=await e_.api.audits.list(e);console.log("BaseAfiliadosExitosas: audits loaded",Array.isArray(t)?t.length:0);let r=(Array.isArray(t)?t:[]).sort((e,t)=>{let r=new Date(e.fechaCreacionQR||e.scheduledAt).getTime();return new Date(t.fechaCreacionQR||t.scheduledAt).getTime()-r});a(r)}catch(e){console.error(e),eO.toast.error("Error al cargar afiliaciones")}finally{s(!1)}},P=(e,t)=>{c(r=>({...r,[e]:t}))},D=async()=>{y(!0),C(!0);try{let{data:e}=await e_.api.audits.getSupervisorStats();j(e)}catch(e){console.error(e),eO.toast.error("Error al cargar estadsticas")}finally{C(!1)}},R={binimed:r.filter(e=>e.obraSocialVendida?.toLowerCase().trim()==="binimed").length,meplife:r.filter(e=>e.obraSocialVendida?.toLowerCase().trim().includes("meplife")).length,turf:r.filter(e=>e.obraSocialVendida?.toLowerCase().trim()==="turf").length};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)("span",{className:"p-2 rounded-lg bg-green-500/20 text-green-500",children:(0,ep.jsx)(oa.BarChart3,{className:"w-6 h-6"})}),"Afiliaciones Exitosas"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:'Listado histrico de ventas con estado "QR hecho"'})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("button",{onClick:D,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-purple-500/20 text-purple-300 hover:bg-purple-500/30":"bg-purple-100 text-purple-700 hover:bg-purple-200"),children:[(0,ep.jsx)(oa.BarChart3,{className:"w-4 h-4"}),"Historial de ventas por Supervisor"]}),(0,ep.jsxs)("button",{onClick:()=>{if(!r.length)return void eO.toast.info("No hay datos para exportar");let e=mA(r.map(e=>({"Fecha de carga":mP(e.createdAt),"Fecha de QR":mP(e.fechaCreacionQR||e.scheduledAt),"Nombre del afiliado":e.nombre,CUIL:e.cuil||"-",Telfono:e.telefono||"-","Obra social vendida":e.obraSocialVendida||"-",Asesor:e.asesor?.nombre||"-",Supervisor:mD(e)}))),t=m_();mO(t,e,"Afiliaciones Exitosas"),mj(t,`afiliaciones_exitosas_${new Date().toISOString().slice(0,10)}.xlsx`)},className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar"]})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 transition-all duration-300","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(ow.Filter,{className:(0,eg.cn)("w-4 h-4","dark"===e?"text-purple-400":"text-purple-600")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("font-medium","dark"===e?"text-gray-200":"text-gray-700"),children:"Filtros"})]}),(0,ep.jsx)("button",{onClick:()=>o(!i),className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-gray-100"),children:i?(0,ep.jsx)(oj,{className:"w-4 h-4"}):(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})})]}),i&&(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,ep.jsxs)("div",{className:"relative",ref:T,children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Asesor"}),(0,ep.jsxs)("div",{onClick:()=>u(!d),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,ep.jsx)("span",{className:"truncate",children:l.asesor||"Todos los asesores"}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),d&&(0,ep.jsxs)("div",{className:(0,eg.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,ep.jsx)("div",{onClick:()=>{P("asesor",""),u(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los asesores"}),p.map(t=>(0,ep.jsx)("div",{onClick:()=>{P("asesor",t.nombre),u(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",l.asesor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,ep.jsxs)("div",{className:"relative",ref:A,children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Supervisor"}),(0,ep.jsxs)("div",{onClick:()=>f(!h),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,ep.jsx)("span",{className:"truncate",children:l.supervisor||"Todos los supervisores"}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),h&&(0,ep.jsxs)("div",{className:(0,eg.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,ep.jsx)("div",{onClick:()=>{P("supervisor",""),f(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los supervisores"}),g.map(t=>(0,ep.jsx)("div",{onClick:()=>{P("supervisor",t.nombre),f(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",l.supervisor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"CUIL"}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("input",{type:"text",value:l.cuil,onChange:e=>P("cuil",e.target.value),placeholder:"Buscar por CUIL...",className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border pl-9 transition-all outline-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-purple-300")}),(0,ep.jsx)(ox.Search,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Desde (Fecha QR)"}),(0,ep.jsx)("input",{type:"date",value:l.dateFrom,onChange:e=>P("dateFrom",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Hasta (Fecha QR)"}),(0,ep.jsx)("input",{type:"date",value:l.dateTo,onChange:e=>P("dateTo",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]})]})]}),(0,ep.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,ep.jsx)("button",{onClick:()=>{c({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),O()},className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-colors","dark"===e?"text-gray-400 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:"Limpiar filtros"}),(0,ep.jsx)("button",{onClick:O,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium text-white shadow-lg shadow-purple-500/20 transition-all hover:scale-105 active:scale-95","bg-gradient-to-r from-purple-600 to-blue-600"),children:"Aplicar filtros"})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-2xl border flex items-center justify-between","dark"===e?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-100"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium","dark"===e?"text-blue-300":"text-blue-700"),children:"Binimed"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-2xl font-bold","dark"===e?"text-blue-200":"text-blue-800"),children:R.binimed})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-2xl border flex items-center justify-between","dark"===e?"bg-green-500/10 border-green-500/20":"bg-green-100 border-green-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium","dark"===e?"text-green-300":"text-green-700"),children:"Meplife"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-2xl font-bold","dark"===e?"text-green-400":"text-green-800"),children:R.meplife})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-2xl border flex items-center justify-between","dark"===e?"bg-purple-500/10 border-purple-500/20":"bg-purple-50 border-purple-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium","dark"===e?"text-purple-300":"text-purple-700"),children:"TURF"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-2xl font-bold","dark"===e?"text-purple-200":"text-purple-800"),children:R.turf})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:(0,eg.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,ep.jsx)("th",{className:"px-6 py-4",children:"Fecha de carga"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Fecha de QR"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Afiliado"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Telfono"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Obra Social"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Supervisor"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:n?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-5 h-5 animate-spin text-purple-500"}),(0,ep.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===r.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron afiliaciones exitosas"})}):r.map(t=>{var r,a;let n,s;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:mP(t.createdAt)}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-green-500",children:mP(t.fechaCreacionQR||t.scheduledAt)}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap font-medium",children:t.nombre.toUpperCase()}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.cuil||"-"}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.telefono||"-"}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-1 rounded-md text-xs font-medium",(r=t.obraSocialVendida,"binimed"===(n=r?.toLowerCase()?.trim())?"dark"===e?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"meplife"===n||"meplife "===n?"dark"===e?"bg-green-500/20 text-green-400":"bg-green-200 text-green-800":"turf"===n?"dark"===e?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800":"dark"===e?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700")),children:t.obraSocialVendida||"-"})}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.asesor?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-1 rounded-md text-xs font-medium",(a=mD(t),(s=a.toLowerCase()).includes("nahuel")&&s.includes("sanchez")||s.includes("nahia")&&s.includes("avellaneda")||s.includes("santiago")&&s.includes("goldsztein")||s.includes("facundo")&&s.includes("tevez")?"dark"===e?"bg-red-900 text-red-200":"bg-red-100 text-red-800":s.includes("abigail")&&s.includes("vera")?"dark"===e?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800":s.includes("mateo")&&s.includes("viera")?"dark"===e?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800":s.includes("belen")&&s.includes("salaverry")?"dark"===e?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800":s.includes("analia")&&s.includes("suarez")?"dark"===e?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800":s.includes("erika")&&s.includes("cardozo")?"dark"===e?"bg-green-900 text-green-200":"bg-green-100 text-green-800":s.includes("aryel")&&s.includes("puiggros")?"dark"===e?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800":s.includes("joaquin")&&s.includes("valdez")||s.includes("joquin")&&s.includes("valdez")?"dark"===e?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800":s.includes("luciano")&&s.includes("carugno")?"dark"===e?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800":s.includes("alejandro")&&s.includes("mejail")?"dark"===e?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800":s.includes("gaston")&&s.includes("sarmiento")?"dark"===e?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800":"dark"===e?"bg-gray-800 text-gray-300":"bg-gray-100 text-gray-800")),children:mD(t)})})]},t._id)})})]})})}),b&&(0,ov.createPortal)((0,ep.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[(0,ep.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>y(!1)}),(0,ep.jsxs)("div",{className:(0,eg.cn)("relative w-full max-w-lg rounded-2xl p-6 shadow-2xl animate-fade-in-up max-h-[80vh] overflow-y-auto","dark"===e?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,ep.jsx)("button",{onClick:()=>y(!1),className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 transition-colors",children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})}),(0,ep.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[(0,ep.jsx)(oa.BarChart3,{className:"w-6 h-6 text-purple-500"}),"Historial de ventas por Supervisor"]}),E?(0,ep.jsx)("div",{className:"flex justify-center py-8",children:(0,ep.jsx)(eE.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,ep.jsx)("div",{className:"space-y-3",children:k.map((e,t)=>(0,ep.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",0===t?"bg-yellow-500 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-400 text-white":"bg-gray-200 dark:bg-white/10 text-gray-600 dark:text-gray-400"),children:t+1}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,ep.jsx)("span",{className:"font-medium",children:e.nombre}),(0,ep.jsx)("span",{className:"font-bold",children:e.count})]}),(0,ep.jsx)("div",{className:"h-2 rounded-full bg-gray-100 dark:bg-white/5 overflow-hidden",children:(0,ep.jsx)("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${e.count/k[0].count*100}%`}})})]})]},t))})]})]}),document.body),v&&(0,ov.createPortal)((0,ep.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[(0,ep.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>w(!1)}),(0,ep.jsxs)("div",{className:(0,eg.cn)("relative w-full max-w-lg rounded-2xl p-6 shadow-2xl animate-fade-in-up max-h-[80vh] overflow-y-auto","dark"===e?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,ep.jsx)("button",{onClick:()=>w(!1),className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 transition-colors",children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})}),(0,ep.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[(0,ep.jsx)(oa.BarChart3,{className:"w-6 h-6 text-blue-500"}),"Top Obras Sociales (Histrico)"]}),E?(0,ep.jsx)("div",{className:"flex justify-center py-8",children:(0,ep.jsx)(eE.RefreshCw,{className:"w-8 h-8 animate-spin text-blue-500"})}):(0,ep.jsx)("div",{className:"space-y-3",children:N.map((e,t)=>(0,ep.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",0===t?"bg-yellow-500 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-400 text-white":"bg-gray-200 dark:bg-white/10 text-gray-600 dark:text-gray-400"),children:t+1}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,ep.jsx)("span",{className:"font-medium",children:e.nombre}),(0,ep.jsx)("span",{className:"font-bold",children:e.count})]}),(0,ep.jsx)("div",{className:"h-2 rounded-full bg-gray-100 dark:bg-white/5 overflow-hidden",children:(0,ep.jsx)("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${e.count/N[0].count*100}%`}})})]})]},t))})]})]}),document.body)]})}var mM=e.i(18096);let mI=(0,ek.default)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),mL=(0,ek.default)("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),mF=[{label:"Total Palabras",value:3,icon:mM.Shield,color:"blue"},{label:"Activas",value:3,icon:mI,color:"green"},{label:"Detecciones",value:0,icon:eJ.AlertTriangle,color:"orange"},{label:"Sin Resolver",value:0,icon:of.XCircle,color:"red"}],mB=[{id:1,palabra:"misma obra social",severidad:"alta",fecha:"5/11/2025"},{id:2,palabra:"sindicato",severidad:"alta",fecha:"4/11/2025"},{id:3,palabra:"superintendencia",severidad:"alta",fecha:"4/11/2025"}],mU=["Legal","Competencia","Inapropiado","Otra"];function mz(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)(""),[a,n]=(0,em.useState)("Todas las categoras"),[s,i]=(0,em.useState)(!0);return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,ep.jsx)("div",{className:"flex items-start justify-between",children:(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-10 h-10 rounded-xl flex items-center justify-center","dark"===e?"bg-red-500/20":"bg-red-100"),children:(0,ep.jsx)(mM.Shield,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-red-400":"text-red-500")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl font-bold","dark"===e?"text-white":"text-gray-800"),children:"Lista de Palabras"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Gestiona la lista de palabras prohibidas"})]})]})}),(0,ep.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:mF.map((t,r)=>{let a=t.icon;return(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-4 transition-all duration-300","dark"===e?"bg-white/5 border-white/10 hover:border-white/20":"bg-white border-gray-200 hover:border-purple-200 shadow-sm"),children:(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-2xl font-bold mt-1",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color)),children:t.value})]}),(0,ep.jsx)(a,{className:(0,eg.cn)("w-6 h-6",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color))})]})},r)})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-lg"),children:(0,ep.jsxs)("div",{className:"space-y-4 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3",children:[(0,ep.jsxs)("div",{className:"flex-1 relative",children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar palabra...",value:t,onChange:e=>r(e.target.value),className:(0,eg.cn)("w-full pl-10 pr-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-800 placeholder:text-gray-400 focus:border-purple-300")})]}),(0,ep.jsxs)("select",{value:a,onChange:e=>n(e.target.value),className:(0,eg.cn)("px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-gray-50 border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{children:"Todas las categoras"}),mU.map(e=>(0,ep.jsx)("option",{children:e},e))]}),(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-2 px-4 py-2 rounded-lg border cursor-pointer transition-all",s?"dark"===e?"bg-green-500/20 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-600":"dark"===e?"bg-white/5 border-white/10 text-gray-400":"bg-gray-50 border-gray-200 text-gray-600"),children:[(0,ep.jsx)("input",{type:"checkbox",checked:s,onChange:e=>i(e.target.checked),className:"sr-only"}),(0,ep.jsx)(mI,{className:"w-4 h-4"}),(0,ep.jsx)("span",{className:"text-sm font-medium",children:"Activas"})]})]}),(0,ep.jsx)("div",{className:"space-y-2",children:mB.map(t=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-4 rounded-xl border transition-all hover:scale-[1.01]","dark"===e?"bg-white/5 border-white/10 hover:border-purple-500/30":"bg-gray-50 border-gray-200 hover:border-purple-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-10 h-10 rounded-lg flex items-center justify-center","dark"===e?"bg-purple-500/20":"bg-purple-100"),children:(0,ep.jsx)(mL,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:t.palabra}),(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-xs font-medium border",(t=>{switch(t.toLowerCase()){case"alta":return"dark"===e?"bg-red-500/20 text-red-400 border-red-500/30":"bg-red-100 text-red-600 border-red-200";case"media":return"dark"===e?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-yellow-100 text-yellow-600 border-yellow-200";case"baja":return"dark"===e?"bg-green-500/20 text-green-400 border-green-500/30":"bg-green-100 text-green-600 border-green-200";default:return"dark"===e?"bg-gray-500/20 text-gray-400 border-gray-500/30":"bg-gray-100 text-gray-600 border-gray-200"}})(t.severidad)),children:t.severidad})]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-0.5","text-gray-500"),children:["Agregada por el ",t.fecha]})]})]}),(0,ep.jsx)("button",{className:(0,eg.cn)("p-2 rounded-lg transition-all hover:scale-110","dark"===e?"text-red-400 hover:bg-red-500/20":"text-red-500 hover:bg-red-50"),children:(0,ep.jsx)(eU.Trash2,{className:"w-5 h-5"})})]},t.id))})]})})]})}var mV=e.i(50363);let m$=[{label:"Total Palabras",value:3,icon:mM.Shield,color:"blue"},{label:"Activas",value:3,icon:mI,color:"green"},{label:"Detecciones",value:0,icon:eJ.AlertTriangle,color:"orange"},{label:"Sin Resolver",value:0,icon:of.XCircle,color:"red"}];function mH(){let{theme:e}=(0,ex.useTheme)();return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,ep.jsx)("div",{className:"flex items-start justify-between",children:(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-10 h-10 rounded-xl flex items-center justify-center","dark"===e?"bg-orange-500/20":"bg-orange-100"),children:(0,ep.jsx)(eJ.AlertTriangle,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-orange-400":"text-orange-500")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl font-bold","dark"===e?"text-white":"text-gray-800"),children:"Detecciones"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Revisa las alertas de deteccin de palabras prohibidas"})]})]})}),(0,ep.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:m$.map((t,r)=>{let a=t.icon;return(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-4 transition-all duration-300","dark"===e?"bg-white/5 border-white/10 hover:border-white/20":"bg-white border-gray-200 hover:border-purple-200 shadow-sm"),children:(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-2xl font-bold mt-1",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color)),children:t.value})]}),(0,ep.jsx)(a,{className:(0,eg.cn)("w-6 h-6",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color))})]})},r)})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-lg"),children:(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl py-16 animate-fade-in-up","dark"===e?"bg-gradient-to-br from-white/5 to-purple-500/5":"bg-gradient-to-br from-gray-50 to-purple-50/30"),children:(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-16 h-16 rounded-full flex items-center justify-center mb-4 border-2","dark"===e?"bg-green-500/10 border-green-500/30":"bg-green-50 border-green-200"),children:(0,ep.jsx)(mV.CheckCircle2,{className:(0,eg.cn)("w-8 h-8","dark"===e?"text-green-400":"text-green-500")})}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-base","dark"===e?"text-gray-400":"text-gray-500"),children:"No hay detecciones registradas"})]})})})]})}let mW=[{label:"Total Palabras",value:3,icon:mM.Shield,color:"blue"},{label:"Activas",value:3,icon:mI,color:"green"},{label:"Detecciones",value:0,icon:eJ.AlertTriangle,color:"orange"},{label:"Sin Resolver",value:0,icon:of.XCircle,color:"red"}],mq=["Legal","Competencia","Inapropiado","Otra"],mG=["Alta","Media","Baja"];function mK(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)(""),[a,n]=(0,em.useState)("Otra"),[s,i]=(0,em.useState)("Media"),[o,l]=(0,em.useState)("");return(0,ep.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,ep.jsx)("div",{className:"flex items-start justify-between",children:(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-10 h-10 rounded-xl flex items-center justify-center","dark"===e?"bg-purple-500/20":"bg-purple-100"),children:(0,ep.jsx)(e0.Plus,{className:(0,eg.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl font-bold","dark"===e?"text-white":"text-gray-800"),children:"Agregar Palabra"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Aade una nueva palabra prohibida a la lista"})]})]})}),(0,ep.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:mW.map((t,r)=>{let a=t.icon;return(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-4 transition-all duration-300","dark"===e?"bg-white/5 border-white/10 hover:border-white/20":"bg-white border-gray-200 hover:border-purple-200 shadow-sm"),children:(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-2xl font-bold mt-1",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color)),children:t.value})]}),(0,ep.jsx)(a,{className:(0,eg.cn)("w-6 h-6",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color))})]})},r)})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-lg"),children:(0,ep.jsx)("div",{className:"flex justify-center animate-fade-in-up",children:(0,ep.jsxs)("div",{className:"w-full max-w-md space-y-5",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:["Palabra Prohibida ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsx)("input",{type:"text",placeholder:"Ej: competidor, ilegal, etc.",value:t,onChange:e=>r(e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-800 placeholder:text-gray-400 focus:border-purple-300")})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:"Categora"}),(0,ep.jsx)("select",{value:a,onChange:e=>n(e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-gray-50 border-gray-200 text-gray-800"),children:mq.map(e=>(0,ep.jsx)("option",{children:e},e))})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:"Severidad"}),(0,ep.jsx)("select",{value:s,onChange:e=>i(e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-gray-50 border-gray-200 text-gray-800"),children:mG.map(e=>(0,ep.jsx)("option",{children:e},e))})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas (Opcional)"}),(0,ep.jsx)("textarea",{placeholder:"Motivo o contexto de la prohibicin...",value:o,onChange:e=>l(e.target.value),rows:4,className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-800 placeholder:text-gray-400 focus:border-purple-300")})]}),(0,ep.jsxs)("button",{onClick:()=>{console.log({nuevaPalabra:t,nuevaCategoria:a,nuevaSeveridad:s,notas:o})},className:(0,eg.cn)("w-full flex items-center justify-center gap-2 py-3 rounded-lg font-medium text-white transition-all hover:scale-[1.02] active:scale-[0.98]","dark"===e?"bg-gradient-to-r from-teal-600 to-cyan-600 hover:shadow-lg hover:shadow-teal-500/20":"bg-gradient-to-r from-teal-500 to-cyan-500 hover:shadow-lg hover:shadow-teal-300/30"),children:[(0,ep.jsx)(e0.Plus,{className:"w-5 h-5"}),"Agregar Palabra"]})]})})})]})}function mX({isActive:e,onComplete:t,duration:r=3500}){let[a,n]=(0,em.useState)(!1),[s,i]=(0,em.useState)(!1),[o,l]=(0,em.useState)(!1);(0,em.useEffect)(()=>(n(!0),()=>n(!1)),[]),(0,em.useEffect)(()=>{if(console.log("[CelebrationAnimation] isActive cambi a:",e),e){console.log("[CelebrationAnimation]  Iniciando animacin de celebracin!"),i(!0),l(!1);let e=setTimeout(()=>{l(!0)},r-500),a=setTimeout(()=>{console.log("[CelebrationAnimation] Finalizando animacin"),i(!1),t?.()},r);return()=>{clearTimeout(a),clearTimeout(e)}}},[e,r,t]);let c=(0,em.useMemo)(()=>Array.from({length:60},(e,t)=>({id:t,left:100*Math.random(),delay:.8*Math.random(),color:["#10B981","#34D399","#6EE7B7","#FFD700","#F59E0B","#8B5CF6","#EC4899","#3B82F6"][Math.floor(8*Math.random())],size:8+8*Math.random(),duration:2.5+1.5*Math.random()})),[]);return a&&s?(0,ov.createPortal)((0,ep.jsxs)("div",{className:"fixed inset-0 z-[99999] pointer-events-none overflow-hidden",style:{opacity:+!o,transition:"opacity 0.5s ease-out"},children:[c.map(e=>(0,ep.jsx)("div",{style:{position:"absolute",left:`${e.left}%`,top:"-20px",width:`${e.size}px`,height:`${e.size}px`,backgroundColor:e.color,borderRadius:"2px",animation:`confettiFall ${e.duration}s ease-out ${e.delay}s forwards`}},e.id)),(0,ep.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,ep.jsxs)("div",{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-12 py-8 rounded-3xl shadow-2xl flex flex-col items-center gap-4",style:{animation:"celebrationPop 0.5s ease-out forwards, celebrationPulse 1s ease-in-out infinite 0.5s",boxShadow:"0 25px 60px -12px rgba(16, 185, 129, 0.5)"},children:[(0,ep.jsx)("div",{className:"text-7xl",style:{animation:"bounce 0.6s ease-in-out infinite"},children:""}),(0,ep.jsx)("div",{className:"text-3xl font-bold tracking-wide",children:"EXCELENTE!"}),(0,ep.jsx)("div",{className:"text-emerald-100 text-lg",children:"Venta completada exitosamente"})]})}),["","","","","",""].map((e,t)=>(0,ep.jsx)("div",{className:"absolute text-4xl",style:{left:`${15+15*t}%`,top:`${20+t%3*25}%`,animation:`starFloat 2s ease-in-out ${.15*t}s infinite`},children:e},t)),(0,ep.jsx)("style",{children:`
                @keyframes confettiFall {
                    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
                }
                @keyframes celebrationPop {
                    0% { transform: scale(0); opacity: 0; }
                    50% { transform: scale(1.1); }
                    100% { transform: scale(1); opacity: 1; }
                }
                @keyframes celebrationPulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.03); }
                }
                @keyframes bounce {
                    0%, 100% { transform: translateY(0); }
                    50% { transform: translateY(-10px); }
                }
                @keyframes starFloat {
                    0%, 100% { transform: translateY(0) rotate(0deg) scale(1); opacity: 0.8; }
                    50% { transform: translateY(-20px) rotate(180deg) scale(1.3); opacity: 1; }
                }
            `})]}),document.body):null}let mY=["Completa","QR hecho"],mQ=["Mensaje enviado","En videollamada","Rechazada","Falta documentacin","Falta clave","Falta clave (por ARCA)","Reprogramada","Reprogramada (falta confirmar hora)","Reprogramada (solo clave)","Completa","No atendi","Tiene dudas","Falta clave y documentacin","No le llegan los mensajes","Cort","Autovinculacin","Cada","Rehacer vdeo","Pendiente","QR hecho","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrn","En revisin","Remuneracin no vlida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vdeo","Rechazada","Falta documentacin","Falta clave","Falta clave y documentacin","El afiliado cambi la clave"],mJ=["OSDE","OSDEPYM","IOMA","OSSEG","OSDE 210","OSFATUN","OSDE GBA","OSECAC (126205)","OSPRERA","OMINT","OSSEGUR","OSPR","OSUTHGRA (108803)","OSBLYCA","UOM","OSPM","OSPECON (105408)","Elevar (114307)","OSCHOCA (105804)","OSPEP (113908)","OSPROTURA","OSPSIP (119708)","OSEIV (122401)","OSPIF (108100)","OSIPA (114208)","OSPESESGYPE (107206)","OSTCARA (126007)","OSPIT (121002)","OSMP (111209)","OSPECA (103709)","OSPIQYP (118705)","OSBLYCA (102904)","VIASANO (2501)","OSPCYD (103402)","OSUOMRA (112103)","OSAMOC (3405)","OSPAGA (101000)","OSPF (107404)","OSPIP (116006)","OSPIC","OSG (109202)","OSPERYH (106500)","OSPCRA (104009)","OSPMA (700108)","HOMINIS (901501)","OSCTCP (121606)","OSMA (112509)"],mZ=["Binimed","Meplife","TURF"],m0=["Alta","Cambio"];function m1({isOpen:t,onClose:r,audit:a,onSave:n}){let s,i,{theme:o}=(0,ex.useTheme)(),{user:l}=(0,i4.useAuth)(),c=(e=>{if(!e)return{fecha:"",hora:""};let t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return{fecha:`${r}-${a}-${n}`,hora:`${s}:${i}`}})(a.scheduledAt),d=l?.role?.toLowerCase(),u="asesor"===d,h="gerencia"===d,f="administrativo"===d,p=["auditor","supervisor"].includes(d||""),m="recuperador"===d,g="encargado"===d,x="independiente"===d,b=a.status?.toLowerCase()==="qr hecho"&&!f&&!h,y=(0,em.useMemo)(()=>{if(h||f||g||"auditor"===d||"independiente"===d)return!0;if("supervisor"===d)return a.supervisorSnapshot?._id===l?._id;let e=a.supervisorSnapshot?.numeroEquipo,t=l?.numeroEquipo;return e&&t&&String(e)===String(t)},[h,f,d,a.supervisorSnapshot,l]),v=y?a.telefono:"",w=f?["Pendiente","QR hecho","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrn","En revisin","Remuneracin no vlida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vdeo","Rechazada","Falta documentacin","Falta clave","Falta clave y documentacin","El afiliado cambi la clave"]:p||x||g?["Mensaje enviado","En videollamada","Rechazada","Falta documentacin","Falta clave","Falta clave (por ARCA)","Reprogramada","Reprogramada (falta confirmar hora)","Reprogramada (solo clave)","Completa","No atendi","Tiene dudas","Falta clave y documentacin","No le llegan los mensajes","Cort","Autovinculacin","Cada","Rehacer vdeo"]:h?mQ:m?["Completa","Cada","Reprogramada"]:[],[k,j]=(0,em.useState)({nombre:a.nombre||"",cuil:a.cuil||"",telefono:a.telefono||"",obraSocialAnterior:a.obraSocialAnterior||"",obraSocialVendida:a.obraSocialVendida||"",status:a.status||"",tipoVenta:a.tipoVenta||"Alta",asesor:a.asesor?._id||"",grupo:a.groupId?.nombre||a.groupId?.name||a.grupo||"",numeroEquipo:a.asesor?.numeroEquipo||a.numeroEquipo||"",auditor:a.auditor?._id||"",administrador:a.administrador?._id||"",fecha:c.fecha,hora:c.hora,datosExtra:a.datosExtra||"",isRecuperada:a.isRecuperada||!1,isReferido:!1,disponibleParaVenta:a.disponibleParaVenta||!1,fechaCreacionQR:a.fechaCreacionQR?a.fechaCreacionQR.split("T")[0]:"",supervisor:a.supervisorSnapshot?._id||""}),[N,S]=(0,em.useState)(!1),[E,C]=(0,em.useState)(!1),[T,A]=(0,em.useState)("details"),[_,O]=(0,em.useState)(!1),P=(0,em.useRef)(null),[D,R]=(0,em.useState)([]),[M,I]=(0,em.useState)([]),[L,F]=(0,em.useState)([]),[B,U]=(0,em.useState)([]),[z,V]=(0,em.useState)([]),[H,W]=(0,em.useState)([]);(0,em.useEffect)(()=>{t&&(j({nombre:a.nombre||"",cuil:a.cuil||"",telefono:a.telefono||"",obraSocialAnterior:a.obraSocialAnterior||"",obraSocialVendida:a.obraSocialVendida||"",status:a.status||"",tipoVenta:a.tipoVenta||"Alta",asesor:a.asesor?._id||"",grupo:a.groupId?.nombre||a.groupId?.name||a.grupo||"",numeroEquipo:a.asesor?.numeroEquipo||a.numeroEquipo||"",auditor:a.auditor?._id||"",administrador:a.administrador?._id||"",fecha:c.fecha,hora:c.hora,datosExtra:a.datosExtra||"",isRecuperada:a.isRecuperada||!1,isReferido:a.isReferido||!1,disponibleParaVenta:a.disponibleParaVenta||!1,fechaCreacionQR:a.fechaCreacionQR?a.fechaCreacionQR.split("T")[0]:"",supervisor:a.supervisorSnapshot?._id||""}),q())},[t,a]),(0,em.useEffect)(()=>{k.fecha&&Q(k.fecha)},[k.fecha]);let q=async()=>{try{let e=(await e_.api.users.list("includeAllAuditors=true")).data||[];console.log("AuditEditModal: Users fetched:",e.length,e),R(e.filter(e=>!1!==e.active));let t=e.filter(e=>["auditor","supervisor","gerencia","recuperador"].includes(e.role?.toLowerCase())&&!1!==e.active);console.log("AuditEditModal: Filtered auditores:",t.length,t),F(t),U(e.filter(e=>["supervisor","supervisor_reventa","encargado","gerencia"].includes(e.role?.toLowerCase())&&!1!==e.active)),V(e.filter(e=>"administrativo"===e.role&&!1!==e.active));let r=Array.from(new Set(e.filter(e=>e.numeroEquipo).map(e=>e.numeroEquipo))).map(e=>({_id:e,nombre:e,name:e}));I(r)}catch(e){console.error("Error fetching filter options:",e),R([]),F([]),V([]),I([])}},G=(0,em.useMemo)(()=>k.isReferido?B.filter(e=>["supervisor","supervisor_reventa","encargado","gerencia"].includes(e.role?.toLowerCase())):B.filter(e=>["supervisor","supervisor_reventa","encargado"].includes(e.role?.toLowerCase())),[B,k.isReferido]),K=(0,em.useMemo)(()=>{if(!k.supervisor)return!1;let e=B.find(e=>e._id===k.supervisor);return e?.role?.toLowerCase()==="gerencia"},[k.supervisor,B]),X=(0,em.useMemo)(()=>{if(!k.supervisor)return!1;let e=B.find(e=>e._id===k.supervisor),t=e?.nombre?.toLowerCase()||"";return t.includes("eliana")&&(t.includes("suarez")||t.includes("surez"))},[k.supervisor,B]),Y=(0,em.useMemo)(()=>{if(X)return D.filter(e=>{let t=e.role?.toLowerCase();return"gerencia"===t||"recuperador"===t||"supervisor"===t});if(K)return D.filter(e=>e.role?.toLowerCase()==="gerencia");if(!k.numeroEquipo&&!k.grupo)return D;let e=k.numeroEquipo||k.grupo;return D.filter(t=>t.numeroEquipo===e)},[D,k.numeroEquipo,k.grupo,K,X]),Q=async e=>{try{let{data:t}=await e_.api.audits.getAvailableSlots(e);W(t||[])}catch(e){console.error("Error fetching slots:",e),W([])}},J=(s=(()=>{let e=[],t=new Date;t.setHours(9,20,0,0);let r=new Date;r.setHours(23,0,0,0);let a=new Date(t);for(;a<=r;){let t=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0");e.push(`${t}:${r}`),a.setMinutes(a.getMinutes()+20)}return e})(),i={},Array.isArray(H)&&H.forEach(e=>{i[e.time]=e.count}),s.map(e=>({time:e,disabled:(i[e]||0)>=10})));if(!t)return null;let Z=e=>{let{name:t,value:r,type:a}=e.target,n=e.target.checked;if("grupo"===t){let e=D.find(e=>e.numeroEquipo===r&&["supervisor","supervisor_reventa","encargado"].includes(e.role?.toLowerCase()));j(t=>({...t,grupo:r,numeroEquipo:r,asesor:e?._id||""}))}else if("supervisor"===t){let e=B.find(e=>e._id===r);e?.role?.toLowerCase()==="gerencia"?j(e=>({...e,supervisor:r,grupo:"",numeroEquipo:"",asesor:""})):j(e=>({...e,supervisor:r}))}else"isReferido"===t?j(e=>{if(!n){let t=B.find(t=>t._id===e.supervisor);if(t?.role?.toLowerCase()==="gerencia")return{...e,isReferido:n,supervisor:"",grupo:"",numeroEquipo:"",asesor:""}}return{...e,isReferido:n}}):j(e=>({...e,[t]:"checkbox"===a?n:r}))},ee=async()=>{try{S(!0);let e={...k,scheduledAt:`${k.fecha}T${k.hora}:00`,fechaCreacionQR:k.fechaCreacionQR?new Date(k.fechaCreacionQR).toISOString():null};if(e.asesor||(e.asesor=null),e.grupo||(e.grupo=null),e.numeroEquipo||(e.numeroEquipo=null),e.auditor=k.auditor||null,e.administrador=k.administrador||null,h||g?e.supervisor||(e.supervisor=null):delete e.supervisor,E&&k.fecha&&k.hora&&(e.scheduledAt=new Date(`${k.fecha}T${k.hora}:00`).toISOString()),a.auditor?._id&&!k.auditor){let e=l?._id===a.auditor._id,t=(()=>{if(l?.role?.toLowerCase()!=="supervisor")return!1;let e=a.asesor?.numeroEquipo||a.numeroEquipo,t=l?.numeroEquipo;return e&&t&&String(e)===String(t)})();if(!h&&!t&&!e){eO.toast.error("No tienes permiso para quitar al auditor asignado. Solo gerencia, el supervisor del equipo o el auditor mismo pueden hacerlo."),S(!1);return}}if(a.administrador?._id&&!k.administrador){let e=l?._id===a.administrador._id;if(!h&&!e){eO.toast.error("No tienes permiso para quitar al administrador asignado"),S(!1);return}}let t=await e_.api.audits.update(a._id,e),s=a.status,i=k.status,o=mY.includes(i)&&s!==i;console.log("[AuditEditModal] Estado anterior:",s,"-> Nuevo estado:",i),console.log("[AuditEditModal] Debera celebrar?:",o,"Estados de celebracin:",mY),o?(console.log("[AuditEditModal]  Activando celebracin!"),eO.toast.success(" Excelente! Venta completada"),P.current=t.data,O(!0)):(eO.toast.success("Auditora actualizada"),n(t.data),r())}catch(e){console.error("Error updating audit:",e),eO.toast.error(e.response?.data?.message||"Error al actualizar auditora")}finally{S(!1)}},[et,er]=(0,em.useState)(!1);if((0,em.useEffect)(()=>(er(!0),()=>er(!1)),[]),!et)return null;let{createPortal:ea}=e.r(56667);return ea((0,ep.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-4xl rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]","dark"===o?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("px-6 py-4 border-b flex items-center justify-between","dark"===o?"border-white/10":"border-gray-100"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold","dark"===o?"text-white":"text-gray-800"),children:"Editar Auditora"}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===o?"text-gray-400":"text-gray-500"),children:[a.nombre," - ",a.cuil]})]}),(0,ep.jsx)("button",{onClick:r,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===o?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex border-b","dark"===o?"border-white/10":"border-gray-100"),children:[(0,ep.jsx)("button",{onClick:()=>A("details"),className:(0,eg.cn)("flex-1 px-4 py-3 text-sm font-medium transition-colors border-b-2","details"===T?"dark"===o?"border-purple-500 text-purple-400":"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Detalles"}),(0,ep.jsx)("button",{onClick:()=>A("history"),className:(0,eg.cn)("flex-1 px-4 py-3 text-sm font-medium transition-colors border-b-2","history"===T?"dark"===o?"border-purple-500 text-purple-400":"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Historial"})]}),(0,ep.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[b&&(0,ep.jsx)("div",{className:(0,eg.cn)("mb-4 p-3 rounded-lg border","dark"===o?"bg-yellow-500/10 border-yellow-500/30":"bg-yellow-50 border-yellow-200"),children:(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===o?"text-yellow-400":"text-yellow-700"),children:' Esta auditora tiene estado "QR Hecho" y no puede ser editada.'})}),m&&(0,ep.jsx)("div",{className:(0,eg.cn)("mb-4 p-3 rounded-lg border","dark"===o?"bg-blue-500/10 border-blue-500/30":"bg-blue-50 border-blue-200"),children:(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===o?"text-blue-400":"text-blue-700"),children:[" Modo solo lectura - ",f?"Utiliza Registro de Ventas para editar este registro.":"Puedes visualizar la informacin pero no modificarla."]})}),(0,ep.jsx)("fieldset",{disabled:u||b||m,className:"contents",children:"details"===T?(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Afiliado"}),(0,ep.jsx)("input",{name:"nombre",value:k.nombre,onChange:Z,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Telfono"}),(0,ep.jsx)("input",{name:"telefono",value:y?k.telefono:v,onChange:Z,readOnly:!y,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",!y&&"text-gray-400 select-none cursor-not-allowed",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"CUIL"}),(0,ep.jsx)("input",{name:"cuil",value:k.cuil,onChange:Z,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Obra Social Anterior"}),(0,ep.jsxs)("select",{name:"obraSocialAnterior",value:k.obraSocialAnterior,onChange:Z,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar --"}),mJ.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Obra Social Vendida"}),(0,ep.jsx)("select",{name:"obraSocialVendida",value:k.obraSocialVendida,onChange:Z,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:mZ.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Estado"}),(0,ep.jsxs)("select",{name:"status",value:k.status,onChange:Z,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar estado..."}),k.status&&!w.includes(k.status)&&(0,ep.jsx)("option",{value:k.status,children:k.status}),w.map(e=>(0,ep.jsx)("option",{value:e,disabled:"Reprogramada"===e&&!E,children:e},e))]}),(k.status?.toLowerCase()==="afip"||k.status?.toLowerCase()==="padrn")&&(0,ep.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,ep.jsx)("input",{type:"checkbox",name:"disponibleParaVenta",checked:k.disponibleParaVenta,onChange:Z,className:"w-4 h-4 rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm","dark"===o?"text-gray-300":"text-gray-700"),children:"Disponible para venta"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Tipo"}),(0,ep.jsx)("select",{name:"tipoVenta",value:k.tipoVenta,onChange:Z,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:m0.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Asesor"}),(0,ep.jsxs)("select",{name:"asesor",value:k.asesor,onChange:Z,disabled:!h&&!g||m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",(!h&&!g||m)&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),Y?.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Grupo"}),(0,ep.jsxs)("select",{name:"grupo",value:k.grupo,onChange:Z,disabled:!h&&!g||K||m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",(!h&&!g||K||m)&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"-- Sin Grupo (Asignacin Manual) --"}),M?.map(e=>(0,ep.jsx)("option",{value:e.nombre||e.name,children:e.nombre||e.name},e._id))]}),K&&!m&&(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===o?"text-amber-400":"text-amber-600"),children:"Grupo deshabilitado (Supervisor es Gerencia)"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Supervisor"}),(0,ep.jsxs)("select",{name:"supervisor",value:k.supervisor,onChange:Z,disabled:!h&&!g||m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",(!h&&!g||m)&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),G?.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," ",e.role?.toLowerCase()==="gerencia"?"(Gerencia)":e.numeroEquipo?`(${e.numeroEquipo})`:""]},e._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Auditor"}),(0,ep.jsxs)("select",{name:"auditor",value:k.auditor,onChange:Z,disabled:m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",m&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),L?.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Administrador"}),(0,ep.jsxs)("select",{name:"administrador",value:k.administrador,onChange:Z,disabled:!h&&!f||m,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",(!h&&!f||m)&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),z?.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Fecha (da)"}),(0,ep.jsx)("input",{type:"date",name:"fecha",value:k.fecha,onChange:Z,disabled:!E,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",!E&&"opacity-50 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Hora (Turno)"}),(0,ep.jsxs)("select",{name:"hora",value:k.hora,onChange:Z,disabled:!E,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",!E&&"opacity-50 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar hora"}),J.map(e=>(0,ep.jsxs)("option",{value:e.time,disabled:e.disabled&&e.time!==k.hora,children:[e.time," ",e.disabled?"(Lleno)":""]},e.time))]})]})]}),["administrativo","gerencia"].includes(l?.role?.toLowerCase()||"")&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Fecha Creacin QR"}),(0,ep.jsx)("input",{type:"date",name:"fechaCreacionQR",value:k.fechaCreacionQR,onChange:Z,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("input",{type:"checkbox",id:"reprogramar",checked:E,onChange:e=>{let t=e.target.checked;C(t),t&&j(e=>({...e,status:"Reprogramada"}))},className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,ep.jsx)("label",{htmlFor:"reprogramar",className:(0,eg.cn)("text-sm font-medium","dark"===o?"text-gray-300":"text-gray-700"),children:"Reprogramar turno (habilitar fecha/hora)"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Datos Extra / Notas"}),(0,ep.jsx)("textarea",{name:"datosExtra",value:k.datosExtra,onChange:Z,rows:3,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("input",{type:"checkbox",name:"isRecuperada",checked:k.isRecuperada,onChange:Z,disabled:m,className:(0,eg.cn)("w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500",m&&"opacity-60 cursor-not-allowed")}),(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm","dark"===o?"text-gray-300":"text-gray-700"),children:"Recuperada?"}),m&&(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs ml-2","dark"===o?"text-gray-500":"text-gray-400"),children:"(Se marca automticamente al pasar a Completa)"})]}),h&&(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("input",{type:"checkbox",name:"isReferido",checked:k.isReferido,onChange:Z,className:"w-4 h-4 rounded border-gray-300 text-amber-600 focus:ring-amber-500"}),(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm","dark"===o?"text-gray-300":"text-gray-700"),children:"Referido"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs ml-2","dark"===o?"text-gray-500":"text-gray-400"),children:"(Permite asignar Gerencia como Supervisor)"})]})]}):(0,ep.jsxs)("div",{className:"space-y-6",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3 flex items-center gap-2","dark"===o?"text-white":"text-gray-800"),children:[(0,ep.jsx)(eV.Clock,{className:"w-4 h-4"}),"Historial de Estados"]}),(0,ep.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-200 dark:border-white/10",children:[a.statusHistory?.slice().reverse().map((e,t)=>(0,ep.jsxs)("div",{className:"relative pl-4 pb-2",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2","dark"===o?"bg-gray-900 border-purple-500":"bg-white border-purple-500")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===o?"text-gray-200":"text-gray-800"),children:e.value}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs","dark"===o?"text-gray-400":"text-gray-500"),children:[e.updatedBy?.nombre||"Sistema"," - ",new Date(e.updatedAt).toLocaleString()]})]},t)),(!a.statusHistory||0===a.statusHistory.length)&&(0,ep.jsx)("p",{className:"text-sm text-gray-500 pl-4",children:"No hay historial de estados"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3 flex items-center gap-2","dark"===o?"text-white":"text-gray-800"),children:[(0,ep.jsx)(ew.Users,{className:"w-4 h-4"}),"Historial de Asesores"]}),(0,ep.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-200 dark:border-white/10",children:[a.asesorHistory?.slice().reverse().map((e,t)=>(0,ep.jsxs)("div",{className:"relative pl-4 pb-2",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2","dark"===o?"bg-gray-900 border-blue-500":"bg-white border-blue-500")}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===o?"text-gray-200":"text-gray-800"),children:[e.previousAsesor?.nombre||e.previousAsesor?.name||"Sin Asesor","  ",e.newAsesor?.nombre||e.newAsesor?.name||"Sin Asesor"]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs","dark"===o?"text-gray-400":"text-gray-500"),children:[e.changedBy?.nombre||e.changedBy?.name||"Sistema"," - ",new Date(e.changedAt).toLocaleString()]})]},t)),(!a.asesorHistory||0===a.asesorHistory.length)&&(0,ep.jsx)("p",{className:"text-sm text-gray-500 pl-4",children:"No hay historial de cambios de asesor"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3 flex items-center gap-2","dark"===o?"text-white":"text-gray-800"),children:[(0,ep.jsx)(eA.MessageSquare,{className:"w-4 h-4"}),"Historial de Comentarios"]}),(0,ep.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-200 dark:border-white/10",children:[a.datosExtraHistory?.slice().reverse().map((e,t)=>(0,ep.jsxs)("div",{className:"relative pl-4 pb-2",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2","dark"===o?"bg-gray-900 border-green-500":"bg-white border-green-500")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===o?"text-gray-200":"text-gray-800"),children:e.value}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs","dark"===o?"text-gray-400":"text-gray-500"),children:[e.updatedBy?.nombre||"Sistema"," - ",new Date(e.updatedAt).toLocaleString()]})]},t)),(!a.datosExtraHistory||0===a.datosExtraHistory.length)&&(0,ep.jsx)("p",{className:"text-sm text-gray-500 pl-4",children:"No hay historial de comentarios"})]})]})]})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("px-6 py-4 border-t flex justify-end gap-3","dark"===o?"border-white/10":"border-gray-100"),children:[(0,ep.jsx)("button",{onClick:r,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===o?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:"Cancelar"}),!m&&(0,ep.jsxs)("button",{onClick:ee,disabled:N,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",N?"opacity-50 cursor-not-allowed":"hover:opacity-90","bg-purple-600"),children:[(0,ep.jsx)(eB.Save,{className:"w-4 h-4"}),N?"Guardando...":"Guardar Cambios"]})]})]}),(0,ep.jsx)(mX,{isActive:_,onComplete:()=>{console.log("[AuditEditModal] Animacin completada, guardando y cerrando..."),O(!1),P.current&&(n(P.current),P.current=null),r()},duration:3500})]}),document.body)}let m2=["OSDE","OSDEPYM","IOMA","OSSEG","OSDE 210","OSFATUN","OSDE GBA","OSECAC (126205)","OSPRERA","OMINT","OSSEGUR","OSPR","OSUTHGRA (108803)","OSBLYCA","UOM","OSPM","OSPECON (105408)","Elevar (114307)","OSCHOCA (105804)","OSPEP (113908)","OSPROTURA","OSPSIP (119708)","OSEIV (122401)","OSPIF (108100)","OSIPA (114208)","OSPESESGYPE (107206)","OSTCARA (126007)","OSPIT (121002)","OSMP (111209)","OSPECA (103709)","OSPIQYP (118705)","OSBLYCA (102904)","VIASANO (2501)","OSPCYD (103402)","OSUOMRA (112103)","OSAMOC (3405)","OSPAGA (101000)","OSPF (107404)","OSPIP (116006)","OSPIC","OSG (109202)","OSPERYH (106500)","OSPCRA (104009)","OSPMA (700108)","HOMINIS (901501)","OSCTCP (121606)","OSMA (112509)"],m5=["Binimed","Meplife","TURF"],m4=["Sin estado","Mensaje enviado","En videollamada","Rechazada","Falta documentacin","Falta clave","Falta clave (por ARCA)","Reprogramada","Reprogramada (falta confirmar hora)","Reprogramada (solo clave)","Completa","No atendi","Tiene dudas","Falta clave y documentacin","No le llegan los mensajes","Cort","Autovinculacin","Cada","Rehacer vdeo","Pendiente","QR hecho","QR hecho pero pendiente de aprobacin","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrn","En revisin","Remuneracin no vlida","Cargada","Aprobada","Aprobada, pero no reconoce clave","El afiliado cambi la clave"],m3=["Alta","Cambio"],m6=(e,t)=>{let r=(e||"").toLowerCase();return"binimed"===r?"dark"===t?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"meplife"===r||"meplife "===r?"dark"===t?"bg-green-500/20 text-green-400":"bg-green-200 text-green-800":"turf"===r?"dark"===t?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800":"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700"},m8=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-";function m7(){let e,t,r,a,{theme:n}=(0,ex.useTheme)(),{user:s}=(0,i4.useAuth)(),[i,o]=(0,em.useState)([]),[l,c]=(0,em.useState)(!1),[d,u]=(0,em.useState)(!0),[h,f]=(0,em.useState)({afiliado:"",cuil:"",obraAnterior:"",obraVendida:"",estado:"",tipo:"",asesor:"",datos:"",auditor:"",supervisor:"",administrador:""}),[p,m]=(0,em.useState)(""),[g,x]=(0,em.useState)(""),[b,y]=(0,em.useState)([]),[v,w]=(0,em.useState)([]),[k,j]=(0,em.useState)([]),[N,S]=(0,em.useState)([]),[E,C]=(0,em.useState)([]),[T,A]=(0,em.useState)([]),[_,O]=(0,em.useState)(!1),[P,D]=(0,em.useState)(!1),[R,M]=(0,em.useState)(!1),[I,L]=(0,em.useState)(!1),[F,B]=(0,em.useState)(!1),[U,z]=(0,em.useState)(!1),[V,H]=(0,em.useState)([]),[W,q]=(0,em.useState)([]),[G,K]=(0,em.useState)([]),[X,Y]=(0,em.useState)([]),[Q,J]=(0,em.useState)([]),Z=(0,em.useMemo)(()=>{if(0===E.length)return V;let e=new Set;return(E.forEach(t=>{let r=X.find(e=>e.nombre===t);r?.numeroEquipo&&e.add(r.numeroEquipo)}),0===e.size)?V:V.filter(t=>t.numeroEquipo&&e.has(t.numeroEquipo))},[V,E,X]),[ee,et]=(0,em.useState)(null),[er,ea]=(0,em.useState)(!1),[en,es]=(0,em.useState)(!1),[ei,eo]=(0,em.useState)([]),[el,ec]=(0,em.useState)(!1),[ed,eu]=(0,em.useState)(new Date().toISOString().split("T")[0]),[eh,ef]=(0,em.useState)(!1),[eb,ey]=(0,em.useState)([]),[ev,ew]=(0,em.useState)(!1),[ek,ej]=(0,em.useState)(new Date().toISOString().split("T")[0]),eN=(0,em.useRef)(null),eC=(0,em.useRef)(null),eA=(0,em.useRef)(null),eP=(0,em.useRef)(null),eD=(0,em.useRef)(null),eR=(0,em.useRef)(null),eM=(()=>{try{let e=localStorage.getItem("token");if(!e)return null;let t=JSON.parse(atob(e.split(".")[1]));return t?.role||null}catch{return null}})(),eI="supervisor"===eM||"Supervisor"===eM||"encargado"===eM||"Encargado"===eM,eL="admin"===eM||"Admin"===eM,eF="gerencia"===eM||"Gerencia"===eM,eB="asesor"===eM||"Asesor"===eM,eV="administrativo"===eM||"Administrativo"===eM,e$="recuperador"===eM||"Recuperador"===eM,eH="encargado"===eM||"Encargado"===eM,eW=(e,t)=>{let r=(e||"").trim();r&&t(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])},eq=(e,t,r)=>0===e.length?t:1===e.length?e[0]:`${e.length} ${r}`,eG=async()=>{try{c(!0);let e=(()=>{let e={...h};if(v.length>0&&!v.includes("Sin estado")&&(e.estado=v.map(e=>e.trim()).join(",")),k.length>0&&(e.asesor=k.map(e=>e.trim()).filter(Boolean).join(",")),N.length>0&&(e.auditor=N.map(e=>e.trim()).filter(Boolean).join(",")),E.length>0&&(e.supervisor=E.map(e=>e.trim()).filter(Boolean).join(",")),T.length>0&&(e.administrador=T.map(e=>e.trim()).filter(Boolean).join(",")),b.length>0&&(e.grupo=b.map(e=>e.trim()).filter(Boolean).join(",")),h.cuil&&""!==h.cuil.trim())delete e.dateFrom,delete e.dateTo,delete e.date;else if(p&&g)e.dateFrom=p,e.dateTo=g;else{let t,r,a,n,s,i;p||g||(r=(t=new Date(new Date().toLocaleString("en-US",{timeZone:"America/Argentina/Buenos_Aires"}))).getHours(),a=t.getMinutes(),(23===r&&a>=1||r>23)&&t.setDate(t.getDate()+1),n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),e.date=`${n}-${s}-${i}`)}return Object.keys(e).forEach(t=>{(""===e[t]||null===e[t]||void 0===e[t])&&delete e[t]}),e})(),{data:t}=await e_.api.audits.list(e),r=Array.isArray(t)?t:[],a=r;if(v.length>0)a=v.includes("Sin estado")?r.filter(e=>{let t=(e.status||"").trim(),r=!t||"Seleccione"===t||"Seleccionar estado..."===t,a=v.includes(t);return r||a}):r;else{let e=["cargada","aprobada"];a=r.filter(t=>{let r=(t.status||"").toLowerCase();return!e.includes(r)})}o(a)}catch(e){console.error(e),eO.toast.error("Error al cargar auditoras"),o([])}finally{c(!1)}},eK=async()=>{try{let e=await e_.api.users.list("includeAllAuditors=true"),t=Array.isArray(e.data)?e.data:[];if(eB&&s?.nombre){let e=t.find(e=>e._id===s._id);e?(H([e]),j([e.nombre])):(H([{_id:s._id,nombre:s.nombre,email:s.email||"",role:"asesor"}]),j([s.nombre]))}else{let e=t.filter(e=>{let t=e?.active!==!1,r="asesor"===e.role||"Asesor"===e.role,a=("auditor"===e.role||"Auditor"===e.role)&&e.numeroEquipo;return t&&(r||a)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));H(e)}let r=t.filter(e=>{let t=e?.active!==!1,r=e?.role;return t&&("auditor"===r||"Auditor"===r||"gerencia"===r||"Gerencia"===r||"supervisor"===r||"Supervisor"===r)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));K(r);let a=await e_.api.groups.list(),n=Array.isArray(a.data)?a.data:[];q(n.sort((e,t)=>(e.nombre||"").localeCompare(t.nombre||"")));let i=t.filter(e=>{let t=e?.active!==!1,r=e.role?.toLowerCase();return t&&("supervisor"===r||"gerencia"===r||"encargado"===r)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));Y(i);let o=t.filter(e=>{let t=e?.active!==!1,r=(e.role||"").toLowerCase();return t&&"administrativo"===r&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));J(o)}catch(e){console.error("Error al cargar opciones de filtros:",e)}},eX=(e,t)=>{f(r=>({...r,[e]:t}))},eY=async e=>{if(confirm("Ests seguro de eliminar esta auditora?"))try{await e_.api.audits.delete(e),eO.toast.success("Auditora eliminada"),eG()}catch(e){console.error("Error deleting audit:",e),eO.toast.error("Error al eliminar auditora")}},eQ=async e=>{ec(!0);try{let{data:t}=await e_.api.audits.getAvailableSlots(e);eo(Array.isArray(t)?t:[])}catch(e){console.error(e),eO.toast.error("No se pudieron cargar los turnos")}finally{ec(!1)}},eJ=async e=>{ew(!0);try{let{data:t}=await e_.api.audits.getSalesStats(e);ey(Array.isArray(t)?t:[])}catch(e){console.error(e),eO.toast.error("No se pudieron cargar las estadsticas")}finally{ew(!1)}};return(0,em.useEffect)(()=>{eG(),eK();let e=(0,iQ.connectSocket)();e.emit("audits:subscribeAll"),console.log("[Seguimiento] Subscribed to audits_all room");let t=e=>{if(console.log("[Socket] New audit received:",e._id),eB&&s?._id){let t="object"==typeof e.asesor?e.asesor?._id:e.asesor,r=e.createdBy?._id||e.createdBy;if(t!==s._id&&r!==s._id)return void console.log("[Socket] Asesor filter: ignoring audit (not owned)",e._id)}o(t=>{if(t.some(t=>t._id===e._id))return t;let r=[e,...t];return eO.toast.info(`Nueva auditor\xeda: ${e.nombre}`,{duration:3e3}),r})},r=e=>{console.log("[Socket] Actualizacin de auditora recibida:",e._id),o(t=>{let r=t.findIndex(t=>t._id===e._id);if(-1===r)return t;let a=[...t];return a[r]={...t[r],...e},a}),et(t=>t&&t._id===e._id?(er&&e.updatedBy!==s?._id&&eO.toast.warning("Esta auditora fue modificada por otro usuario",{duration:5e3}),{...t,...e}):t)},a=e=>{console.log("[Socket] Audit deleted:",e._id),o(t=>t.filter(t=>t._id!==e._id)),ee&&ee._id===e._id&&(ea(!1),et(null),eO.toast.error("La auditora que estabas editando fue eliminada",{duration:5e3}))};return e.on("audits:new",t),e.on("audit:update",r),e.on("audit:deleted",a),()=>{e.off("audits:new",t),e.off("audit:update",r),e.off("audit:deleted",a),e.emit("audits:unsubscribeAll"),console.log("[Seguimiento] Unsubscribed from audits_all room")}},[er,ee]),(0,em.useEffect)(()=>{eG()},[h,b,v,k,N,E,T,p,g]),(0,em.useEffect)(()=>{let e=[{ref:eN,setOpen:O},{ref:eC,setOpen:D},{ref:eA,setOpen:M},{ref:eP,setOpen:L},{ref:eD,setOpen:B},{ref:eR,setOpen:z}],t=t=>{e.forEach(({ref:e,setOpen:r})=>{e.current&&!e.current.contains(t.target)&&r(!1)})};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm relative z-20","dark"===n?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,ep.jsx)(ow.Filter,{className:(0,eg.cn)("w-5 h-5","dark"===n?"text-purple-400":"text-purple-500")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("font-semibold","dark"===n?"text-white":"text-gray-800"),children:"Filtros"})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3 mb-3",children:[(0,ep.jsx)("input",{type:"text",placeholder:"Buscar afiliado",value:h.afiliado,onChange:e=>eX("afiliado",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar CUIL",value:h.cuil,onChange:e=>eX("cuil",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsxs)("select",{value:h.obraAnterior,onChange:e=>eX("obraAnterior",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Obra social anterior"}),m2.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]}),(0,ep.jsxs)("select",{value:h.obraVendida,onChange:e=>eX("obraVendida",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Obra social vendida"}),m5.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]}),(0,ep.jsxs)("div",{className:"relative",ref:eC,children:[(0,ep.jsxs)("button",{onClick:()=>D(!P),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:eq(v,"Estado","estados")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),P&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>w(m4),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),v.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>w([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),m4.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:v.includes(e),onChange:()=>eW(e,w),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e})]},e))]})]}),(0,ep.jsxs)("select",{value:h.tipo,onChange:e=>eX("tipo",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Tipo"}),m3.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3 mb-3",children:[(0,ep.jsxs)("div",{className:"relative",ref:eA,children:[(0,ep.jsxs)("button",{onClick:()=>!eB&&M(!R),disabled:eB,className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800",eB&&"opacity-70 cursor-not-allowed"),title:eB?"Solo puedes ver tus propias ventas":void 0,children:[(0,ep.jsx)("span",{className:"truncate",children:eq(k,"Asesor","asesores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),R&&!eB&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>j(Z.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),k.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>j([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),Z.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:k.includes(e.nombre),onChange:()=>eW(e.nombre,j),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,ep.jsxs)("div",{className:"relative",ref:eP,children:[(0,ep.jsxs)("button",{onClick:()=>L(!I),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:eq(N,"Auditor","auditores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),I&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>S(G.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),N.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>S([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),G.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:N.includes(e.nombre),onChange:()=>eW(e.nombre,S),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),("auditor"===eM||"Auditor"===eM||eF||eL||eI||eB||eV)&&(0,ep.jsxs)("div",{className:"relative",ref:eD,children:[(0,ep.jsxs)("button",{onClick:()=>B(!F),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:eq(E,"Supervisor","supervisores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),F&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>C(X.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),E.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>C([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),X.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:E.includes(e.nombre),onChange:()=>eW(e.nombre,C),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,ep.jsxs)("div",{className:"relative",ref:eR,children:[(0,ep.jsxs)("button",{onClick:()=>z(!U),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:eq(T,"Administrativos","administrativos")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),U&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>A(Q.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),T.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>A([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),Q.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:T.includes(e.nombre),onChange:()=>eW(e.nombre,A),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]})]}),(0,ep.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs block mb-1","dark"===n?"text-gray-400":"text-gray-500"),children:"Desde"}),(0,ep.jsx)("input",{type:"date",value:p,onChange:e=>m(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs block mb-1","dark"===n?"text-gray-400":"text-gray-500"),children:"Hasta"}),(0,ep.jsx)("input",{type:"date",value:g,onChange:e=>x(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsx)("div",{className:"flex-1"}),(0,ep.jsx)("button",{onClick:eG,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===n?"bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30":"bg-cyan-500 text-white hover:bg-cyan-600"),children:"Aplicar filtros"}),(0,ep.jsx)("button",{onClick:()=>{f({afiliado:"",cuil:"",obraAnterior:"",obraVendida:"",estado:"",tipo:"",asesor:"",datos:"",auditor:"",supervisor:"",administrador:""}),m(""),x(""),y([]),w([]),eB||j([]),S([]),C([]),A([])},className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===n?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Limpiar"}),!["asesor","supervisor"].includes(s?.role?.toLowerCase()||"")&&(0,ep.jsxs)("button",{onClick:()=>{if(!i||0===i.length)return void eO.toast.info("No hay datos para exportar");let e=mA(i.map(e=>{let t=e.telefono||"-";if(eI||eB){let r=e.asesor?.numeroEquipo,a=s?.numeroEquipo;r&&a&&r!==a&&(t="***")}return{Fecha:e.scheduledAt?new Date(e.scheduledAt).toLocaleDateString("es-AR"):"-",Hora:e.scheduledAt?new Date(e.scheduledAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-",Afiliado:e.nombre||"-",CUIL:e.cuil||"-",Telfono:t,"Obra Social Anterior":e.obraSocialAnterior||"-","Obra Social Vendida":e.obraSocialVendida||"-",Estado:e.status||"-",Tipo:e.tipoVenta||"-",Asesor:e.asesor?.nombre||"-",Supervisor:m8(e),Grupo:e.groupId?.nombre||"-",Auditor:e.auditor?.nombre||"-",Administrador:e.administrador?.nombre||"-","Recuperada?":e.isRecuperada?"S":"No"}})),t=m_();mO(t,e,"Auditoras");let r=new Date().toISOString().slice(0,10);mj(t,`audits_${p||r}.xlsx`),eO.toast.success("Exportado correctamente")},className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2",style:{backgroundColor:"#17C787"},children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar"]}),(0,ep.jsxs)("button",{onClick:()=>{es(!0),eQ(ed)},className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2","bg-purple-600 hover:bg-purple-700"),children:[(0,ep.jsx)(eS,{className:"w-4 h-4"}),"Turnos"]}),(eI||eF)&&(0,ep.jsxs)("button",{onClick:()=>{ef(!0),eJ(ek)},className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2","bg-indigo-600 hover:bg-indigo-700"),children:[(0,ep.jsx)(oa.BarChart3,{className:"w-4 h-4"}),"Estadsticas"]})]})]}),i.length>0&&(e={},t=0,i.forEach(r=>{let a=r.status||"Sin estado";e[a]=(e[a]||0)+1,r.isRecuperada&&t++}),r=i.length,a=Object.entries(e).sort((e,t)=>t[1]-e[1]),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-3 mb-4","dark"===n?"bg-gradient-to-r from-blue-900/20 to-indigo-900/20 border-blue-700/30":"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"),children:(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("font-bold","dark"===n?"text-gray-200":"text-gray-800"),children:["Total: ",(0,ep.jsx)("span",{className:"dark"===n?"text-blue-400":"text-blue-600",children:r})]}),a.map(([e,t])=>(0,ep.jsxs)("span",{className:"dark"===n?"text-gray-300":"text-gray-700",children:[(0,ep.jsxs)("span",{className:"font-semibold",children:[e,":"]})," ",(0,ep.jsx)("span",{className:"dark"===n?"text-indigo-400":"text-indigo-600",children:t})]},e)),t>0&&(0,ep.jsxs)("span",{className:"dark"===n?"text-gray-300":"text-gray-700",children:[(0,ep.jsx)("span",{className:"font-semibold",children:"Recuperadas:"})," ",(0,ep.jsx)("span",{className:"dark"===n?"text-green-400":"text-green-600",children:t})]})]})})),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===n?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{className:(0,eg.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===n?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,ep.jsxs)("tr",{children:[(0,ep.jsx)("th",{className:"px-2 py-2 w-[120px]",children:"Fecha"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[150px]",children:"Afiliado"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"Telfono"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ant"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ven"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[120px]",children:"Estado"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"Tipo"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Supervisor"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[60px]",children:"Grupo"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Auditor"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Admin"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px] text-center",children:"Recup."}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px] text-center",children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:l?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:15,className:"px-4 py-8 text-center opacity-50",children:(0,ep.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando auditoras..."]})})}):0===i.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:15,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron auditoras"})}):i.map((e,t)=>{var r;let a;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors group",((e,t)=>{if(!e)return"";let r={"mensaje enviado":{light:"bg-cyan-50 hover:bg-cyan-100",dark:"bg-cyan-900/20 hover:bg-cyan-900/30"},"en videollamada":{light:"bg-blue-100 hover:bg-blue-200",dark:"bg-blue-900/30 hover:bg-blue-900/40"},"falta documentacin":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},"falta clave":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},"falta clave (por arca)":{light:"bg-indigo-50 hover:bg-indigo-100",dark:"bg-indigo-900/20 hover:bg-indigo-900/30"},reprogramada:{light:"bg-violet-50 hover:bg-violet-100",dark:"bg-violet-900/20 hover:bg-violet-900/30"},"reprogramada (falta confirmar hora)":{light:"bg-violet-50 hover:bg-violet-100",dark:"bg-violet-900/20 hover:bg-violet-900/30"},"reprogramada (solo clave)":{light:"bg-violet-50 hover:bg-violet-100",dark:"bg-violet-900/20 hover:bg-violet-900/30"},completa:{light:"bg-lime-100 hover:bg-lime-200",dark:"bg-lime-900/30 hover:bg-lime-900/40"},"qr hecho":{light:"bg-green-100 hover:bg-green-200",dark:"bg-green-900/30 hover:bg-green-900/40"},aprobada:{light:"bg-teal-100 hover:bg-teal-200",dark:"bg-teal-900/30 hover:bg-teal-900/40"},"aprobada, pero no reconoce clave":{light:"bg-yellow-100 hover:bg-yellow-200",dark:"bg-yellow-900/30 hover:bg-yellow-900/40"},"no atendi":{light:"bg-yellow-50 hover:bg-yellow-100",dark:"bg-yellow-900/20 hover:bg-yellow-900/30"},"tiene dudas":{light:"bg-pink-50 hover:bg-pink-100",dark:"bg-pink-900/20 hover:bg-pink-900/30"},"falta clave y documentacin":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},"no le llegan los mensajes":{light:"bg-purple-50 hover:bg-purple-100",dark:"bg-purple-900/20 hover:bg-purple-900/30"},cort:{light:"bg-yellow-50 hover:bg-yellow-100",dark:"bg-yellow-900/20 hover:bg-yellow-900/30"},autovinculacin:{light:"bg-pink-50 hover:bg-pink-100",dark:"bg-pink-900/20 hover:bg-pink-900/30"},cada:{light:"bg-red-100 hover:bg-red-200",dark:"bg-red-900/30 hover:bg-red-900/40"},pendiente:{light:"bg-gray-100 hover:bg-gray-200",dark:"bg-gray-700/30 hover:bg-gray-700/40"},"rehacer vdeo":{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"},rechazada:{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"},"baja remuneracin":{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"}}[e.toLowerCase()];return r?"dark"===t?r.dark:r.light:""})(e.status,n)||(t%2==0?"":"dark"===n?"bg-white/[0.02]":"bg-gray-50/50")),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-2.5 text-center","dark"===n?"text-gray-400":"text-gray-600"),children:e.fechaCreacionQR?(0,ep.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ep.jsx)("span",{className:"text-purple-500 font-medium",children:(e=>{if(!e)return"-";let t=e.split("T")[0];if(!t)return"-";let[r,a,n]=t.split("-");return r&&a&&n?`${n}/${a}/${r}`:"-"})(e.fechaCreacionQR)}),(0,ep.jsx)("span",{className:"text-[10px] text-gray-400",children:"(QR)"})]}):(e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`})(e.scheduledAt)}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center font-medium truncate max-w-[150px]",title:e.nombre,children:e.nombre}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center font-mono opacity-70 truncate",children:e.cuil||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center font-mono opacity-70 truncate",children:(eI||eB)&&e.asesor?.numeroEquipo!==s?.numeroEquipo&&!eH?"***":e.telefono}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center truncate max-w-[80px]",title:e.obraSocialAnterior,children:e.obraSocialAnterior||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[80px]",m6(e.obraSocialVendida,n)),children:e.obraSocialVendida})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px]",(r=e.status,a=({"mensaje enviado":{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-500/20 text-cyan-400"},"en videollamada":{light:"bg-blue-600 text-white",dark:"bg-blue-500/30 text-blue-300"},"falta documentacin":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"falta clave":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"falta clave (por arca)":{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-500/20 text-indigo-400"},reprogramada:{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},"reprogramada (falta confirmar hora)":{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},"reprogramada (solo clave)":{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},completa:{light:"bg-lime-600 text-white",dark:"bg-lime-500/30 text-lime-300"},"qr hecho":{light:"bg-green-600 text-white",dark:"bg-green-500/30 text-green-300"},"qr hecho pero pendiente de aprobacin":{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-500/20 text-emerald-400"},"qr hecho (temporal)":{light:"bg-green-200 text-green-800",dark:"bg-green-500/20 text-green-400"},"hacer qr":{light:"bg-gray-200 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},aprobada:{light:"bg-teal-600 text-white",dark:"bg-teal-500/30 text-teal-300"},cargada:{light:"bg-sky-100 text-sky-800",dark:"bg-sky-500/20 text-sky-400"},"no atendi":{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},"tiene dudas":{light:"bg-pink-100 text-pink-800",dark:"bg-pink-500/20 text-pink-400"},"falta clave y documentacin":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"no le llegan los mensajes":{light:"bg-purple-100 text-purple-800",dark:"bg-purple-500/20 text-purple-400"},cort:{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},autovinculacin:{light:"bg-pink-100 text-pink-700",dark:"bg-pink-500/30 text-pink-300"},cada:{light:"bg-red-600 text-white",dark:"bg-red-500/30 text-red-300"},pendiente:{light:"bg-gray-200 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"rehacer vdeo":{light:"bg-red-300 text-red-900",dark:"bg-red-500/20 text-red-400"},rechazada:{light:"bg-red-100 text-red-700",dark:"bg-red-500/20 text-red-400"},"aprobada, pero no reconoce clave":{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},afip:{light:"bg-indigo-600 text-white",dark:"bg-indigo-500/30 text-indigo-300"},"baja laboral con nueva alta":{light:"bg-blue-100 text-blue-800",dark:"bg-blue-500/20 text-blue-400"},"baja laboral sin nueva alta":{light:"bg-slate-100 text-slate-800",dark:"bg-slate-500/20 text-slate-400"},padrn:{light:"bg-fuchsia-100 text-fuchsia-800",dark:"bg-fuchsia-500/20 text-fuchsia-400"},"en revisin":{light:"bg-amber-100 text-amber-800",dark:"bg-amber-500/20 text-amber-400"},"remuneracin no vlida":{light:"bg-rose-100 text-rose-800",dark:"bg-rose-500/20 text-rose-400"},"el afiliado cambi la clave":{light:"bg-orange-200 text-orange-900",dark:"bg-orange-500/20 text-orange-400"}})[(r||"").toLowerCase()]||{light:"bg-gray-100 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"dark"===n?a.dark:a.light)),title:e.status,children:e.status})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:e.tipoVenta||"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3 text-center","dark"===n?"text-gray-300":"text-gray-700"),children:e.asesor?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px] inline-block",((e,t)=>{if(!e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=e.toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";if(r.includes("belen")&&r.includes("salaverry"))return"dark"===t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800";if(r.includes("analia")&&r.includes("suarez"))return"dark"===t?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800";if(r.includes("erika")&&r.includes("cardozo"))return"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800";if(r.includes("aryel")&&r.includes("puiggros"))return"dark"===t?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800";if(r.includes("joaquin")&&r.includes("valdez")||r.includes("joquin")&&r.includes("valdez"))return"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800";if(r.includes("luciano")&&r.includes("carugno"))return"dark"===t?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800";if(r.includes("alejandro")&&r.includes("mejail"))return"dark"===t?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800";if(r.includes("gaston")&&r.includes("sarmiento"))return"dark"===t?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-900 text-rose-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-900 text-indigo-200"}],n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);let s=Math.abs(n)%a.length,i=a[s];return"dark"===t?i.dark:i.light})(m8(e),n)),title:m8(e),children:m8(e)})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-semibold truncate max-w-[60px]","dark"===n?"bg-indigo-900 text-indigo-200":"bg-indigo-100 text-indigo-800"),children:e.asesor?.numeroEquipo||"-"})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3 text-center","dark"===n?"text-gray-400":"text-gray-600"),children:e.auditor?.nombre||"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3 text-center","dark"===n?"text-gray-400":"text-gray-600"),children:e.administrador?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:e.isRecuperada?(0,ep.jsx)("span",{className:"inline-flex items-center justify-center px-2 py-1 rounded text-[10px] font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"S"}):(0,ep.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1 transition-opacity",children:[!eB&&(0,ep.jsx)("button",{onClick:()=>{et(e),ea(!0)},className:"p-1 hover:bg-blue-100 text-blue-600 rounded dark:hover:bg-blue-900/30 dark:text-blue-400",title:e$||eV?"Ver detalles":"Editar",children:e$||eV?(0,ep.jsx)(ez.Eye,{className:"w-3 h-3"}):(0,ep.jsx)(e1,{className:"w-3 h-3"})}),(eL||eF)&&!e$&&!eH&&(0,ep.jsx)("button",{onClick:()=>eY(e._id),className:"p-1 hover:bg-red-100 text-red-600 rounded dark:hover:bg-red-900/30 dark:text-red-400",title:"Eliminar",children:(0,ep.jsx)(eU.Trash2,{className:"w-3 h-3"})})]})})]},e._id)})})]})})}),ee&&er&&(0,ov.createPortal)((0,ep.jsx)(m1,{isOpen:er,onClose:()=>{ea(!1),et(null)},audit:ee,onSave:e=>{o(t=>t.map(t=>t._id===e._id?e:t)),ea(!1),et(null)}}),document.body),en&&(0,ep.jsx)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-20 p-4 bg-black/50 backdrop-blur-sm",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] overflow-hidden flex flex-col","dark"===n?"bg-gray-900 border border-white/10":"bg-white"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-4 border-b","dark"===n?"border-gray-700 bg-purple-900/20":"border-gray-200 bg-gradient-to-r from-purple-50 to-blue-50"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:"bg-purple-600 p-2 rounded-lg",children:(0,ep.jsx)(eS,{className:"w-6 h-6 text-white"})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-xl font-semibold","dark"===n?"text-white":"text-gray-800"),children:"Turnos Disponibles"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===n?"text-gray-400":"text-gray-500"),children:"Consulta la disponibilidad de turnos por fecha"})]})]}),(0,ep.jsx)("button",{className:(0,eg.cn)("p-2 rounded-lg transition","dark"===n?"hover:bg-gray-800":"hover:bg-gray-100"),onClick:()=>es(!1),children:(0,ep.jsx)(eT.X,{className:(0,eg.cn)("w-6 h-6","dark"===n?"text-gray-400":"text-gray-600")})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 border-b","dark"===n?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-2","dark"===n?"text-gray-300":"text-gray-700"),children:"Seleccionar fecha:"}),(0,ep.jsx)("input",{type:"date",value:ed,onChange:e=>{var t;eu(t=e.target.value),eQ(t)},className:(0,eg.cn)("p-2 border rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent","dark"===n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 border-b","dark"===n?"bg-blue-900/20 border-gray-700":"bg-blue-50 border-gray-200"),children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs font-semibold mb-2","dark"===n?"text-gray-300":"text-gray-700"),children:"Leyenda de disponibilidad:"}),(0,ep.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:"w-4 h-4 rounded bg-green-100 border border-green-300"}),(0,ep.jsx)("span",{className:"dark"===n?"text-gray-300":"",children:"5-10 cupos disponibles"})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:"w-4 h-4 rounded bg-yellow-100 border border-yellow-300"}),(0,ep.jsx)("span",{className:"dark"===n?"text-gray-300":"",children:"3-4 cupos disponibles"})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:"w-4 h-4 rounded bg-orange-100 border border-orange-300"}),(0,ep.jsx)("span",{className:"dark"===n?"text-gray-300":"",children:"1-2 cupos disponibles"})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("div",{className:"w-4 h-4 rounded bg-red-100 border border-red-300"}),(0,ep.jsx)("span",{className:"dark"===n?"text-gray-300":"",children:"Turno completo"})]})]})]}),(0,ep.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:el?(0,ep.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-12 h-12 animate-spin text-purple-600"}),(0,ep.jsx)("span",{className:(0,eg.cn)("ml-3","dark"===n?"text-gray-400":"text-gray-600"),children:"Cargando turnos..."})]}):0===ei.length?(0,ep.jsx)("div",{className:(0,eg.cn)("text-center py-12","dark"===n?"text-gray-400":"text-gray-500"),children:(0,ep.jsx)("p",{children:"No hay turnos disponibles para esta fecha."})}):(0,ep.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:ei.map(e=>{let t,r=10-e.count,a=r<=0;return(0,ep.jsxs)("div",{className:`p-4 rounded-lg border-2 transition-all ${(t=10-e.count)<=0?"bg-red-100 text-red-800 border-red-300":t>=1&&t<=2?"bg-orange-100 text-orange-800 border-orange-300":t>=3&&t<=4?"bg-yellow-100 text-yellow-800 border-yellow-300":"bg-green-100 text-green-800 border-green-300"} ${a?"opacity-60":"hover:shadow-md"}`,children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ep.jsx)("span",{className:"text-lg font-bold",children:e.time}),a&&(0,ep.jsx)(eT.X,{className:"w-5 h-5"})]}),(0,ep.jsxs)("div",{className:"text-xs space-y-1",children:[(0,ep.jsxs)("div",{className:"flex justify-between",children:[(0,ep.jsx)("span",{className:"text-gray-600",children:"Pactadas:"}),(0,ep.jsxs)("span",{className:"font-semibold",children:[e.count,"/10"]})]}),(0,ep.jsxs)("div",{className:"flex justify-between",children:[(0,ep.jsx)("span",{className:"text-gray-600",children:"Disponibles:"}),(0,ep.jsx)("span",{className:"font-bold",children:Math.max(0,r)})]})]}),a&&(0,ep.jsx)("div",{className:"mt-2 text-xs font-semibold text-center",children:"COMPLETO"})]},e.time)})})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 border-t flex justify-between items-center","dark"===n?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-50"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("text-sm","dark"===n?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)("span",{className:"font-semibold",children:"Total de turnos:"})," ",ei.length,(0,ep.jsx)("span",{className:"ml-4 font-semibold",children:"Auditoras pactadas:"})," ",ei.reduce((e,t)=>e+t.count,0)]}),(0,ep.jsx)("button",{className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 transition",onClick:()=>es(!1),children:"Cerrar"})]})]})}),eh&&(0,ep.jsx)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-20 p-4 bg-black/50 backdrop-blur-sm",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] overflow-hidden flex flex-col","dark"===n?"bg-gray-900 border border-white/10":"bg-white"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-5 border-b","dark"===n?"border-gray-700 bg-indigo-900/20":"border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:"bg-indigo-600 p-2 rounded-lg",children:(0,ep.jsx)(oa.BarChart3,{className:"w-6 h-6 text-white"})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-xl font-semibold","dark"===n?"text-white":"text-gray-800"),children:"Estadsticas de Contactacin"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===n?"text-gray-400":"text-gray-500"),children:"Afiliados contactados por obra social anterior"})]})]}),(0,ep.jsx)("button",{className:(0,eg.cn)("p-2 rounded-lg transition","dark"===n?"hover:bg-gray-800":"hover:bg-gray-100"),onClick:()=>ef(!1),children:(0,ep.jsx)(eT.X,{className:(0,eg.cn)("w-6 h-6","dark"===n?"text-gray-400":"text-gray-600")})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-5 border-b","dark"===n?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-2","dark"===n?"text-gray-300":"text-gray-700"),children:"Seleccionar fecha:"}),(0,ep.jsx)("input",{type:"date",value:ek,onChange:e=>{var t;ej(t=e.target.value),eJ(t)},className:(0,eg.cn)("p-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent","dark"===n?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),(0,ep.jsx)("div",{className:"flex-1 overflow-y-auto p-5",children:ev?(0,ep.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-12 h-12 animate-spin text-indigo-600"}),(0,ep.jsx)("span",{className:(0,eg.cn)("ml-3","dark"===n?"text-gray-400":"text-gray-600"),children:"Cargando estadsticas..."})]}):0===eb.length?(0,ep.jsx)("div",{className:(0,eg.cn)("text-center py-12","dark"===n?"text-gray-400":"text-gray-500"),children:(0,ep.jsx)("p",{className:"font-medium",children:"No hay contactaciones registradas para esta fecha."})}):(0,ep.jsx)("div",{className:"space-y-3",children:eb.map((e,t)=>{let r=eb.reduce((e,t)=>e+t.count,0),a=(e.count/r*100).toFixed(1),s=["#4F46E5","#7C3AED","#2563EB","#6B7280"];return(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-lg p-4 border-l-4 hover:shadow-md transition","dark"===n?"bg-gradient-to-r from-gray-800 to-gray-700":"bg-gradient-to-r from-white to-gray-50"),style:{borderLeftColor:s[t%s.length]},children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("flex items-center justify-center w-8 h-8 rounded-full font-bold text-sm","dark"===n?"bg-indigo-900 text-indigo-300":"bg-indigo-100 text-indigo-700"),children:t+1}),(0,ep.jsx)("div",{children:(0,ep.jsx)("span",{className:`font-semibold text-base ${m6(e.obraSocial,n)} px-3 py-1 rounded-full inline-block`,children:e.obraSocial})})]}),(0,ep.jsxs)("div",{className:"text-right",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("text-2xl font-bold","dark"===n?"text-indigo-400":"text-indigo-600"),children:e.count}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-xs","dark"===n?"text-gray-400":"text-gray-500"),children:"contactaciones"})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("w-full rounded-full h-2 mt-2","dark"===n?"bg-gray-600":"bg-gray-200"),children:(0,ep.jsx)("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:{width:`${a}%`}})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("text-xs mt-1 text-right","dark"===n?"text-gray-400":"text-gray-600"),children:[a,"% del total"]})]},e.obraSocial)})})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-5 border-t flex justify-between items-center","dark"===n?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-50"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("text-sm","dark"===n?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)("span",{className:"font-semibold",children:"Total contactaciones:"})," ",eb.reduce((e,t)=>e+t.count,0),(0,ep.jsx)("span",{className:"ml-4 font-semibold",children:"Obras sociales:"})," ",eb.length]}),(0,ep.jsx)("button",{className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition",onClick:()=>ef(!1),children:"Cerrar"})]})]})})]})}let m9=["OSDE","OSDEPYM","IOMA","OSSEG","OSDE 210","OSFATUN","OSDE GBA","OSECAC (126205)","OSPRERA","OMINT","OSSEGUR","OSPR","OSUTHGRA (108803)","OSBLYCA","UOM","OSPM","OSPECON (105408)","Elevar (114307)","OSCHOCA (105804)","OSPEP (113908)","OSPROTURA","OSPSIP (119708)","OSEIV (122401)","OSPIF (108100)","OSIPA (114208)","OSPESESGYPE (107206)","OSTCARA (126007)","OSPIT (121002)","OSMP (111209)","OSPECA (103709)","OSPIQYP (118705)","OSBLYCA (102904)","VIASANO (2501)","OSPCYD (103402)","OSUOMRA (112103)","OSAMOC (3405)","OSPAGA (101000)","OSPF (107404)","OSPIP (116006)","OSPIC","OSG (109202)","OSPERYH (106500)","OSPCRA (104009)","OSPMA (700108)","HOMINIS (901501)","OSCTCP (121606)","OSMA (112509)"],ge=["Binimed","Meplife","TURF"],gt=["alta","cambio"];function gr(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),r=(0,em.useRef)(null),a=t?.role?.toLowerCase()||"",n="supervisor"===a,s="recuperador"===a,i="encargado"===a,o="independiente"===a,l="auditor"===a&&!!t?.numeroEquipo,c="asesor"===a||l||s||o,d="gerencia"===a||"auditor"===a&&!t?.numeroEquipo,u=i&&!!t?.numeroEquipo,h=n||u,[f,p]=(0,em.useState)({nombre:"",cuil:"",telefono:"",tipoVenta:"alta",obraSocialAnterior:"",obraSocialVendida:"Binimed",fecha:"",hora:"",supervisor:"",asesor:"",validador:"",datosExtra:""}),[m,g]=(0,em.useState)([]),[x,b]=(0,em.useState)([]),[y,v]=(0,em.useState)([]),[w,k]=(0,em.useState)([]),[j,N]=(0,em.useState)(!1),[S,E]=(0,em.useState)(!1),[C,T]=(0,em.useState)(""),[A,_]=(0,em.useState)(!1),[O,P]=(0,em.useState)(!1),[D,R]=(0,em.useState)(!1),[M,I]=(0,em.useState)(!1),[L,F]=(0,em.useState)({current:0,total:0}),[B,U]=(0,em.useState)([]),[z,V]=(0,em.useState)(null);(0,em.useEffect)(()=>{(d||n||s||i)&&W()},[d,n,s,i]),(0,em.useEffect)(()=>{(n||i)&&A?(t?._id&&(p(e=>({...e,asesor:t._id})),console.log("Supervisor Venta Propia: Asesor autoasignado:",t.nombre)),z&&(p(e=>({...e,supervisor:z._id})),console.log("Supervisor Venta Propia: Supervisor asignado - Eliana Suarez"))):(n||i)&&!A&&p(e=>({...e,asesor:"",supervisor:""}))},[A,n,i,t,z]),(0,em.useEffect)(()=>{o&&(t?._id&&(p(e=>({...e,asesor:t._id})),console.log("Independiente: Asesor autoasignado:",t.nombre)),H())},[o,t]);let H=async()=>{try{let e=(await e_.api.users.list()).data.find(e=>e.role?.toLowerCase()==="gerencia"&&e.nombre?.toLowerCase().includes("eliana")&&(e.nombre?.toLowerCase().includes("suarez")||e.nombre?.toLowerCase().includes("surez")));e?(V(e),p(t=>({...t,supervisor:e._id})),console.log("Independiente: Supervisor asignado - Eliana Suarez")):eO.toast.error("No se pudo encontrar a Eliana Suarez (Gerencia) en el sistema")}catch(e){console.error("Error cargando Eliana Suarez para Independiente:",e),eO.toast.error("Error al cargar supervisor automtico")}};(0,em.useEffect)(()=>{d&&f.supervisor?G(f.supervisor):n&&(S&&C?G(C):q())},[f.supervisor,n,d,S,C]),(0,em.useEffect)(()=>{console.log("Validadores useEffect triggered:",{otroEquipo:j,asesor:f.asesor,user:t?.nombre,numeroEquipo:t?.numeroEquipo,isSupervisor:n,isAsesor:c,isRecuperador:s,isGerenciaOrAuditorSinEquipo:d,perteneceOtroSupervisor:S,supervisorSeleccionado:C}),j?Q():n&&S&&C?X(C):s&&z?X(z._id):Y()},[j,f.asesor,f.supervisor,t,n,c,s,d,S,C,x,z]),(0,em.useEffect)(()=>{if(s&&y.length>0&&!f.validador){let e=y.find(e=>e.nombre?.toLowerCase().includes("eliana")&&e.nombre?.toLowerCase().includes("suarez"));e?(p(t=>({...t,validador:e._id})),console.log("Recuperador: Validador preseleccionado - Eliana Suarez")):t?._id&&y.find(e=>e._id===t._id)&&(p(e=>({...e,validador:t._id})),console.log("Recuperador: Validador preseleccionado - Usuario de sesin"))}},[s,y,t]),(0,em.useEffect)(()=>{f.fecha&&J(f.fecha)},[f.fecha]),(0,em.useEffect)(()=>{let e=sessionStorage.getItem("prefillAudit");if(e)try{let t=JSON.parse(e);p(e=>({...e,nombre:t.nombre||"",cuil:t.cuil||"",telefono:t.telefono||"",obraSocialAnterior:t.obraSocialAnterior||"",datosExtra:t.localidad?`Localidad: ${t.localidad}`:""})),sessionStorage.removeItem("prefillAudit"),eO.toast.info("Datos precargados desde Lead Management")}catch(e){console.error("Error parsing prefill data",e)}},[]);let W=async()=>{try{let{data:e}=await e_.api.users.list("includeAllAuditors=true"),t=Array.isArray(e)?e:[],r=t.filter(e=>(e.role?.toLowerCase()==="supervisor"||e.role?.toLowerCase()==="encargado")&&!1!==e.active);console.log("loadSupervisores:",r.length,"supervisores encontrados"),b(r);let a=t.find(e=>(e.role?.toLowerCase()==="supervisor"||e.role?.toLowerCase()==="gerencia")&&!1!==e.active&&e.nombre?.toLowerCase().includes("eliana")&&e.nombre?.toLowerCase().includes("suarez"));a?(V(a),console.log("Eliana Suarez encontrada:",a.nombre),s&&(p(e=>({...e,supervisor:a._id})),console.log("Recuperador: Supervisor preseleccionado - Eliana Suarez"))):console.warn("No se encontr a Eliana Suarez en la lista de supervisores")}catch(e){console.error(e)}},q=async()=>{try{let{data:e}=await e_.api.users.list("scope=group"),r=Array.isArray(e)?e:[],a=t?.numeroEquipo,n=r.filter(e=>{let t=!1!==e.active,r=e.nombre&&e.nombre.trim().length>0,n=["asesor","auditor","supervisor","encargado"].includes(e.role?.toLowerCase()),s=!h||!a||String(e.numeroEquipo)===String(a);return t&&r&&n&&s}).sort((e,t)=>e.nombre.localeCompare(t.nombre));h&&t&&(n.some(e=>e._id===t._id)||n.unshift({_id:t._id,nombre:t.nombre||t.email,role:t.role,numeroEquipo:t.numeroEquipo})),g(n)}catch(e){console.error(e),eO.toast.error("Error al cargar asesores")}},G=async e=>{try{let{data:t}=await e_.api.users.list("includeAllAuditors=true"),r=Array.isArray(t)?t:[];console.log("loadAsesoresByEquipo:",{supervisorId:e,totalUsers:r.length});let a=r.find(t=>t._id===e);if(!a?.numeroEquipo)return void g([]);let n=r.filter(e=>{let t=!1!==e.active,r=e.nombre&&e.nombre.trim().length>0,n=["asesor","auditor","supervisor"].includes(e.role?.toLowerCase()),s=String(e.numeroEquipo)===String(a.numeroEquipo);return t&&r&&n&&s}).sort((e,t)=>e.nombre.localeCompare(t.nombre));g(n),K(a.numeroEquipo,r)}catch(e){console.error(e),eO.toast.error("Error al cargar asesores del equipo")}},K=(e,t)=>{v(t.filter(t=>{let r=!1!==t.active,a=t.nombre&&t.nombre.trim().length>0,n=String(t.numeroEquipo)===String(e);return r&&a&&n}).sort((e,t)=>e.nombre.localeCompare(t.nombre)))},X=async e=>{try{let{data:r}=await e_.api.users.list("includeAllAuditors=true"),a=Array.isArray(r)?r:[];console.log("loadValidadoresPorSupervisor:",{supervisorId:e,totalUsers:a.length});let n=a.find(t=>t._id===e);if(!n?.numeroEquipo)return void v([]);let i=a.filter(e=>{let t=!1!==e.active,r=e.nombre&&e.nombre.trim().length>0,a=String(e.numeroEquipo)===String(n.numeroEquipo),s=!f.asesor||e._id!==f.asesor;return t&&r&&a&&s}).sort((e,t)=>e.nombre.localeCompare(t.nombre));s&&t&&!i.some(e=>e._id===t._id)&&(i.push({_id:t._id,nombre:t.nombre||t.email,role:t.role,numeroEquipo:t.numeroEquipo}),console.log("Recuperador: Usuario de sesin agregado a validadores:",t.nombre)),v(i)}catch(e){console.error(e)}},Y=async()=>{try{let e=t?.numeroEquipo;if(d){if(!f.supervisor)return void v([]);let t=x.find(e=>e._id===f.supervisor);t&&(e=t.numeroEquipo)}if(console.log("loadValidadores called",{role:t?.role,userTeam:t?.numeroEquipo,targetTeam:e,supervisor:f.supervisor,isAsesor:c,isSupervisor:n,isGerenciaOrAuditorSinEquipo:d}),!e){console.log("No targetNumeroEquipo, setting validadores to empty"),v([]);return}let{data:r}=await e_.api.users.list("scope=all"),a=Array.isArray(r)?r:[];console.log("API devuelve",a.length,"usuarios"),console.log("Usuarios con numeroEquipo:",a.filter(e=>e.numeroEquipo).map(e=>({nombre:e.nombre,equipo:e.numeroEquipo,role:e.role}))),console.log("Buscando equipo:",e,"tipo:",typeof e);let s=a.filter(r=>{let a=!1!==r.active,n=r.nombre&&r.nombre.trim().length>0,s=r.numeroEquipo?String(r.numeroEquipo):null,i=e?String(e):null,o=c?t?._id:f.asesor,l=!o||r._id!==o;return a&&n&&s===i&&l}).sort((e,t)=>e.nombre.localeCompare(t.nombre));console.log("Filtered validadores:",s.length,"users from team",e),v(s)}catch(e){console.error("Error loading validadores:",e)}},Q=async()=>{try{let{data:e}=await e_.api.users.list("includeAllAuditors=true"),r=Array.isArray(e)?e:[];console.log("loadTodosLosValidadores: API devuelve",r.length,"usuarios");let a=r.filter(e=>{let r=!1!==e.active,a=e.nombre&&e.nombre.trim().length>0,n=["asesor","supervisor","auditor","gerencia"].includes(e.role?.toLowerCase()),s=c?t?._id:f.asesor,i=!s||e._id!==s;return r&&a&&n&&i}).sort((e,t)=>e.nombre.localeCompare(t.nombre));v(a)}catch(e){console.error(e)}},J=async e=>{try{R(!0);let{data:t}=await e_.api.audits.getAvailableSlots(e);k(Array.isArray(t)?t:[])}catch(e){console.error(e),k([])}finally{R(!1)}},Z=(0,em.useMemo)(()=>{let e=(()=>{let e=[],t=new Date;t.setHours(9,20,0,0);let r=new Date;r.setHours(23,0,0,0);let a=new Date(t);for(;a<=r;){let t=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0");e.push(`${t}:${r}`),a.setMinutes(a.getMinutes()+20)}return e})(),t={};return Array.isArray(w)&&w.forEach(e=>{t[e.time]=e.count}),e.map(e=>({time:e,disabled:(t[e]||0)>=10}))},[w]),ee=(e,t)=>{p(r=>({...r,[e]:t}))},et=async e=>{e.preventDefault();let r=f.nombre.trim()?/^\d{11}$/.test(f.cuil)?f.telefono&&!/^\d{10}$/.test(f.telefono.replace(/\D/g,""))?"Telfono debe tener 10 dgitos":f.fecha?f.hora?c||(n||i)&&A||f.asesor?f.validador?d&&!f.supervisor?"Supervisor es requerido":(n||i)&&A&&!z?"No se encontr a Eliana Suarez para asignar como supervisor":null:"Validador es requerido":"Asesor es requerido":"Hora es requerida":"Fecha es requerida":"CUIL debe tener exactamente 11 dgitos":"Nombre es requerido";if(r)return void eO.toast.error(r);try{P(!0);let e=new Date(`${f.fecha}T${f.hora}:00`),r=c||(n||i)&&A?t?._id:f.asesor,a={nombre:f.nombre,cuil:f.cuil,telefono:f.telefono,tipoVenta:f.tipoVenta,obraSocialAnterior:f.obraSocialAnterior,obraSocialVendida:f.obraSocialVendida,scheduledAt:e.toISOString(),asesor:r,validador:f.validador,datosExtra:f.datosExtra,status:"Pendiente"};(s||(n||i)&&A)&&z?(a.supervisor=z._id,a.isReferido=!0,console.log("Supervisor asignado (Eliana Suarez):",z.nombre,z._id,"isReferido: true")):f.supervisor&&(a.supervisor=f.supervisor),await e_.api.audits.create(a),eO.toast.success("Auditora creada exitosamente"),p({nombre:"",cuil:"",telefono:"",tipoVenta:"alta",obraSocialAnterior:"",obraSocialVendida:"Binimed",fecha:"",hora:"",supervisor:"",asesor:"",validador:"",datosExtra:""}),(n||i)&&_(!1)}catch(t){console.error("Full error:",t),console.error("Error response:",t.response),console.error("Error response data:",JSON.stringify(t.response?.data,null,2)),console.error("Error status:",t.response?.status),t.response?.data?.error&&(console.error("Error details:",JSON.stringify(t.response.data.error,null,2)),console.error("Error code:",t.response.data.error.code),console.error("Error message:",t.response.data.error.message),console.error("Error traceId:",t.response.data.error.traceId),console.error("Error details array:",t.response.data.error.details));let e="Error al crear auditora";t.response?.data?.error?"string"==typeof t.response.data.error?e=t.response.data.error:"object"==typeof t.response.data.error&&t.response.data.error.message&&(e=t.response.data.error.message):t.response?.data?.message?e=t.response.data.message:t.message&&(e=t.message),eO.toast.error(e)}finally{P(!1)}},er=async e=>{let t=e.target.files?.[0];if(t)try{I(!0),F({current:0,total:0}),U([]);let{accepted:e,rejected:r}=(await e_.api.audits.bulkUpload(t)).data;eO.toast.success(`${e} auditor\xedas creadas exitosamente`),r&&r.length>0&&(U(r),eO.toast.warning(`${r.length} filas rechazadas`))}catch(e){console.error(e),eO.toast.error(e.response?.data?.message||"Error en carga masiva")}finally{I(!1),r.current&&(r.current.value="")}};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Pautar Auditora / Venta"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Crear nuevo turno de auditora"})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsx)("input",{ref:r,type:"file",accept:".xlsx,.xls,.csv",onChange:er,className:"hidden"}),(0,ep.jsxs)("button",{onClick:()=>r.current?.click(),disabled:M,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",M?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-green-500 text-white hover:bg-green-600"),children:[M?(0,ep.jsx)(e2.Loader2,{className:"w-4 h-4 animate-spin"}):(0,ep.jsx)(eI.Upload,{className:"w-4 h-4"}),"Carga Masiva"]})]})]}),B.length>0&&(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-4","dark"===e?"bg-red-500/10 border-red-500/20":"bg-red-50 border-red-200"),children:(0,ep.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ep.jsx)(eZ,{className:"w-5 h-5 text-red-500 mt-0.5"}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold text-sm mb-2","dark"===e?"text-red-400":"text-red-700"),children:["Filas rechazadas (",B.length,")"]}),(0,ep.jsxs)("div",{className:"space-y-1 text-xs",children:[B.slice(0,5).map((t,r)=>(0,ep.jsxs)("div",{className:"dark"===e?"text-red-300":"text-red-600",children:["Fila ",t.row,": ",t.reason]},r)),B.length>5&&(0,ep.jsxs)("div",{className:"text-gray-500",children:["... y ",B.length-5," ms"]})]}),(0,ep.jsx)("button",{onClick:()=>U([]),className:"mt-2 text-xs underline hover:no-underline",children:"Cerrar"})]})]})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm max-w-2xl mx-auto","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,ep.jsxs)("form",{onSubmit:et,className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Nombre de afiliado ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsx)("input",{type:"text",value:f.nombre,onChange:e=>ee("nombre",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),required:!0})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["CUIL ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsx)("input",{type:"text",placeholder:"11 dgitos",value:f.cuil,onChange:e=>ee("cuil",e.target.value.replace(/\D/g,"")),maxLength:11,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),required:!0})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Telfono"}),(0,ep.jsx)("input",{type:"tel",value:f.telefono,onChange:e=>ee("telefono",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Tipo de venta"}),(0,ep.jsx)("select",{value:f.tipoVenta,onChange:e=>ee("tipoVenta",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:gt.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Obra social vendida"}),(0,ep.jsx)("select",{value:f.obraSocialVendida,onChange:e=>ee("obraSocialVendida",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:ge.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Obra social anterior"}),(0,ep.jsxs)("select",{value:f.obraSocialAnterior,onChange:e=>ee("obraSocialAnterior",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar --"}),m9.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Fecha (da) ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsx)("input",{type:"date",value:f.fecha,onChange:e=>ee("fecha",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Hora (turno) ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsxs)("select",{value:f.hora,onChange:e=>ee("hora",e.target.value),disabled:D,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar --"}),Z.map(({time:e,disabled:t})=>(0,ep.jsxs)("option",{value:e,disabled:t,children:[e," ",t?"(lleno)":""]},e))]})]})]}),n&&(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border","dark"===e?"bg-purple-500/10 border-purple-500/30":"bg-purple-50 border-purple-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("input",{type:"checkbox",id:"perteneceOtroSupervisor",checked:S,onChange:e=>{E(e.target.checked),e.target.checked||(T(""),p(e=>({...e,asesor:"",validador:""})))},className:"w-4 h-4 rounded"}),(0,ep.jsx)("label",{htmlFor:"perteneceOtroSupervisor",className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-purple-400":"text-purple-700"),children:"Pertenece a otro supervisor"})]}),S&&(0,ep.jsxs)("div",{className:"mt-3",children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Seleccionar supervisor"}),(0,ep.jsxs)("select",{value:C,onChange:e=>{T(e.target.value),p(e=>({...e,asesor:"",validador:""}))},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar --"}),x.filter(e=>e._id!==t?._id).map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]})]}),d&&(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Supervisor ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsxs)("select",{value:f.supervisor,onChange:e=>ee("supervisor",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar supervisor --"}),x.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),s&&(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border","dark"===e?"bg-purple-500/10 border-purple-500/30":"bg-purple-50 border-purple-200"),children:[(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-purple-400":"text-purple-700"),children:[" ",(0,ep.jsx)("strong",{children:"Supervisor:"})," ",z?.nombre||"Eliana Suarez (cargando...)"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-purple-400/70":"text-purple-600"),children:"La venta se asignar automticamente al equipo de Eliana Suarez"})]}),!c&&(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Asesor ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsxs)("select",{value:f.asesor,onChange:e=>ee("asesor",e.target.value),disabled:(n||i)&&A,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800",(n||i)&&A&&"opacity-60 cursor-not-allowed"),required:!0,children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar asesor --"}),m.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]}),d&&!f.supervisor&&(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-cyan-400":"text-cyan-600"),children:"Primero selecciona un supervisor"})]}),(n||i)&&!S&&(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border",A?"dark"===e?"bg-green-500/10 border-green-500/30":"bg-green-50 border-green-200":"dark"===e?"bg-gray-500/10 border-gray-500/30":"bg-gray-50 border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("input",{type:"checkbox",id:"ventaPropia",checked:A,onChange:e=>{_(e.target.checked),e.target.checked||p(e=>({...e,asesor:"",supervisor:""}))},className:"w-4 h-4 rounded"}),(0,ep.jsx)("label",{htmlFor:"ventaPropia",className:(0,eg.cn)("text-sm font-medium",A?"dark"===e?"text-green-400":"text-green-700":"dark"===e?"text-gray-400":"text-gray-700"),children:"Venta propia"})]}),A&&(0,ep.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-green-400/80":"text-green-600"),children:[" ",(0,ep.jsx)("strong",{children:"Asesor:"})," ",t?.nombre||"Tu usuario"]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-green-400/80":"text-green-600"),children:[" ",(0,ep.jsx)("strong",{children:"Supervisor:"})," ",z?.nombre||"Eliana Suarez (cargando...)"]})]})]}),c&&(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border","dark"===e?"bg-cyan-500/10 border-cyan-500/30":"bg-cyan-50 border-cyan-200"),children:[(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-cyan-400":"text-cyan-700"),children:[" ",(0,ep.jsx)("strong",{children:"Asesor:"})," ",t?.nombre||"Tu usuario"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-cyan-400/70":"text-cyan-600"),children:"La venta se registrar automticamente a tu nombre"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Validador ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsxs)("select",{value:f.validador,onChange:e=>ee("validador",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,ep.jsx)("option",{value:"",children:"-- Seleccionar validador --"}),y.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,ep.jsx)("input",{type:"checkbox",id:"otroEquipo",checked:j,onChange:e=>N(e.target.checked),className:"w-4 h-4 rounded"}),(0,ep.jsx)("label",{htmlFor:"otroEquipo",className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:"Pertenece a otro equipo"})]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","text-gray-500"),children:"Selecciona un compaero de tu equipo que validar la venta"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Datos extra (opcional)"}),(0,ep.jsx)("textarea",{placeholder:"Ejemplo: Afiliado con familiares, enfermedad preexistente, observaciones...",value:f.datosExtra,onChange:e=>ee("datosExtra",e.target.value),rows:3,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,ep.jsxs)("button",{type:"submit",disabled:O,className:(0,eg.cn)("w-full px-6 py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",O?"opacity-50 cursor-not-allowed":"","bg-gradient-to-r from-cyan-500 to-teal-500 text-white hover:from-cyan-600 hover:to-teal-600"),children:[O?(0,ep.jsx)(e2.Loader2,{className:"w-4 h-4 animate-spin"}):(0,ep.jsx)(ev.Send,{className:"w-4 h-4"}),O?"Creando...":"Crear Auditora"]})]})})]})}let ga=["Binimed","Meplife","TURF"],gn=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-",gs=e=>{if(!e)return"-";let t=e.split("T")[0];if(!t)return"-";let[r,a,n]=t.split("-");return r&&a&&n?`${n}/${a}/${r}`:"-"};function gi(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),r=t?.role?.toLowerCase()==="gerencia",a=t?.role?.toLowerCase()==="asesor",n=t?.role?.toLowerCase()==="recuperador";t?.role?.toLowerCase();let[s,i]=(0,em.useState)([]),[o,l]=(0,em.useState)(!0),[c,d]=(0,em.useState)(1),[u,h]=(0,em.useState)(!1),[f,p]=(0,em.useState)(!1),[m,g]=(0,em.useState)(""),[x,b]=(0,em.useState)(""),[y,v]=(0,em.useState)(!0),[w,k]=(0,em.useState)({afiliado:"",cuil:"",auditor:"",administrador:"",obraSocialVendida:"",estado:"",dateFrom:"",dateTo:"",dateField:"fechaCreacionQR"}),[j,N]=(0,em.useState)([]),[S,E]=(0,em.useState)([]),[C,T]=(0,em.useState)("fecha"),[A,_]=(0,em.useState)([]),[O,P]=(0,em.useState)([]),[D,R]=(0,em.useState)([]),[M,I]=(0,em.useState)([]),[L,F]=(0,em.useState)(!1),[B,U]=(0,em.useState)(!1),z=(0,em.useMemo)(()=>{if(0===j.length)return A;let e=new Set;return(j.forEach(t=>{let r=O.find(e=>e.nombre===t);r?.numeroEquipo&&e.add(r.numeroEquipo)}),0===e.size)?A:A.filter(t=>t.numeroEquipo&&e.has(t.numeroEquipo))},[A,j,O]),V=async(e=!1)=>{try{l(!0);let r=e?{...w,dateField:"fechaCreacionQR"}:{};a&&t?._id&&(r.asesor=t._id);let{data:n}=await e_.api.liquidation.list(r);i(Array.isArray(n)?n:[])}catch(e){console.error(e),eO.toast.error("Error al cargar datos")}finally{l(!1)}},H=async()=>{try{let{data:e}=await e_.api.users.list(),t=Array.isArray(e)?e:[];_(t.filter(e=>e.role?.toLowerCase()==="asesor"&&!1!==e.active)),P(t.filter(e=>(e.role?.toLowerCase()==="supervisor"||e.role?.toLowerCase()==="encargado")&&!1!==e.active)),R(t.filter(e=>e.role?.toLowerCase()==="auditor"&&!1!==e.active)),I(t.filter(e=>e.role?.toLowerCase()==="administrativo"&&!1!==e.active))}catch(e){console.error(e)}};(0,em.useEffect)(()=>{V(),H();let e=(0,iQ.connectSocket)();e.emit("audits:subscribeAll"),console.log("[Liquidacin] Subscribed to audits_all room");let t=e=>{console.log("[Socket] New audit received:",e._id),i(t=>{if(t.some(t=>t._id===e._id))return t;let r=[e,...t];return["Cargada","Aprobada","QR hecho"].includes(e.status)&&eO.toast.info(`Nueva venta en liquidaci\xf3n: ${e.nombre}`,{duration:3e3}),r})},r=e=>{console.log("[Socket] Audit update received:",e._id),i(t=>{let r=t.findIndex(t=>t._id===e._id);if(-1===r)return[e,...t];let a=[...t];return a[r]={...t[r],...e},a})},a=e=>{console.log("[Socket] Audit deleted:",e._id),i(t=>t.filter(t=>t._id!==e._id))};return e.on("audits:new",t),e.on("audit:update",r),e.on("audit:deleted",a),()=>{e.off("audits:new",t),e.off("audit:update",r),e.off("audit:deleted",a),e.emit("audits:unsubscribeAll"),console.log("[Liquidacin] Unsubscribed from audits_all room")}},[]);let W=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,q=e=>{if(!e)return new Date;let[t,r,a]=e.split("T")[0].split("-").map(Number);return new Date(t,r-1,a,12,0,0)},G=(0,em.useMemo)(()=>{let e={};return s.forEach(t=>{let r,a,n,s,i,o;if(!["Cargada","Aprobada","QR hecho"].includes(t.status))return;let l=W((a=(r=new Date(q("QR hecho"===t.status&&t.fechaCreacionQR||t.scheduledAt||t.createdAt))).getDay(),n=r.getHours(),s=r.getMinutes(),4===a&&(n>23||23===n&&s>=1)&&(r.setDate(r.getDate()+1),r.setHours(0,0,0,0)),i=r.getDay(),o=0,o=5===i?0:6===i?1:i+2,r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r));e[l]||(e[l]=[]),e[l].push(t)}),Object.entries(e).sort((e,t)=>new Date(t[0]).getTime()-new Date(e[0]).getTime()).map(([e,t])=>({start:e,items:t}))},[s]),K=(0,em.useMemo)(()=>{let e=s.filter(e=>["Cargada","Aprobada","QR hecho"].includes(e.status));return(e=w.dateFrom||w.dateTo?e.filter(e=>{let t=W(q("QR hecho"===e.status&&e.fechaCreacionQR||e.scheduledAt));return(!w.dateFrom||!(t<w.dateFrom))&&(!w.dateTo||!(t>w.dateTo))}):G[c-1]?.items||[]).filter(e=>{if(n&&!e.isRecuperada||w.afiliado&&!e.nombre?.toLowerCase().includes(w.afiliado.toLowerCase())||w.cuil&&!e.cuil?.includes(w.cuil))return!1;if(j.length>0){let t=gn(e);if(!j.includes(t))return!1}if(S.length>0){let t=e.asesor?.nombre||"";if(!S.includes(t))return!1}return(!w.auditor||e.auditor?._id===w.auditor)&&(!w.administrador||e.administrador?._id===w.administrador)&&(!w.obraSocialVendida||e.obraSocialVendida===w.obraSocialVendida)&&(!w.estado||e.status===w.estado)}).sort((e,t)=>{if("asesor"===C){let r=(e.asesor?.nombre||"").toLowerCase(),a=(t.asesor?.nombre||"").toLowerCase();return r.localeCompare(a)}if("supervisor"===C){let r=gn(e).toLowerCase(),a=gn(t).toLowerCase();return r.localeCompare(a)}return new Date(t.scheduledAt).getTime()-new Date(e.scheduledAt).getTime()})},[s,G,c,w,j,S,C,n]),X=async()=>{try{console.log(" Exportando liquidacin...",w);let e=await e_.api.liquidation.export(w);console.log(" Respuesta:",e.data instanceof Blob?"Blob vlido":"ERROR: No es Blob");let t=e.data instanceof Blob?e.data:new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.setAttribute("download",`liquidacion_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(r),console.log(" Descarga completada"),eO.toast.success("Archivo exportado correctamente")}catch(e){console.error(" Error al exportar:",e),eO.toast.error("Error al exportar")}},Y=(0,em.useMemo)(()=>{let e=K.filter(e=>"QR hecho"===e.status),t=K.filter(e=>"Cargada"===e.status),r=K.filter(e=>"Aprobada"===e.status),a={};e.forEach(e=>{let t="-"===gn(e)?"Sin supervisor":gn(e);a[t]=(a[t]||0)+1});let n=Object.entries(a).map(([e,t])=>({name:e,count:t})).sort((e,t)=>t.count-e.count);return{qr:e.length,cargada:t.length,aprobada:r.length,total:K.length,supervisorStats:n}},[K]),Q=async()=>{try{p(!0);let e=await e_.api.audits.recalculateSupervisors({dateFrom:m||void 0,dateTo:x||void 0,onlyMissing:y});eO.toast.success(`Recalculaci\xf3n completada: ${e.data.success} exitosos, ${e.data.errors} errores`),h(!1),V()}catch(e){console.error("Error recalculating supervisors:",e),eO.toast.error(e.response?.data?.error||"Error al recalcular supervisores")}finally{p(!1)}};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 shadow-sm","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Liquidacin (QR Hecho)"}),(0,ep.jsx)("p",{className:"text-sm opacity-60",children:"Semana laboral: Viernes a Jueves"})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[r&&(0,ep.jsxs)("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"}),"Recalcular Supervisores"]}),(0,ep.jsxs)("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar Excel"]})]})]}),!w.dateFrom&&!w.dateTo&&G.length>0&&(0,ep.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-white/5 p-3 rounded-xl mb-4",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("span",{className:"text-sm font-medium",children:"Semana:"}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("button",{onClick:()=>d(Math.max(1,c-1)),disabled:1===c,className:"p-1 hover:bg-gray-200 dark:hover:bg-white/10 rounded disabled:opacity-50",children:""}),(0,ep.jsx)("span",{className:"px-3 py-1 bg-purple-600 text-white rounded text-sm font-bold",children:c}),(0,ep.jsx)("button",{onClick:()=>d(Math.min(G.length,c+1)),disabled:c===G.length,className:"p-1 hover:bg-gray-200 dark:hover:bg-white/10 rounded disabled:opacity-50",children:""})]}),(0,ep.jsxs)("span",{className:"text-xs opacity-60",children:["de ",G.length]})]}),(0,ep.jsxs)("div",{className:"flex gap-3 text-xs font-medium",children:[(0,ep.jsxs)("span",{className:"px-2 py-1 bg-green-500/20 text-green-600 rounded",children:["QR: ",Y.qr]}),(0,ep.jsxs)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-600 rounded",children:["Cargada: ",Y.cargada]}),(0,ep.jsxs)("span",{className:"px-2 py-1 bg-teal-500/20 text-teal-600 rounded",children:["Aprobada: ",Y.aprobada]})]})]}),Y.supervisorStats.length>0&&(0,ep.jsx)("div",{className:(0,eg.cn)("p-3 rounded-xl text-xs mb-4","dark"===e?"bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-white/10":"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-100"),children:(0,ep.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["QR Hechos: ",Y.qr]}),(0,ep.jsx)("span",{className:"opacity-50",children:"|"}),Y.supervisorStats.map((t,r)=>(0,ep.jsxs)("span",{className:"dark"===e?"text-gray-300":"text-gray-700",children:[t.name,": ",(0,ep.jsx)("span",{className:"dark"===e?"text-cyan-400":"text-cyan-600",children:t.count}),r<Y.supervisorStats.length-1&&(0,ep.jsx)("span",{className:"ml-2 opacity-50",children:"|"})]},t.name))]})}),(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-gray-300":"text-gray-600"),children:"Ordenar por:"}),(0,ep.jsx)("div",{className:"flex gap-1",children:["fecha","asesor","supervisor"].map(t=>(0,ep.jsx)("button",{onClick:()=>T(t),className:(0,eg.cn)("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",C===t?"bg-purple-600 text-white":"dark"===e?"bg-white/10 text-gray-300 hover:bg-white/20":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"fecha"===t?"Fecha":"asesor"===t?"Asesor":"Supervisor"},t))})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3",children:[(0,ep.jsx)("input",{placeholder:"Buscar afiliado...",value:w.afiliado,onChange:e=>k({...w,afiliado:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,ep.jsx)("input",{placeholder:"Buscar CUIL...",value:w.cuil,onChange:e=>k({...w,cuil:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsxs)("button",{onClick:()=>F(!L),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,ep.jsx)("span",{className:"truncate",children:0===j.length?"Todos los Supervisores":`${j.length} supervisor${j.length>1?"es":""}`}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),L&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>N(O.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800",children:"Todos"}),j.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>N([]),className:"text-xs text-blue-600 hover:text-blue-800",children:"Limpiar"})]}),O.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:j.includes(e.nombre),onChange:()=>{N(t=>t.includes(e.nombre)?t.filter(t=>t!==e.nombre):[...t,e.nombre])},className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),!a&&(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsxs)("button",{onClick:()=>U(!B),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,ep.jsx)("span",{className:"truncate",children:0===S.length?"Todos los Asesores":`${S.length} asesor${S.length>1?"es":""}`}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),B&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>E(z.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800",children:"Todos"}),S.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>E([]),className:"text-xs text-blue-600 hover:text-blue-800",children:"Limpiar"})]}),z.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:S.includes(e.nombre),onChange:()=>{E(t=>t.includes(e.nombre)?t.filter(t=>t!==e.nombre):[...t,e.nombre])},className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3",children:[(0,ep.jsxs)("select",{value:w.auditor,onChange:e=>k({...w,auditor:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los Auditores"}),D.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]}),(0,ep.jsxs)("select",{value:w.administrador,onChange:e=>k({...w,administrador:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los Administrativos"}),M.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]}),(0,ep.jsxs)("select",{value:w.obraSocialVendida,onChange:e=>k({...w,obraSocialVendida:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,ep.jsx)("option",{value:"",children:"Todas las Obras Sociales"}),ga.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]}),(0,ep.jsxs)("select",{value:w.estado,onChange:e=>k({...w,estado:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los Estados"}),(0,ep.jsx)("option",{value:"QR hecho",children:"QR hecho"}),(0,ep.jsx)("option",{value:"Cargada",children:"Cargada"}),(0,ep.jsx)("option",{value:"Aprobada",children:"Aprobada"})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,ep.jsx)("input",{type:"date",placeholder:"Fecha desde",value:w.dateFrom,onChange:e=>k({...w,dateFrom:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,ep.jsx)("input",{type:"date",placeholder:"Fecha hasta",value:w.dateTo,onChange:e=>k({...w,dateTo:e.target.value}),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,ep.jsx)("button",{onClick:()=>V(!0),className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm transition-colors",children:"Buscar"}),(0,ep.jsx)("button",{onClick:()=>{k({afiliado:"",cuil:"",auditor:"",administrador:"",obraSocialVendida:"",estado:"",dateFrom:"",dateTo:"",dateField:"fechaCreacionQR"}),N([]),E([]),T("fecha"),setTimeout(()=>V(!1),0)},className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-white/10 dark:hover:bg-white/20 rounded-lg text-sm transition-colors",children:"Limpiar Filtros"})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border shadow-sm overflow-hidden","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{className:(0,eg.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===e?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,ep.jsxs)("tr",{children:[(0,ep.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"Fecha"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[150px]",children:"Afiliado"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ven"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Supervisor"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Auditor"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Admin"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[60px] text-center",children:"Recup."})]})}),(0,ep.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:o?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:9,className:"px-4 py-8 text-center opacity-50",children:(0,ep.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando..."]})})}):0===K.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:9,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron registros"})}):K.map((t,r)=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-gray-50",r%2==0?"":"dark"===e?"bg-white/[0.02]":"bg-gray-50/50"),children:[(0,ep.jsx)("td",{className:"px-2 py-1.5 whitespace-nowrap opacity-70",children:t.fechaCreacionQR?gs(t.fechaCreacionQR):t.scheduledAt?gs(t.scheduledAt):"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 font-medium truncate max-w-[150px]",title:t.nombre,children:t.nombre}),(0,ep.jsx)("td",{className:"px-2 py-1.5 font-mono opacity-70 truncate",children:t.cuil}),(0,ep.jsx)("td",{className:"px-2 py-1.5",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[80px]",((e,t)=>{if(!e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=e.toLowerCase();return r.includes("meplife")?"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800":r.includes("binimed")?"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800":r.includes("turf")?"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800":"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700"})(t.obraSocialVendida,e)),children:t.obraSocialVendida})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 truncate max-w-[100px]",title:t.asesor?.nombre,children:t.asesor?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[100px]",((e,t)=>{if(!e||"-"===e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=e.toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";if(r.includes("belen")&&r.includes("salaverry"))return"dark"===t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800";if(r.includes("analia")&&r.includes("suarez"))return"dark"===t?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800";if(r.includes("erika")&&r.includes("cardozo"))return"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800";if(r.includes("aryel")&&r.includes("puiggros"))return"dark"===t?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800";if(r.includes("joaquin")&&r.includes("valdez")||r.includes("joquin")&&r.includes("valdez"))return"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800";if(r.includes("luciano")&&r.includes("carugno"))return"dark"===t?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800";if(r.includes("alejandro")&&r.includes("mejail"))return"dark"===t?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800";if(r.includes("gaston")&&r.includes("sarmiento"))return"dark"===t?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-900 text-rose-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-900 text-indigo-200"}],n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);let s=Math.abs(n)%a.length,i=a[s];return"dark"===t?i.dark:i.light})(gn(t),e)),title:gn(t),children:gn(t)})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 truncate max-w-[100px]",title:t.auditor?.nombre,children:t.auditor?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 truncate max-w-[100px]",title:t.administrador?.nombre,children:t.administrador?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:t.isRecuperada?(0,ep.jsx)(mV.CheckCircle2,{className:"w-3 h-3 text-green-500 mx-auto"}):(0,ep.jsx)("span",{className:"text-gray-300 dark:text-gray-700",children:"-"})})]},t._id))})]})})}),u&&(0,ep.jsx)(go,{children:(0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-2xl","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Recalcular Supervisores"}),(0,ep.jsx)("button",{onClick:()=>h(!1),className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsx)("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-600 dark:text-blue-400 text-sm",children:"Esta accin recalcular el supervisor asignado a cada venta basndose en la fecha de la venta y el historial de equipos de los asesores."}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Desde"}),(0,ep.jsx)("input",{type:"date",value:m,onChange:e=>g(e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Hasta"}),(0,ep.jsx)("input",{type:"date",value:x,onChange:e=>b(e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:y,onChange:e=>v(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-600"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Solo ventas sin supervisor asignado (snapshot)"})]})]}),(0,ep.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,ep.jsx)("button",{onClick:()=>h(!1),className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,ep.jsxs)("button",{onClick:Q,disabled:f,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",f?"bg-purple-600/50 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"),children:[f&&(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),f?"Recalculando...":"Confirmar"]})]})]})})})]})}function go({children:t}){let[r,a]=(0,em.useState)(!1);if((0,em.useEffect)(()=>(a(!0),()=>a(!1)),[]),!r)return null;let{createPortal:n}=e.r(56667);return n(t,document.body)}let gl={"falta-clave":{title:"Falta Clave",description:"Ventas con problemas de clave",statusFilters:["Falta clave","Falta clave (por ARCA)","Aprobada, pero no reconoce clave","El afiliado cambi la clave"],defaultSort:"asc"},rechazada:{title:"Rechazada",description:"Ventas con estado 'Rechazada'",statusFilters:["Rechazada"],defaultSort:"desc"},pendiente:{title:"Pendiente",description:"Ventas con estado 'Pendiente' o 'Falta documentacin'",statusFilters:["Pendiente","Falta documentacin"],defaultSort:"desc"},"afip-padron":{title:"AFIP y Padrn",description:"Ventas con estado 'AFIP' o 'Padrn' disponibles para venta",statusFilters:["AFIP","Padrn"],defaultSort:"desc",requireDisponibleParaVenta:!0}},gc=e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`},gd=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-";function gu({type:e}){let{theme:t}=(0,ex.useTheme)(),{user:r}=(0,i4.useAuth)(),a=gl[e],[n,s]=(0,em.useState)([]),[i,o]=(0,em.useState)(!1),[l,c]=(0,em.useState)(a.defaultSort),[d,u]=(0,em.useState)({afiliado:"",cuil:""}),[h,f]=(0,em.useState)(""),[p,m]=(0,em.useState)(""),[g,x]=(0,em.useState)([]),[b,y]=(0,em.useState)([]),[v,w]=(0,em.useState)(!1),[k,j]=(0,em.useState)(!1),[N,S]=(0,em.useState)([]),[E,C]=(0,em.useState)([]),[T,A]=(0,em.useState)(null),[_,O]=(0,em.useState)(!1),P=(0,em.useRef)(null),D=(0,em.useRef)(null),R=r?.role?.toLowerCase(),M="gerencia"===R,I=M||"recuperador"===R||"encargado"===R,L=(0,em.useMemo)(()=>{if(0===g.length)return N;let e=new Set;return(g.forEach(t=>{let r=E.find(e=>e.nombre===t);r?.numeroEquipo&&e.add(r.numeroEquipo)}),0===e.size)?N:N.filter(t=>t.numeroEquipo&&e.has(t.numeroEquipo))},[N,g,E]),F=(e,t)=>{let r=(e||"").trim();r&&t(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])},B=(e,t,r)=>0===e.length?t:1===e.length?e[0]:`${e.length} ${r}`,U=async()=>{try{let e;o(!0);let t=((e={...d}).estado=a.statusFilters.join(","),e.ignoreDate="true",b.length>0&&(e.asesor=b.map(e=>e.trim()).filter(Boolean).join(",")),g.length>0&&(e.supervisor=g.map(e=>e.trim()).filter(Boolean).join(",")),d.cuil&&""!==d.cuil.trim()?(delete e.dateFrom,delete e.dateTo):h&&p?(delete e.ignoreDate,e.dateFrom=h,e.dateTo=p):h?(delete e.ignoreDate,e.dateFrom=h):p&&(delete e.ignoreDate,e.dateTo=p),Object.keys(e).forEach(t=>{(""===e[t]||null===e[t]||void 0===e[t])&&delete e[t]}),e),{data:r}=await e_.api.audits.list(t),n=Array.isArray(r)?r:[];a.requireDisponibleParaVenta&&(n=n.filter(e=>!0===e.disponibleParaVenta)),n.sort((e,t)=>{let r=new Date(e.createdAt).getTime(),a=new Date(t.createdAt).getTime();return"asc"===l?r-a:a-r}),s(n)}catch(e){console.error(e),eO.toast.error("Error al cargar auditoras"),s([])}finally{o(!1)}},z=async()=>{try{let e=await e_.api.users.list("includeAllAuditors=true"),t=Array.isArray(e.data)?e.data:[],r=t.filter(e=>{let t=e?.active!==!1,r="asesor"===e.role||"Asesor"===e.role,a=("auditor"===e.role||"Auditor"===e.role)&&e.numeroEquipo;return t&&(r||a)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));S(r);let a=t.filter(e=>{let t=e?.active!==!1,r=e.role?.toLowerCase();return t&&("supervisor"===r||"gerencia"===r||"encargado"===r)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));C(a)}catch(e){console.error("Error al cargar opciones de filtros:",e)}},V=(e,t)=>{u(r=>({...r,[e]:t}))},H=async e=>{if(!M)return void eO.toast.error("No tienes permisos para eliminar auditoras");if(confirm("Ests seguro de eliminar esta auditora?"))try{await e_.api.audits.delete(e),eO.toast.success("Auditora eliminada"),U()}catch(e){console.error("Error deleting audit:",e),eO.toast.error("Error al eliminar auditora")}};return(0,em.useEffect)(()=>{U(),z();let e=(0,iQ.connectSocket)();e.emit("audits:subscribeAll");let t=e=>{s(t=>{let r=t.findIndex(t=>t._id===e._id);if(-1===r)return t;let a=[...t];return a[r]={...t[r],...e},a})},r=e=>{s(t=>t.filter(t=>t._id!==e._id)),T&&T._id===e._id&&(O(!1),A(null))};return e.on("audit:update",t),e.on("audit:deleted",r),()=>{e.off("audit:update",t),e.off("audit:deleted",r),e.emit("audits:unsubscribeAll")}},[]),(0,em.useEffect)(()=>{U()},[d,g,b,h,p,l]),(0,em.useEffect)(()=>{let e=e=>{P.current&&!P.current.contains(e.target)&&w(!1),D.current&&!D.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm relative z-20","dark"===t?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(ow.Filter,{className:(0,eg.cn)("w-5 h-5","dark"===t?"text-purple-400":"text-purple-500")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("font-semibold","dark"===t?"text-white":"text-gray-800"),children:a.title})]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===t?"text-gray-400":"text-gray-500"),children:a.description})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 mb-3",children:[(0,ep.jsx)("input",{type:"text",placeholder:"Buscar afiliado",value:d.afiliado,onChange:e=>V("afiliado",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===t?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar CUIL",value:d.cuil,onChange:e=>V("cuil",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===t?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsx)("input",{type:"date",value:h,onChange:e=>f(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),placeholder:"Desde"}),(0,ep.jsx)("input",{type:"date",value:p,onChange:e=>m(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),placeholder:"Hasta"}),(0,ep.jsxs)("div",{className:"relative",ref:P,children:[(0,ep.jsxs)("button",{onClick:()=>w(!v),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:B(g,"Supervisor","supervisores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),v&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>x(E.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Seleccionar todos"}),g.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>x([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Limpiar"})]}),E.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:g.includes(e.nombre),onChange:()=>F(e.nombre,x),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,ep.jsxs)("div",{className:"relative",ref:D,children:[(0,ep.jsxs)("button",{onClick:()=>j(!k),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:B(b,"Asesor","asesores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),k&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>y(L.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Seleccionar todos"}),b.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>y([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400",children:"Limpiar"})]}),L.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:b.includes(e.nombre),onChange:()=>F(e.nombre,y),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]})]}),(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,ep.jsxs)("button",{onClick:()=>{u({afiliado:"",cuil:""}),f(""),m(""),x([]),y([])},className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors","dark"===t?"bg-white/10 text-gray-300 hover:bg-white/20":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[(0,ep.jsx)(eT.X,{className:"w-4 h-4"}),"Limpiar"]}),(0,ep.jsxs)("button",{onClick:U,className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors","dark"===t?"bg-purple-600 text-white hover:bg-purple-700":"bg-purple-500 text-white hover:bg-purple-600"),children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,ep.jsxs)("button",{onClick:()=>{if(!n||0===n.length)return void eO.toast.info("No hay datos para exportar");let t=mA(n.map(e=>({"Fecha de creacin":gc(e.createdAt),Afiliado:e.nombre||"-",CUIL:e.cuil||"-",Telfono:e.telefono||"-","Obra Social Vendida":e.obraSocialVendida||"-",Asesor:e.asesor?.nombre||"-",Supervisor:gd(e),Grupo:e.asesor?.numeroEquipo||"-",Administrativo:e.administrador?.nombre||"-",Estado:e.status||"-"}))),r=m_();mO(r,t,a.title);let s=new Date().toISOString().slice(0,10);mj(r,`${e}_${s}.xlsx`),eO.toast.success("Exportado correctamente")},className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors","dark"===t?"bg-green-600 text-white hover:bg-green-700":"bg-green-500 text-white hover:bg-green-600"),children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar Excel"]}),(0,ep.jsx)("button",{onClick:()=>c("asc"===l?"desc":"asc"),className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors","dark"===t?"bg-white/10 text-gray-300 hover:bg-white/20":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:"asc"===l?" Ms antiguas primero":" Ms recientes primero"})]})]}),n.length>0&&(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-3","dark"===t?"bg-gradient-to-r from-blue-900/20 to-indigo-900/20 border-blue-700/30":"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"),children:(0,ep.jsx)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:(0,ep.jsxs)("span",{className:(0,eg.cn)("font-bold","dark"===t?"text-gray-200":"text-gray-800"),children:["Total: ",(0,ep.jsx)("span",{className:"dark"===t?"text-blue-400":"text-blue-600",children:n.length})]})})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===t?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{className:(0,eg.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===t?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,ep.jsxs)("tr",{children:[(0,ep.jsx)("th",{className:"px-2 py-2 w-[120px]",children:"Fecha creacin"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[150px]",children:"Afiliado"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"Telfono"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ven"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Supervisor"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[60px]",children:"Grupo"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Admin"}),(0,ep.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Estado"}),(0,ep.jsx)("th",{className:"px-2 py-2 w-[80px] text-center",children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:i?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:11,className:"px-4 py-8 text-center opacity-50",children:(0,ep.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando auditoras..."]})})}):0===n.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:11,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron auditoras"})}):n.map((e,r)=>{var a,n;let s,i;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors group",((e,t)=>{if(!e)return"";let r={"falta clave":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},"falta clave (por arca)":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},rechazada:{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"},pendiente:{light:"bg-gray-100 hover:bg-gray-200",dark:"bg-gray-700/30 hover:bg-gray-700/40"},"falta documentacin":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},afip:{light:"bg-blue-50 hover:bg-blue-100",dark:"bg-blue-900/20 hover:bg-blue-900/30"},padrn:{light:"bg-indigo-50 hover:bg-indigo-100",dark:"bg-indigo-900/20 hover:bg-indigo-900/30"}}[e.toLowerCase()];return r?"dark"===t?r.dark:r.light:""})(e.status,t)||(r%2==0?"":"dark"===t?"bg-white/[0.02]":"bg-gray-50/50")),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-2.5 text-center","dark"===t?"text-gray-400":"text-gray-600"),children:gc(e.createdAt)}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center font-medium truncate max-w-[150px]",title:e.nombre,children:e.nombre}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center font-mono opacity-70 truncate",children:e.cuil||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center font-mono opacity-70 truncate",children:e.telefono||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[80px]",(a=e.obraSocialVendida,"binimed"===(s=(a||"").toLowerCase())?"dark"===t?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"meplife"===s||"meplife "===s?"dark"===t?"bg-green-500/20 text-green-400":"bg-green-200 text-green-800":"turf"===s?"dark"===t?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800":"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700")),children:e.obraSocialVendida})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3 text-center","dark"===t?"text-gray-300":"text-gray-700"),children:e.asesor?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px] inline-block",((e,t)=>{if(!e||"-"===e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=e.toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"}],n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);let s=Math.abs(n)%a.length,i=a[s];return"dark"===t?i.dark:i.light})(gd(e),t)),title:gd(e),children:gd(e)})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-semibold truncate max-w-[60px]","dark"===t?"bg-indigo-900 text-indigo-200":"bg-indigo-100 text-indigo-800"),children:e.asesor?.numeroEquipo||"-"})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3 text-center","dark"===t?"text-gray-400":"text-gray-600"),children:e.administrador?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px]",(n=e.status,i=({"falta clave":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"falta clave (por arca)":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},rechazada:{light:"bg-red-100 text-red-700",dark:"bg-red-500/20 text-red-400"},pendiente:{light:"bg-gray-200 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"falta documentacin":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},afip:{light:"bg-blue-100 text-blue-800",dark:"bg-blue-500/20 text-blue-400"},padrn:{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-500/20 text-indigo-400"},completa:{light:"bg-lime-600 text-white",dark:"bg-lime-500/30 text-lime-300"},reprogramada:{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},cada:{light:"bg-red-600 text-white",dark:"bg-red-500/30 text-red-300"}})[(n||"").toLowerCase()]||{light:"bg-gray-100 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"dark"===t?i.dark:i.light)),title:e.status,children:e.status})}),(0,ep.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1 transition-opacity",children:[I&&(0,ep.jsx)("button",{onClick:()=>{!I?eO.toast.error("No tienes permisos para editar auditoras"):(A(e),O(!0))},className:"p-1 hover:bg-blue-100 text-blue-600 rounded dark:hover:bg-blue-900/30 dark:text-blue-400",title:"Editar",children:(0,ep.jsx)(e1,{className:"w-3 h-3"})}),M&&(0,ep.jsx)("button",{onClick:()=>H(e._id),className:"p-1 hover:bg-red-100 text-red-600 rounded dark:hover:bg-red-900/30 dark:text-red-400",title:"Eliminar",children:(0,ep.jsx)(eU.Trash2,{className:"w-3 h-3"})})]})})]},e._id)})})]})})}),T&&_&&(0,ov.createPortal)((0,ep.jsx)(m1,{isOpen:_,onClose:()=>{O(!1),A(null)},audit:T,onSave:e=>{s(t=>t.map(t=>t._id===e._id?e:t)),O(!1),A(null)}}),document.body)]})}function gh(){return(0,ep.jsx)(gu,{type:"falta-clave"})}function gf(){return(0,ep.jsx)(gu,{type:"rechazada"})}function gp(){return(0,ep.jsx)(gu,{type:"pendiente"})}function gm(){return(0,ep.jsx)(gu,{type:"afip-padron"})}var gg=e.i(83638);let gx=(0,ek.default)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);var gb=e.i(6737);let gy=(0,ek.default)("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),gv=(0,ek.default)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),gw=(0,ek.default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),gk=(0,ek.default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),gj=(0,ek.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var gN=Symbol.for("immer-nothing"),gS=Symbol.for("immer-draftable"),gE=Symbol.for("immer-state");function gC(e){throw Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var gT=Object,gA=gT.getPrototypeOf,g_="constructor",gO="prototype",gP="configurable",gD="enumerable",gR="writable",gM="value",gI=e=>!!e&&!!e[gE];function gL(e){return!!e&&(gU(e)||gq(e)||!!e[gS]||!!e[g_]?.[gS]||gG(e)||gK(e))}var gF=gT[gO][g_].toString(),gB=new WeakMap;function gU(e){if(!e||!gX(e))return!1;let t=gA(e);if(null===t||t===gT[gO])return!0;let r=gT.hasOwnProperty.call(t,g_)&&t[g_];if(r===Object)return!0;if(!gY(r))return!1;let a=gB.get(r);return void 0===a&&(a=Function.toString.call(r),gB.set(r,a)),a===gF}function gz(e,t,r=!0){0===gV(e)?(r?Reflect.ownKeys(e):gT.keys(e)).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function gV(e){let t=e[gE];return t?t.type_:gq(e)?1:gG(e)?2:3*!!gK(e)}var g$=(e,t,r=gV(e))=>2===r?e.has(t):gT[gO].hasOwnProperty.call(e,t),gH=(e,t,r=gV(e))=>2===r?e.get(t):e[t],gW=(e,t,r,a=gV(e))=>{2===a?e.set(t,r):3===a?e.add(r):e[t]=r},gq=Array.isArray,gG=e=>e instanceof Map,gK=e=>e instanceof Set,gX=e=>"object"==typeof e,gY=e=>"function"==typeof e,gQ=e=>e.modified_?e.copy_:e.base_;function gJ(e,t){if(gG(e))return new Map(e);if(gK(e))return new Set(e);if(gq(e))return Array[gO].slice.call(e);let r=gU(e);if(!0!==t&&("class_only"!==t||r)){let t=gA(e);if(null!==t&&r)return{...e};let a=gT.create(t);return gT.assign(a,e)}{let t=gT.getOwnPropertyDescriptors(e);delete t[gE];let r=Reflect.ownKeys(t);for(let a=0;a<r.length;a++){let n=r[a],s=t[n];!1===s[gR]&&(s[gR]=!0,s[gP]=!0),(s.get||s.set)&&(t[n]={[gP]:!0,[gR]:!0,[gD]:s[gD],[gM]:e[n]})}return gT.create(gA(e),t)}}function gZ(e,t=!1){return g1(e)||gI(e)||(gV(e)>1&&gT.defineProperties(e,{set:g0,add:g0,clear:g0,delete:g0}),gT.freeze(e),t&&gz(e,(e,t)=>{gZ(t,!0)},!1)),e}var g0={[gM]:function(){gC(2)}};function g1(e){return!(null!==e&&gX(e))||gT.isFrozen(e)}var g2="MapSet",g5="Patches",g4={};function g3(e){let t=g4[e];return t||gC(0,e),t}function g6(e,t){t&&(e.patchPlugin_=g3(g5),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function g8(e){g7(e),e.drafts_.forEach(xe),e.drafts_=null}function g7(e){e===en&&(en=e.parent_)}var g9=e=>{let t;return t=en,en={drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:g4[g2]?g3(g2):void 0}};function xe(e){let t=e[gE];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function xt(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];if(void 0!==e&&e!==r){r[gE].modified_&&(g8(t),gC(4)),gL(e)&&(e=xr(t,e));let{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[gE].base_,e,t)}else e=xr(t,r);return function(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&gZ(t,r)}(t,e,!0),g8(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==gN?e:void 0}function xr(e,t){if(g1(t))return t;let r=t[gE];if(!r)return xl(t,e.handledSet_,e);if(!xn(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){let{callbacks_:t}=r;if(t)for(;t.length>0;)t.pop()(e);xo(r,e)}return r.copy_}function xa(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var xn=(e,t)=>e.scope_===t,xs=[];function xi(e,t,r,a){let n=e.copy_||e.base_,s=e.type_;if(void 0!==a&&gH(n,a,s)===t)return void gW(n,a,r,s);if(!e.draftLocations_){let t=e.draftLocations_=new Map;gz(n,(e,r)=>{if(gI(r)){let a=t.get(r)||[];a.push(e),t.set(r,a)}})}for(let a of e.draftLocations_.get(t)??xs)gW(n,a,r,s)}function xo(e,t){if(e.modified_&&!e.finalized_&&(3===e.type_||(e.assigned_?.size??0)>0)){let{patchPlugin_:r}=t;if(r){let a=r.getPath(e);a&&r.generatePatches_(e,a,t)}xa(e)}}function xl(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||gI(e)||t.has(e)||!gL(e)||g1(e)||(t.add(e),gz(e,(a,n)=>{if(gI(n)){let t=n[gE];xn(t,r)&&(gW(e,a,gQ(t),e.type_),xa(t))}else gL(n)&&xl(n,t,r)})),e}var xc={get(e,t){if(t===gE)return e;let r=e.copy_||e.base_;if(!g$(r,t,e.type_)){var a;let n;return a=e,(n=xh(r,t))?gM in n?n[gM]:n.get?.call(a.draft_):void 0}let n=r[t];if(e.finalized_||!gL(n))return n;if(n===xu(e.base_,t)){xp(e);let r=1===e.type_?+t:t,a=xm(e.scope_,n,e,r);return e.copy_[r]=a}return n},has:(e,t)=>t in(e.copy_||e.base_),ownKeys:e=>Reflect.ownKeys(e.copy_||e.base_),set(e,t,r){let a=xh(e.copy_||e.base_,t);if(a?.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){let a=xu(e.copy_||e.base_,t),n=a?.[gE];if(n&&n.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if((r===a?0!==r||1/r==1/a:r!=r&&a!=a)&&(void 0!==r||g$(e.base_,t,e.type_)))return!0;xp(e),xf(e)}return!!(e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t]))||(e.copy_[t]=r,e.assigned_.set(t,!0),!function(e,t,r){let{scope_:a}=e;if(gI(r)){let n=r[gE];xn(n,a)&&n.callbacks_.push(function(){xp(e),xi(e,r,gQ(n),t)})}else gL(r)&&e.callbacks_.push(function(){gH(e.copy_||e.base_,t,e.type_)===r&&a.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&xl(gH(e.copy_,t,e.type_),a.handledSet_,a)})}(e,t,r),!0)},deleteProperty:(e,t)=>(xp(e),void 0!==xu(e.base_,t)||t in e.base_?(e.assigned_.set(t,!1),xf(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){let r=e.copy_||e.base_,a=Reflect.getOwnPropertyDescriptor(r,t);return a?{[gR]:!0,[gP]:1!==e.type_||"length"!==t,[gD]:a[gD],[gM]:r[t]}:a},defineProperty(){gC(11)},getPrototypeOf:e=>gA(e.base_),setPrototypeOf(){gC(12)}},xd={};function xu(e,t){let r=e[gE];return(r?r.copy_||r.base_:e)[t]}function xh(e,t){if(!(t in e))return;let r=gA(e);for(;r;){let e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=gA(r)}}function xf(e){!e.modified_&&(e.modified_=!0,e.parent_&&xf(e.parent_))}function xp(e){e.copy_||(e.assigned_=new Map,e.copy_=gJ(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function xm(e,t,r,a){let[n,s]=gG(t)?g3(g2).proxyMap_(t,r):gK(t)?g3(g2).proxySet_(t,r):function(e,t){let r=gq(e),a={type_:+!!r,scope_:t?t.scope_:en,modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0},n=a,s=xc;r&&(n=[a],s=xd);let{revoke:i,proxy:o}=Proxy.revocable(n,s);return a.draft_=o,a.revoke_=i,[o,a]}(t,r);if((r?.scope_??en).drafts_.push(n),s.callbacks_=r?.callbacks_??[],s.key_=a,r&&void 0!==a)r.callbacks_.push(function(e){if(!s||!xn(s,e))return;e.mapSetPlugin_?.fixSetContents(s);let t=gQ(s);xi(r,s.draft_??s,t,a),xo(s,e)});else s.callbacks_.push(function(e){e.mapSetPlugin_?.fixSetContents(s);let{patchPlugin_:t}=e;s.modified_&&t&&t.generatePatches_(s,[],e)});return n}function xg(e){return gI(e)||gC(10,e),function e(t){let r;if(!gL(t)||g1(t))return t;let a=t[gE],n=!0;if(a){if(!a.modified_)return a.base_;a.finalized_=!0,r=gJ(t,a.scope_.immer_.useStrictShallowCopy_),n=a.scope_.immer_.shouldUseStrictIteration()}else r=gJ(t,!0);return gz(r,(t,a)=>{gW(r,t,e(a))},n),a&&(a.finalized_=!1),r}(e)}gz(xc,(e,t)=>{xd[e]=function(){let e=arguments;return e[0]=e[0][0],t.apply(this,e)}}),xd.deleteProperty=function(e,t){return xd.set.call(this,e,t,void 0)},xd.set=function(e,t,r){return xc.set.call(this,e[0],t,r,e[0])};var xx=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(e,t,r)=>{let a;if(gY(e)&&!gY(t)){let r=t;t=e;let a=this;return function(e=r,...n){return a.produce(e,e=>t.call(this,e,...n))}}if(gY(t)||gC(6),void 0===r||gY(r)||gC(7),gL(e)){let n=g9(this),s=xm(n,e,void 0),i=!0;try{a=t(s),i=!1}finally{i?g8(n):g7(n)}return g6(n,r),xt(a,n)}if(e&&gX(e))gC(1,e);else{if(void 0===(a=t(e))&&(a=e),a===gN&&(a=void 0),this.autoFreeze_&&gZ(a,!0),r){let t=[],n=[];g3(g5).generateReplacementPatches_(e,a,{patches_:t,inversePatches_:n}),r(t,n)}return a}},this.produceWithPatches=(e,t)=>{let r,a;return gY(e)?(t,...r)=>this.produceWithPatches(t,t=>e(t,...r)):[this.produce(e,t,(e,t)=>{r=e,a=t}),r,a]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"==typeof e?.useStrictIteration&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){gL(e)||gC(8),gI(e)&&(e=xg(e));let t=g9(this),r=xm(t,e,void 0);return r[gE].isManual_=!0,g7(t),r}finishDraft(e,t){let r=e&&e[gE];r&&r.isManual_||gC(9);let{scope_:a}=r;return g6(a,t),xt(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}r>-1&&(t=t.slice(r+1));let a=g3(g5).applyPatches_;return gI(e)?a(e,t):this.produce(e,e=>a(e,t))}}().produce,xb=e=>Array.isArray(e)?e:[e],xy=0,xv=class{revision=xy;_value;_lastValue;_isEqual=xw;constructor(e,t=xw){this._value=this._lastValue=e,this._isEqual=t}get value(){return this._value}set value(e){this.value!==e&&(this._value=e,this.revision=++xy)}};function xw(e,t){return e===t}function xk(e){return e instanceof xv||console.warn("Not a valid cell! ",e),e.value}var xj=(e,t)=>!1;function xN(){return function(e,t=xw){return new xv(null,t)}(0,xj)}var xS=e=>{let t=e.collectionTag;null===t&&(t=e.collectionTag=xN()),xk(t)};Symbol();var xE=0,xC=Object.getPrototypeOf({}),xT=class{constructor(e){this.value=e,this.value=e,this.tag.value=e}proxy=new Proxy(this,xA);tag=xN();tags={};children={};collectionTag=null;id=xE++},xA={get:(e,t)=>(function(){let{value:r}=e,a=Reflect.get(r,t);if("symbol"==typeof t||t in xC)return a;if("object"==typeof a&&null!==a){var n;let r=e.children[t];return void 0===r&&(r=e.children[t]=Array.isArray(n=a)?new x_(n):new xT(n)),r.tag&&xk(r.tag),r.proxy}{let r=e.tags[t];return void 0===r&&((r=e.tags[t]=xN()).value=a),xk(r),a}})(),ownKeys:e=>(xS(e),Reflect.ownKeys(e.value)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e.value,t),has:(e,t)=>Reflect.has(e.value,t)},x_=class{constructor(e){this.value=e,this.value=e,this.tag.value=e}proxy=new Proxy([this],xO);tag=xN();tags={};children={};collectionTag=null;id=xE++},xO={get:([e],t)=>("length"===t&&xS(e),xA.get(e,t)),ownKeys:([e])=>xA.ownKeys(e),getOwnPropertyDescriptor:([e],t)=>xA.getOwnPropertyDescriptor(e,t),has:([e],t)=>xA.has(e,t)},xP="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function xD(){return{s:0,v:void 0,o:null,p:null}}function xR(e,t={}){let r,a=xD(),{resultEqualityCheck:n}=t,s=0;function i(){let t,i=a,{length:o}=arguments;for(let e=0;e<o;e++){let t=arguments[e];if("function"==typeof t||"object"==typeof t&&null!==t){let e=i.o;null===e&&(i.o=e=new WeakMap);let r=e.get(t);void 0===r?(i=xD(),e.set(t,i)):i=r}else{let e=i.p;null===e&&(i.p=e=new Map);let r=e.get(t);void 0===r?(i=xD(),e.set(t,i)):i=r}}let l=i;if(1===i.s)t=i.v;else if(t=e.apply(null,arguments),s++,n){let e=r?.deref?.()??r;null!=e&&n(e,t)&&(t=e,0!==s&&s--),r="object"==typeof t&&null!==t||"function"==typeof t?new xP(t):t}return l.s=1,l.v=t,t}return i.clearCache=()=>{a=xD(),i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}var xM=function(e,...t){let r="function"==typeof e?{memoize:e,memoizeOptions:t}:e,a=(...e)=>{let t,a,n=0,s=0,i={},o=e.pop();"object"==typeof o&&(i=o,o=e.pop()),function(e,t=`expected a function, instead received ${typeof e}`){if("function"!=typeof e)throw TypeError(t)}(o,`createSelector expects an output function after the inputs, but received: [${typeof o}]`);let{memoize:l,memoizeOptions:c=[],argsMemoize:d=xR,argsMemoizeOptions:u=[],devModeChecks:h={}}={...r,...i},f=xb(c),p=xb(u),m=(!function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(e=>"function"==typeof e)){let r=e.map(e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e).join(", ");throw TypeError(`${t}[${r}]`)}}(t=Array.isArray(e[0])?e[0]:e,"createSelector expects all input-selectors to be functions, but received the following types: "),t),g=l(function(){return n++,o.apply(null,arguments)},...f);return Object.assign(d(function(){s++;let e=function(e,t){let r=[],{length:a}=e;for(let n=0;n<a;n++)r.push(e[n].apply(null,t));return r}(m,arguments);return a=g.apply(null,e)},...p),{resultFunc:o,memoizedResultFunc:g,dependencies:m,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>a,recomputations:()=>n,resetRecomputations:()=>{n=0},memoize:l,argsMemoize:d})};return Object.assign(a,{withTypes:()=>a}),a}(xR),xI=Object.assign((e,t=xM)=>{!function(e,t=`expected an object, instead received ${typeof e}`){if("object"!=typeof e)throw TypeError(t)}(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e);return t(r.map(t=>e[t]),(...e)=>e.reduce((e,t,a)=>(e[r[a]]=t,e),{}))},{withTypes:()=>xI});function xL(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var xF="function"==typeof Symbol&&Symbol.observable||"@@observable",xB=()=>Math.random().toString(36).substring(7).split("").join("."),xU={INIT:`@@redux/INIT${xB()}`,REPLACE:`@@redux/REPLACE${xB()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${xB()}`};function xz(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function xV(e){let t,r=Object.keys(e),a={};for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof e[n]&&(a[n]=e[n])}let n=Object.keys(a);try{Object.keys(a).forEach(e=>{let t=a[e];if(void 0===t(void 0,{type:xU.INIT}))throw Error(xL(12));if(void 0===t(void 0,{type:xU.PROBE_UNKNOWN_ACTION()}))throw Error(xL(13))})}catch(e){t=e}return function(e={},r){if(t)throw t;let s=!1,i={};for(let t=0;t<n.length;t++){let o=n[t],l=a[o],c=e[o],d=l(c,r);if(void 0===d)throw r&&r.type,Error(xL(14));i[o]=d,s=s||d!==c}return(s=s||n.length!==Object.keys(e).length)?i:e}}function x$(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce((e,t)=>(...r)=>e(t(...r)))}function xH(e){return xz(e)&&"type"in e&&"string"==typeof e.type}function xW(e){return({dispatch:t,getState:r})=>a=>n=>"function"==typeof n?n(t,r,e):a(n)}var xq=xW(),xG="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!=arguments.length)return"object"==typeof arguments[0]?x$:x$.apply(null,arguments)};function xK(e,t){function r(...a){if(t){let r=t(...a);if(!r)throw Error(bT(0));return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=t=>xH(t)&&t.type===e,r}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var xX=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function xY(e){return gL(e)?xx(e,()=>{}):e}function xQ(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}var xJ="RTK_autoBatch",xZ=()=>e=>({payload:e,meta:{[xJ]:!0}}),x0=e=>t=>{setTimeout(t,e)},x1=(e={type:"raf"})=>t=>(...r)=>{let a=t(...r),n=!0,s=!1,i=!1,o=new Set,l="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:x0(10):"callback"===e.type?e.queueNotification:x0(e.timeout),c=()=>{i=!1,s&&(s=!1,o.forEach(e=>e()))};return Object.assign({},a,{subscribe(e){let t=a.subscribe(()=>n&&e());return o.add(e),()=>{t(),o.delete(e)}},dispatch(e){try{return(s=!(n=!e?.meta?.[xJ]))&&!i&&(i=!0,l(c)),a.dispatch(e)}finally{n=!0}}})};function x2(e){let t,r={},a=[],n={addCase(e,t){let a="string"==typeof e?e:e.type;if(!a)throw Error(bT(28));if(a in r)throw Error(bT(29));return r[a]=t,n},addAsyncThunk:(e,t)=>(t.pending&&(r[e.pending.type]=t.pending),t.rejected&&(r[e.rejected.type]=t.rejected),t.fulfilled&&(r[e.fulfilled.type]=t.fulfilled),t.settled&&a.push({matcher:e.settled,reducer:t.settled}),n),addMatcher:(e,t)=>(a.push({matcher:e,reducer:t}),n),addDefaultCase:e=>(t=e,n)};return e(n),[r,a,t]}var x5=Symbol.for("rtk-slice-createasyncthunk"),x4=((Z=x4||{}).reducer="reducer",Z.reducerWithPrepare="reducerWithPrepare",Z.asyncThunk="asyncThunk",Z),x3=function({creators:e}={}){let t=e?.asyncThunk?.[x5];return function(e){let r,{name:a,reducerPath:n=a}=e;if(!a)throw Error(bT(11));let s=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},i=Object.keys(s),o={},l={},c={},d=[],u={addCase(e,t){let r="string"==typeof e?e:e.type;if(!r)throw Error(bT(12));if(r in l)throw Error(bT(13));return l[r]=t,u},addMatcher:(e,t)=>(d.push({matcher:e,reducer:t}),u),exposeAction:(e,t)=>(c[e]=t,u),exposeCaseReducer:(e,t)=>(o[e]=t,u)};function h(){let[t={},r=[],a]="function"==typeof e.extraReducers?x2(e.extraReducers):[e.extraReducers],n={...t,...l};return function(e,t){let r,[a,n,s]=x2(t);if("function"==typeof e)r=()=>xY(e());else{let t=xY(e);r=()=>t}function i(e=r(),t){let o=[a[t.type],...n.filter(({matcher:e})=>e(t)).map(({reducer:e})=>e)];return 0===o.filter(e=>!!e).length&&(o=[s]),o.reduce((e,r)=>{if(r)if(gI(e)){let a=r(e,t);return void 0===a?e:a}else{if(gL(e))return xx(e,e=>r(e,t));let a=r(e,t);if(void 0===a){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return a}return e},e)}return i.getInitialState=r,i}(e.initialState,e=>{for(let t in n)e.addCase(t,n[t]);for(let t of d)e.addMatcher(t.matcher,t.reducer);for(let t of r)e.addMatcher(t.matcher,t.reducer);a&&e.addDefaultCase(a)})}i.forEach(r=>{let n=s[r],i={reducerName:r,type:`${a}/${r}`,createNotation:"function"==typeof e.reducers};"asyncThunk"===n._reducerDefinitionType?function({type:e,reducerName:t},r,a,n){if(!n)throw Error(bT(18));let{payloadCreator:s,fulfilled:i,pending:o,rejected:l,settled:c,options:d}=r,u=n(e,s,d);a.exposeAction(t,u),i&&a.addCase(u.fulfilled,i),o&&a.addCase(u.pending,o),l&&a.addCase(u.rejected,l),c&&a.addMatcher(u.settled,c),a.exposeCaseReducer(t,{fulfilled:i||x6,pending:o||x6,rejected:l||x6,settled:c||x6})}(i,n,u,t):function({type:e,reducerName:t,createNotation:r},a,n){let s,i;if("reducer"in a){if(r&&"reducerWithPrepare"!==a._reducerDefinitionType)throw Error(bT(17));s=a.reducer,i=a.prepare}else s=a;n.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,i?xK(e,i):xK(e))}(i,n,u)});let f=e=>e,p=new Map,m=new WeakMap;function g(e,t){return r||(r=h()),r(e,t)}function x(){return r||(r=h()),r.getInitialState()}function b(t,r=!1){function a(e){let n=e[t];return void 0===n&&r&&(n=xQ(m,a,x)),n}function n(t=f){let a=xQ(p,r,()=>new WeakMap);return xQ(a,t,()=>{let a={};for(let[n,s]of Object.entries(e.selectors??{}))a[n]=function(e,t,r,a){function n(s,...i){let o=t(s);return void 0===o&&a&&(o=r()),e(o,...i)}return n.unwrapped=e,n}(s,t,()=>xQ(m,t,x),r);return a})}return{reducerPath:t,getSelectors:n,get selectors(){return n(a)},selectSlice:a}}let y={name:a,reducer:g,actions:c,caseReducers:o,getInitialState:x,...b(n),injectInto(e,{reducerPath:t,...r}={}){let a=t??n;return e.inject({reducerPath:a,reducer:g},r),{...y,...b(a,!0)}}};return y}}();function x6(){}var x8="listener",x7="completed",x9="cancelled",be=`task-${x9}`,bt=`task-${x7}`,br=`${x8}-${x9}`,ba=`${x8}-${x7}`,bn=class{constructor(e){this.code=e,this.message=`task ${x9} (reason: ${e})`}name="TaskAbortError";message},bs=(e,t)=>{if("function"!=typeof e)throw TypeError(bT(32))},bi=()=>{},bo=(e,t=bi)=>(e.catch(t),e),bl=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),bc=(e,t)=>{let r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},bd=e=>{if(e.aborted){let{reason:t}=e;throw new bn(t)}};function bu(e,t){let r=bi;return new Promise((a,n)=>{let s=()=>n(new bn(e.reason));e.aborted?s():(r=bl(e,s),t.finally(()=>r()).then(a,n))}).finally(()=>{r=bi})}var bh=async(e,t)=>{try{await Promise.resolve();let t=await e();return{status:"ok",value:t}}catch(e){return{status:e instanceof bn?"cancelled":"rejected",error:e}}finally{t?.()}},bf=e=>t=>bo(bu(e,t).then(t=>(bd(e),t))),bp=e=>{let t=bf(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:bm}=Object,bg={},bx="listenerMiddleware",bb=e=>{let{type:t,actionCreator:r,matcher:a,predicate:n,effect:s}=e;if(t)n=xK(t).match;else if(r)t=r.type,n=r.match;else if(a)n=a;else if(n);else throw Error(bT(21));return bs(s,"options.listener"),{predicate:n,type:t,effect:s}},by=bm(e=>{let{type:t,predicate:r,effect:a}=bb(e);return{id:((e=21)=>{let t="",r=e;for(;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t})(),effect:a,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw Error(bT(22))}}},{withTypes:()=>by}),bv=(e,t)=>{let{type:r,effect:a,predicate:n}=bb(t);return Array.from(e.values()).find(e=>("string"==typeof r?e.type===r:e.predicate===n)&&e.effect===a)},bw=e=>{e.pending.forEach(e=>{bc(e,br)})},bk=(e,t,r)=>{try{e(t,r)}catch(e){setTimeout(()=>{throw e},0)}},bj=bm(xK(`${bx}/add`),{withTypes:()=>bj}),bN=xK(`${bx}/removeAll`),bS=bm(xK(`${bx}/remove`),{withTypes:()=>bS}),bE=(...e)=>{console.error(`${bx}/error`,...e)},bC=(e={})=>{let t=new Map,r=new Map,{extra:a,onError:n=bE}=e;bs(n,"onError");let s=e=>{var r;return(r=bv(t,e)??by(e)).unsubscribe=()=>t.delete(r.id),t.set(r.id,r),e=>{r.unsubscribe(),e?.cancelActive&&bw(r)}};bm(s,{withTypes:()=>s});let i=e=>{let r=bv(t,e);return r&&(r.unsubscribe(),e.cancelActive&&bw(r)),!!r};bm(i,{withTypes:()=>i});let o=async(e,i,o,l)=>{var c,d;let u,h=new AbortController,f=(c=h.signal,u=async(e,t)=>{bd(c);let r=()=>{},a=[new Promise((t,a)=>{let n=s({predicate:e,effect:(e,r)=>{r.unsubscribe(),t([e,r.getState(),r.getOriginalState()])}});r=()=>{n(),a()}})];null!=t&&a.push(new Promise(e=>setTimeout(e,t,null)));try{let e=await bu(c,Promise.race(a));return bd(c),e}finally{r()}},(e,t)=>bo(u(e,t))),p=[];try{let n;e.pending.add(h),n=r.get(e)??0,r.set(e,n+1),await Promise.resolve(e.effect(i,bm({},o,{getOriginalState:l,condition:(e,t)=>f(e,t).then(Boolean),take:f,delay:bp(h.signal),pause:bf(h.signal),extra:a,signal:h.signal,fork:(d=h.signal,(e,t)=>{bs(e,"taskExecutor");let r=new AbortController;bl(d,()=>bc(r,d.reason));let a=bh(async()=>{bd(d),bd(r.signal);let t=await e({pause:bf(r.signal),delay:bp(r.signal),signal:r.signal});return bd(r.signal),t},()=>bc(r,bt));return t?.autoJoin&&p.push(a.catch(bi)),{result:bf(d)(a),cancel(){bc(r,be)}}}),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,r)=>{e!==h&&(bc(e,br),r.delete(e))})},cancel:()=>{bc(h,br),e.pending.delete(h)},throwIfCancelled:()=>{bd(h.signal)}})))}catch(e){e instanceof bn||bk(n,e,{raisedBy:"effect"})}finally{let t;await Promise.all(p),bc(h,ba),1===(t=r.get(e)??1)?r.delete(e):r.set(e,t-1),e.pending.delete(h)}},l=()=>{for(let e of r.keys())bw(e);t.clear()};return{middleware:e=>r=>a=>{let c;if(!xH(a))return r(a);if(bj.match(a))return s(a.payload);if(bN.match(a))return void l();if(bS.match(a))return i(a.payload);let d=e.getState(),u=()=>{if(d===bg)throw Error(bT(23));return d};try{if(c=r(a),t.size>0){let r=e.getState();for(let s of Array.from(t.values())){let t=!1;try{t=s.predicate(a,r,d)}catch(e){t=!1,bk(n,e,{raisedBy:"predicate"})}t&&o(s,a,e,u)}}}finally{d=bg}return c},startListening:s,stopListening:i,clearListeners:l}};function bT(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}Symbol.for("rtk-state-proxy-original");var bA=e.i(23647),b_=e=>0===e?0:e>0?1:-1,bO=e=>"number"==typeof e&&e!=+e,bP=e=>"string"==typeof e&&e.indexOf("%")===e.length-1,bD=e=>("number"==typeof e||e instanceof Number)&&!bO(e),bR=e=>bD(e)||"string"==typeof e,bM=0,bI=e=>{var t=++bM;return"".concat(e||"").concat(t)},bL=function(e,t){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!bD(e)&&"string"!=typeof e)return a;if(bP(e)){if(null==t)return a;var s=e.indexOf("%");r=t*parseFloat(e.slice(0,s))/100}else r=+e;return bO(r)&&(r=a),n&&null!=t&&r>t&&(r=t),r},bF=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},a=0;a<t;a++)if(r[e[a]])return!0;else r[e[a]]=!0;return!1};function bB(e,t,r){return bD(e)&&bD(t)?e+r*(t-e):t}var bU=e=>null==e?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function bz(e){return null!=e}function bV(){}function b$(e,t){if(t){var r=Number.parseInt(t,10);if(!bO(r))return null==e?void 0:e[r]}}var bH=x3({name:"options",initialState:{chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},reducers:{createEventEmitter:e=>{null==e.eventEmitter&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),bW=bH.reducer,{createEventEmitter:bq}=bH.actions,bG=(e.i(16428),{notify(){},get:()=>[]}),bK="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,bX="undefined"!=typeof navigator&&"ReactNative"===navigator.product,bY=bK||bX?em.useLayoutEffect:em.useEffect;function bQ(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}var bJ=Symbol.for("react-redux-context"),bZ="undefined"!=typeof globalThis?globalThis:{},b0=function(){if(!em.createContext)return{};let e=bZ[bJ]??=new Map,t=e.get(em.createContext);return t||(t=em.createContext(null),e.set(em.createContext,t)),t}(),b1=function(e){let{children:t,context:r,serverState:a,store:n}=e,s=em.useMemo(()=>{let e=function(e,t){let r,a=bG,n=0,s=!1;function i(){c.onStateChange&&c.onStateChange()}function o(){if(n++,!r){let t,n;r=e.subscribe(i),t=null,n=null,a={clear(){t=null,n=null},notify(){let e=t;for(;e;)e.callback(),e=e.next},get(){let e=[],r=t;for(;r;)e.push(r),r=r.next;return e},subscribe(e){let r=!0,a=n={callback:e,next:null,prev:n};return a.prev?a.prev.next=a:t=a,function(){r&&null!==t&&(r=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}}function l(){n--,r&&0===n&&(r(),r=void 0,a.clear(),a=bG)}let c={addNestedSub:function(e){o();let t=a.subscribe(e),r=!1;return()=>{r||(r=!0,t(),l())}},notifyNestedSubs:function(){a.notify()},handleChangeWrapper:i,isSubscribed:function(){return s},trySubscribe:function(){s||(s=!0,o())},tryUnsubscribe:function(){s&&(s=!1,l())},getListeners:()=>a};return c}(n);return{store:n,subscription:e,getServerState:a?()=>a:void 0}},[n,a]),i=em.useMemo(()=>n.getState(),[n]);return bY(()=>{let{subscription:e}=s;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),i!==n.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[s,i]),em.createElement((r||b0).Provider,{value:s},t)};function b2(e=b0){return function(){return em.useContext(e)}}var b5=b2(),b4=Symbol.for("immer-nothing"),b3=Symbol.for("immer-draftable"),b6=Symbol.for("immer-state");function b8(e){throw Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var b7=Object.getPrototypeOf;function b9(e){return!!e&&!!e[b6]}function ye(e){return!!e&&(ya(e)||Array.isArray(e)||!!e[b3]||!!e.constructor?.[b3]||yl(e)||yc(e))}var yt=Object.prototype.constructor.toString(),yr=new WeakMap;function ya(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if("function"!=typeof r)return!1;let a=yr.get(r);return void 0===a&&(a=Function.toString.call(r),yr.set(r,a)),a===yt}function yn(e,t,r=!0){0===ys(e)?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function ys(e){let t=e[b6];return t?t.type_:Array.isArray(e)?1:yl(e)?2:3*!!yc(e)}function yi(e,t){return 2===ys(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function yo(e,t,r){let a=ys(e);2===a?e.set(t,r):3===a?e.add(r):e[t]=r}function yl(e){return e instanceof Map}function yc(e){return e instanceof Set}function yd(e){return e.copy_||e.base_}function yu(e,t){if(yl(e))return new Map(e);if(yc(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=ya(e);if(!0!==t&&("class_only"!==t||r)){let t=b7(e);return null!==t&&r?{...e}:Object.assign(Object.create(t),e)}{let t=Object.getOwnPropertyDescriptors(e);delete t[b6];let r=Reflect.ownKeys(t);for(let a=0;a<r.length;a++){let n=r[a],s=t[n];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[n]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[n]})}return Object.create(b7(e),t)}}function yh(e,t=!1){return yp(e)||b9(e)||!ye(e)||(ys(e)>1&&Object.defineProperties(e,{set:yf,add:yf,clear:yf,delete:yf}),Object.freeze(e),t&&Object.values(e).forEach(e=>yh(e,!0))),e}var yf={value:function(){b8(2)}};function yp(e){return null===e||"object"!=typeof e||Object.isFrozen(e)}var ym={};function yg(e){let t=ym[e];return t||b8(0,e),t}function yx(e,t){t&&(yg("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function yb(e){yy(e),e.drafts_.forEach(yw),e.drafts_=null}function yy(e){e===es&&(es=e.parent_)}function yv(e){return es={drafts_:[],parent_:es,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function yw(e){let t=e[b6];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function yk(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return void 0!==e&&e!==r?(r[b6].modified_&&(yb(t),b8(4)),ye(e)&&(e=yj(t,e),t.parent_||yS(t,e)),t.patches_&&yg("Patches").generateReplacementPatches_(r[b6].base_,e,t.patches_,t.inversePatches_)):e=yj(t,r,[]),yb(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==b4?e:void 0}function yj(e,t,r){if(yp(t))return t;let a=e.immer_.shouldUseStrictIteration(),n=t[b6];if(!n)return yn(t,(a,s)=>yN(e,n,t,a,s,r),a),t;if(n.scope_!==e)return t;if(!n.modified_)return yS(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let t=n.copy_,s=t,i=!1;3===n.type_&&(s=new Set(t),t.clear(),i=!0),yn(s,(a,s)=>yN(e,n,t,a,s,r,i),a),yS(e,t,!1),r&&e.patches_&&yg("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function yN(e,t,r,a,n,s,i){if(null==n||"object"!=typeof n&&!i)return;let o=yp(n);if(!o||i){if(b9(n)){let i=yj(e,n,s&&t&&3!==t.type_&&!yi(t.assigned_,a)?s.concat(a):void 0);if(yo(r,a,i),!b9(i))return;e.canAutoFreeze_=!1}else i&&r.add(n);if(ye(n)&&!o){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[a]===n&&o)return;yj(e,n),(!t||!t.scope_.parent_)&&"symbol"!=typeof a&&(yl(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&yS(e,n)}}}function yS(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&yh(t,r)}var yE={get(e,t){if(t===b6)return e;let r=yd(e);if(!yi(r,t)){var a;let n;return a=e,(n=yA(r,t))?"value"in n?n.value:n.get?.call(a.draft_):void 0}let n=r[t];return e.finalized_||!ye(n)?n:n===yT(e.base_,t)?(yO(e),e.copy_[t]=yD(n,e)):n},has:(e,t)=>t in yd(e),ownKeys:e=>Reflect.ownKeys(yd(e)),set(e,t,r){let a=yA(yd(e),t);if(a?.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){let a=yT(yd(e),t),n=a?.[b6];if(n&&n.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if((r===a?0!==r||1/r==1/a:r!=r&&a!=a)&&(void 0!==r||yi(e.base_,t)))return!0;yO(e),y_(e)}return!!(e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t]))||(e.copy_[t]=r,e.assigned_[t]=!0,!0)},deleteProperty:(e,t)=>(void 0!==yT(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,yO(e),y_(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){let r=yd(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:a.enumerable,value:r[t]}:a},defineProperty(){b8(11)},getPrototypeOf:e=>b7(e.base_),setPrototypeOf(){b8(12)}},yC={};function yT(e,t){let r=e[b6];return(r?yd(r):e)[t]}function yA(e,t){if(!(t in e))return;let r=b7(e);for(;r;){let e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=b7(r)}}function y_(e){!e.modified_&&(e.modified_=!0,e.parent_&&y_(e.parent_))}function yO(e){e.copy_||(e.copy_=yu(e.base_,e.scope_.immer_.useStrictShallowCopy_))}yn(yE,(e,t)=>{yC[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),yC.deleteProperty=function(e,t){return yC.set.call(this,e,t,void 0)},yC.set=function(e,t,r){return yE.set.call(this,e[0],t,r,e[0])};var yP=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,r)=>{let a;if("function"==typeof e&&"function"!=typeof t){let r=t;t=e;let a=this;return function(e=r,...n){return a.produce(e,e=>t.call(this,e,...n))}}if("function"!=typeof t&&b8(6),void 0!==r&&"function"!=typeof r&&b8(7),ye(e)){let n=yv(this),s=yD(e,void 0),i=!0;try{a=t(s),i=!1}finally{i?yb(n):yy(n)}return yx(n,r),yk(a,n)}if(e&&"object"==typeof e)b8(1,e);else{if(void 0===(a=t(e))&&(a=e),a===b4&&(a=void 0),this.autoFreeze_&&yh(a,!0),r){let t=[],n=[];yg("Patches").generateReplacementPatches_(e,a,t,n),r(t,n)}return a}},this.produceWithPatches=(e,t)=>{let r,a;return"function"==typeof e?(t,...r)=>this.produceWithPatches(t,t=>e(t,...r)):[this.produce(e,t,(e,t)=>{r=e,a=t}),r,a]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"==typeof e?.useStrictIteration&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){var t;ye(e)||b8(8),b9(e)&&(b9(t=e)||b8(10,t),e=function e(t){let r;if(!ye(t)||yp(t))return t;let a=t[b6],n=!0;if(a){if(!a.modified_)return a.base_;a.finalized_=!0,r=yu(t,a.scope_.immer_.useStrictShallowCopy_),n=a.scope_.immer_.shouldUseStrictIteration()}else r=yu(t,!0);return yn(r,(t,a)=>{yo(r,t,e(a))},n),a&&(a.finalized_=!1),r}(t));let r=yv(this),a=yD(e,void 0);return a[b6].isManual_=!0,yy(r),a}finishDraft(e,t){let r=e&&e[b6];r&&r.isManual_||b8(9);let{scope_:a}=r;return yx(a,t),yk(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}r>-1&&(t=t.slice(r+1));let a=yg("Patches").applyPatches_;return b9(e)?a(e,t):this.produce(e,e=>a(e,t))}};function yD(e,t){let r=yl(e)?yg("MapSet").proxyMap_(e,t):yc(e)?yg("MapSet").proxySet_(e,t):function(e,t){let r=Array.isArray(e),a={type_:+!!r,scope_:t?t.scope_:es,modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},n=a,s=yE;r&&(n=[a],s=yC);let{revoke:i,proxy:o}=Proxy.revocable(n,s);return a.draft_=o,a.revoke_=i,o}(e,t);return(t?t.scope_:es).drafts_.push(r),r}new yP().produce;var yR={active:!1,index:null,dataKey:void 0,coordinate:void 0},yM=x3({name:"tooltip",initialState:{itemInteraction:{click:yR,hover:yR},axisInteraction:{click:yR,hover:yR},keyboardInteraction:yR,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:xZ()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:a}=t.payload,n=xg(e).tooltipItemPayloads.indexOf(r);n>-1&&(e.tooltipItemPayloads[n]=a)},prepare:xZ()},removeTooltipEntrySettings:{reducer(e,t){var r=xg(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:xZ()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:yI,replaceTooltipEntrySettings:yL,removeTooltipEntrySettings:yF,setTooltipSettingsState:yB,setActiveMouseOverItemIndex:yU,mouseLeaveItem:yz,mouseLeaveChart:yV,setActiveClickItemIndex:y$,setMouseOverAxisIndex:yH,setMouseClickAxisIndex:yW,setSyncInteraction:yq,setKeyboardInteraction:yG}=yM.actions,yK=yM.reducer,yX=x3({name:"chartData",initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,null==t.payload){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:a}=t.payload;null!=r&&(e.dataStartIndex=r),null!=a&&(e.dataEndIndex=a)}}}),{setChartData:yY,setDataStartEndIndexes:yQ,setComputedData:yJ}=yX.actions,yZ=yX.reducer,y0=x3({name:"chartLayout",initialState:{layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,a,n,s;e.margin.top=null!=(r=t.payload.top)?r:0,e.margin.right=null!=(a=t.payload.right)?a:0,e.margin.bottom=null!=(n=t.payload.bottom)?n:0,e.margin.left=null!=(s=t.payload.left)?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:y1,setLayout:y2,setChartSize:y5,setScale:y4}=y0.actions,y3=y0.reducer,y6=e.i(1238),y8=(0,em.createContext)(null),y7=e=>e,y9=()=>{var e=(0,em.useContext)(y8);return e?e.store.dispatch:y7},ve=()=>{},vt=()=>ve,vr=(e,t)=>e===t;function va(e){var t=(0,em.useContext)(y8);return(0,y6.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:vt,t?t.store.getState:ve,t?t.store.getState:ve,t?e:ve,vr)}var vn=e.i(76515),vs=e=>e.legend.settings,vi=xM([e=>e.legend.payload,vs],(e,t)=>{var{itemSorter:r}=t,a=e.flat(1);return r?(0,vn.default)(a,r):a});function vo(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function vl(e){return function(){return e}}function vc(e,t){if((n=e.length)>1)for(var r,a,n,s=1,i=e[t[0]],o=i.length;s<n;++s)for(a=i,i=e[t[s]],r=0;r<o;++r)i[r][1]+=i[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function vd(e){for(var t=e.length,r=Array(t);--t>=0;)r[t]=t;return r}function vu(e,t){return e[t]}function vh(e){let t=[];return t.key=e,t}function vf(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function vp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function vm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vp(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vp(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function vg(e,t,r){return null==e||null==t?r:bR(t)?(0,bA.default)(e,t,r):"function"==typeof t?t(e):r}Array.prototype.slice;var vx=(e,t)=>"horizontal"===e&&"xAxis"===t||"vertical"===e&&"yAxis"===t||"centric"===e&&"angleAxis"===t||"radial"===e&&"radiusAxis"===t,vb={sign:e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,s=0,i=0;i<t;++i){var o=bO(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=n,e[i][r][1]=n+o,n=e[i][r][1]):(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1])}},expand:function(e,t){if((a=e.length)>0){for(var r,a,n,s=0,i=e[0].length;s<i;++s){for(n=r=0;r<a;++r)n+=e[r][s][1]||0;if(n)for(r=0;r<a;++r)e[r][s][1]/=n}vc(e,t)}},none:vc,silhouette:function(e,t){if((r=e.length)>0){for(var r,a=0,n=e[t[0]],s=n.length;a<s;++a){for(var i=0,o=0;i<r;++i)o+=e[i][a][1]||0;n[a][1]+=n[a][0]=-o/2}vc(e,t)}},wiggle:function(e,t){if((n=e.length)>0&&(a=(r=e[t[0]]).length)>0){for(var r,a,n,s=0,i=1;i<a;++i){for(var o=0,l=0,c=0;o<n;++o){for(var d=e[t[o]],u=d[i][1]||0,h=(u-(d[i-1][1]||0))/2,f=0;f<o;++f){var p=e[t[f]];h+=(p[i][1]||0)-(p[i-1][1]||0)}l+=u,c+=h*u}r[i-1][1]+=r[i-1][0]=s,l&&(s-=c/l)}r[i-1][1]+=r[i-1][0]=s,vc(e,t)}},positive:e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var n=0,s=0;s<t;++s){var i=bO(e[s][r][1])?e[s][r][0]:e[s][r][1];i>=0?(e[s][r][0]=n,e[s][r][1]=n+i,n=e[s][r][1]):(e[s][r][0]=0,e[s][r][1]=0)}}},vy=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vv=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vw=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&t&&t.length>=2){for(var n=(0,vn.default)(t,e=>e.coordinate),s=1/0,i=1,o=n.length;i<o;i++){var l=n[i],c=n[i-1];s=Math.min((l.coordinate||0)-(c.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0};function vk(e){var{tooltipEntrySettings:t,dataKey:r,payload:a,value:n,name:s}=e;return vm(vm({},t),{},{dataKey:r,payload:a,value:n,name:s})}function vj(e,t){return e?String(e):"string"==typeof t?t:void 0}var vN=e=>e.layout.width,vS=e=>e.layout.height,vE=e=>e.layout.scale,vC=e=>e.layout.margin,vT=xM(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),vA=xM(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),v_="data-recharts-item-index",vO="data-recharts-item-data-key";function vP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function vD(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vP(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vP(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var vR=xM([vN,vS,vC,e=>e.brush.height,function(e){return vA(e).reduce((e,t)=>"left"!==t.orientation||t.mirror||t.hide?e:e+("number"==typeof t.width?t.width:60),0)},function(e){return vA(e).reduce((e,t)=>"right"!==t.orientation||t.mirror||t.hide?e:e+("number"==typeof t.width?t.width:60),0)},function(e){return vT(e).reduce((e,t)=>"top"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},function(e){return vT(e).reduce((e,t)=>"bottom"!==t.orientation||t.mirror||t.hide?e:e+t.height,0)},vs,e=>e.legend.size],(e,t,r,a,n,s,i,o,l,c)=>{var d={left:(r.left||0)+n,right:(r.right||0)+s},u=vD(vD({},{top:(r.top||0)+i,bottom:(r.bottom||0)+o}),d),h=u.bottom;u.bottom+=a;var f=e-(u=((e,t,r)=>{if(t&&r){var{width:a,height:n}=r,{align:s,verticalAlign:i,layout:o}=t;if(("vertical"===o||"horizontal"===o&&"middle"===i)&&"center"!==s&&bD(e[s]))return vm(vm({},e),{},{[s]:e[s]+(a||0)});if(("horizontal"===o||"vertical"===o&&"center"===s)&&"middle"!==i&&bD(e[i]))return vm(vm({},e),{},{[i]:e[i]+(n||0)})}return e})(u,l,c)).left-u.right,p=t-u.top-u.bottom;return vD(vD({brushBottom:h},u),{},{width:Math.max(f,0),height:Math.max(p,0)})}),vM=xM(vR,e=>({x:e.left,y:e.top,width:e.width,height:e.height}));xM(vN,vS,(e,t)=>({x:0,y:0,width:e,height:t}));var vI=(0,em.createContext)(null),vL=()=>null!=(0,em.useContext)(vI),vF=e=>e.brush,vB=xM([vF,vR,vC],(e,t,r)=>({height:e.height,x:bD(e.x)?e.x:t.left,y:bD(e.y)?e.y:t.top+t.height+t.brushBottom-((null==r?void 0:r.bottom)||0),width:bD(e.width)?e.width:t.width})),vU=e.i(57431),vz=e.i(70936),vV=function(e,t){for(var r=arguments.length,a=Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];if("undefined"!=typeof console&&console.warn&&(void 0===t&&console.warn("LogUtils requires an error message argument"),!e))if(void 0===t)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;console.warn(t.replace(/%s/g,()=>a[s++]))}},v$=(e,t,r)=>{var{width:a="100%",height:n="100%",aspect:s,maxHeight:i}=r,o=bP(a)?e:Number(a),l=bP(n)?t:Number(n);return s&&s>0&&(o?l=o/s:l&&(o=l*s),i&&null!=l&&l>i&&(l=i)),{calculatedWidth:o,calculatedHeight:l}},vH={width:0,height:0,overflow:"visible"},vW={width:0,overflowX:"visible"},vq={height:0,overflowY:"visible"},vG={};function vK(e){return Number.isFinite(e)}function vX(e){return"number"==typeof e&&e>0&&Number.isFinite(e)}function vY(){return(vY=Object.assign.bind()).apply(null,arguments)}function vQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function vJ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?vQ(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vQ(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var vZ=(0,em.createContext)({width:-1,height:-1});function v0(e){var{children:t,width:r,height:a}=e,n=(0,em.useMemo)(()=>({width:r,height:a}),[r,a]);return vX(n.width)&&vX(n.height)?em.createElement(vZ.Provider,{value:n},t):null}var v1=()=>(0,em.useContext)(vZ),v2=(0,em.forwardRef)((e,t)=>{var{aspect:r,initialDimension:a={width:-1,height:-1},width:n,height:s,minWidth:i=0,minHeight:o,maxHeight:l,children:c,debounce:d=0,id:u,className:h,onResize:f,style:p={}}=e,m=(0,em.useRef)(null),g=(0,em.useRef)();g.current=f,(0,em.useImperativeHandle)(t,()=>m.current);var[x,b]=(0,em.useState)({containerWidth:a.width,containerHeight:a.height}),y=(0,em.useCallback)((e,t)=>{b(r=>{var a=Math.round(e),n=Math.round(t);return r.containerWidth===a&&r.containerHeight===n?r:{containerWidth:a,containerHeight:n}})},[]);(0,em.useEffect)(()=>{if(null==m.current||"undefined"==typeof ResizeObserver)return bV;var e=e=>{var t,{width:r,height:a}=e[0].contentRect;y(r,a),null==(t=g.current)||t.call(g,r,a)};d>0&&(e=(0,vz.default)(e,d,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:r,height:a}=m.current.getBoundingClientRect();return y(r,a),t.observe(m.current),()=>{t.disconnect()}},[y,d]);var{containerWidth:v,containerHeight:w}=x;vV(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:k,calculatedHeight:j}=v$(v,w,{width:n,height:s,aspect:r,maxHeight:l});return vV(null!=k&&k>0||null!=j&&j>0,"The width(%s) and height(%s) of chart should be greater than 0,\n       please check the style of container, or the props width(%s) and height(%s),\n       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the\n       height and width.",k,j,n,s,i,o,r),em.createElement("div",{id:u?"".concat(u):void 0,className:(0,vU.clsx)("recharts-responsive-container",h),style:vJ(vJ({},p),{},{width:n,height:s,minWidth:i,minHeight:o,maxHeight:l}),ref:m},em.createElement("div",{style:(e=>{var{width:t,height:r}=e,a=bP(t),n=bP(r);return a&&n?vH:a?vW:n?vq:vG})({width:n,height:s})},em.createElement(v0,{width:k,height:j},c)))}),v5=(0,em.forwardRef)((e,t)=>{var r=v1();if(vX(r.width)&&vX(r.height))return e.children;var{width:a,height:n}=function(e){var{width:t,height:r,aspect:a}=e,n=t,s=r;return void 0===n&&void 0===s?(n="100%",s="100%"):void 0===n?n=a&&a>0?void 0:"100%":void 0===s&&(s=a&&a>0?void 0:"100%"),{width:n,height:s}}({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:i}=v$(void 0,void 0,{width:a,height:n,aspect:e.aspect,maxHeight:e.maxHeight});return bD(s)&&bD(i)?em.createElement(v0,{width:s,height:i},e.children):em.createElement(v2,vY({},e,{width:a,height:n,ref:t}))});function v4(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var v3=()=>{var e,t=vL(),r=va(vM),a=va(vB),n=null==(e=va(vF))?void 0:e.padding;return t&&a&&n?{width:a.width-n.left-n.right,height:a.height-n.top-n.bottom,x:n.left,y:n.top}:r},v6={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},v8=e=>e.layout.layoutType,v7=e=>{var t=y9(),r=vL(),{width:a,height:n}=e,s=v1(),i=a,o=n;return s&&(i=s.width>0?s.width:a,o=s.height>0?s.height:n),(0,em.useEffect)(()=>{!r&&vX(i)&&vX(o)&&t(y5({width:i,height:o}))},[t,r,i,o]),null},v9=e.i(76197);function we(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function wt(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}e.s([],13590),e.i(13590),e.s([],88204),e.i(88204);class wr extends Map{constructor(e,t=wn){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,r]of e)this.set(t,r)}get(e){return super.get(wa(this,e))}has(e){return super.has(wa(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},r){let a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},r){let a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}(this,e))}}function wa({_intern:e,_key:t},r){let a=t(r);return e.has(a)?e.get(a):r}function wn(e){return null!==e&&"object"==typeof e?e.valueOf():e}let ws=Symbol("implicit");function wi(){var e=new wr,t=[],r=[],a=ws;function n(n){let s=e.get(n);if(void 0===s){if(a!==ws)return a;e.set(n,s=t.push(n)-1)}return r[s%r.length]}return n.domain=function(r){if(!arguments.length)return t.slice();for(let a of(t=[],e=new wr,r))e.has(a)||e.set(a,t.push(a)-1);return n},n.range=function(e){return arguments.length?(r=Array.from(e),n):r.slice()},n.unknown=function(e){return arguments.length?(a=e,n):a},n.copy=function(){return wi(t,r).unknown(a)},we.apply(n,arguments),n}function wo(){var e,t,r=wi().unknown(void 0),a=r.domain,n=r.range,s=0,i=1,o=!1,l=0,c=0,d=.5;function u(){var r=a().length,u=i<s,h=u?i:s,f=u?s:i;e=(f-h)/Math.max(1,r-l+2*c),o&&(e=Math.floor(e)),h+=(f-h-e*(r-l))*d,t=e*(1-l),o&&(h=Math.round(h),t=Math.round(t));var p=(function(e,t,r){e*=1,t*=1,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var a=-1,n=0|Math.max(0,Math.ceil((t-e)/r)),s=Array(n);++a<n;)s[a]=e+a*r;return s})(r).map(function(t){return h+e*t});return n(u?p.reverse():p)}return delete r.unknown,r.domain=function(e){return arguments.length?(a(e),u()):a()},r.range=function(e){return arguments.length?([s,i]=e,s*=1,i*=1,u()):[s,i]},r.rangeRound=function(e){return[s,i]=e,s*=1,i*=1,o=!0,u()},r.bandwidth=function(){return t},r.step=function(){return e},r.round=function(e){return arguments.length?(o=!!e,u()):o},r.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),u()):l},r.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),u()):l},r.paddingOuter=function(e){return arguments.length?(c=+e,u()):c},r.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),u()):d},r.copy=function(){return wo(a(),[s,i]).round(o).paddingInner(l).paddingOuter(c).align(d)},we.apply(u(),arguments)}function wl(){return function e(t){var r=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e(r())},t}(wo.apply(null,arguments).paddingInner(1))}let wc=Math.sqrt(50),wd=Math.sqrt(10),wu=Math.sqrt(2);function wh(e,t,r){let a,n,s,i=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(i)),l=i/Math.pow(10,o),c=l>=wc?10:l>=wd?5:l>=wu?2:1;return(o<0?(a=Math.round(e*(s=Math.pow(10,-o)/c)),n=Math.round(t*s),a/s<e&&++a,n/s>t&&--n,s=-s):(a=Math.round(e/(s=Math.pow(10,o)*c)),n=Math.round(t/s),a*s<e&&++a,n*s>t&&--n),n<a&&.5<=r&&r<2)?wh(e,t,2*r):[a,n,s]}function wf(e,t,r){if(t*=1,e*=1,!((r*=1)>0))return[];if(e===t)return[e];let a=t<e,[n,s,i]=a?wh(t,e,r):wh(e,t,r);if(!(s>=n))return[];let o=s-n+1,l=Array(o);if(a)if(i<0)for(let e=0;e<o;++e)l[e]=-((s-e)/i);else for(let e=0;e<o;++e)l[e]=(s-e)*i;else if(i<0)for(let e=0;e<o;++e)l[e]=-((n+e)/i);else for(let e=0;e<o;++e)l[e]=(n+e)*i;return l}function wp(e,t,r){return wh(e*=1,t*=1,r*=1)[2]}function wm(e,t,r){t*=1,e*=1,r*=1;let a=t<e,n=a?wp(t,e,r):wp(e,t,r);return(a?-1:1)*(n<0?-(1/n):n)}function wg(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function wx(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wb(e){let t,r,a;function n(e,a,s=0,i=e.length){if(s<i){if(0!==t(a,a))return i;do{let t=s+i>>>1;0>r(e[t],a)?s=t+1:i=t}while(s<i)}return s}return 2!==e.length?(t=wg,r=(t,r)=>wg(e(t),r),a=(t,r)=>e(t)-r):(t=e===wg||e===wx?e:wy,r=e,a=e),{left:n,center:function(e,t,r=0,s=e.length){let i=n(e,t,r,s-1);return i>r&&a(e[i-1],t)>-a(e[i],t)?i-1:i},right:function(e,a,n=0,s=e.length){if(n<s){if(0!==t(a,a))return s;do{let t=n+s>>>1;0>=r(e[t],a)?n=t+1:s=t}while(n<s)}return n}}}function wy(){return 0}function wv(e){return null===e?NaN:+e}let ww=wb(wg),wk=ww.right;function wj(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function wN(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function wS(){}ww.left,wb(wv).center;var wE="\\s*([+-]?\\d+)\\s*",wC="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wA=/^#([0-9a-f]{3,8})$/,w_=RegExp(`^rgb\\(${wE},${wE},${wE}\\)$`),wO=RegExp(`^rgb\\(${wT},${wT},${wT}\\)$`),wP=RegExp(`^rgba\\(${wE},${wE},${wE},${wC}\\)$`),wD=RegExp(`^rgba\\(${wT},${wT},${wT},${wC}\\)$`),wR=RegExp(`^hsl\\(${wC},${wT},${wT}\\)$`),wM=RegExp(`^hsla\\(${wC},${wT},${wT},${wC}\\)$`),wI={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function wL(){return this.rgb().formatHex()}function wF(){return this.rgb().formatRgb()}function wB(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=wA.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?wU(t):3===r?new w$(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?wz(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?wz(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=w_.exec(e))?new w$(t[1],t[2],t[3],1):(t=wO.exec(e))?new w$(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=wP.exec(e))?wz(t[1],t[2],t[3],t[4]):(t=wD.exec(e))?wz(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=wR.exec(e))?wX(t[1],t[2]/100,t[3]/100,1):(t=wM.exec(e))?wX(t[1],t[2]/100,t[3]/100,t[4]):wI.hasOwnProperty(e)?wU(wI[e]):"transparent"===e?new w$(NaN,NaN,NaN,0):null}function wU(e){return new w$(e>>16&255,e>>8&255,255&e,1)}function wz(e,t,r,a){return a<=0&&(e=t=r=NaN),new w$(e,t,r,a)}function wV(e,t,r,a){var n;return 1==arguments.length?((n=e)instanceof wS||(n=wB(n)),n)?new w$((n=n.rgb()).r,n.g,n.b,n.opacity):new w$:new w$(e,t,r,null==a?1:a)}function w$(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}function wH(){return`#${wK(this.r)}${wK(this.g)}${wK(this.b)}`}function wW(){let e=wq(this.opacity);return`${1===e?"rgb(":"rgba("}${wG(this.r)}, ${wG(this.g)}, ${wG(this.b)}${1===e?")":`, ${e})`}`}function wq(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function wG(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function wK(e){return((e=wG(e))<16?"0":"")+e.toString(16)}function wX(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new wQ(e,t,r,a)}function wY(e){if(e instanceof wQ)return new wQ(e.h,e.s,e.l,e.opacity);if(e instanceof wS||(e=wB(e)),!e)return new wQ;if(e instanceof wQ)return e;var t=(e=e.rgb()).r/255,r=e.g/255,a=e.b/255,n=Math.min(t,r,a),s=Math.max(t,r,a),i=NaN,o=s-n,l=(s+n)/2;return o?(i=t===s?(r-a)/o+(r<a)*6:r===s?(a-t)/o+2:(t-r)/o+4,o/=l<.5?s+n:2-s-n,i*=60):o=l>0&&l<1?0:i,new wQ(i,o,l,e.opacity)}function wQ(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}function wJ(e){return(e=(e||0)%360)<0?e+360:e}function wZ(e){return Math.max(0,Math.min(1,e||0))}function w0(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function w1(e,t,r,a,n){var s=e*e,i=s*e;return((1-3*e+3*s-i)*t+(4-6*s+3*i)*r+(1+3*e+3*s-3*i)*a+i*n)/6}wj(wS,wB,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:wL,formatHex:wL,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return wY(this).formatHsl()},formatRgb:wF,toString:wF}),wj(w$,wV,wN(wS,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new w$(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new w$(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new w$(wG(this.r),wG(this.g),wG(this.b),wq(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wH,formatHex:wH,formatHex8:function(){return`#${wK(this.r)}${wK(this.g)}${wK(this.b)}${wK((isNaN(this.opacity)?1:this.opacity)*255)}`},formatRgb:wW,toString:wW})),wj(wQ,function(e,t,r,a){return 1==arguments.length?wY(e):new wQ(e,t,r,null==a?1:a)},wN(wS,{brighter(e){return e=null==e?1.4285714285714286:Math.pow(1.4285714285714286,e),new wQ(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new wQ(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,n=2*r-a;return new w$(w0(e>=240?e-240:e+120,n,a),w0(e,n,a),w0(e<120?e+240:e-120,n,a),this.opacity)},clamp(){return new wQ(wJ(this.h),wZ(this.s),wZ(this.l),wq(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=wq(this.opacity);return`${1===e?"hsl(":"hsla("}${wJ(this.h)}, ${100*wZ(this.s)}%, ${100*wZ(this.l)}%${1===e?")":`, ${e})`}`}}));let w2=e=>()=>e;function w5(e,t){var r=t-e;return r?function(t){return e+t*r}:w2(isNaN(e)?t:e)}let w4=function e(t){var r,a=1==(r=+t)?w5:function(e,t){var a,n,s;return t-e?(a=e,n=t,a=Math.pow(a,s=r),n=Math.pow(n,s)-a,s=1/s,function(e){return Math.pow(a+e*n,s)}):w2(isNaN(e)?t:e)};function n(e,t){var r=a((e=wV(e)).r,(t=wV(t)).r),n=a(e.g,t.g),s=a(e.b,t.b),i=w5(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=n(t),e.b=s(t),e.opacity=i(t),e+""}}return n.gamma=e,n}(1);function w3(e){return function(t){var r,a,n=t.length,s=Array(n),i=Array(n),o=Array(n);for(r=0;r<n;++r)a=wV(t[r]),s[r]=a.r||0,i[r]=a.g||0,o[r]=a.b||0;return s=e(s),i=e(i),o=e(o),a.opacity=1,function(e){return a.r=s(e),a.g=i(e),a.b=o(e),a+""}}}function w6(e,t){return e*=1,t*=1,function(r){return e*(1-r)+t*r}}w3(function(e){var t=e.length-1;return function(r){var a=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),n=e[a],s=e[a+1],i=a>0?e[a-1]:2*n-s,o=a<t-1?e[a+2]:2*s-n;return w1((r-a/t)*t,i,n,s,o)}}),w3(function(e){var t=e.length;return function(r){var a=Math.floor(((r%=1)<0?++r:r)*t),n=e[(a+t-1)%t],s=e[a%t],i=e[(a+1)%t],o=e[(a+2)%t];return w1((r-a/t)*t,n,s,i,o)}});var w8=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,w7=RegExp(w8.source,"g");function w9(e,t){var r,a,n=typeof t;return null==t||"boolean"===n?w2(t):("number"===n?w6:"string"===n?(a=wB(t))?(t=a,w4):function(e,t){var r,a,n,s,i,o=w8.lastIndex=w7.lastIndex=0,l=-1,c=[],d=[];for(e+="",t+="";(n=w8.exec(e))&&(s=w7.exec(t));)(i=s.index)>o&&(i=t.slice(o,i),c[l]?c[l]+=i:c[++l]=i),(n=n[0])===(s=s[0])?c[l]?c[l]+=s:c[++l]=s:(c[++l]=null,d.push({i:l,x:w6(n,s)})),o=w7.lastIndex;return o<t.length&&(i=t.slice(o),c[l]?c[l]+=i:c[++l]=i),c.length<2?d[0]?(r=d[0].x,function(e){return r(e)+""}):(a=t,function(){return a}):(t=d.length,function(e){for(var r,a=0;a<t;++a)c[(r=d[a]).i]=r.x(e);return c.join("")})}:t instanceof wB?w4:t instanceof Date?function(e,t){var r=new Date;return e*=1,t*=1,function(a){return r.setTime(e*(1-a)+t*a),r}}:!ArrayBuffer.isView(r=t)||r instanceof DataView?Array.isArray(t)?function(e,t){var r,a=t?t.length:0,n=e?Math.min(a,e.length):0,s=Array(n),i=Array(a);for(r=0;r<n;++r)s[r]=w9(e[r],t[r]);for(;r<a;++r)i[r]=t[r];return function(e){for(r=0;r<n;++r)i[r]=s[r](e);return i}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var r,a={},n={};for(r in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)r in e?a[r]=w9(e[r],t[r]):n[r]=t[r];return function(e){for(r in a)n[r]=a[r](e);return n}}:w6:function(e,t){t||(t=[]);var r,a=e?Math.min(t.length,e.length):0,n=t.slice();return function(s){for(r=0;r<a;++r)n[r]=e[r]*(1-s)+t[r]*s;return n}})(e,t)}function ke(e,t){return e*=1,t*=1,function(r){return Math.round(e*(1-r)+t*r)}}function kt(e){return+e}var kr=[0,1];function ka(e){return e}function kn(e,t){var r;return(t-=e*=1)?function(r){return(r-e)/t}:(r=isNaN(t)?NaN:.5,function(){return r})}function ks(e,t,r){var a=e[0],n=e[1],s=t[0],i=t[1];return n<a?(a=kn(n,a),s=r(i,s)):(a=kn(a,n),s=r(s,i)),function(e){return s(a(e))}}function ki(e,t,r){var a=Math.min(e.length,t.length)-1,n=Array(a),s=Array(a),i=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<a;)n[i]=kn(e[i],e[i+1]),s[i]=r(t[i],t[i+1]);return function(t){var r=wk(e,t,1,a)-1;return s[r](n[r](t))}}function ko(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function kl(){var e,t,r,a,n,s,i=kr,o=kr,l=w9,c=ka;function d(){var e,t,r,l=Math.min(i.length,o.length);return c!==ka&&(e=i[0],t=i[l-1],e>t&&(r=e,e=t,t=r),c=function(r){return Math.max(e,Math.min(t,r))}),a=l>2?ki:ks,n=s=null,u}function u(t){return null==t||isNaN(t*=1)?r:(n||(n=a(i.map(e),o,l)))(e(c(t)))}return u.invert=function(r){return c(t((s||(s=a(o,i.map(e),w6)))(r)))},u.domain=function(e){return arguments.length?(i=Array.from(e,kt),d()):i.slice()},u.range=function(e){return arguments.length?(o=Array.from(e),d()):o.slice()},u.rangeRound=function(e){return o=Array.from(e),l=ke,d()},u.clamp=function(e){return arguments.length?(c=!!e||ka,d()):c!==ka},u.interpolate=function(e){return arguments.length?(l=e,d()):l},u.unknown=function(e){return arguments.length?(r=e,u):r},function(r,a){return e=r,t=a,d()}}function kc(){return kl()(ka,ka)}function kd(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function ku(e){return(e=kd(Math.abs(e)))?e[1]:NaN}var kh=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kf(e){var t;if(!(t=kh.exec(e)))throw Error("invalid format: "+e);return new kp({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function kp(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function km(e,t){var r=kd(e,t);if(!r)return e+"";var a=r[0],n=r[1];return n<0?"0."+Array(-n).join("0")+a:a.length>n+1?a.slice(0,n+1)+"."+a.slice(n+1):a+Array(n-a.length+2).join("0")}kf.prototype=kp.prototype,kp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let kg={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>km(100*e,t),r:km,s:function(e,t){var r=kd(e,t);if(!r)return e+"";var a=r[0],n=r[1],s=n-(ei=3*Math.max(-8,Math.min(8,Math.floor(n/3))))+1,i=a.length;return s===i?a:s>i?a+Array(s-i+1).join("0"):s>0?a.slice(0,s)+"."+a.slice(s):"0."+Array(1-s).join("0")+kd(e,Math.max(0,t+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function kx(e){return e}var kb=Array.prototype.map,ky=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function kv(e,t,r,a){var n,s,i=wm(e,t,r);switch((a=kf(null==a?",f":a)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=a.precision||isNaN(s=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ku(o)/3)))-ku(Math.abs(i))))||(a.precision=s),ec(a,o);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(s=Math.max(0,ku(Math.abs(Math.max(Math.abs(e),Math.abs(t)))-(n=Math.abs(n=i)))-ku(n))+1)||(a.precision=s-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(s=Math.max(0,-ku(Math.abs(i))))||(a.precision=s-("%"===a.type)*2)}return el(a)}function kw(e){var t=e.domain;return e.ticks=function(e){var r=t();return wf(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,r){var a=t();return kv(a[0],a[a.length-1],null==e?10:e,r)},e.nice=function(r){null==r&&(r=10);var a,n,s=t(),i=0,o=s.length-1,l=s[i],c=s[o],d=10;for(c<l&&(n=l,l=c,c=n,n=i,i=o,o=n);d-- >0;){if((n=wp(l,c,r))===a)return s[i]=l,s[o]=c,t(s);if(n>0)l=Math.floor(l/n)*n,c=Math.ceil(c/n)*n;else if(n<0)l=Math.ceil(l*n)/n,c=Math.floor(c*n)/n;else break;a=n}return e},e}function kk(){var e=kc();return e.copy=function(){return ko(e,kk())},we.apply(e,arguments),kw(e)}function kj(e){var t;function r(e){return null==e||isNaN(e*=1)?t:e}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,kt),r):e.slice()},r.unknown=function(e){return arguments.length?(t=e,r):t},r.copy=function(){return kj(e).unknown(t)},e=arguments.length?Array.from(e,kt):[0,1],kw(r)}function kN(e,t){e=e.slice();var r,a=0,n=e.length-1,s=e[a],i=e[n];return i<s&&(r=a,a=n,n=r,r=s,s=i,i=r),e[a]=t.floor(s),e[n]=t.ceil(i),e}function kS(e){return Math.log(e)}function kE(e){return Math.exp(e)}function kC(e){return-Math.log(-e)}function kT(e){return-Math.exp(-e)}function kA(e){return isFinite(e)?+("1e"+e):e<0?0:e}function k_(e){return(t,r)=>-e(-t,r)}function kO(e){let t,r,a=e(kS,kE),n=a.domain,s=10;function i(){var i,o;return t=(i=s)===Math.E?Math.log:10===i&&Math.log10||2===i&&Math.log2||(i=Math.log(i),e=>Math.log(e)/i),r=10===(o=s)?kA:o===Math.E?Math.exp:e=>Math.pow(o,e),n()[0]<0?(t=k_(t),r=k_(r),e(kC,kT)):e(kS,kE),a}return a.base=function(e){return arguments.length?(s=+e,i()):s},a.domain=function(e){return arguments.length?(n(e),i()):n()},a.ticks=e=>{let a,i,o=n(),l=o[0],c=o[o.length-1],d=c<l;d&&([l,c]=[c,l]);let u=t(l),h=t(c),f=null==e?10:+e,p=[];if(!(s%1)&&h-u<f){if(u=Math.floor(u),h=Math.ceil(h),l>0){for(;u<=h;++u)for(a=1;a<s;++a)if(!((i=u<0?a/r(-u):a*r(u))<l)){if(i>c)break;p.push(i)}}else for(;u<=h;++u)for(a=s-1;a>=1;--a)if(!((i=u>0?a/r(-u):a*r(u))<l)){if(i>c)break;p.push(i)}2*p.length<f&&(p=wf(l,c,f))}else p=wf(u,h,Math.min(h-u,f)).map(r);return d?p.reverse():p},a.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===s?"s":","),"function"!=typeof n&&(s%1||null!=(n=kf(n)).precision||(n.trim=!0),n=el(n)),e===1/0)return n;let i=Math.max(1,s*e/a.ticks().length);return e=>{let a=e/r(Math.round(t(e)));return a*s<s-.5&&(a*=s),a<=i?n(e):""}},a.nice=()=>n(kN(n(),{floor:e=>r(Math.floor(t(e))),ceil:e=>r(Math.ceil(t(e)))})),a}function kP(){let e=kO(kl()).domain([1,10]);return e.copy=()=>ko(e,kP()).base(e.base()),we.apply(e,arguments),e}function kD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function kR(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function kM(e){var t=1,r=e(kD(1),kR(t));return r.constant=function(r){return arguments.length?e(kD(t=+r),kR(t)):t},kw(r)}function kI(){var e=kM(kl());return e.copy=function(){return ko(e,kI()).constant(e.constant())},we.apply(e,arguments)}function kL(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function kF(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function kB(e){return e<0?-e*e:e*e}function kU(e){var t=e(ka,ka),r=1;return t.exponent=function(t){return arguments.length?1==(r=+t)?e(ka,ka):.5===r?e(kF,kB):e(kL(r),kL(1/r)):r},kw(t)}function kz(){var e=kU(kl());return e.copy=function(){return ko(e,kz()).exponent(e.exponent())},we.apply(e,arguments),e}function kV(){return kz.apply(null,arguments).exponent(.5)}function k$(e){return Math.sign(e)*e*e}function kH(){var e,t=kc(),r=[0,1],a=!1;function n(r){var n,s=Math.sign(n=t(r))*Math.sqrt(Math.abs(n));return isNaN(s)?e:a?Math.round(s):s}return n.invert=function(e){return t.invert(k$(e))},n.domain=function(e){return arguments.length?(t.domain(e),n):t.domain()},n.range=function(e){return arguments.length?(t.range((r=Array.from(e,kt)).map(k$)),n):r.slice()},n.rangeRound=function(e){return n.range(e).round(!0)},n.round=function(e){return arguments.length?(a=!!e,n):a},n.clamp=function(e){return arguments.length?(t.clamp(e),n):t.clamp()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return kH(t.domain(),r).round(a).clamp(t.clamp()).unknown(e)},we.apply(n,arguments),kw(n)}function kW(e,t){let r;if(void 0===t)for(let t of e)null!=t&&(r<t||void 0===r&&t>=t)&&(r=t);else{let a=-1;for(let n of e)null!=(n=t(n,++a,e))&&(r<n||void 0===r&&n>=n)&&(r=n)}return r}function kq(e,t){let r;if(void 0===t)for(let t of e)null!=t&&(r>t||void 0===r&&t>=t)&&(r=t);else{let a=-1;for(let n of e)null!=(n=t(n,++a,e))&&(r>n||void 0===r&&n>=n)&&(r=n)}return r}function kG(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:+(e>t))}function kK(e,t,r){let a=e[t];e[t]=e[r],e[r]=a}function kX(){var e,t=[],r=[],a=[];function n(){var e=0,n=Math.max(1,r.length);for(a=Array(n-1);++e<n;)a[e-1]=function(e,t,r=wv){if(!(!(a=e.length)||isNaN(t*=1))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,n=(a-1)*t,s=Math.floor(n),i=+r(e[s],s,e);return i+(r(e[s+1],s+1,e)-i)*(n-s)}}(t,e/n);return s}function s(t){return null==t||isNaN(t*=1)?e:r[wk(a,t)]}return s.invertExtent=function(e){var n=r.indexOf(e);return n<0?[NaN,NaN]:[n>0?a[n-1]:t[0],n<a.length?a[n]:t[t.length-1]]},s.domain=function(e){if(!arguments.length)return t.slice();for(let r of(t=[],e))null==r||isNaN(r*=1)||t.push(r);return t.sort(wg),n()},s.range=function(e){return arguments.length?(r=Array.from(e),n()):r.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return a.slice()},s.copy=function(){return kX().domain(t).range(r).unknown(e)},we.apply(s,arguments)}function kY(){var e,t=0,r=1,a=1,n=[.5],s=[0,1];function i(t){return null!=t&&t<=t?s[wk(n,t,0,a)]:e}function o(){var e=-1;for(n=Array(a);++e<a;)n[e]=((e+1)*r-(e-a)*t)/(a+1);return i}return i.domain=function(e){return arguments.length?([t,r]=e,t*=1,r*=1,o()):[t,r]},i.range=function(e){return arguments.length?(a=(s=Array.from(e)).length-1,o()):s.slice()},i.invertExtent=function(e){var i=s.indexOf(e);return i<0?[NaN,NaN]:i<1?[t,n[0]]:i>=a?[n[a-1],r]:[n[i-1],n[i]]},i.unknown=function(t){return arguments.length&&(e=t),i},i.thresholds=function(){return n.slice()},i.copy=function(){return kY().domain([t,r]).range(s).unknown(e)},we.apply(kw(i),arguments)}function kQ(){var e,t=[.5],r=[0,1],a=1;function n(n){return null!=n&&n<=n?r[wk(t,n,0,a)]:e}return n.domain=function(e){return arguments.length?(a=Math.min((t=Array.from(e)).length,r.length-1),n):t.slice()},n.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(t.length,r.length-1),n):r.slice()},n.invertExtent=function(e){var a=r.indexOf(e);return[t[a-1],t[a]]},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return kQ().domain(t).range(r).unknown(e)},we.apply(n,arguments)}el=(eo=function(e){var t,r,a,n=void 0===e.grouping||void 0===e.thousands?kx:(t=kb.call(e.grouping,Number),r=e.thousands+"",function(e,a){for(var n=e.length,s=[],i=0,o=t[0],l=0;n>0&&o>0&&(l+o+1>a&&(o=Math.max(1,a-l)),s.push(e.substring(n-=o,n+o)),!((l+=o+1)>a));)o=t[i=(i+1)%t.length];return s.reverse().join(r)}),s=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",l=void 0===e.numerals?kx:(a=kb.call(e.numerals,String),function(e){return e.replace(/[0-9]/g,function(e){return a[+e]})}),c=void 0===e.percent?"%":e.percent+"",d=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=kf(e)).fill,r=e.align,a=e.sign,h=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,x=e.trim,b=e.type;"n"===b?(m=!0,b="g"):kg[b]||(void 0===g&&(g=12),x=!0,b="g"),(f||"0"===t&&"="===r)&&(f=!0,t="0",r="=");var y="$"===h?s:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",v="$"===h?i:/[%p]/.test(b)?c:"",w=kg[b],k=/[defgprs%]/.test(b);function j(e){var s,i,c,h=y,j=v;if("c"===b)j=w(e)+j,e="";else{var N=(e*=1)<0||1/e<0;if(e=isNaN(e)?u:w(Math.abs(e),g),x&&(e=function(e){s:for(var t,r=e.length,a=1,n=-1;a<r;++a)switch(e[a]){case".":n=t=a;break;case"0":0===n&&(n=a),t=a;break;default:if(!+e[a])break s;n>0&&(n=0)}return n>0?e.slice(0,n)+e.slice(t+1):e}(e)),N&&0==+e&&"+"!==a&&(N=!1),h=(N?"("===a?a:d:"-"===a||"("===a?"":a)+h,j=("s"===b?ky[8+ei/3]:"")+j+(N&&"("===a?")":""),k){for(s=-1,i=e.length;++s<i;)if(48>(c=e.charCodeAt(s))||c>57){j=(46===c?o+e.slice(s+1):e.slice(s))+j,e=e.slice(0,s);break}}}m&&!f&&(e=n(e,1/0));var S=h.length+e.length+j.length,E=S<p?Array(p-S+1).join(t):"";switch(m&&f&&(e=n(E+e,E.length?p-j.length:1/0),E=""),r){case"<":e=h+e+j+E;break;case"=":e=h+E+e+j;break;case"^":e=E.slice(0,S=E.length>>1)+h+e+j+E.slice(S);break;default:e=E+h+e+j}return l(e)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),j.toString=function(){return e+""},j}return{format:h,formatPrefix:function(e,t){var r=h(((e=kf(e)).type="f",e)),a=3*Math.max(-8,Math.min(8,Math.floor(ku(t)/3))),n=Math.pow(10,-a),s=ky[8+a/3];return function(e){return r(n*e)+s}}}}({thousands:",",grouping:[3],currency:["$",""]})).format,ec=eo.formatPrefix;let kJ=new Date,kZ=new Date;function k0(e,t,r,a){function n(t){return e(t=0==arguments.length?new Date:new Date(+t)),t}return n.floor=t=>(e(t=new Date(+t)),t),n.ceil=r=>(e(r=new Date(r-1)),t(r,1),e(r),r),n.round=e=>{let t=n(e),r=n.ceil(e);return e-t<r-e?t:r},n.offset=(e,r)=>(t(e=new Date(+e),null==r?1:Math.floor(r)),e),n.range=(r,a,s)=>{let i,o=[];if(r=n.ceil(r),s=null==s?1:Math.floor(s),!(r<a)||!(s>0))return o;do o.push(i=new Date(+r)),t(r,s),e(r);while(i<r&&r<a)return o},n.filter=r=>k0(t=>{if(t>=t)for(;e(t),!r(t);)t.setTime(t-1)},(e,a)=>{if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!r(e););else for(;--a>=0;)for(;t(e,1),!r(e););}),r&&(n.count=(t,a)=>(kJ.setTime(+t),kZ.setTime(+a),e(kJ),e(kZ),Math.floor(r(kJ,kZ))),n.every=e=>isFinite(e=Math.floor(e))&&e>0?e>1?n.filter(a?t=>a(t)%e==0:t=>n.count(0,t)%e==0):n:null),n}let k1=k0(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());k1.every=e=>isFinite(e=Math.floor(e))&&e>0?k0(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)}):null,k1.range;let k2=k0(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());k2.every=e=>isFinite(e=Math.floor(e))&&e>0?k0(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)}):null,k2.range;let k5=k0(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());k5.range;let k4=k0(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());k4.range;function k3(e){return k0(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/6048e5)}let k6=k3(0),k8=k3(1),k7=k3(2),k9=k3(3),je=k3(4),jt=k3(5),jr=k3(6);function ja(e){return k0(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/6048e5)}k6.range,k8.range,k7.range,k9.range,je.range,jt.range,jr.range;let jn=ja(0),js=ja(1),ji=ja(2),jo=ja(3),jl=ja(4),jc=ja(5),jd=ja(6);jn.range,js.range,ji.range,jo.range,jl.range,jc.range,jd.range;let ju=k0(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1);ju.range;let jh=k0(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1);jh.range;let jf=k0(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5));jf.range;let jp=k0(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-6e4*e.getMinutes())},(e,t)=>{e.setTime(+e+36e5*t)},(e,t)=>(t-e)/36e5,e=>e.getHours());jp.range;let jm=k0(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+36e5*t)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours());jm.range;let jg=k0(e=>{e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},(e,t)=>{e.setTime(+e+6e4*t)},(e,t)=>(t-e)/6e4,e=>e.getMinutes());jg.range;let jx=k0(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+6e4*t)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes());jx.range;let jb=k0(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+1e3*t)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds());jb.range;let jy=k0(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);function jv(e,t,r,a,n,s){let i=[[jb,1,1e3],[jb,5,5e3],[jb,15,15e3],[jb,30,3e4],[s,1,6e4],[s,5,3e5],[s,15,9e5],[s,30,18e5],[n,1,36e5],[n,3,108e5],[n,6,216e5],[n,12,432e5],[a,1,864e5],[a,2,1728e5],[r,1,6048e5],[t,1,2592e6],[t,3,7776e6],[e,1,31536e6]];function o(t,r,a){let n=Math.abs(r-t)/a,s=wb(([,,e])=>e).right(i,n);if(s===i.length)return e.every(wm(t/31536e6,r/31536e6,a));if(0===s)return jy.every(Math.max(wm(t,r,a),1));let[o,l]=i[n/i[s-1][2]<i[s][2]/n?s-1:s];return o.every(l)}return[function(e,t,r){let a=t<e;a&&([e,t]=[t,e]);let n=r&&"function"==typeof r.range?r:o(e,t,r),s=n?n.range(e,+t+1):[];return a?s.reverse():s},o]}jy.every=e=>isFinite(e=Math.floor(e))&&e>0?e>1?k0(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):jy:null,jy.range;let[jw,jk]=jv(k2,k4,jn,jf,jm,jx),[jj,jN]=jv(k1,k5,k6,ju,jp,jg);function jS(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function jE(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function jC(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}var jT={"-":"",_:" ",0:"0"},jA=/^\s*\d+/,j_=/^%/,jO=/[\\^$*+?|[\]().{}]/g;function jP(e,t,r){var a=e<0?"-":"",n=(a?-e:e)+"",s=n.length;return a+(s<r?Array(r-s+1).join(t)+n:n)}function jD(e){return e.replace(jO,"\\$&")}function jR(e){return RegExp("^(?:"+e.map(jD).join("|")+")","i")}function jM(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function jI(e,t,r){var a=jA.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function jL(e,t,r){var a=jA.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function jF(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function jB(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function jU(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function jz(e,t,r){var a=jA.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function jV(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function j$(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function jH(e,t,r){var a=jA.exec(t.slice(r,r+1));return a?(e.q=3*a[0]-3,r+a[0].length):-1}function jW(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function jq(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function jG(e,t,r){var a=jA.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function jK(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function jX(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function jY(e,t,r){var a=jA.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function jQ(e,t,r){var a=jA.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function jJ(e,t,r){var a=jA.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function jZ(e,t,r){var a=j_.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function j0(e,t,r){var a=jA.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function j1(e,t,r){var a=jA.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function j2(e,t){return jP(e.getDate(),t,2)}function j5(e,t){return jP(e.getHours(),t,2)}function j4(e,t){return jP(e.getHours()%12||12,t,2)}function j3(e,t){return jP(1+ju.count(k1(e),e),t,3)}function j6(e,t){return jP(e.getMilliseconds(),t,3)}function j8(e,t){return j6(e,t)+"000"}function j7(e,t){return jP(e.getMonth()+1,t,2)}function j9(e,t){return jP(e.getMinutes(),t,2)}function Ne(e,t){return jP(e.getSeconds(),t,2)}function Nt(e){var t=e.getDay();return 0===t?7:t}function Nr(e,t){return jP(k6.count(k1(e)-1,e),t,2)}function Na(e){var t=e.getDay();return t>=4||0===t?je(e):je.ceil(e)}function Nn(e,t){return e=Na(e),jP(je.count(k1(e),e)+(4===k1(e).getDay()),t,2)}function Ns(e){return e.getDay()}function Ni(e,t){return jP(k8.count(k1(e)-1,e),t,2)}function No(e,t){return jP(e.getFullYear()%100,t,2)}function Nl(e,t){return jP((e=Na(e)).getFullYear()%100,t,2)}function Nc(e,t){return jP(e.getFullYear()%1e4,t,4)}function Nd(e,t){var r=e.getDay();return jP((e=r>=4||0===r?je(e):je.ceil(e)).getFullYear()%1e4,t,4)}function Nu(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+jP(t/60|0,"0",2)+jP(t%60,"0",2)}function Nh(e,t){return jP(e.getUTCDate(),t,2)}function Nf(e,t){return jP(e.getUTCHours(),t,2)}function Np(e,t){return jP(e.getUTCHours()%12||12,t,2)}function Nm(e,t){return jP(1+jh.count(k2(e),e),t,3)}function Ng(e,t){return jP(e.getUTCMilliseconds(),t,3)}function Nx(e,t){return Ng(e,t)+"000"}function Nb(e,t){return jP(e.getUTCMonth()+1,t,2)}function Ny(e,t){return jP(e.getUTCMinutes(),t,2)}function Nv(e,t){return jP(e.getUTCSeconds(),t,2)}function Nw(e){var t=e.getUTCDay();return 0===t?7:t}function Nk(e,t){return jP(jn.count(k2(e)-1,e),t,2)}function Nj(e){var t=e.getUTCDay();return t>=4||0===t?jl(e):jl.ceil(e)}function NN(e,t){return e=Nj(e),jP(jl.count(k2(e),e)+(4===k2(e).getUTCDay()),t,2)}function NS(e){return e.getUTCDay()}function NE(e,t){return jP(js.count(k2(e)-1,e),t,2)}function NC(e,t){return jP(e.getUTCFullYear()%100,t,2)}function NT(e,t){return jP((e=Nj(e)).getUTCFullYear()%100,t,2)}function NA(e,t){return jP(e.getUTCFullYear()%1e4,t,4)}function N_(e,t){var r=e.getUTCDay();return jP((e=r>=4||0===r?jl(e):jl.ceil(e)).getUTCFullYear()%1e4,t,4)}function NO(){return"+0000"}function NP(){return"%"}function ND(e){return+e}function NR(e){return Math.floor(e/1e3)}function NM(e){return new Date(e)}function NI(e){return e instanceof Date?+e:+new Date(+e)}function NL(e,t,r,a,n,s,i,o,l,c){var d=kc(),u=d.invert,h=d.domain,f=c(".%L"),p=c(":%S"),m=c("%I:%M"),g=c("%I %p"),x=c("%a %d"),b=c("%b %d"),y=c("%B"),v=c("%Y");function w(e){return(l(e)<e?f:o(e)<e?p:i(e)<e?m:s(e)<e?g:a(e)<e?n(e)<e?x:b:r(e)<e?y:v)(e)}return d.invert=function(e){return new Date(u(e))},d.domain=function(e){return arguments.length?h(Array.from(e,NI)):h().map(NM)},d.ticks=function(t){var r=h();return e(r[0],r[r.length-1],null==t?10:t)},d.tickFormat=function(e,t){return null==t?w:c(t)},d.nice=function(e){var r=h();return e&&"function"==typeof e.range||(e=t(r[0],r[r.length-1],null==e?10:e)),e?h(kN(r,e)):d},d.copy=function(){return ko(d,NL(e,t,r,a,n,s,i,o,l,c))},d}function NF(){return we.apply(NL(jj,jN,k1,k5,k6,ju,jp,jg,jb,eu).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function NB(){return we.apply(NL(jw,jk,k2,k4,jn,jh,jm,jx,jb,eh).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function NU(){var e,t,r,a,n,s=0,i=1,o=ka,l=!1;function c(t){return null==t||isNaN(t*=1)?n:o(0===r?.5:(t=(a(t)-e)*r,l?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var r,a;return arguments.length?([r,a]=t,o=e(r,a),c):[o(0),o(1)]}}return c.domain=function(n){return arguments.length?([s,i]=n,e=a(s*=1),t=a(i*=1),r=e===t?0:1/(t-e),c):[s,i]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(o=e,c):o},c.range=d(w9),c.rangeRound=d(ke),c.unknown=function(e){return arguments.length?(n=e,c):n},function(n){return a=n,e=n(s),t=n(i),r=e===t?0:1/(t-e),c}}function Nz(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function NV(){var e=kw(NU()(ka));return e.copy=function(){return Nz(e,NV())},wt.apply(e,arguments)}function N$(){var e=kO(NU()).domain([1,10]);return e.copy=function(){return Nz(e,N$()).base(e.base())},wt.apply(e,arguments)}function NH(){var e=kM(NU());return e.copy=function(){return Nz(e,NH()).constant(e.constant())},wt.apply(e,arguments)}function NW(){var e=kU(NU());return e.copy=function(){return Nz(e,NW()).exponent(e.exponent())},wt.apply(e,arguments)}function Nq(){return NW.apply(null,arguments).exponent(.5)}function NG(){var e=[],t=ka;function r(r){if(null!=r&&!isNaN(r*=1))return t((wk(e,r,1)-1)/(e.length-1))}return r.domain=function(t){if(!arguments.length)return e.slice();for(let r of(e=[],t))null==r||isNaN(r*=1)||e.push(r);return e.sort(wg),r},r.interpolator=function(e){return arguments.length?(t=e,r):t},r.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},r.quantiles=function(t){return Array.from({length:t+1},(r,a)=>(function(e,t,r){if(!(!(a=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t*=1)>=t&&(yield t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(a*=1)>=a&&(yield a)}}(e,void 0))).length)||isNaN(t*=1))){if(t<=0||a<2)return kq(e);if(t>=1)return kW(e);var a,n=(a-1)*t,s=Math.floor(n),i=kW((function e(t,r,a=0,n=1/0,s){if(r=Math.floor(r),a=Math.floor(Math.max(0,a)),n=Math.floor(Math.min(t.length-1,n)),!(a<=r&&r<=n))return t;for(s=void 0===s?kG:function(e=wg){if(e===wg)return kG;if("function"!=typeof e)throw TypeError("compare is not a function");return(t,r)=>{let a=e(t,r);return a||0===a?a:(0===e(r,r))-(0===e(t,t))}}(s);n>a;){if(n-a>600){let i=n-a+1,o=r-a+1,l=Math.log(i),c=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*c*(i-c)/i)*(o-i/2<0?-1:1),u=Math.max(a,Math.floor(r-o*c/i+d)),h=Math.min(n,Math.floor(r+(i-o)*c/i+d));e(t,r,u,h,s)}let i=t[r],o=a,l=n;for(kK(t,a,r),s(t[n],i)>0&&kK(t,a,n);o<l;){for(kK(t,o,l),++o,--l;0>s(t[o],i);)++o;for(;s(t[l],i)>0;)--l}0===s(t[a],i)?kK(t,a,l):kK(t,++l,n),l<=r&&(a=l+1),r<=l&&(n=l-1)}return t})(e,s).subarray(0,s+1));return i+(kq(e.subarray(s+1))-i)*(n-s)}})(e,a/t))},r.copy=function(){return NG(t).domain(e)},wt.apply(r,arguments)}function NK(){var e,t,r,a,n,s,i,o=0,l=.5,c=1,d=1,u=ka,h=!1;function f(e){return isNaN(e*=1)?i:(e=.5+((e=+s(e))-t)*(d*e<d*t?a:n),u(h?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var r,a,n;return arguments.length?([r,a,n]=t,u=function(e,t){void 0===t&&(t=e,e=w9);for(var r=0,a=t.length-1,n=t[0],s=Array(a<0?0:a);r<a;)s[r]=e(n,n=t[++r]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return s[t](e-t)}}(e,[r,a,n]),f):[u(0),u(.5),u(1)]}}return f.domain=function(i){return arguments.length?([o,l,c]=i,e=s(o*=1),t=s(l*=1),r=s(c*=1),a=e===t?0:.5/(t-e),n=t===r?0:.5/(r-t),d=t<e?-1:1,f):[o,l,c]},f.clamp=function(e){return arguments.length?(h=!!e,f):h},f.interpolator=function(e){return arguments.length?(u=e,f):u},f.range=p(w9),f.rangeRound=p(ke),f.unknown=function(e){return arguments.length?(i=e,f):i},function(i){return s=i,e=i(o),t=i(l),r=i(c),a=e===t?0:.5/(t-e),n=t===r?0:.5/(r-t),d=t<e?-1:1,f}}function NX(){var e=kw(NK()(ka));return e.copy=function(){return Nz(e,NX())},wt.apply(e,arguments)}function NY(){var e=kO(NK()).domain([.1,1,10]);return e.copy=function(){return Nz(e,NY()).base(e.base())},wt.apply(e,arguments)}function NQ(){var e=kM(NK());return e.copy=function(){return Nz(e,NQ()).constant(e.constant())},wt.apply(e,arguments)}function NJ(){var e=kU(NK());return e.copy=function(){return Nz(e,NJ()).exponent(e.exponent())},wt.apply(e,arguments)}function NZ(){return NJ.apply(null,arguments).exponent(.5)}eu=(ed=function(e){var t=e.dateTime,r=e.date,a=e.time,n=e.periods,s=e.days,i=e.shortDays,o=e.months,l=e.shortMonths,c=jR(n),d=jM(n),u=jR(s),h=jM(s),f=jR(i),p=jM(i),m=jR(o),g=jM(o),x=jR(l),b=jM(l),y={a:function(e){return i[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:j2,e:j2,f:j8,g:Nl,G:Nd,H:j5,I:j4,j:j3,L:j6,m:j7,M:j9,p:function(e){return n[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ND,s:NR,S:Ne,u:Nt,U:Nr,V:Nn,w:Ns,W:Ni,x:null,X:null,y:No,Y:Nc,Z:Nu,"%":NP},v={a:function(e){return i[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:Nh,e:Nh,f:Nx,g:NT,G:N_,H:Nf,I:Np,j:Nm,L:Ng,m:Nb,M:Ny,p:function(e){return n[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ND,s:NR,S:Nv,u:Nw,U:Nk,V:NN,w:NS,W:NE,x:null,X:null,y:NC,Y:NA,Z:NO,"%":NP},w={a:function(e,t,r){var a=f.exec(t.slice(r));return a?(e.w=p.get(a[0].toLowerCase()),r+a[0].length):-1},A:function(e,t,r){var a=u.exec(t.slice(r));return a?(e.w=h.get(a[0].toLowerCase()),r+a[0].length):-1},b:function(e,t,r){var a=x.exec(t.slice(r));return a?(e.m=b.get(a[0].toLowerCase()),r+a[0].length):-1},B:function(e,t,r){var a=m.exec(t.slice(r));return a?(e.m=g.get(a[0].toLowerCase()),r+a[0].length):-1},c:function(e,r,a){return N(e,t,r,a)},d:jq,e:jq,f:jJ,g:jV,G:jz,H:jK,I:jK,j:jG,L:jQ,m:jW,M:jX,p:function(e,t,r){var a=c.exec(t.slice(r));return a?(e.p=d.get(a[0].toLowerCase()),r+a[0].length):-1},q:jH,Q:j0,s:j1,S:jY,u:jL,U:jF,V:jB,w:jI,W:jU,x:function(e,t,a){return N(e,r,t,a)},X:function(e,t,r){return N(e,a,t,r)},y:jV,Y:jz,Z:j$,"%":jZ};function k(e,t){return function(r){var a,n,s,i=[],o=-1,l=0,c=e.length;for(r instanceof Date||(r=new Date(+r));++o<c;)37===e.charCodeAt(o)&&(i.push(e.slice(l,o)),null!=(n=jT[a=e.charAt(++o)])?a=e.charAt(++o):n="e"===a?" ":"0",(s=t[a])&&(a=s(r,n)),i.push(a),l=o+1);return i.push(e.slice(l,o)),i.join("")}}function j(e,t){return function(r){var a,n,s=jC(1900,void 0,1);if(N(s,e,r+="",0)!=r.length)return null;if("Q"in s)return new Date(s.Q);if("s"in s)return new Date(1e3*s.s+("L"in s?s.L:0));if(!t||"Z"in s||(s.Z=0),"p"in s&&(s.H=s.H%12+12*s.p),void 0===s.m&&(s.m="q"in s?s.q:0),"V"in s){if(s.V<1||s.V>53)return null;"w"in s||(s.w=1),"Z"in s?(a=(n=(a=jE(jC(s.y,0,1))).getUTCDay())>4||0===n?js.ceil(a):js(a),a=jh.offset(a,(s.V-1)*7),s.y=a.getUTCFullYear(),s.m=a.getUTCMonth(),s.d=a.getUTCDate()+(s.w+6)%7):(a=(n=(a=jS(jC(s.y,0,1))).getDay())>4||0===n?k8.ceil(a):k8(a),a=ju.offset(a,(s.V-1)*7),s.y=a.getFullYear(),s.m=a.getMonth(),s.d=a.getDate()+(s.w+6)%7)}else("W"in s||"U"in s)&&("w"in s||(s.w="u"in s?s.u%7:+("W"in s)),n="Z"in s?jE(jC(s.y,0,1)).getUTCDay():jS(jC(s.y,0,1)).getDay(),s.m=0,s.d="W"in s?(s.w+6)%7+7*s.W-(n+5)%7:s.w+7*s.U-(n+6)%7);return"Z"in s?(s.H+=s.Z/100|0,s.M+=s.Z%100,jE(s)):jS(s)}}function N(e,t,r,a){for(var n,s,i=0,o=t.length,l=r.length;i<o;){if(a>=l)return -1;if(37===(n=t.charCodeAt(i++))){if(!(s=w[(n=t.charAt(i++))in jT?t.charAt(i++):n])||(a=s(e,r,a))<0)return -1}else if(n!=r.charCodeAt(a++))return -1}return a}return y.x=k(r,y),y.X=k(a,y),y.c=k(t,y),v.x=k(r,v),v.X=k(a,v),v.c=k(t,v),{format:function(e){var t=k(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=j(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=k(e+="",v);return t.toString=function(){return e},t},utcParse:function(e){var t=j(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})).format,ed.parse,eh=ed.utcFormat,ed.utcParse,e.s(["scaleBand",()=>wo,"scaleDiverging",()=>NX,"scaleDivergingLog",()=>NY,"scaleDivergingPow",()=>NJ,"scaleDivergingSqrt",()=>NZ,"scaleDivergingSymlog",()=>NQ,"scaleIdentity",()=>kj,"scaleImplicit",0,ws,"scaleLinear",()=>kk,"scaleLog",()=>kP,"scaleOrdinal",()=>wi,"scalePoint",()=>wl,"scalePow",()=>kz,"scaleQuantile",()=>kX,"scaleQuantize",()=>kY,"scaleRadial",()=>kH,"scaleSequential",()=>NV,"scaleSequentialLog",()=>N$,"scaleSequentialPow",()=>NW,"scaleSequentialQuantile",()=>NG,"scaleSequentialSqrt",()=>Nq,"scaleSequentialSymlog",()=>NH,"scaleSqrt",()=>kV,"scaleSymlog",()=>kI,"scaleThreshold",()=>kQ,"scaleTime",()=>NF,"scaleUtc",()=>NB,"tickFormat",()=>kv],11719),e.i(11719),e.s(["scaleBand",()=>wo,"scaleDiverging",()=>NX,"scaleDivergingLog",()=>NY,"scaleDivergingPow",()=>NJ,"scaleDivergingSqrt",()=>NZ,"scaleDivergingSymlog",()=>NQ,"scaleIdentity",()=>kj,"scaleImplicit",0,ws,"scaleLinear",()=>kk,"scaleLog",()=>kP,"scaleOrdinal",()=>wi,"scalePoint",()=>wl,"scalePow",()=>kz,"scaleQuantile",()=>kX,"scaleQuantize",()=>kY,"scaleRadial",()=>kH,"scaleSequential",()=>NV,"scaleSequentialLog",()=>N$,"scaleSequentialPow",()=>NW,"scaleSequentialQuantile",()=>NG,"scaleSequentialSqrt",()=>Nq,"scaleSequentialSymlog",()=>NH,"scaleSqrt",()=>kV,"scaleSymlog",()=>kI,"scaleThreshold",()=>kQ,"scaleTime",()=>NF,"scaleUtc",()=>NB,"tickFormat",()=>kv],58610);var N0=e.i(58610),N1=e=>e.chartData,N2=xM([N1],e=>{var t=null!=e.chartData?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),N5=(e,t,r,a)=>a?N2(e):N1(e);function N4(e){if(Array.isArray(e)&&2===e.length){var[t,r]=e;if(vK(t)&&vK(r))return!0}return!1}function N3(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function N6(e,t){if(t&&"function"!=typeof e&&Array.isArray(e)&&2===e.length){var r,a,[n,s]=e;if(vK(n))r=n;else if("function"==typeof n)return;if(vK(s))a=s;else if("function"==typeof s)return;var i=[r,a];if(N4(i))return i}}var N8=e.i(51216),N7=e=>e,N9={},Se=e=>function t(){let r;return 0==arguments.length||1==arguments.length&&(r=arguments.length<=0?void 0:arguments[0],r===N9)?t:e(...arguments)},St=(e,t)=>1===e?t:Se(function(){for(var r=arguments.length,a=Array(r),n=0;n<r;n++)a[n]=arguments[n];var s=a.filter(e=>e!==N9).length;return s>=e?t(...a):St(e-s,Se(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t(...a.map(e=>e===N9?r.shift():e),...r)}))}),Sr=(e,t)=>{for(var r=[],a=e;a<t;++a)r[a-e]=a;return r},Sa=St((n=(e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e)).length,n),Sn=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!t.length)return N7;var a=t.reverse(),n=a[0],s=a.slice(1);return function(){return s.reduce((e,t)=>t(e),n(...arguments))}},Ss=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join("");function Si(e){return 0===e?1:Math.floor(new N8.default(e).abs().log(10).toNumber())+1}function So(e,t,r){for(var a=new N8.default(e),n=0,s=[];a.lt(t)&&n<1e5;)s.push(a.toNumber()),a=a.add(r),n++;return s}var Sl=e=>{var[t,r]=e,[a,n]=[t,r];return t>r&&([a,n]=[r,t]),[a,n]},Sc=(e,t,r)=>{if(e.lte(0))return new N8.default(0);var a=Si(e.toNumber()),n=new N8.default(10).pow(a),s=e.div(n),i=1!==a?.05:.1,o=new N8.default(Math.ceil(s.div(i).toNumber())).add(r).mul(i).mul(n);return new N8.default(t?o.toNumber():Math.ceil(o.toNumber()))},Sd=function(e,t,r,a){var n,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new N8.default(0),tickMin:new N8.default(0),tickMax:new N8.default(0)};var i=Sc(new N8.default(t).sub(e).div(r-1),a,s),o=Math.ceil((n=e<=0&&t>=0?new N8.default(0):(n=new N8.default(e).add(t).div(2)).sub(new N8.default(n).mod(i))).sub(e).div(i).toNumber()),l=Math.ceil(new N8.default(t).sub(n).div(i).toNumber()),c=o+l+1;return c>r?Sd(e,t,r,a,s+1):(c<r&&(l=t>0?l+(r-c):l,o=t>0?o:o+(r-c)),{step:i,tickMin:n.sub(new N8.default(o).mul(i)),tickMax:n.add(new N8.default(l).mul(i))})},Su=function(e){var[t,r]=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],s=Math.max(a,2),[i,o]=Sl([t,r]);if(i===-1/0||o===1/0){var l=o===1/0?[i,...Sr(0,a-1).map(()=>1/0)]:[...Sr(0,a-1).map(()=>-1/0),o];return t>r?Ss(l):l}if(i===o){var c=new N8.default(1),d=new N8.default(i);if(!d.isint()&&n){var u=Math.abs(i);u<1?(c=new N8.default(10).pow(Si(i)-1),d=new N8.default(Math.floor(d.div(c).toNumber())).mul(c)):u>1&&(d=new N8.default(Math.floor(i)))}else 0===i?d=new N8.default(Math.floor((a-1)/2)):n||(d=new N8.default(Math.floor(i)));var h=Math.floor((a-1)/2);return Sn(Sa(e=>d.add(new N8.default(e-h).mul(c)).toNumber()),Sr)(0,a)}var{step:f,tickMin:p,tickMax:m}=Sd(i,o,s,n,0),g=So(p,m.add(new N8.default(.1).mul(f)),f);return t>r?Ss(g):g},Sh=function(e,t){var[r,a]=e,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[s,i]=Sl([r,a]);if(s===-1/0||i===1/0)return[r,a];if(s===i)return[s];var o=Math.max(t,2),l=Sc(new N8.default(i).sub(s).div(o-1),n,0),c=[...So(new N8.default(s),new N8.default(i),l),i];return!1===n&&(c=c.map(e=>Math.round(e))),r>a?Ss(c):c},Sf=e=>e.rootProps.stackOffset,Sp=e=>e.rootProps.reverseStackOrder,Sm=e=>e.options.chartName,Sg=e=>e.rootProps.syncId,Sx=e=>e.rootProps.syncMethod,Sb=e=>e.options.eventEmitter;function Sy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Sv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Sy(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sy(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Sw=Math.PI/180,Sk=(e,t,r,a)=>({x:e+Math.cos(-Sw*a)*r,y:t+Math.sin(-Sw*a)*r}),Sj=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(r.left||0)-(r.right||0)),Math.abs(t-(r.top||0)-(r.bottom||0)))/2},SN={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},SS={allowDecimals:!1,allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category",zIndex:SN.axis},SE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,includeHidden:!1,orientation:"right",radiusAxisId:0,reversed:!1,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number",zIndex:SN.axis},SC=(e,t)=>{if(e&&t)return null!=e&&e.reversed?[t[1],t[0]]:t},ST={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:SS.angleAxisId,includeHidden:!1,name:void 0,reversed:SS.reversed,scale:SS.scale,tick:SS.tick,tickCount:void 0,ticks:void 0,type:SS.type,unit:void 0},SA={allowDataOverflow:SE.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:SE.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:SE.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:SE.scale,tick:SE.tick,tickCount:SE.tickCount,ticks:void 0,type:SE.type,unit:void 0},S_={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:SS.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:SS.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:SS.scale,tick:SS.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},SO={allowDataOverflow:SE.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:SE.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:SE.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:SE.scale,tick:SE.tick,tickCount:SE.tickCount,ticks:void 0,type:"category",unit:void 0},SP=(e,t)=>null!=e.polarAxis.angleAxis[t]?e.polarAxis.angleAxis[t]:"radial"===e.layout.layoutType?S_:ST,SD=(e,t)=>null!=e.polarAxis.radiusAxis[t]?e.polarAxis.radiusAxis[t]:"radial"===e.layout.layoutType?SO:SA,SR=e=>e.polarOptions,SM=xM([vN,vS,vR],Sj),SI=xM([SR,SM],(e,t)=>{if(null!=e)return bL(e.innerRadius,t,0)}),SL=xM([SR,SM],(e,t)=>{if(null!=e)return bL(e.outerRadius,t,.8*t)}),SF=xM([SR],e=>{if(null==e)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]});xM([SP,SF],SC);var SB=xM([SM,SI,SL],(e,t,r)=>{if(null!=e&&null!=t&&null!=r)return[t,r]});xM([SD,SB],SC);var SU=xM([v8,SR,SI,SL,vN,vS],(e,t,r,a,n,s)=>{if(("centric"===e||"radial"===e)&&null!=t&&null!=r&&null!=a){var{cx:i,cy:o,startAngle:l,endAngle:c}=t;return{cx:bL(i,n,n/2),cy:bL(o,s,s/2),innerRadius:r,outerRadius:a,startAngle:l,endAngle:c,clockWise:!1}}}),Sz=(e,t)=>t,SV=(e,t,r)=>r;function S$(e){return null==e?void 0:e.id}function SH(e,t,r){var{chartData:a=[]}=t,{allowDuplicatedCategory:n,dataKey:s}=r,i=new Map;return e.forEach(e=>{var t,r=null!=(t=e.data)?t:a;if(null!=r&&0!==r.length){var o=S$(e);r.forEach((t,r)=>{var a,l=null==s||n?r:String(vg(t,s,null)),c=vg(t,e.dataKey,0);Object.assign(a=i.has(l)?i.get(l):{},{[o]:c}),i.set(l,a)})}}),Array.from(i.values())}function SW(e){return null!=e.stackId&&null!=e.dataKey}var Sq=(e,t)=>e===t||null!=e&&null!=t&&e[0]===t[0]&&e[1]===t[1];function SG(e,t){return!!(Array.isArray(e)&&Array.isArray(t))&&0===e.length&&0===t.length||e===t}var SK=e=>{var t=v8(e);return"horizontal"===t?"xAxis":"vertical"===t?"yAxis":"centric"===t?"angleAxis":"radiusAxis"},SX=e=>e.tooltip.settings.axisId;function SY(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function SQ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SY(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SY(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var SJ=[0,"auto"],SZ={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},S0=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return null==r?SZ:r},S1={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:SJ,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:60},S2=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return null==r?S1:r},S5={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},S4=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return null==r?S5:r},S3=(e,t,r)=>{switch(t){case"xAxis":return S0(e,r);case"yAxis":return S2(e,r);case"zAxis":return S4(e,r);case"angleAxis":return SP(e,r);case"radiusAxis":return SD(e,r);default:throw Error("Unexpected axis type: ".concat(t))}},S6=(e,t,r)=>{switch(t){case"xAxis":return S0(e,r);case"yAxis":return S2(e,r);case"angleAxis":return SP(e,r);case"radiusAxis":return SD(e,r);default:throw Error("Unexpected axis type: ".concat(t))}},S8=e=>e.graphicalItems.cartesianItems.some(e=>"bar"===e.type)||e.graphicalItems.polarItems.some(e=>"radialBar"===e.type);function S7(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var S9=xM([Sz,SV],S7),Ee=(e,t,r)=>e.filter(r).filter(e=>(null==t?void 0:t.includeHidden)===!0||!e.hide),Et=xM([e=>e.graphicalItems.cartesianItems,S3,S9],Ee,{memoizeOptions:{resultEqualityCheck:SG}}),Er=xM([Et],e=>e.filter(e=>"area"===e.type||"bar"===e.type).filter(SW)),Ea=e=>e.filter(e=>!("stackId"in e)||void 0===e.stackId),En=xM([Et],Ea),Es=e=>e.map(e=>e.data).filter(Boolean).flat(1),Ei=xM([Et],Es,{memoizeOptions:{resultEqualityCheck:SG}}),Eo=(e,t)=>{var{chartData:r=[],dataStartIndex:a,dataEndIndex:n}=t;return e.length>0?e:r.slice(a,n+1)},El=xM([Ei,N5],Eo),Ec=(e,t,r)=>(null==t?void 0:t.dataKey)!=null?e.map(e=>({value:vg(e,t.dataKey)})):r.length>0?r.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:vg(e,t)}))):e.map(e=>({value:e})),Ed=xM([El,S3,Et],Ec);function Eu(e,t){switch(e){case"xAxis":return"x"===t.direction;case"yAxis":return"y"===t.direction;default:return!1}}function Eh(e){if(bR(e)||e instanceof Date){var t=Number(e);if(vK(t))return t}}function Ef(e){if(Array.isArray(e)){var t=[Eh(e[0]),Eh(e[1])];return N4(t)?t:void 0}var r=Eh(e);if(null!=r)return[r,r]}function Ep(e){return e.map(Eh).filter(bz)}var Em=e=>{var t=SK(e),r=SX(e);return S6(e,t,r)},Eg=xM([Em],e=>null==e?void 0:e.dataKey),Ex=xM([Er,N5,Em],SH),Eb=(e,t,r,a)=>Object.fromEntries(Object.entries(t.reduce((e,t)=>(null==t.stackId||(null==e[t.stackId]&&(e[t.stackId]=[]),e[t.stackId].push(t)),e),{})).map(t=>{var n,[s,i]=t,o=a?[...i].reverse():i,l=o.map(S$);return[s,{stackedData:(n=vb[r],(function(){var e=vl([]),t=vd,r=vc,a=vu;function n(n){var s,i,o=Array.from(e.apply(this,arguments),vh),l=o.length,c=-1;for(let e of n)for(s=0,++c;s<l;++s)(o[s][c]=[0,+a(e,o[s].key,c,n)]).data=e;for(s=0,i=vo(t(o));s<l;++s)o[i[s]].index=s;return r(o,i),o}return n.keys=function(t){return arguments.length?(e="function"==typeof t?t:vl(Array.from(t)),n):e},n.value=function(e){return arguments.length?(a="function"==typeof e?e:vl(+e),n):a},n.order=function(e){return arguments.length?(t=null==e?vd:"function"==typeof e?e:vl(Array.from(e)),n):t},n.offset=function(e){return arguments.length?(r=null==e?vc:e,n):r},n})().keys(l).value((e,t)=>Number(vg(e,t,0))).order(vd).offset(n)(e)),graphicalItems:o}]})),Ey=xM([Ex,Er,Sf,Sp],Eb),Ev=(e,t,r,a)=>{var{dataStartIndex:n,dataEndIndex:s}=t;if(null==a&&"zAxis"!==r){var i=((e,t,r)=>{if(null!=e){let a;return[(a=Object.keys(e).reduce((a,n)=>{var{stackedData:s}=e[n],i=s.reduce((e,a)=>{var n,s=[Math.min(...n=vf(a,t,r).flat(2).filter(bD)),Math.max(...n)];return[Math.min(e[0],s[0]),Math.max(e[1],s[1])]},[1/0,-1/0]);return[Math.min(i[0],a[0]),Math.max(i[1],a[1])]},[1/0,-1/0]))[0]===1/0?0:a[0],a[1]===-1/0?0:a[1]]}})(e,n,s);if(null==i||0!==i[0]||0!==i[1])return i}},Ew=xM([S3],e=>e.allowDataOverflow),Ek=e=>{var t;if(null==e||!("domain"in e))return SJ;if(null!=e.domain)return e.domain;if(null!=e.ticks){if("number"===e.type){var r=Ep(e.ticks);return[Math.min(...r),Math.max(...r)]}if("category"===e.type)return e.ticks.map(String)}return null!=(t=null==e?void 0:e.domain)?t:SJ},Ej=xM([S3],Ek),EN=xM([Ej,Ew],N6),ES=xM([Ey,N1,Sz,EN],Ev,{memoizeOptions:{resultEqualityCheck:Sq}}),EE=e=>e.errorBars,EC=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=t.filter(Boolean);if(0!==a.length){var n=a.flat();return[Math.min(...n),Math.max(...n)]}},ET=(e,t,r,a,n)=>{var s,i;if(r.length>0&&e.forEach(e=>{r.forEach(r=>{var o,l,c=null==(o=a[r.id])?void 0:o.filter(e=>Eu(n,e)),d=vg(e,null!=(l=t.dataKey)?l:r.dataKey),u=!(!c||"number"!=typeof d||bO(d))&&c.length?Ep(c.flatMap(t=>{var r,a,n=vg(e,t.dataKey);if(Array.isArray(n)?[r,a]=n:r=a=n,vK(r)&&vK(a))return[d-r,d+a]})):[];if(u.length>=2){var h=Math.min(...u),f=Math.max(...u);(null==s||h<s)&&(s=h),(null==i||f>i)&&(i=f)}var p=Ef(d);null!=p&&(s=null==s?p[0]:Math.min(s,p[0]),i=null==i?p[1]:Math.max(i,p[1]))})}),(null==t?void 0:t.dataKey)!=null&&e.forEach(e=>{var r=Ef(vg(e,t.dataKey));null!=r&&(s=null==s?r[0]:Math.min(s,r[0]),i=null==i?r[1]:Math.max(i,r[1]))}),vK(s)&&vK(i))return[s,i]},EA=xM([El,S3,En,EE,Sz],ET,{memoizeOptions:{resultEqualityCheck:Sq}});function E_(e){var{value:t}=e;if(bR(t)||t instanceof Date)return t}var EO=e=>e.referenceElements.dots,EP=(e,t,r)=>e.filter(e=>"extendDomain"===e.ifOverflow).filter(e=>"xAxis"===t?e.xAxisId===r:e.yAxisId===r),ED=xM([EO,Sz,SV],EP),ER=e=>e.referenceElements.areas,EM=xM([ER,Sz,SV],EP),EI=e=>e.referenceElements.lines,EL=xM([EI,Sz,SV],EP),EF=(e,t)=>{var r=Ep(e.map(e=>"xAxis"===t?e.x:e.y));if(0!==r.length)return[Math.min(...r),Math.max(...r)]},EB=xM(ED,Sz,EF),EU=(e,t)=>{var r=Ep(e.flatMap(e=>["xAxis"===t?e.x1:e.y1,"xAxis"===t?e.x2:e.y2]));if(0!==r.length)return[Math.min(...r),Math.max(...r)]},Ez=xM([EM,Sz],EU),EV=(e,t)=>{var r=e.flatMap(e=>"xAxis"===t?function(e){if(null!=e.x)return Ep([e.x]);var t,r=null==(t=e.segment)?void 0:t.map(e=>e.x);return null==r||0===r.length?[]:Ep(r)}(e):function(e){if(null!=e.y)return Ep([e.y]);var t,r=null==(t=e.segment)?void 0:t.map(e=>e.y);return null==r||0===r.length?[]:Ep(r)}(e));if(0!==r.length)return[Math.min(...r),Math.max(...r)]},E$=xM([EL,Sz],EV),EH=xM(EB,E$,Ez,(e,t,r)=>EC(e,r,t)),EW=(e,t,r,a,n,s,i,o)=>null!=r?r:function(e,t,r){if(r||null!=t){if("function"==typeof e&&null!=t)try{var a=e(t,r);if(N4(a))return N3(a,t,r)}catch(e){}if(Array.isArray(e)&&2===e.length){var n,s,[i,o]=e;if("auto"===i)null!=t&&(n=Math.min(...t));else if(bD(i))n=i;else if("function"==typeof i)try{null!=t&&(n=i(null==t?void 0:t[0]))}catch(e){}else if("string"==typeof i&&vy.test(i)){var l=vy.exec(i);if(null==l||null==t)n=void 0;else{var c=+l[1];n=t[0]-c}}else n=null==t?void 0:t[0];if("auto"===o)null!=t&&(s=Math.max(...t));else if(bD(o))s=o;else if("function"==typeof o)try{null!=t&&(s=o(null==t?void 0:t[1]))}catch(e){}else if("string"==typeof o&&vv.test(o)){var d=vv.exec(o);if(null==d||null==t)s=void 0;else{var u=+d[1];s=t[1]+u}}else s=null==t?void 0:t[1];var h=[n,s];if(N4(h))return null==t?h:N3(h,t,r)}}}(t,"vertical"===i&&"xAxis"===o||"horizontal"===i&&"yAxis"===o?EC(a,s,n):EC(s,n),e.allowDataOverflow),Eq=xM([S3,Ej,EN,ES,EA,EH,v8,Sz],EW,{memoizeOptions:{resultEqualityCheck:Sq}}),EG=[0,1],EK=(e,t,r,a,n,s,i)=>{if(null!=e&&null!=r&&0!==r.length||void 0!==i){var o,l,{dataKey:c,type:d}=e,u=vx(t,s);return u&&null==c?(0,v9.default)(0,null!=(l=null==r?void 0:r.length)?l:0):"category"===d?(o=a.map(E_).filter(e=>null!=e),u&&(null==e.dataKey||e.allowDuplicatedCategory&&bF(o))?(0,v9.default)(0,a.length):e.allowDuplicatedCategory?o:Array.from(new Set(o))):"expand"===n?EG:i}},EX=xM([S3,v8,El,Ed,Sf,Sz,Eq],EK),EY=(e,t,r,a,n)=>{if(null!=e){var{scale:s,type:i}=e;if("auto"===s)return"radial"===t&&"radiusAxis"===n?"band":"radial"===t&&"angleAxis"===n?"linear":"category"===i&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":"category"===i?"band":"linear";if("string"==typeof s){var o="scale".concat(bU(s));return o in N0?o:"point"}}},EQ=xM([S3,v8,S8,Sm,Sz],EY);function EJ(e,t,r,a){if(null!=r&&null!=a){if("function"==typeof e.scale)return e.scale.copy().domain(r).range(a);var n=function(e){if(null!=e){if(e in N0)return N0[e]();var t="scale".concat(bU(e));if(t in N0)return N0[t]()}}(t);if(null!=n){var s=n.domain(r).range(a);return(e=>{var t=e.domain();if(t&&!(t.length<=2)){var r=t.length,a=e.range(),n=Math.min(a[0],a[1])-1e-4,s=Math.max(a[0],a[1])+1e-4,i=e(t[0]),o=e(t[r-1]);(i<n||i>s||o<n||o>s)&&e.domain([t[0],t[r-1]])}})(s),s}}}var EZ=(e,t,r)=>{var a=Ek(t);if("auto"===r||"linear"===r){if(null!=t&&t.tickCount&&Array.isArray(a)&&("auto"===a[0]||"auto"===a[1])&&N4(e))return Su(e,t.tickCount,t.allowDecimals);if(null!=t&&t.tickCount&&"number"===t.type&&N4(e))return Sh(e,t.tickCount,t.allowDecimals)}},E0=xM([EX,S6,EQ],EZ),E1=(e,t,r,a)=>"angleAxis"!==a&&(null==e?void 0:e.type)==="number"&&N4(t)&&Array.isArray(r)&&r.length>0?[Math.min(t[0],r[0]),Math.max(t[1],r[r.length-1])]:t,E2=xM([S3,EX,E0,Sz],E1),E5=xM(Ed,S3,(e,t)=>{if(t&&"number"===t.type){var r=1/0,a=Array.from(Ep(e.map(e=>e.value))).sort((e,t)=>e-t);if(a.length<2)return 1/0;var n=a[a.length-1]-a[0];if(0===n)return 1/0;for(var s=0;s<a.length-1;s++)r=Math.min(r,a[s+1]-a[s]);return r/n}}),E4=xM(E5,v8,e=>e.rootProps.barCategoryGap,vR,(e,t,r,a)=>a,(e,t,r,a,n)=>{if(!vK(e))return 0;var s="vertical"===t?a.height:a.width;if("gap"===n)return e*s/2;if("no-gap"===n){var i=bL(r,e*s),o=e*s/2;return o-i-(o-i)/s*i}return 0}),E3=xM(S0,(e,t)=>{var r=S0(e,t);return null==r||"string"!=typeof r.padding?0:E4(e,"xAxis",t,r.padding)},(e,t)=>{if(null==e)return{left:0,right:0};var r,a,{padding:n}=e;return"string"==typeof n?{left:t,right:t}:{left:(null!=(r=n.left)?r:0)+t,right:(null!=(a=n.right)?a:0)+t}}),E6=xM(S2,(e,t)=>{var r=S2(e,t);return null==r||"string"!=typeof r.padding?0:E4(e,"yAxis",t,r.padding)},(e,t)=>{if(null==e)return{top:0,bottom:0};var r,a,{padding:n}=e;return"string"==typeof n?{top:t,bottom:t}:{top:(null!=(r=n.top)?r:0)+t,bottom:(null!=(a=n.bottom)?a:0)+t}}),E8=xM([vR,E3,vB,vF,(e,t,r)=>r],(e,t,r,a,n)=>{var{padding:s}=a;return n?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),E7=xM([vR,v8,E6,vB,vF,(e,t,r)=>r],(e,t,r,a,n,s)=>{var{padding:i}=n;return s?[a.height-i.bottom,i.top]:"horizontal"===t?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),E9=(e,t,r,a)=>{var n;switch(t){case"xAxis":return E8(e,r,a);case"yAxis":return E7(e,r,a);case"zAxis":return null==(n=S4(e,r))?void 0:n.range;case"angleAxis":return SF(e);case"radiusAxis":return SB(e,r);default:return}},Ce=xM([S3,E9],SC),Ct=xM([S3,EQ,E2,Ce],EJ);function Cr(e,t){return e.id<t.id?-1:+(e.id>t.id)}xM([Et,EE,Sz],(e,t,r)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>Eu(r,e)));var Ca=(e,t)=>t,Cn=(e,t,r)=>r,Cs=xM(vT,Ca,Cn,(e,t,r)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===r).sort(Cr)),Ci=xM(vA,Ca,Cn,(e,t,r)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===r).sort(Cr)),Co=(e,t)=>({width:e.width,height:t.height});xM(vR,S0,Co);var Cl=xM(vS,vR,Cs,Ca,Cn,(e,t,r,a,n)=>{var s,i={};return r.forEach(r=>{var o=Co(t,r);null==s&&(s=((e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}})(t,a,e));var l="top"===a&&!n||"bottom"===a&&n;i[r.id]=s-Number(l)*o.height,s+=(l?-1:1)*o.height}),i}),Cc=xM(vN,vR,Ci,Ca,Cn,(e,t,r,a,n)=>{var s,i={};return r.forEach(r=>{var o={width:"number"==typeof r.width?r.width:60,height:t.height};null==s&&(s=((e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}})(t,a,e));var l="left"===a&&!n||"right"===a&&n;i[r.id]=s-Number(l)*o.width,s+=(l?-1:1)*o.width}),i});xM([vR,S0,(e,t)=>{var r=S0(e,t);if(null!=r)return Cl(e,r.orientation,r.mirror)},(e,t)=>t],(e,t,r,a)=>{if(null!=t){var n=null==r?void 0:r[a];return null==n?{x:e.left,y:0}:{x:e.left,y:n}}}),xM([vR,S2,(e,t)=>{var r=S2(e,t);if(null!=r)return Cc(e,r.orientation,r.mirror)},(e,t)=>t],(e,t,r,a)=>{if(null!=t){var n=null==r?void 0:r[a];return null==n?{x:0,y:e.top}:{x:n,y:e.top}}}),xM(vR,S2,(e,t)=>({width:"number"==typeof t.width?t.width:60,height:e.height}));var Cd=(e,t,r,a)=>{if(null!=r){var{allowDuplicatedCategory:n,type:s,dataKey:i}=r,o=vx(e,a),l=t.map(e=>e.value);if(i&&o&&"category"===s&&n&&bF(l))return l}},Cu=xM([v8,Ed,S3,Sz],Cd),Ch=(e,t,r,a)=>{if(null!=r&&null!=r.dataKey){var{type:n,scale:s}=r;if(vx(e,a)&&("number"===n||"auto"!==s))return t.map(e=>e.value)}},Cf=xM([v8,Ed,S6,Sz],Ch);xM([v8,(e,t,r)=>{switch(t){case"xAxis":return S0(e,r);case"yAxis":return S2(e,r);default:throw Error("Unexpected axis type: ".concat(t))}},EQ,Ct,Cu,Cf,E9,E0,Sz],(e,t,r,a,n,s,i,o,l)=>{if(null!=t){var c=vx(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:s,duplicateDomain:n,isCategorical:c,niceTicks:o,range:i,realScaleType:r,scale:a}}}),xM([v8,S6,EQ,Ct,E0,E9,Cu,Cf,Sz],(e,t,r,a,n,s,i,o,l)=>{if(null!=t&&null!=a){var c=vx(e,l),{type:d,ticks:u,tickCount:h}=t,f="scaleBand"===r&&"function"==typeof a.bandwidth?a.bandwidth()/2:2,p="category"===d&&a.bandwidth?a.bandwidth()/f:0;p="angleAxis"===l&&null!=s&&s.length>=2?2*b_(s[0]-s[1])*p:p;var m=u||n;return m?m.map((e,t)=>({index:t,coordinate:a(i?i.indexOf(e):e)+p,value:e,offset:p})).filter(e=>vK(e.coordinate)):c&&o?o.map((e,t)=>({coordinate:a(e)+p,value:e,index:t,offset:p})).filter(e=>vK(e.coordinate)):a.ticks?a.ticks(h).map(e=>({coordinate:a(e)+p,value:e,offset:p})):a.domain().map((e,t)=>({coordinate:a(e)+p,value:i?i[e]:e,index:t,offset:p}))}}),xM([v8,S6,Ct,E9,Cu,Cf,Sz],(e,t,r,a,n,s,i)=>{if(null!=t&&null!=r&&null!=a&&a[0]!==a[1]){var o=vx(e,i),{tickCount:l}=t,c=0;return(c="angleAxis"===i&&(null==a?void 0:a.length)>=2?2*b_(a[0]-a[1])*c:c,o&&s)?s.map((e,t)=>({coordinate:r(e)+c,value:e,index:t,offset:c})):r.ticks?r.ticks(l).map(e=>({coordinate:r(e)+c,value:e,offset:c})):r.domain().map((e,t)=>({coordinate:r(e)+c,value:n?n[e]:e,index:t,offset:c}))}}),xM(S3,Ct,(e,t)=>{if(null!=e&&null!=t)return SQ(SQ({},e),{},{scale:t})});var Cp=xM([S3,EQ,EX,Ce],EJ);xM((e,t,r)=>S4(e,r),Cp,(e,t)=>{if(null!=e&&null!=t)return SQ(SQ({},e),{},{scale:t})});var Cm=xM([v8,vT,vA],(e,t,r)=>{switch(e){case"horizontal":return t.some(e=>e.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(e=>e.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Cg=e=>e.options.defaultTooltipEventType,Cx=e=>e.options.validateTooltipEventTypes;function Cb(e,t,r){if(null==e)return t;var a=e?"axis":"item";return null==r?t:r.includes(a)?a:t}function Cy(e,t){return Cb(t,Cg(e),Cx(e))}var Cv=(e,t)=>{var r,a=Number(t);if(!bO(a)&&null!=t)return a>=0?null==e||null==(r=e[a])?void 0:r.value:void 0};function Cw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Ck(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Cw(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Cj=(e,t,r,a)=>{if(null==t)return yR;var n,s,i,o=(n=e,s=t,i=r,"axis"===s?"click"===i?n.axisInteraction.click:n.axisInteraction.hover:"click"===i?n.itemInteraction.click:n.itemInteraction.hover);if(null==o)return yR;if(o.active)return o;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&null!=e.syncInteraction.index)return e.syncInteraction;var l=!0===e.settings.active;if(null!=o.index){if(l)return Ck(Ck({},o),{},{active:!0})}else if(null!=a)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return Ck(Ck({},yR),{},{coordinate:o.coordinate})},CN=(e,t,r,a)=>{var n=null==e?void 0:e.index;if(null==n)return null;var s=Number(n);if(!vK(s))return n;var i=Infinity;t.length>0&&(i=t.length-1);var o=Math.max(0,Math.min(s,i)),l=t[o];return null==l?String(o):!function(e,t,r){if(null==r||null==t)return!0;var a=vg(e,t);return!(null!=a&&N4(r))||function(e,t){var r=function(e){if("number"==typeof e)return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}(e),a=t[0],n=t[1];if(void 0===r)return!1;var s=Math.min(a,n),i=Math.max(a,n);return r>=s&&r<=i}(a,r)}(l,r,a)?null:String(o)},CS=(e,t,r,a,n,s,i,o)=>{if(null!=s&&null!=o){var l=i[0],c=null==l?void 0:o(l.positions,s);if(null!=c)return c;var d=null==n?void 0:n[Number(s)];if(d)if("horizontal"===r)return{x:d.coordinate,y:(a.top+t)/2};else return{x:(a.left+e)/2,y:d.coordinate}}},CE=(e,t,r,a)=>{var n;return"axis"===t?e.tooltipItemPayloads:0===e.tooltipItemPayloads.length?[]:null==(n="hover"===r?e.itemInteraction.hover.dataKey:e.itemInteraction.click.dataKey)&&null!=a?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(e=>{var t;return(null==(t=e.settings)?void 0:t.dataKey)===n})},CC=e=>e.options.tooltipPayloadSearcher,CT=e=>e.tooltip;function CA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function C_(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?CA(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CA(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var CO=(e,t,r,a,n,s,i)=>{if(null!=t&&null!=s){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:d}=r;return e.reduce((e,r)=>{var u,h,f,{dataDefinedOnItem:p,settings:m}=r,g=null!=p?p:o,x=Array.isArray(g)?vf(g,c,d):g,b=null!=(u=null==m?void 0:m.dataKey)?u:a,y=null==m?void 0:m.nameKey;return Array.isArray(h=a&&Array.isArray(x)&&!Array.isArray(x[0])&&"axis"===i?function(e,t,r){if(e&&e.length)return e.find(e=>e&&("function"==typeof t?t(e):(0,bA.default)(e,t))===r)}(x,a,n):s(x,t,l,y))?h.forEach(t=>{var r=C_(C_({},m),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(vk({tooltipEntrySettings:r,dataKey:t.dataKey,payload:t.payload,value:vg(t.payload,t.dataKey),name:t.name}))}):e.push(vk({tooltipEntrySettings:m,dataKey:b,payload:h,value:vg(h,b),name:null!=(f=vg(h,y))?f:null==m?void 0:m.name})),e},[])}},CP=xM([Em,v8,S8,Sm,SK],EY),CD=xM([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),CR=xM([SK,SX],S7),CM=xM([CD,Em,CR],Ee,{memoizeOptions:{resultEqualityCheck:SG}}),CI=xM([CM],e=>e.filter(SW)),CL=xM([CM],Es,{memoizeOptions:{resultEqualityCheck:SG}}),CF=xM([CL,N1],Eo),CB=xM([CI,N1,Em],SH),CU=xM([CF,Em,CM],Ec),Cz=xM([Em],Ek),CV=xM([Em],e=>e.allowDataOverflow),C$=xM([Cz,CV],N6),CH=xM([CM],e=>e.filter(SW)),CW=xM([CB,CH,Sf,Sp],Eb),Cq=xM([CW,N1,SK,C$],Ev),CG=xM([CM],Ea),CK=xM([CF,Em,CG,EE,SK],ET,{memoizeOptions:{resultEqualityCheck:Sq}}),CX=xM([EO,SK,SX],EP),CY=xM([CX,SK],EF),CQ=xM([ER,SK,SX],EP),CJ=xM([CQ,SK],EU),CZ=xM([EI,SK,SX],EP),C0=xM([CZ,SK],EV),C1=xM([CY,C0,CJ],EC),C2=xM([Em,Cz,C$,Cq,CK,C1,v8,SK],EW),C5=xM([Em,v8,CF,CU,Sf,SK,C2],EK),C4=xM([C5,Em,CP],EZ),C3=xM([Em,C5,C4,SK],E1),C6=e=>{var t=SK(e),r=SX(e);return E9(e,t,r,!1)},C8=xM([Em,C6],SC),C7=xM([Em,CP,C3,C8],EJ),C9=xM([v8,CU,Em,SK],Cd),Te=xM([v8,CU,Em,SK],Ch),Tt=xM([v8,Em,CP,C7,C6,C9,Te,SK],(e,t,r,a,n,s,i,o)=>{if(t){var{type:l}=t,c=vx(e,o);if(a){var d="scaleBand"===r&&a.bandwidth?a.bandwidth()/2:2,u="category"===l&&a.bandwidth?a.bandwidth()/d:0;return(u="angleAxis"===o&&null!=n&&(null==n?void 0:n.length)>=2?2*b_(n[0]-n[1])*u:u,c&&i)?i.map((e,t)=>({coordinate:a(e)+u,value:e,index:t,offset:u})):a.domain().map((e,t)=>({coordinate:a(e)+u,value:s?s[e]:e,index:t,offset:u}))}}}),Tr=xM([Cg,Cx,e=>e.tooltip.settings],(e,t,r)=>Cb(r.shared,e,t)),Ta=e=>e.tooltip.settings.trigger,Tn=e=>e.tooltip.settings.defaultIndex,Ts=xM([CT,Tr,Ta,Tn],Cj),Ti=xM([Ts,CF,Eg,C5],CN),To=xM([Tt,Ti],Cv),Tl=xM([Ts],e=>{if(e)return e.dataKey}),Tc=xM([CT,Tr,Ta,Tn],CE),Td=xM([vN,vS,v8,vR,Tt,Tn,Tc,CC],CS),Tu=xM([Ts,Td],(e,t)=>null!=e&&e.coordinate?e.coordinate:t),Th=xM([Ts],e=>e.active),Tf=xM([Tc,Ti,N1,Eg,To,CC,Tr],CO);function Tp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Tm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tp(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tp(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}xM([Tf],e=>{if(null!=e)return Array.from(new Set(e.map(e=>e.payload).filter(e=>null!=e)))});var Tg=(e,t,r,a,n)=>{var s,i=-1,o=null!=(s=null==t?void 0:t.length)?s:0;if(o<=1||null==e)return 0;if("angleAxis"===a&&null!=n&&1e-6>=Math.abs(Math.abs(n[1]-n[0])-360))for(var l=0;l<o;l++){var c=l>0?r[l-1].coordinate:r[o-1].coordinate,d=r[l].coordinate,u=l>=o-1?r[0].coordinate:r[l+1].coordinate,h=void 0;if(b_(d-c)!==b_(u-d)){var f=[];if(b_(u-d)===b_(n[1]-n[0])){h=u;var p=d+n[1]-n[0];f[0]=Math.min(p,(p+c)/2),f[1]=Math.max(p,(p+c)/2)}else{h=c;var m=u+n[1]-n[0];f[0]=Math.min(d,(m+d)/2),f[1]=Math.max(d,(m+d)/2)}var g=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>g[0]&&e<=g[1]||e>=f[0]&&e<=f[1]){({index:i}=r[l]);break}}else{var x=Math.min(c,u),b=Math.max(c,u);if(e>(x+d)/2&&e<=(b+d)/2){({index:i}=r[l]);break}}}else if(t){for(var y=0;y<o;y++)if(0===y&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y>0&&y<o-1&&e>(t[y].coordinate+t[y-1].coordinate)/2&&e<=(t[y].coordinate+t[y+1].coordinate)/2||y===o-1&&e>(t[y].coordinate+t[y-1].coordinate)/2){({index:i}=t[y]);break}}return i},Tx=(e,t)=>t,Tb=(e,t,r)=>r,Ty=(e,t,r,a)=>a,Tv=xM(Tt,e=>(0,vn.default)(e,e=>e.coordinate)),Tw=xM([CT,Tx,Tb,Ty],Cj),Tk=xM([Tw,CF,Eg,C5],CN),Tj=xM([CT,Tx,Tb,Ty],CE),TN=xM([vN,vS,v8,vR,Tt,Ty,Tj,CC],CS),TS=xM([Tw,TN],(e,t)=>{var r;return null!=(r=e.coordinate)?r:t}),TE=xM([Tt,Tk],Cv),TC=xM([Tj,Tk,N1,Eg,TE,CC,Tx],CO),TT=xM([Tw,Tk],(e,t)=>({isActive:e.active&&null!=t,activeIndex:t})),TA=xM([(e,t)=>t,v8,SU,SK,C8,Tt,Tv,vR],(e,t,r,a,n,s,i,o)=>{if(e&&t&&a&&n&&s){if("horizontal"===t||"vertical"===t){if(!e||!a||!n||!s)return;if(function(e,t){var{chartX:r,chartY:a}=e;return r>=t.left&&r<=t.left+t.width&&a>=t.top&&a<=t.top+t.height}(e,o)){var l=Tg("horizontal"===t?e.chartX:"vertical"===t?e.chartY:void 0,i,s,a,n),c=((e,t,r,a)=>{var n=t.find(e=>e&&e.index===r);if(n){if("horizontal"===e)return{x:n.coordinate,y:a.chartY};if("vertical"===e)return{x:a.chartX,y:n.coordinate}}return{x:0,y:0}})(t,s,l,e);return{activeIndex:String(l),activeCoordinate:c}}return}if(e&&a&&n&&s&&r){var d=((e,t)=>{var r,{chartX:a,chartY:n}=e,{radius:s,angle:i}=((e,t)=>{var{x:r,y:a}=e,{cx:n,cy:s}=t,i=((e,t)=>{var{x:r,y:a}=e,{x:n,y:s}=t;return Math.sqrt((r-n)**2+(a-s)**2)})({x:r,y:a},{x:n,y:s});if(i<=0)return{radius:i,angle:0};var o=Math.acos((r-n)/i);return a>s&&(o=2*Math.PI-o),{radius:i,angle:180*o/Math.PI,angleInRadian:o}})({x:a,y:n},t),{innerRadius:o,outerRadius:l}=t;if(s<o||s>l||0===s)return null;var{startAngle:c,endAngle:d}=(e=>{var{startAngle:t,endAngle:r}=e,a=Math.min(Math.floor(t/360),Math.floor(r/360));return{startAngle:t-360*a,endAngle:r-360*a}})(t),u=i;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;r=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;r=u>=d&&u<=c}return r?Sv(Sv({},t),{},{radius:s,angle:((e,t)=>{var{startAngle:r,endAngle:a}=t;return e+360*Math.min(Math.floor(r/360),Math.floor(a/360))})(u,t)}):null})(e,r);if(d){var u=Tg("centric"===t?d.angle:d.radius,i,s,a,n),h=((e,t,r,a)=>{var n=t.find(e=>e&&e.index===r);if(n){if("centric"===e){var s=n.coordinate,{radius:i}=a;return Tm(Tm(Tm({},a),Sk(a.cx,a.cy,i,s)),{},{angle:s,radius:i})}var o=n.coordinate,{angle:l}=a;return Tm(Tm(Tm({},a),Sk(a.cx,a.cy,o,l)),{},{angle:l,radius:o})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}})(t,s,u,d);return{activeIndex:String(u),activeCoordinate:h}}return}}}),T_=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/a)}},TO=xK("mouseClick"),TP=bC();TP.startListening({actionCreator:TO,effect:(e,t)=>{var r=e.payload,a=TA(t.getState(),T_(r));(null==a?void 0:a.activeIndex)!=null&&t.dispatch(yW({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var TD=xK("mouseMove"),TR=bC(),TM=null;function TI(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":"children"===e&&"object"==typeof t&&null!==t?"<<CHILDREN>>":t}function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function TF(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}TR.startListening({actionCreator:TD,effect:(e,t)=>{var r=e.payload;null!==TM&&cancelAnimationFrame(TM);var a=T_(r);TM=requestAnimationFrame(()=>{var e=t.getState();if("axis"===Cy(e,e.tooltip.settings.shared)){var r=TA(e,a);(null==r?void 0:r.activeIndex)!=null?t.dispatch(yH({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate})):t.dispatch(yV())}TM=null})}});var TB=x3({name:"cartesianAxis",initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:xZ()},replaceXAxis:{reducer(e,t){var{prev:r,next:a}=t.payload;void 0!==e.xAxis[r.id]&&(r.id!==a.id&&delete e.xAxis[r.id],e.xAxis[a.id]=a)},prepare:xZ()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:xZ()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:xZ()},replaceYAxis:{reducer(e,t){var{prev:r,next:a}=t.payload;void 0!==e.yAxis[r.id]&&(r.id!==a.id&&delete e.yAxis[r.id],e.yAxis[a.id]=a)},prepare:xZ()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:xZ()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:xZ()},replaceZAxis:{reducer(e,t){var{prev:r,next:a}=t.payload;void 0!==e.zAxis[r.id]&&(r.id!==a.id&&delete e.zAxis[r.id],e.zAxis[a.id]=a)},prepare:xZ()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:xZ()},updateYAxisWidth(e,t){var{id:r,width:a}=t.payload,n=e.yAxis[r];if(n){var s=n.widthHistory||[];if(3===s.length&&s[0]===s[2]&&a===s[1]&&a!==n.width&&1>=Math.abs(a-s[0]))return;var i=[...s,a].slice(-3);e.yAxis[r]=TF(TF({},e.yAxis[r]),{},{width:a,widthHistory:i})}}}}),{addXAxis:TU,replaceXAxis:Tz,removeXAxis:TV,addYAxis:T$,replaceYAxis:TH,removeYAxis:TW,addZAxis:Tq,replaceZAxis:TG,removeZAxis:TK,updateYAxisWidth:TX}=TB.actions,TY=TB.reducer,TQ=x3({name:"graphicalItems",initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:xZ()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:a}=t.payload,n=xg(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=a)},prepare:xZ()},removeCartesianGraphicalItem:{reducer(e,t){var r=xg(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:xZ()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:xZ()},removePolarGraphicalItem:{reducer(e,t){var r=xg(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:xZ()}}}),{addCartesianGraphicalItem:TJ,replaceCartesianGraphicalItem:TZ,removeCartesianGraphicalItem:T0,addPolarGraphicalItem:T1,removePolarGraphicalItem:T2}=TQ.actions,T5=TQ.reducer,T4=x3({name:"referenceElements",initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=xg(e).dots.findIndex(e=>e===t.payload);-1!==r&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=xg(e).areas.findIndex(e=>e===t.payload);-1!==r&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=xg(e).lines.findIndex(e=>e===t.payload);-1!==r&&e.lines.splice(r,1)}}}),{addDot:T3,removeDot:T6,addArea:T8,removeArea:T7,addLine:T9,removeLine:Ae}=T4.actions,At=T4.reducer,Ar={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},Aa=x3({name:"brush",initialState:Ar,reducers:{setBrushSettings:(e,t)=>null==t.payload?Ar:t.payload}}),{setBrushSettings:An}=Aa.actions,As=Aa.reducer,Ai=x3({name:"legend",initialState:{settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:xZ()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:a}=t.payload,n=xg(e).payload.indexOf(r);n>-1&&(e.payload[n]=a)},prepare:xZ()},removeLegendPayload:{reducer(e,t){var r=xg(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:xZ()}}}),{setLegendSize:Ao,setLegendSettings:Al,addLegendPayload:Ac,replaceLegendPayload:Ad,removeLegendPayload:Au}=Ai.actions,Ah=Ai.reducer,Af={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Ap=x3({name:"rootProps",initialState:Af,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=null!=(r=t.payload.barGap)?r:Af.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),Am=Ap.reducer,{updateOptions:Ag}=Ap.actions,Ax=x3({name:"polarAxis",initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Ab,removeRadiusAxis:Ay,addAngleAxis:Av,removeAngleAxis:Aw}=Ax.actions,Ak=Ax.reducer,Aj=x3({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:AN}=Aj.actions,AS=Aj.reducer,AE=xK("keyDown"),AC=xK("focus"),AT=bC();AT.startListening({actionCreator:AE,effect:(e,t)=>{var r=t.getState();if(!1===r.rootProps.accessibilityLayer)return;var{keyboardInteraction:a}=r.tooltip,n=e.payload;if("ArrowRight"===n||"ArrowLeft"===n||"Enter"===n){var s=CN(a,CF(r),Eg(r),C5(r)),i=null==s?-1:Number(s);if(Number.isFinite(i)&&!(i<0)){var o=Tt(r);if("Enter"===n){var l=TN(r,"axis","hover",String(a.index));t.dispatch(yG({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:l}));return}var c=i+("ArrowRight"===n?1:-1)*("left-to-right"===Cm(r)?1:-1);if(null!=o&&!(c>=o.length)&&!(c<0)){var d=TN(r,"axis","hover",String(c));t.dispatch(yG({active:!0,activeIndex:c.toString(),activeDataKey:void 0,activeCoordinate:d}))}}}}}),AT.startListening({actionCreator:AC,effect:(e,t)=>{var r=t.getState();if(!1!==r.rootProps.accessibilityLayer){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&null==a.index){var n=TN(r,"axis","hover",String("0"));t.dispatch(yG({activeDataKey:void 0,active:!0,activeIndex:"0",activeCoordinate:n}))}}}});var AA=xK("externalEvent"),A_=bC(),AO=new Map;A_.startListening({actionCreator:AA,effect:(e,t)=>{var{handler:r,reactEvent:a}=e.payload;if(null!=r){a.persist();var n=a.type,s=AO.get(n);void 0!==s&&cancelAnimationFrame(s);var i=requestAnimationFrame(()=>{try{var e=t.getState(),s={activeCoordinate:Tu(e),activeDataKey:Tl(e),activeIndex:Ti(e),activeLabel:To(e),activeTooltipIndex:Ti(e),isTooltipActive:Th(e)};r(s,a)}finally{AO.delete(n)}});AO.set(n,i)}}});var AP=xM([CT],e=>e.tooltipItemPayloads),AD=xM([AP,CC,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,a)=>{var n=e.find(e=>e.settings.dataKey===a);if(null!=n){var{positions:s}=n;if(null!=s)return t(s,r)}}),AR=xK("touchMove"),AM=bC();AM.startListening({actionCreator:AR,effect:(e,t)=>{var r=e.payload;if(null!=r.touches&&0!==r.touches.length){var a=t.getState(),n=Cy(a,a.tooltip.settings.shared);if("axis"===n){var s=TA(a,T_({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(null==s?void 0:s.activeIndex)!=null&&t.dispatch(yH({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if("item"===n){var i,o=r.touches[0];if(null==document.elementFromPoint)return;var l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(v_),d=null!=(i=l.getAttribute(vO))?i:void 0,u=AD(t.getState(),c,d);t.dispatch(yU({activeDataKey:d,activeIndex:c,activeCoordinate:u}))}}}});var AI=x3({name:"errorBars",initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]||(e[r]=[]),e[r].push(a)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:a,next:n}=t.payload;e[r]&&(e[r]=e[r].map(e=>e.dataKey===a.dataKey&&e.direction===a.direction?n:e))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]&&(e[r]=e[r].filter(e=>e.dataKey!==a.dataKey||e.direction!==a.direction))}}}),{addErrorBar:AL,replaceErrorBar:AF,removeErrorBar:AB}=AI.actions,AU=AI.reducer,Az={devToolsEnabled:!1,isSsr:!("undefined"!=typeof window&&window.document&&window.document.createElement&&window.setTimeout)};function AV(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function A$(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?AV(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AV(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var AH={zIndexMap:Object.values(SN).reduce((e,t)=>A$(A$({},e),{},{[t]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),{})},AW=new Set(Object.values(SN)),Aq=x3({name:"zIndex",initialState:AH,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:xZ()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!AW.has(r)&&delete e.zIndexMap[r])},prepare:xZ()},registerZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r,elementId:a,isPanorama:n}=t.payload;e.zIndexMap[r]?n?e.zIndexMap[r].panoramaElementId=a:e.zIndexMap[r].elementId=a:e.zIndexMap[r]={consumers:0,elementId:n?void 0:a,panoramaElementId:n?a:void 0}},prepare:xZ()},unregisterZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElementId=void 0:e.zIndexMap[r].elementId=void 0)},prepare:xZ()}}}),{registerZIndexPortal:AG,unregisterZIndexPortal:AK,registerZIndexPortalId:AX,unregisterZIndexPortalId:AY}=Aq.actions,AQ=xV({brush:As,cartesianAxis:TY,chartData:yZ,errorBars:AU,graphicalItems:T5,layout:y3,legend:Ah,options:bW,polarAxis:Ak,polarOptions:AS,referenceElements:At,rootProps:Am,tooltip:yK,zIndex:Aq.reducer}),AJ=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Chart";return function(e){let t,r,a,n=function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:a=!0,actionCreatorCheck:n=!0}=e??{},s=new xX;return t&&("boolean"==typeof t?s.push(xq):s.push(xW(t.extraArgument))),s},{reducer:s,middleware:i,devTools:o=!0,duplicateMiddlewareCheck:l=!0,preloadedState:c,enhancers:d}=e||{};if("function"==typeof s)t=s;else if(xz(s))t=xV(s);else throw Error(bT(1));r="function"==typeof i?i(n):n();let u=x$;o&&(u=xG({trace:!1,..."object"==typeof o&&o}));let h=(a=function(...e){return t=>(r,a)=>{let n=t(r,a),s=()=>{throw Error(xL(15))},i={getState:n.getState,dispatch:(e,...t)=>s(e,...t)};return s=x$(...e.map(e=>e(i)))(n.dispatch),{...n,dispatch:s}}}(...r),function(e){let{autoBatch:t=!0}=e??{},r=new xX(a);return t&&r.push(x1("object"==typeof t?t:void 0)),r});return function e(t,r,a){if("function"!=typeof t)throw Error(xL(2));if("function"==typeof r&&"function"==typeof a||"function"==typeof a&&"function"==typeof arguments[3])throw Error(xL(0));if("function"==typeof r&&void 0===a&&(a=r,r=void 0),void 0!==a){if("function"!=typeof a)throw Error(xL(1));return a(e)(t,r)}let n=t,s=r,i=new Map,o=i,l=0,c=!1;function d(){o===i&&(o=new Map,i.forEach((e,t)=>{o.set(t,e)}))}function u(){if(c)throw Error(xL(3));return s}function h(e){if("function"!=typeof e)throw Error(xL(4));if(c)throw Error(xL(5));let t=!0;d();let r=l++;return o.set(r,e),function(){if(t){if(c)throw Error(xL(6));t=!1,d(),o.delete(r),i=null}}}function f(e){if(!xz(e))throw Error(xL(7));if(void 0===e.type)throw Error(xL(8));if("string"!=typeof e.type)throw Error(xL(17));if(c)throw Error(xL(9));try{c=!0,s=n(s,e)}finally{c=!1}return(i=o).forEach(e=>{e()}),e}return f({type:xU.INIT}),{dispatch:f,subscribe:h,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw Error(xL(10));n=e,f({type:xU.REPLACE})},[xF]:function(){return{subscribe(e){if("object"!=typeof e||null===e)throw Error(xL(11));function t(){e.next&&e.next(u())}return t(),{unsubscribe:h(t)}},[xF](){return this}}}}}(t,c,u(..."function"==typeof d?d(h):h()))}({reducer:AQ,preloadedState:e,middleware:e=>e({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes("es6")}).concat([TP.middleware,TR.middleware,AT.middleware,A_.middleware,AM.middleware]),enhancers:e=>{var t=e;return"function"==typeof e&&(t=e()),t.concat(x1({type:"raf"}))},devTools:Az.devToolsEnabled&&{serialize:{replacer:TI},name:"recharts-".concat(t)}})};function AZ(e){var{preloadedState:t,children:r,reduxStoreName:a}=e,n=vL(),s=(0,em.useRef)(null);return n?r:(null==s.current&&(s.current=AJ(t,a)),em.createElement(b1,{context:y8,store:s.current},r))}var A0=e=>{var{chartData:t}=e,r=y9(),a=vL();return(0,em.useEffect)(()=>a?()=>{}:(r(yY(t)),()=>{r(yY(void 0))}),[t,r,a]),null},A1=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle"]),A2=(0,em.memo)(function(e){var{layout:t,margin:r}=e,a=y9(),n=vL();return(0,em.useEffect)(()=>{n||(a(y2(t)),a(y1(r)))},[a,n,t,r]),null},function(e,t){for(var r of new Set([...Object.keys(e),...Object.keys(t)]))if(A1.has(r)){if(null==e[r]&&null==t[r])continue;if(!function(e,t){if(bQ(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!bQ(e[r[a]],t[r[a]]))return!1;return!0}(e[r],t[r]))return!1}else{var a,n;if(a=e[r],n=t[r],(null!=a||null!=n)&&("number"==typeof a&&"number"==typeof n?a!==n&&(a==a||n==n):a!==n))return!1}return!0});function A5(e){var t=y9();return(0,em.useEffect)(()=>{t(Ag(e))},[t,e]),null}function A4(e){var t=y9();return(0,em.useEffect)(()=>{t(AN(e))},[t,e]),null}var A3=()=>{var e;return null==(e=va(e=>e.rootProps.accessibilityLayer))||e},A6=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function A8(e){return"string"==typeof e&&A6.includes(e)}var A7=new Set(["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"]);function A9(e){return"string"==typeof e&&A7.has(e)}function _e(e){return"string"==typeof e&&e.startsWith("data-")}function _t(e){if("object"!=typeof e||null===e)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(A9(r)||_e(r))&&(t[r]=e[r]);return t}function _r(e){return null==e?null:(0,em.isValidElement)(e)&&"object"==typeof e.props&&null!==e.props?_t(e.props):"object"!=typeof e||Array.isArray(e)?null:_t(e)}function _a(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(A9(r)||_e(r)||A8(r))&&(t[r]=e[r]);return t}var _n=["children","width","height","viewBox","className","style","title","desc"];function _s(){return(_s=Object.assign.bind()).apply(null,arguments)}var _i=(0,em.forwardRef)((e,t)=>{var{children:r,width:a,height:n,viewBox:s,className:i,style:o,title:l,desc:c}=e,d=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,_n),u=s||{width:a,height:n,x:0,y:0},h=(0,vU.clsx)("recharts-surface",i);return em.createElement("svg",_s({},_a(d),{className:h,width:a,height:n,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height),ref:t}),em.createElement("title",null,l),em.createElement("desc",null,c),r)}),_o=null!=(ef=em["useId".toString()])?ef:()=>{var[e]=em.useState(()=>bI("uid-"));return e};function _l(e,t){var r=_o();return t||(e?"".concat(e,"-").concat(r):r)}var _c=xM(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(null!=t){var a=e[t];if(null!=a)return r?a.panoramaElementId:a.elementId}}),_d=xM(e=>e.zIndex.zIndexMap,e=>Array.from(new Set(Object.keys(e).map(e=>parseInt(e,10)).concat(Object.values(SN)))).sort((e,t)=>e-t),{memoizeOptions:{resultEqualityCheck:function(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}}});function _u(e){var{zIndex:t,isPanorama:r}=e,a=r?"recharts-zindex-panorama-":"recharts-zindex-",n=_l("".concat(a).concat(t)),s=y9();return(0,em.useLayoutEffect)(()=>(s(AX({zIndex:t,elementId:n,isPanorama:r})),()=>{s(AY({zIndex:t,isPanorama:r}))}),[s,t,n,r]),em.createElement("g",{id:n})}function _h(e){var{children:t,isPanorama:r}=e,a=va(_d);if(!a||0===a.length)return t;var n=a.filter(e=>e<0),s=a.filter(e=>e>0);return em.createElement(em.Fragment,null,n.map(e=>em.createElement(_u,{key:e,zIndex:e,isPanorama:r})),t,s.map(e=>em.createElement(_u,{key:e,zIndex:e,isPanorama:r})))}var _f=["children"];function _p(){return(_p=Object.assign.bind()).apply(null,arguments)}var _m={width:"100%",height:"100%",display:"block"},_g=(0,em.forwardRef)((e,t)=>{var r,a,n=va(vN),s=va(vS),i=A3();if(!vX(n)||!vX(s))return null;var{children:o,otherAttributes:l,title:c,desc:d}=e;return null!=l&&(r="number"==typeof l.tabIndex?l.tabIndex:i?0:void 0,a="string"==typeof l.role?l.role:i?"application":void 0),em.createElement(_i,_p({},l,{title:c,desc:d,role:a,tabIndex:r,width:n,height:s,style:_m,ref:t}),o)}),_x=e=>{var{children:t}=e,r=va(vB);if(!r)return null;var{width:a,height:n,y:s,x:i}=r;return em.createElement(_i,{width:a,height:n,x:i,y:s},t)},_b=(0,em.forwardRef)((e,t)=>{var{children:r}=e,a=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,_f);return vL()?em.createElement(_x,null,em.createElement(_h,{isPanorama:!0},r)):em.createElement(_g,_p({ref:t},a),em.createElement(_h,{isPanorama:!1},r))}),_y=new(e.i(65417)).default,_v="recharts.syncEvent.tooltip",_w="recharts.syncEvent.brush";function _k(e){return e.tooltip.syncInteraction}var _j=["x","y"];function _N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_N(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_N(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var _E=(0,em.createContext)(null),_C=(0,em.createContext)(null);function _T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _A(){return(_A=Object.assign.bind()).apply(null,arguments)}var __=()=>{var e,t,r,a,n,s,i,o,l,c,d,u;return e=y9(),(0,em.useEffect)(()=>{e(bq())},[e]),t=va(Sg),r=va(Sb),a=y9(),n=va(Sx),s=va(Tt),i=va(v8),o=v3(),l=va(e=>e.rootProps.className),(0,em.useEffect)(()=>{if(null==t)return bV;var e=(e,l,c)=>{if(r!==c&&t===e){if("index"===n){if(o&&null!=l&&null!=(d=l.payload)&&d.coordinate&&l.payload.sourceViewBox){var d,u,h=l.payload.coordinate,{x:f,y:p}=h,m=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(h,_j),{x:g,y:x,width:b,height:y}=l.payload.sourceViewBox,v=_S(_S({},m),{},{x:o.x+(b?(f-g)/b:0)*o.width,y:o.y+(y?(p-x)/y:0)*o.height});a(_S(_S({},l),{},{payload:_S(_S({},l.payload),{},{coordinate:v})}))}else a(l);return}if(null!=s){if("function"==typeof n){var w=n(s,{activeTooltipIndex:null==l.payload.index?void 0:Number(l.payload.index),isTooltipActive:l.payload.active,activeIndex:null==l.payload.index?void 0:Number(l.payload.index),activeLabel:l.payload.label,activeDataKey:l.payload.dataKey,activeCoordinate:l.payload.coordinate});u=s[w]}else"value"===n&&(u=s.find(e=>String(e.value)===l.payload.label));var{coordinate:k}=l.payload;if(null==u||!1===l.payload.active||null==k||null==o)return void a(yq({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));var{x:j,y:N}=k,S=Math.min(j,o.x+o.width),E=Math.min(N,o.y+o.height),C={x:"horizontal"===i?u.coordinate:S,y:"horizontal"===i?E:u.coordinate};a(yq({active:l.payload.active,coordinate:C,dataKey:l.payload.dataKey,index:String(u.index),label:l.payload.label,sourceViewBox:l.payload.sourceViewBox}))}}};return _y.on(_v,e),()=>{_y.off(_v,e)}},[l,a,r,t,n,s,i,o]),c=va(Sg),d=va(Sb),u=y9(),(0,em.useEffect)(()=>{if(null==c)return bV;var e=(e,t,r)=>{d!==r&&c===e&&u(yQ(t))};return _y.on(_w,e),()=>{_y.off(_w,e)}},[u,d,c]),null};function _O(e){if("number"==typeof e)return e;if("string"==typeof e){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var _P=(0,em.forwardRef)((e,t)=>{var r,a,n=(0,em.useRef)(null),[s,i]=(0,em.useState)({containerWidth:_O(null==(r=e.style)?void 0:r.width),containerHeight:_O(null==(a=e.style)?void 0:a.height)}),o=(0,em.useCallback)((e,t)=>{i(r=>{var a=Math.round(e),n=Math.round(t);return r.containerWidth===a&&r.containerHeight===n?r:{containerWidth:a,containerHeight:n}})},[]),l=(0,em.useCallback)(e=>{if("function"==typeof t&&t(e),null!=e&&"undefined"!=typeof ResizeObserver){var{width:r,height:a}=e.getBoundingClientRect();o(r,a);var s=new ResizeObserver(e=>{var{width:t,height:r}=e[0].contentRect;o(t,r)});s.observe(e),n.current=s}},[t,o]);return(0,em.useEffect)(()=>()=>{var e=n.current;null!=e&&e.disconnect()},[o]),em.createElement(em.Fragment,null,em.createElement(v7,{width:s.containerWidth,height:s.containerHeight}),em.createElement("div",_A({ref:l},e)))}),_D=(0,em.forwardRef)((e,t)=>{var{width:r,height:a}=e,[n,s]=(0,em.useState)({containerWidth:_O(r),containerHeight:_O(a)}),i=(0,em.useCallback)((e,t)=>{s(r=>{var a=Math.round(e),n=Math.round(t);return r.containerWidth===a&&r.containerHeight===n?r:{containerWidth:a,containerHeight:n}})},[]),o=(0,em.useCallback)(e=>{if("function"==typeof t&&t(e),null!=e){var{width:r,height:a}=e.getBoundingClientRect();i(r,a)}},[t,i]);return em.createElement(em.Fragment,null,em.createElement(v7,{width:n.containerWidth,height:n.containerHeight}),em.createElement("div",_A({ref:o},e)))}),_R=(0,em.forwardRef)((e,t)=>{var{width:r,height:a}=e;return em.createElement(em.Fragment,null,em.createElement(v7,{width:r,height:a}),em.createElement("div",_A({ref:t},e)))}),_M=(0,em.forwardRef)((e,t)=>{var{width:r,height:a}=e;return bP(r)||bP(a)?em.createElement(_D,_A({},e,{ref:t})):em.createElement(_R,_A({},e,{ref:t}))}),_I=(0,em.forwardRef)((e,t)=>{var{children:r,className:a,height:n,onClick:s,onContextMenu:i,onDoubleClick:o,onMouseDown:l,onMouseEnter:c,onMouseLeave:d,onMouseMove:u,onMouseUp:h,onTouchEnd:f,onTouchMove:p,onTouchStart:m,style:g,width:x,responsive:b,dispatchTouchEvents:y=!0}=e,v=(0,em.useRef)(null),w=y9(),[k,j]=(0,em.useState)(null),[N,S]=(0,em.useState)(null),E=function(){var e=y9(),[t,r]=(0,em.useState)(null),a=va(vE);return(0,em.useEffect)(()=>{if(null!=t){var r=t.getBoundingClientRect().width/t.offsetWidth;vK(r)&&r!==a&&e(y4(r))}},[t,e,a]),r}(),C=v1(),T=(null==C?void 0:C.width)>0?C.width:x,A=(null==C?void 0:C.height)>0?C.height:n,_=(0,em.useCallback)(e=>{E(e),"function"==typeof t&&t(e),j(e),S(e),null!=e&&(v.current=e)},[E,t,j,S]),O=(0,em.useCallback)(e=>{w(TO(e)),w(AA({handler:s,reactEvent:e}))},[w,s]),P=(0,em.useCallback)(e=>{w(TD(e)),w(AA({handler:c,reactEvent:e}))},[w,c]),D=(0,em.useCallback)(e=>{w(yV()),w(AA({handler:d,reactEvent:e}))},[w,d]),R=(0,em.useCallback)(e=>{w(TD(e)),w(AA({handler:u,reactEvent:e}))},[w,u]),M=(0,em.useCallback)(()=>{w(AC())},[w]),I=(0,em.useCallback)(e=>{w(AE(e.key))},[w]),L=(0,em.useCallback)(e=>{w(AA({handler:i,reactEvent:e}))},[w,i]),F=(0,em.useCallback)(e=>{w(AA({handler:o,reactEvent:e}))},[w,o]),B=(0,em.useCallback)(e=>{w(AA({handler:l,reactEvent:e}))},[w,l]),U=(0,em.useCallback)(e=>{w(AA({handler:h,reactEvent:e}))},[w,h]),z=(0,em.useCallback)(e=>{w(AA({handler:m,reactEvent:e}))},[w,m]),V=(0,em.useCallback)(e=>{y&&w(AR(e)),w(AA({handler:p,reactEvent:e}))},[w,y,p]),H=(0,em.useCallback)(e=>{w(AA({handler:f,reactEvent:e}))},[w,f]);return em.createElement(_E.Provider,{value:k},em.createElement(_C.Provider,{value:N},em.createElement(!0===b?_P:_M,{width:null!=T?T:null==g?void 0:g.width,height:null!=A?A:null==g?void 0:g.height,className:(0,vU.clsx)("recharts-wrapper",a),style:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_T(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_T(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({position:"relative",cursor:"default",width:T,height:A},g),onClick:O,onContextMenu:L,onDoubleClick:F,onFocus:M,onKeyDown:I,onMouseDown:B,onMouseEnter:P,onMouseLeave:D,onMouseMove:R,onMouseUp:U,onTouchEnd:H,onTouchMove:V,onTouchStart:z,ref:_},em.createElement(__,null),r)))}),_L=xM([vR],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),_F=xM([_L,vN,vS],(e,t,r)=>{if(e&&null!=t&&null!=r)return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),_B=(0,em.createContext)(void 0),_U=e=>{var{children:t}=e,[r]=(0,em.useState)("".concat(bI("recharts"),"-clip")),a=va(_F);if(null==a)return null;var{x:n,y:s,width:i,height:o}=a;return em.createElement(_B.Provider,{value:r},em.createElement("defs",null,em.createElement("clipPath",{id:r},em.createElement("rect",{x:n,y:s,height:o,width:i}))),t)},_z=["width","height","responsive","children","className","style","compact","title","desc"],_V=(0,em.forwardRef)((e,t)=>{var{width:r,height:a,responsive:n,children:s,className:i,style:o,compact:l,title:c,desc:d}=e,u=_t(function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,_z));return l?em.createElement(em.Fragment,null,em.createElement(v7,{width:r,height:a}),em.createElement(_b,{otherAttributes:u,title:c,desc:d},s)):em.createElement(_I,{className:i,style:o,width:r,height:a,responsive:null!=n&&n,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},em.createElement(_b,{otherAttributes:u,title:c,desc:d,ref:t},em.createElement(_U,null,s)))});function _$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _H(e,t){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_$(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_$(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e);return Object.keys(t).reduce((e,r)=>(void 0===e[r]&&void 0!==t[r]&&(e[r]=t[r]),e),r)}var _W=["layout"];function _q(){return(_q=Object.assign.bind()).apply(null,arguments)}var _G={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},_K=(0,em.forwardRef)(function(e,t){var r,a=_H(e.categoricalChartProps,_G),{layout:n}=a,s=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(a,_W),{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c}=e;return em.createElement(AZ,{preloadedState:{options:{chartName:i,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0}},reduxStoreName:null!=(r=a.id)?r:i},em.createElement(A0,{chartData:a.data}),em.createElement(A2,{layout:n,margin:a.margin}),em.createElement(A5,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),em.createElement(A4,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),em.createElement(_V,_q({},s,{ref:t})))}),_X=["item"],_Y={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},_Q=(0,em.forwardRef)((e,t)=>{var r=_H(e,_Y);return em.createElement(_K,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:_X,tooltipPayloadSearcher:b$,categoricalChartProps:r,ref:t})}),_J=e=>e.graphicalItems.polarItems,_Z=xM([Sz,SV],S7),_0=xM([_J,S3,_Z],Ee),_1=xM([_0],Es),_2=xM([_1,N2],Eo),_5=xM([_2,S3,_0],Ec);xM([_2,S3,_0],(e,t,r)=>r.length>0?e.flatMap(e=>r.flatMap(r=>{var a;return{value:vg(e,null!=(a=t.dataKey)?a:r.dataKey),errorDomain:[]}})).filter(Boolean):(null==t?void 0:t.dataKey)!=null?e.map(e=>({value:vg(e,t.dataKey),errorDomain:[]})):e.map(e=>({value:e,errorDomain:[]})));var _4=()=>void 0,_3=xM([_2,S3,_0,EE,Sz],ET),_6=xM([S3,Ej,EN,_4,_3,_4,v8,Sz],EW),_8=xM([S3,v8,_2,_5,Sf,Sz,_6],EK),_7=xM([_8,S3,EQ],EZ);function _9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_9(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_9(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}xM([S3,_8,_7,Sz],E1);var Ot=xM([_J,(e,t)=>t],(e,t)=>e.filter(e=>"pie"===e.type).find(e=>e.id===t)),Or=[],Oa=(e,t,r)=>(null==r?void 0:r.length)===0?Or:r,On=xM([N2,Ot,Oa],(e,t,r)=>{var a,{chartData:n}=e;if(null!=t&&((a=(null==t?void 0:t.data)!=null&&t.data.length>0?t.data:n)&&a.length||null==r||(a=r.map(e=>Oe(Oe({},t.presentationProps),e.props))),null!=a))return a}),Os=xM([On,Ot,Oa],(e,t,r)=>{if(null!=e&&null!=t)return e.map((e,a)=>{var n,s,i=vg(e,t.nameKey,t.name);return s=null!=r&&null!=(n=r[a])&&null!=(n=n.props)&&n.fill?r[a].props.fill:"object"==typeof e&&null!=e&&"fill"in e?e.fill:t.fill,{value:vj(i,t.dataKey),color:s,payload:e,type:t.legendType}})}),Oi=xM([On,Ot,Oa,vR],(e,t,r,a)=>{if(null!=t&&null!=e)return function(e){var t,r,a,{pieSettings:n,displayedData:s,cells:i,offset:o}=e,{cornerRadius:l,startAngle:c,endAngle:d,dataKey:u,nameKey:h,tooltipType:f}=n,p=Math.abs(n.minAngle),m=b_(d-c)*Math.min(Math.abs(d-c),360),g=Math.abs(m),x=s.length<=1?0:null!=(t=n.paddingAngle)?t:0,b=s.filter(e=>0!==vg(e,u,0)).length,y=g-b*p-(g>=360?b:b-1)*x,v=s.reduce((e,t)=>{var r=vg(t,u,0);return e+(bD(r)?r:0)},0);return v>0&&(r=s.map((e,t)=>{var r,s=vg(e,u,0),d=vg(e,h,t),g=((e,t,r)=>{var a,{top:n,left:s,width:i,height:o}=t,l=Sj(i,o),c=s+bL(e.cx,i,i/2),d=n+bL(e.cy,o,o/2),u=bL(e.innerRadius,l,0);return{cx:c,cy:d,innerRadius:u,outerRadius:(a=e.outerRadius,"function"==typeof a?bL(a(r),l,.8*l):bL(a,l,.8*l)),maxRadius:e.maxRadius||Math.sqrt(i*i+o*o)/2}})(n,o,e),b=(bD(s)?s:0)/v,w=D6(D6({},e),i&&i[t]&&i[t].props),k=(r=t?a.endAngle+b_(m)*x*(0!==s):c)+b_(m)*((0!==s?p:0)+b*y),j=(r+k)/2,N=(g.innerRadius+g.outerRadius)/2,S=[{name:d,value:s,payload:w,dataKey:u,type:f}],E=Sk(g.cx,g.cy,N,j);return a=D6(D6(D6(D6({},n.presentationProps),{},{percent:b,cornerRadius:"string"==typeof l?parseFloat(l):l,name:d,tooltipPayload:S,midAngle:j,middleRadius:N,tooltipPosition:E},w),g),{},{value:s,startAngle:r,endAngle:k,payload:w,paddingAngle:b_(m)*x})})),r}({offset:a,pieSettings:t,displayedData:e,cells:r})}),Oo=["children","className"];function Ol(){return(Ol=Object.assign.bind()).apply(null,arguments)}var Oc=em.forwardRef((e,t)=>{var{children:r,className:a}=e,n=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,Oo),s=(0,vU.clsx)("recharts-layer",a);return em.createElement("g",Ol({className:s},_a(n),{ref:t}),r)});function Od(e){this._context=e}function Ou(e){return new Od(e)}Od.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};let Oh=Math.PI,Of=2*Oh,Op=Of-1e-6;function Om(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}class Og{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Om:function(e){let t=Math.floor(e);if(!(t>=0))throw Error(`invalid digits: ${e}`);if(t>15)return Om;let r=10**t;return function(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=Math.round(arguments[t]*r)/r+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,r,a){this._append`Q${+e},${+t},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(e,t,r,a,n,s){this._append`C${+e},${+t},${+r},${+a},${this._x1=+n},${this._y1=+s}`}arcTo(e,t,r,a,n){if(e*=1,t*=1,r*=1,a*=1,(n*=1)<0)throw Error(`negative radius: ${n}`);let s=this._x1,i=this._y1,o=r-e,l=a-t,c=s-e,d=i-t,u=c*c+d*d;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(u>1e-6)if(Math.abs(d*o-l*c)>1e-6&&n){let h=r-s,f=a-i,p=o*o+l*l,m=Math.sqrt(p),g=Math.sqrt(u),x=n*Math.tan((Oh-Math.acos((p+u-(h*h+f*f))/(2*m*g)))/2),b=x/g,y=x/m;Math.abs(b-1)>1e-6&&this._append`L${e+b*c},${t+b*d}`,this._append`A${n},${n},0,0,${+(d*h>c*f)},${this._x1=e+y*o},${this._y1=t+y*l}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,r,a,n,s){if(e*=1,t*=1,r*=1,s=!!s,r<0)throw Error(`negative radius: ${r}`);let i=r*Math.cos(a),o=r*Math.sin(a),l=e+i,c=t+o,d=1^s,u=s?a-n:n-a;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&this._append`L${l},${c}`,r&&(u<0&&(u=u%Of+Of),u>Op?this._append`A${r},${r},0,1,${d},${e-i},${t-o}A${r},${r},0,1,${d},${this._x1=l},${this._y1=c}`:u>1e-6&&this._append`A${r},${r},0,${+(u>=Oh)},${d},${this._x1=e+r*Math.cos(n)},${this._y1=t+r*Math.sin(n)}`)}rect(e,t,r,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${r*=1}v${+a}h${-r}Z`}toString(){return this._}}function Ox(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(null==r)t=null;else{let e=Math.floor(r);if(!(e>=0))throw RangeError(`invalid digits: ${r}`);t=e}return e},()=>new Og(t)}function Ob(e){return e[0]}function Oy(e){return e[1]}function Ov(e,t){var r=vl(!0),a=null,n=Ou,s=null,i=Ox(o);function o(o){var l,c,d,u=(o=vo(o)).length,h=!1;for(null==a&&(s=n(d=i())),l=0;l<=u;++l)!(l<u&&r(c=o[l],l,o))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(c,l,o),+t(c,l,o));if(d)return s=null,d+""||null}return e="function"==typeof e?e:void 0===e?Ob:vl(e),t="function"==typeof t?t:void 0===t?Oy:vl(t),o.x=function(t){return arguments.length?(e="function"==typeof t?t:vl(+t),o):e},o.y=function(e){return arguments.length?(t="function"==typeof e?e:vl(+e),o):t},o.defined=function(e){return arguments.length?(r="function"==typeof e?e:vl(!!e),o):r},o.curve=function(e){return arguments.length?(n=e,null!=a&&(s=n(a)),o):n},o.context=function(e){return arguments.length?(null==e?a=s=null:s=n(a=e),o):a},o}function Ow(e,t,r){var a=null,n=vl(!0),s=null,i=Ou,o=null,l=Ox(c);function c(c){var d,u,h,f,p,m=(c=vo(c)).length,g=!1,x=Array(m),b=Array(m);for(null==s&&(o=i(p=l())),d=0;d<=m;++d){if(!(d<m&&n(f=c[d],d,c))===g)if(g=!g)u=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),h=d-1;h>=u;--h)o.point(x[h],b[h]);o.lineEnd(),o.areaEnd()}g&&(x[d]=+e(f,d,c),b[d]=+t(f,d,c),o.point(a?+a(f,d,c):x[d],r?+r(f,d,c):b[d]))}if(p)return o=null,p+""||null}function d(){return Ov().defined(n).curve(i).context(s)}return e="function"==typeof e?e:void 0===e?Ob:vl(+e),t="function"==typeof t?t:void 0===t?vl(0):vl(+t),r="function"==typeof r?r:void 0===r?Oy:vl(+r),c.x=function(t){return arguments.length?(e="function"==typeof t?t:vl(+t),a=null,c):e},c.x0=function(t){return arguments.length?(e="function"==typeof t?t:vl(+t),c):e},c.x1=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:vl(+e),c):a},c.y=function(e){return arguments.length?(t="function"==typeof e?e:vl(+e),r=null,c):t},c.y0=function(e){return arguments.length?(t="function"==typeof e?e:vl(+e),c):t},c.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:vl(+e),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(a).y(t)},c.defined=function(e){return arguments.length?(n="function"==typeof e?e:vl(!!e),c):n},c.curve=function(e){return arguments.length?(i=e,null!=s&&(o=i(s)),c):i},c.context=function(e){return arguments.length?(null==e?s=o=null:o=i(s=e),c):s},c}function Ok(){}function Oj(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ON(e){this._context=e}function OS(e){this._context=e}function OE(e){this._context=e}Og.prototype,ON.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Oj(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Oj(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},OS.prototype={areaStart:Ok,areaEnd:Ok,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Oj(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},OE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:Oj(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class OC{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function OT(e){this._context=e}OT.prototype={areaStart:Ok,areaEnd:Ok,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e*=1,t*=1,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function OA(e,t,r){var a=e._x1-e._x0,n=t-e._x1,s=(e._y1-e._y0)/(a||n<0&&-0),i=(r-e._y1)/(n||a<0&&-0);return((s<0?-1:1)+(i<0?-1:1))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs((s*n+i*a)/(a+n)))||0}function O_(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function OO(e,t,r){var a=e._x0,n=e._y0,s=e._x1,i=e._y1,o=(s-a)/3;e._context.bezierCurveTo(a+o,n+o*t,s-o,i-o*r,s,i)}function OP(e){this._context=e}function OD(e){this._context=new OR(e)}function OR(e){this._context=e}function OM(e){this._context=e}function OI(e){var t,r,a=e.length-1,n=Array(a),s=Array(a),i=Array(a);for(n[0]=0,s[0]=2,i[0]=e[0]+2*e[1],t=1;t<a-1;++t)n[t]=1,s[t]=4,i[t]=4*e[t]+2*e[t+1];for(n[a-1]=2,s[a-1]=7,i[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)r=n[t]/s[t-1],s[t]-=r,i[t]-=r*i[t-1];for(n[a-1]=i[a-1]/s[a-1],t=a-2;t>=0;--t)n[t]=(i[t]-n[t+1])/s[t];for(t=0,s[a-1]=(e[a]+n[a-1])/2;t<a-1;++t)s[t]=2*e[t+1]-n[t+1];return[n,s]}function OL(e,t){this._context=e,this._t=t}OP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:OO(this,this._t0,O_(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(t*=1,(e*=1)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,OO(this,O_(this,r=OA(this,e,t)),r);break;default:OO(this,this._t0,r=OA(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}},(OD.prototype=Object.create(OP.prototype)).point=function(e,t){OP.prototype.point.call(this,t,e)},OR.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,n,s){this._context.bezierCurveTo(t,e,a,r,s,n)}},OM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===r)this._context.lineTo(e[1],t[1]);else for(var a=OI(e),n=OI(t),s=0,i=1;i<r;++s,++i)this._context.bezierCurveTo(a[0][s],n[0][s],a[1][s],n[1][s],e[i],t[i]);(this._line||0!==this._line&&1===r)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},OL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}}this._x=e,this._y=t}};var OF=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,OB=(e,t,r)=>{if(null===e||"object"!=typeof e&&"function"!=typeof e)return null;var a=null;return Object.keys(e).forEach(n=>{var s=e[n];A8(n)&&"function"==typeof s&&(a||(a={}),a[n]=e=>(s(t,r,e),null))}),a};function OU(){return(OU=Object.assign.bind()).apply(null,arguments)}function Oz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function OV(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oz(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oz(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var O$={curveBasisClosed:function(e){return new OS(e)},curveBasisOpen:function(e){return new OE(e)},curveBasis:function(e){return new ON(e)},curveBumpX:function(e){return new OC(e,!0)},curveBumpY:function(e){return new OC(e,!1)},curveLinearClosed:function(e){return new OT(e)},curveLinear:Ou,curveMonotoneX:function(e){return new OP(e)},curveMonotoneY:function(e){return new OD(e)},curveNatural:function(e){return new OM(e)},curveStep:function(e){return new OL(e,.5)},curveStepAfter:function(e){return new OL(e,1)},curveStepBefore:function(e){return new OL(e,0)}},OH=e=>vK(e.x)&&vK(e.y),OW=e=>null!=e.base&&OH(e.base)&&OH(e),Oq=e=>e.x,OG=e=>e.y,OK=e=>{var{className:t,points:r,path:a,pathRef:n}=e;if((!r||!r.length)&&!a)return null;var s=r&&r.length?(e=>{var{type:t="linear",points:r=[],baseLine:a,layout:n,connectNulls:s=!1}=e,i=((e,t)=>{if("function"==typeof e)return e;var r="curve".concat(bU(e));return("curveMonotone"===r||"curveBump"===r)&&t?O$["".concat(r).concat("vertical"===t?"Y":"X")]:O$[r]||Ou})(t,n),o=s?r.filter(OH):r;if(Array.isArray(a)){var l=r.map((e,t)=>OV(OV({},e),{},{base:a[t]}));return("vertical"===n?Ow().y(OG).x1(Oq).x0(e=>e.base.x):Ow().x(Oq).y1(OG).y0(e=>e.base.y)).defined(OW).curve(i)(s?l.filter(OW):l)}return("vertical"===n&&bD(a)?Ow().y(OG).x1(Oq).x0(a):bD(a)?Ow().x(Oq).y1(OG).y0(a):Ov().x(Oq).y(OG)).defined(OH).curve(i)(o)})(e):a;return em.createElement("path",OU({},_t(e),((e,t)=>{if(!e||"function"==typeof e||"boolean"==typeof e)return null;var r=e;if((0,em.isValidElement)(e)&&(r=e.props),"object"!=typeof r&&"function"!=typeof r)return null;var a={};return Object.keys(r).forEach(e=>{A8(e)&&(a[e]=t||(t=>r[e](r,t)))}),a})(e),{className:(0,vU.clsx)("recharts-curve",t),d:null===s?void 0:s,ref:n}))};function OX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var OY=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?OX(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OX(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},{cacheSize:2e3,enableCache:!0}),OQ=new class{constructor(e){!function(e,t,r){var a;(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(this,"cache",new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return void 0!==t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var r=this.cache.keys().next().value;null!=r&&this.cache.delete(r)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}(OY.cacheSize),OJ={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},OZ="recharts_measurement_span",O0=(e,t)=>{try{var r=document.getElementById(OZ);r||((r=document.createElement("span")).setAttribute("id",OZ),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,OJ,t),r.textContent="".concat(e);var a=r.getBoundingClientRect();return{width:a.width,height:a.height}}catch(e){return{width:0,height:0}}},O1=function(e){var t,r,a,n,s,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e||Az.isSsr)return{width:0,height:0};if(!OY.enableCache)return O0(e,o);var l=(t=o.fontSize||"",r=o.fontFamily||"",a=o.fontWeight||"",n=o.fontStyle||"",s=o.letterSpacing||"",i=o.textTransform||"","".concat(e,"|").concat(t,"|").concat(r,"|").concat(a,"|").concat(n,"|").concat(s,"|").concat(i)),c=OQ.get(l);if(c)return c;var d=O0(e,o);return OQ.set(l,d),d},O2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,O5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,O4=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,O3=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,O6={cm:96/2.54,mm:96/25.4,pt:96/72,pc:16,in:96,Q:96/101.6,px:1},O8=Object.keys(O6);class O7{static parse(e){var t,[,r,a]=null!=(t=O3.exec(e))?t:[];return new O7(parseFloat(r),null!=a?a:"")}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,bO(e)&&(this.unit=""),""===t||O4.test(t)||(this.num=NaN,this.unit=""),O8.includes(t)&&(this.num=e*O6[t],this.unit="px")}add(e){return this.unit!==e.unit?new O7(NaN,""):new O7(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new O7(NaN,""):new O7(this.num-e.num,this.unit)}multiply(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new O7(NaN,""):new O7(this.num*e.num,this.unit||e.unit)}divide(e){return""!==this.unit&&""!==e.unit&&this.unit!==e.unit?new O7(NaN,""):new O7(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return bO(this.num)}}function O9(e){if(e.includes("NaN"))return"NaN";for(var t=e;t.includes("*")||t.includes("/");){var r,[,a,n,s]=null!=(r=O2.exec(t))?r:[],i=O7.parse(null!=a?a:""),o=O7.parse(null!=s?s:""),l="*"===n?i.multiply(o):i.divide(o);if(l.isNaN())return"NaN";t=t.replace(O2,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,h]=null!=(c=O5.exec(t))?c:[],f=O7.parse(null!=d?d:""),p=O7.parse(null!=h?h:""),m="+"===u?f.add(p):f.subtract(p);if(m.isNaN())return"NaN";t=t.replace(O5,m.toString())}return t}var Pe=/\(([^()]*)\)/;function Pt(e){var t=function(e){try{var t;return t=e.replace(/\s+/g,""),t=function(e){for(var t,r=e;null!=(t=Pe.exec(r));){var[,a]=t;r=r.replace(Pe,O9(a))}return r}(t),t=O9(t)}catch(e){return"NaN"}}(e.slice(5,-1));return"NaN"===t?"":t}var Pr=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Pa=["dx","dy","angle","className","breakAll"];function Pn(){return(Pn=Object.assign.bind()).apply(null,arguments)}function Ps(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var Pi=/[ \f\n\r\t\v\u2028\u2029]+/,Po=e=>{var{children:t,breakAll:r,style:a}=e;try{var n=[];null!=t&&(n=r?t.toString().split(""):t.toString().split(Pi));var s=n.map(e=>({word:e,width:O1(e,a).width})),i=r?0:O1("",a).width;return{wordsWithComputedWidth:s,spaceWidth:i}}catch(e){return null}},Pl=(e,t,r,a)=>e.reduce((e,n)=>{var{word:s,width:i}=n,o=e[e.length-1];return o&&null!=i&&(null==t||a||o.width+i+r<Number(t))?(o.words.push(s),o.width+=i+r):e.push({words:[s],width:i}),e},[]),Pc=e=>e.reduce((e,t)=>e.width>t.width?e:t),Pd=(e,t,r,a,n,s,i,o)=>{var l=Po({breakAll:r,style:a,children:e.slice(0,t)+""});if(!l)return[!1,[]];var c=Pl(l.wordsWithComputedWidth,s,i,o);return[c.length>n||Pc(c).width>Number(s),c]},Pu=e=>[{words:null==e?[]:e.toString().split(Pi),width:void 0}],Ph="#808080",Pf={angle:0,breakAll:!1,capHeight:"0.71em",fill:Ph,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Pp=(0,em.forwardRef)((e,t)=>{var r,a=_H(e,Pf),{x:n,y:s,lineHeight:i,capHeight:o,fill:l,scaleToFit:c,textAnchor:d,verticalAnchor:u}=a,h=Ps(a,Pr),f=(0,em.useMemo)(()=>(e=>{var{width:t,scaleToFit:r,children:a,style:n,breakAll:s,maxLines:i}=e;if((t||r)&&!Az.isSsr){var o=Po({breakAll:s,children:a,style:n});if(!o)return Pu(a);var{wordsWithComputedWidth:l,spaceWidth:c}=o;return((e,t,r,a,n)=>{var s,{maxLines:i,children:o,style:l,breakAll:c}=e,d=bD(i),u=String(o),h=Pl(t,a,r,n);if(!d||n||!(h.length>i||Pc(h).width>Number(a)))return h;for(var f=0,p=u.length-1,m=0;f<=p&&m<=u.length-1;){var g=Math.floor((f+p)/2),[x,b]=Pd(u,g-1,c,l,i,a,r,n),[y]=Pd(u,g,c,l,i,a,r,n);if(x||y||(f=g+1),x&&y&&(p=g-1),!x&&y){s=b;break}m++}return s||h})({breakAll:s,children:a,maxLines:i,style:n},l,c,t,!!r)}return Pu(a)})({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:c,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,c,h.style,h.width]),{dx:p,dy:m,angle:g,className:x,breakAll:b}=h,y=Ps(h,Pa);if(!bR(n)||!bR(s)||0===f.length)return null;var v=Number(n)+(bD(p)?p:0),w=Number(s)+(bD(m)?m:0);if(!vK(v)||!vK(w))return null;switch(u){case"start":r=Pt("calc(".concat(o,")"));break;case"middle":r=Pt("calc(".concat((f.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:r=Pt("calc(".concat(f.length-1," * -").concat(i,")"))}var k=[];if(c){var j=f[0].width,{width:N}=h;k.push("scale(".concat(bD(N)&&bD(j)?N/j:1,")"))}return g&&k.push("rotate(".concat(g,", ").concat(v,", ").concat(w,")")),k.length&&(y.transform=k.join(" ")),em.createElement("text",Pn({},_a(y),{ref:t,x:v,y:w,className:(0,vU.clsx)("recharts-text",x),textAnchor:d,fill:l.includes("url")?Ph:l}),f.map((e,t)=>{var a=e.words.join(b?"":" ");return em.createElement("tspan",{x:v,dy:0===t?r:i,key:"".concat(a,"-").concat(t)},a)}))});Pp.displayName="Text";var Pm=e=>null;Pm.displayName="Cell";var Pg=e.i(47169),Px=e=>"string"==typeof e?e:e?e.displayName||e.name||"Component":"",Pb=null,Py=null,Pv=e=>{if(e===Pb&&Array.isArray(Py))return Py;var t=[];return em.Children.forEach(e,e=>{null!=e&&((0,Pg.isFragment)(e)?t=t.concat(Pv(e.props.children)):t.push(e))}),Py=t,Pb=e,t};function Pw(e,t){var r=[],a=[];return a=Array.isArray(t)?t.map(e=>Px(e)):[Px(t)],Pv(e).forEach(e=>{var t=(0,bA.default)(e,"type.displayName")||(0,bA.default)(e,"type.name");t&&-1!==a.indexOf(t)&&r.push(e)}),r}var Pk=e.i(70289);function Pj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function PN(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pj(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pj(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var PS=(e,t,r)=>e.map(e=>"".concat(e.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase()))," ").concat(t,"ms ").concat(r)).join(","),PE=(e,t)=>Object.keys(t).reduce((r,a)=>PN(PN({},r),{},{[a]:e(a,t[a])}),{});function PC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function PT(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?PC(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PC(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var PA=(e,t,r)=>e+(t-e)*r,P_=e=>{var{from:t,to:r}=e;return t!==r},PO=(e,t,r)=>{var a=PE((t,r)=>{if(P_(r)){var[a,n]=e(r.from,r.to,r.velocity);return PT(PT({},r),{},{from:a,velocity:n})}return r},t);return r<1?PE((e,t)=>P_(t)?PT(PT({},t),{},{velocity:PA(t.velocity,a[e].velocity,r),from:PA(t.from,a[e].from,r)}):t,t):PO(e,a,r-1)},PP=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],PD=(e,t)=>e.map((e,r)=>e*t**r).reduce((e,t)=>e+t),PR=(e,t)=>r=>PD(PP(e,t),r),PM=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(1===t.length)switch(t[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:var a,n=t[0].split("(");if("cubic-bezier"===n[0]&&(null==(a=n[1])?void 0:a.split(")")[0].split(",").length)===4){var s=n[1].split(")")[0].split(",").map(e=>parseFloat(e));return[s[0],s[1],s[2],s[3]]}}return 4===t.length?t:[0,0,1,1]},PI=function(){return((e,t,r,a)=>{var n=PR(e,r),s=PR(t,a),i=t=>PD([...PP(e,r).map((e,t)=>e*t).slice(1),0],t),o=e=>e>1?1:e<0?0:e,l=e=>{for(var t=e>1?1:e,r=t,a=0;a<8;++a){var l=n(r)-t,c=i(r);if(1e-4>Math.abs(l-t)||c<1e-4)break;r=o(r-l/c)}return s(r)};return l.isStepper=!1,l})(...PM(...arguments))},PL=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stiff:t=100,damping:r=8,dt:a=17}=e,n=(e,n,s)=>{var i=s+(-(e-n)*t-s*r)*a/1e3,o=s*a/1e3+e;return 1e-4>Math.abs(o-n)&&1e-4>Math.abs(i)?[n,0]:[o,i]};return n.isStepper=!0,n.dt=a,n};class PF{setTimeout(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=performance.now(),a=null,n=s=>{s-r>=t?e(s):"function"==typeof requestAnimationFrame&&(a=requestAnimationFrame(n))};return a=requestAnimationFrame(n),()=>{null!=a&&cancelAnimationFrame(a)}}}var PB=(0,em.createContext)(function(){var e,t,r,a,n;return e=new PF,t=()=>null,r=!1,a=null,n=s=>{if(!r){if(Array.isArray(s)){if(!s.length)return;var[i,...o]=s;if("number"==typeof i){a=e.setTimeout(n.bind(null,o),i);return}n(i),a=e.setTimeout(n.bind(null,o));return}"string"==typeof s&&t(s),"object"==typeof s&&t(s),"function"==typeof s&&s()}},{stop:()=>{r=!0},start:e=>{r=!1,a&&(a(),a=null),n(e)},subscribe:e=>(t=e,()=>{t=()=>null}),getTimeoutController:()=>e}}),PU={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Pz={t:0},PV={t:1};function P$(e){var t,r,a,n=_H(e,PU),{isActive:s,canBegin:i,duration:o,easing:l,begin:c,onAnimationEnd:d,onAnimationStart:u,children:h}=n,f="auto"===s?!Az.isSsr:s,p=(t=n.animationId,r=n.animationManager,a=(0,em.useContext)(PB),(0,em.useMemo)(()=>null!=r?r:a(t),[t,r,a])),[m,g]=(0,em.useState)(f?Pz:PV),x=(0,em.useRef)(null);return(0,em.useEffect)(()=>{f||g(PV)},[f]),(0,em.useEffect)(()=>{if(!f||!i)return bV;var e=((e,t,r,a,n,s)=>{var i,o,l,c,d,u,h,f,p=[Object.keys(e),Object.keys(t)].reduce((e,t)=>e.filter(e=>t.includes(e)));return null==r?()=>(n(PT(PT({},e),t)),()=>{}):!0===r.isStepper?(o=p.reduce((r,a)=>PT(PT({},r),{},{[a]:{from:e[a],velocity:0,to:t[a]}}),{}),l=null,c=a=>{i||(i=a);var d=(a-i)/r.dt;o=PO(r,o,d),n(PT(PT(PT({},e),t),PE((e,t)=>t.from,o))),i=a,Object.values(o).filter(P_).length&&(l=s.setTimeout(c))},()=>(l=s.setTimeout(c),()=>{var e;null==(e=l)||e()})):(u=null,h=p.reduce((r,a)=>PT(PT({},r),{},{[a]:[e[a],t[a]]}),{}),f=i=>{d||(d=i);var o=(i-d)/a,l=PE((e,t)=>PA(...t,r(o)),h);if(n(PT(PT(PT({},e),t),l)),o<1)u=s.setTimeout(f);else{var c=PE((e,t)=>PA(...t,r(1)),h);n(PT(PT(PT({},e),t),c))}},()=>(u=s.setTimeout(f),()=>{var e;null==(e=u)||e()}))})(Pz,PV,(e=>{if("string"==typeof e)switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return PI(e);case"spring":return PL();default:if("cubic-bezier"===e.split("(")[0])return PI(e)}return"function"==typeof e?e:null})(l),o,g,p.getTimeoutController());return p.start([u,c,()=>{x.current=e()},o,d]),()=>{p.stop(),x.current&&x.current(),d()}},[f,i,o,l,c,u,d,p]),h(m.t)}function PH(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"animation-",r=(0,em.useRef)(bI(t)),a=(0,em.useRef)(e);return a.current!==e&&(r.current=bI(t),a.current=e),r.current}var PW=["radius"],Pq=["radius"];function PG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function PK(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?PG(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PG(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function PX(){return(PX=Object.assign.bind()).apply(null,arguments)}function PY(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var PQ=(e,t,r,a,n)=>{var s,i=Math.min(Math.abs(r)/2,Math.abs(a)/2),o=a>=0?1:-1,l=r>=0?1:-1,c=+(a>=0&&r>=0||a<0&&r<0);if(i>0&&n instanceof Array){for(var d=[0,0,0,0],u=0;u<4;u++)d[u]=n[u]>i?i:n[u];s="M".concat(e,",").concat(t+o*d[0]),d[0]>0&&(s+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(t)),s+="L ".concat(e+r-l*d[1],",").concat(t),d[1]>0&&(s+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,",\n        ").concat(e+r,",").concat(t+o*d[1])),s+="L ".concat(e+r,",").concat(t+a-o*d[2]),d[2]>0&&(s+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,",\n        ").concat(e+r-l*d[2],",").concat(t+a)),s+="L ".concat(e+l*d[3],",").concat(t+a),d[3]>0&&(s+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,",\n        ").concat(e,",").concat(t+a-o*d[3])),s+="Z"}else if(i>0&&n===+n&&n>0){var h=Math.min(i,n);s="M ".concat(e,",").concat(t+o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+l*h,",").concat(t,"\n            L ").concat(e+r-l*h,",").concat(t,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+o*h,"\n            L ").concat(e+r,",").concat(t+a-o*h,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-l*h,",").concat(t+a,"\n            L ").concat(e+l*h,",").concat(t+a,"\n            A ").concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+a-o*h," Z")}else s="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return s},PJ={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},PZ=e=>{var t=_H(e,PJ),r=(0,em.useRef)(null),[a,n]=(0,em.useState)(-1);(0,em.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var e=r.current.getTotalLength();e&&n(e)}catch(e){}},[]);var{x:s,y:i,width:o,height:l,radius:c,className:d}=t,{animationEasing:u,animationDuration:h,animationBegin:f,isAnimationActive:p,isUpdateAnimationActive:m}=t,g=(0,em.useRef)(o),x=(0,em.useRef)(l),b=(0,em.useRef)(s),y=(0,em.useRef)(i),v=PH((0,em.useMemo)(()=>({x:s,y:i,width:o,height:l,radius:c}),[s,i,o,l,c]),"rectangle-");if(s!==+s||i!==+i||o!==+o||l!==+l||0===o||0===l)return null;var w=(0,vU.clsx)("recharts-rectangle",d);if(!m){var k=_a(t),{radius:j}=k,N=PY(k,PW);return em.createElement("path",PX({},N,{radius:"number"==typeof c?c:void 0,className:w,d:PQ(s,i,o,l,c)}))}var S=g.current,E=x.current,C=b.current,T=y.current,A="0px ".concat(-1===a?1:a,"px"),_="".concat(a,"px 0px"),O=PS(["strokeDasharray"],h,"string"==typeof u?u:PJ.animationEasing);return em.createElement(P$,{animationId:v,key:v,canBegin:a>0,duration:h,easing:u,isActive:m,begin:f},e=>{var a,n=bB(S,o,e),d=bB(E,l,e),u=bB(C,s,e),h=bB(T,i,e);r.current&&(g.current=n,x.current=d,b.current=u,y.current=h),a=p?e>0?{transition:O,strokeDasharray:_}:{strokeDasharray:A}:{strokeDasharray:_};var f=_a(t),{radius:m}=f,v=PY(f,Pq);return em.createElement("path",PX({},v,{radius:"number"==typeof c?c:void 0,className:w,d:PQ(u,h,n,d,c),ref:r,style:PK(PK({},a),t.style)}))})};function P0(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function P1(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P0(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P0(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function P2(){return(P2=Object.assign.bind()).apply(null,arguments)}var P5=(e,t,r,a,n)=>{var s=r-a;return"M ".concat(e,",").concat(t)+"L ".concat(e+r,",").concat(t)+"L ".concat(e+r-s/2,",").concat(t+n)+"L ".concat(e+r-s/2-a,",").concat(t+n)+"L ".concat(e,",").concat(t," Z")},P4={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},P3=e=>{var t=_H(e,P4),{x:r,y:a,upperWidth:n,lowerWidth:s,height:i,className:o}=t,{animationEasing:l,animationDuration:c,animationBegin:d,isUpdateAnimationActive:u}=t,h=(0,em.useRef)(null),[f,p]=(0,em.useState)(-1),m=(0,em.useRef)(n),g=(0,em.useRef)(s),x=(0,em.useRef)(i),b=(0,em.useRef)(r),y=(0,em.useRef)(a),v=PH(e,"trapezoid-");if((0,em.useEffect)(()=>{if(h.current&&h.current.getTotalLength)try{var e=h.current.getTotalLength();e&&p(e)}catch(e){}},[]),r!==+r||a!==+a||n!==+n||s!==+s||i!==+i||0===n&&0===s||0===i)return null;var w=(0,vU.clsx)("recharts-trapezoid",o);if(!u)return em.createElement("g",null,em.createElement("path",P2({},_a(t),{className:w,d:P5(r,a,n,s,i)})));var k=m.current,j=g.current,N=x.current,S=b.current,E=y.current,C="0px ".concat(-1===f?1:f,"px"),T="".concat(f,"px 0px"),A=PS(["strokeDasharray"],c,l);return em.createElement(P$,{animationId:v,key:v,canBegin:f>0,duration:c,easing:l,isActive:u,begin:d},e=>{var o=bB(k,n,e),l=bB(j,s,e),c=bB(N,i,e),d=bB(S,r,e),u=bB(E,a,e);h.current&&(m.current=o,g.current=l,x.current=c,b.current=d,y.current=u);var f=e>0?{transition:A,strokeDasharray:T}:{strokeDasharray:C};return em.createElement("path",P2({},_a(t),{className:w,d:P5(d,u,o,l,c),ref:h,style:P1(P1({},f),t.style)}))})};function P6(){return(P6=Object.assign.bind()).apply(null,arguments)}var P8=e=>{var{cx:t,cy:r,radius:a,angle:n,sign:s,isExternal:i,cornerRadius:o,cornerIsExternal:l}=e,c=o*(i?1:-1)+a,d=Math.asin(o/c)/Sw,u=l?n:n+s*d,h=Sk(t,r,c,u);return{center:h,circleTangency:Sk(t,r,a,u),lineTangency:Sk(t,r,c*Math.cos(d*Sw),l?n-s*d:n),theta:d}},P7=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:s,endAngle:i}=e,o=b_(i-s)*Math.min(Math.abs(i-s),359.999),l=s+o,c=Sk(t,r,n,s),d=Sk(t,r,n,l),u="M ".concat(c.x,",").concat(c.y,"\n    A ").concat(n,",").concat(n,",0,\n    ").concat(+(Math.abs(o)>180),",").concat(+(s>l),",\n    ").concat(d.x,",").concat(d.y,"\n  ");if(a>0){var h=Sk(t,r,a,s),f=Sk(t,r,a,l);u+="L ".concat(f.x,",").concat(f.y,"\n            A ").concat(a,",").concat(a,",0,\n            ").concat(+(Math.abs(o)>180),",").concat(+(s<=l),",\n            ").concat(h.x,",").concat(h.y," Z")}else u+="L ".concat(t,",").concat(r," Z");return u},P9={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},De=e=>{var t,r=_H(e,P9),{cx:a,cy:n,innerRadius:s,outerRadius:i,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:h}=r;if(i<s||d===u)return null;var f=(0,vU.clsx)("recharts-sector",h),p=i-s,m=bL(o,p,0,!0);return t=m>0&&360>Math.abs(d-u)?(e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:n,cornerRadius:s,forceCornerRadius:i,cornerIsExternal:o,startAngle:l,endAngle:c}=e,d=b_(c-l),{circleTangency:u,lineTangency:h,theta:f}=P8({cx:t,cy:r,radius:n,angle:l,sign:d,cornerRadius:s,cornerIsExternal:o}),{circleTangency:p,lineTangency:m,theta:g}=P8({cx:t,cy:r,radius:n,angle:c,sign:-d,cornerRadius:s,cornerIsExternal:o}),x=o?Math.abs(l-c):Math.abs(l-c)-f-g;if(x<0)return i?"M ".concat(h.x,",").concat(h.y,"\n        a").concat(s,",").concat(s,",0,0,1,").concat(2*s,",0\n        a").concat(s,",").concat(s,",0,0,1,").concat(-(2*s),",0\n      "):P7({cx:t,cy:r,innerRadius:a,outerRadius:n,startAngle:l,endAngle:c});var b="M ".concat(h.x,",").concat(h.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(u.x,",").concat(u.y,"\n    A").concat(n,",").concat(n,",0,").concat(+(x>180),",").concat(+(d<0),",").concat(p.x,",").concat(p.y,"\n    A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(m.x,",").concat(m.y,"\n  ");if(a>0){var{circleTangency:y,lineTangency:v,theta:w}=P8({cx:t,cy:r,radius:a,angle:l,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),{circleTangency:k,lineTangency:j,theta:N}=P8({cx:t,cy:r,radius:a,angle:c,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:o}),S=o?Math.abs(l-c):Math.abs(l-c)-w-N;if(S<0&&0===s)return"".concat(b,"L").concat(t,",").concat(r,"Z");b+="L".concat(j.x,",").concat(j.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(k.x,",").concat(k.y,"\n      A").concat(a,",").concat(a,",0,").concat(+(S>180),",").concat(+(d>0),",").concat(y.x,",").concat(y.y,"\n      A").concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(v.x,",").concat(v.y,"Z")}else b+="L".concat(t,",").concat(r,"Z");return b})({cx:a,cy:n,innerRadius:s,outerRadius:i,cornerRadius:Math.min(m,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):P7({cx:a,cy:n,innerRadius:s,outerRadius:i,startAngle:d,endAngle:u}),em.createElement("path",P6({},_a(r),{className:f,d:t}))};let Dt=Math.cos,Dr=Math.sin,Da=Math.sqrt,Dn=Math.PI,Ds=2*Dn;Da(3);let Di={draw(e,t){let r=Da(t/Dn);e.moveTo(r,0),e.arc(0,0,r,0,Ds)}},Do=Da(1/3),Dl=2*Do,Dc=Dr(Dn/10)/Dr(7*Dn/10),Dd=Dr(Ds/10)*Dc,Du=-Dt(Ds/10)*Dc,Dh=Da(3);Da(3);let Df=Da(3)/2,Dp=1/Da(12),Dm=(Dp/2+1)*3;var Dg=["type","size","sizeType"];function Dx(){return(Dx=Object.assign.bind()).apply(null,arguments)}function Db(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Dy(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Db(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Db(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Dv={symbolCircle:Di,symbolCross:{draw(e,t){let r=Da(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},symbolDiamond:{draw(e,t){let r=Da(t/Dl),a=r*Do;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},symbolSquare:{draw(e,t){let r=Da(t),a=-r/2;e.rect(a,a,r,r)}},symbolStar:{draw(e,t){let r=Da(.8908130915292852*t),a=Dd*r,n=Du*r;e.moveTo(0,-r),e.lineTo(a,n);for(let t=1;t<5;++t){let s=Ds*t/5,i=Dt(s),o=Dr(s);e.lineTo(o*r,-i*r),e.lineTo(i*a-o*n,o*a+i*n)}e.closePath()}},symbolTriangle:{draw(e,t){let r=-Da(t/(3*Dh));e.moveTo(0,2*r),e.lineTo(-Dh*r,-r),e.lineTo(Dh*r,-r),e.closePath()}},symbolWye:{draw(e,t){let r=Da(t/Dm),a=r/2,n=r*Dp,s=r*Dp+r,i=-a;e.moveTo(a,n),e.lineTo(a,s),e.lineTo(i,s),e.lineTo(-.5*a-Df*n,Df*a+-.5*n),e.lineTo(-.5*a-Df*s,Df*a+-.5*s),e.lineTo(-.5*i-Df*s,Df*i+-.5*s),e.lineTo(-.5*a+Df*n,-.5*n-Df*a),e.lineTo(-.5*a+Df*s,-.5*s-Df*a),e.lineTo(-.5*i+Df*s,-.5*s-Df*i),e.closePath()}}},Dw=Math.PI/180,Dk=e=>{var{type:t="circle",size:r=64,sizeType:a="area"}=e,n=Dy(Dy({},function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,Dg)),{},{type:t,size:r,sizeType:a}),s="circle";"string"==typeof t&&(s=t);var{className:i,cx:o,cy:l}=n,c=_a(n);return bD(o)&&bD(l)&&bD(r)?em.createElement("path",Dx({},c,{className:(0,vU.clsx)("recharts-symbols",i),transform:"translate(".concat(o,", ").concat(l,")"),d:(()=>{var e,t=(e=s,Dv["symbol".concat(bU(e))]||Di),n=(function(e,t){let r=null,a=Ox(n);function n(){let n;if(r||(r=n=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),n)return r=null,n+""||null}return e="function"==typeof e?e:vl(e||Di),t="function"==typeof t?t:vl(void 0===t?64:+t),n.type=function(t){return arguments.length?(e="function"==typeof t?t:vl(t),n):e},n.size=function(e){return arguments.length?(t="function"==typeof e?e:vl(+e),n):t},n.context=function(e){return arguments.length?(r=null==e?null:e,n):r},n})().type(t).size(((e,t,r)=>{if("area"===t)return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":var a=18*Dw;return 1.25*e*e*(Math.tan(a)-Math.tan(2*a)*Math.tan(a)**2);case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}})(r,a,s))();if(null!==n)return n})()})):null};Dk.registerSymbol=(e,t)=>{Dv["symbol".concat(bU(e))]=t};var Dj=["option","shapeType","propTransformer","activeClassName"];function DN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function DS(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?DN(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DN(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function DE(e,t){return DS(DS({},t),e)}function DC(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return em.createElement(PZ,r);case"trapezoid":return em.createElement(P3,r);case"sector":return em.createElement(De,r);case"symbols":if("symbols"===t)return em.createElement(Dk,r);break;case"curve":return em.createElement(OK,r);default:return null}}function DT(e){var t,{option:r,shapeType:a,propTransformer:n=DE,activeClassName:s="recharts-active-shape"}=e,i=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,Dj);if((0,em.isValidElement)(r))t=(0,em.cloneElement)(r,DS(DS({},i),(0,em.isValidElement)(r)?r.props:r));else if("function"==typeof r)t=r(i);else if((0,Pk.default)(r)&&"boolean"!=typeof r){var o=n(r,i);t=em.createElement(DC,{shapeType:a,elementProps:o})}else t=em.createElement(DC,{shapeType:a,elementProps:i});return i.isActive?em.createElement(Oc,{className:s},t):t}function DA(e){var{tooltipEntrySettings:t}=e,r=y9(),a=vL(),n=(0,em.useRef)(null);return(0,em.useLayoutEffect)(()=>{a||(null===n.current?r(yI(t)):n.current!==t&&r(yL({prev:n.current,next:t})),n.current=t)},[t,r,a]),(0,em.useLayoutEffect)(()=>()=>{n.current&&(r(yF(n.current)),n.current=null)},[r]),null}function D_(e){var{legendPayload:t}=e,r=y9(),a=va(v8),n=(0,em.useRef)(null);return(0,em.useLayoutEffect)(()=>{("centric"===a||"radial"===a)&&(null===n.current?r(Ac(t)):n.current!==t&&r(Ad({prev:n.current,next:t})),n.current=t)},[r,a,t]),(0,em.useLayoutEffect)(()=>()=>{n.current&&(r(Au(n.current)),n.current=null)},[r]),null}var DO=(0,em.createContext)(void 0),DP=e=>{var{id:t,type:r,children:a}=e,n=_l("recharts-".concat(r),t);return em.createElement(DO.Provider,{value:n},a(n))};function DD(e){var t=y9();return(0,em.useLayoutEffect)(()=>(t(T1(e)),()=>{t(T2(e))}),[t,e]),null}var DR=e.i(12390);function DM(e){var{zIndex:t,children:r}=e,a=void 0!==va(v8)&&void 0!==t&&0!==t,n=vL(),s=y9();(0,em.useLayoutEffect)(()=>a?(s(AG({zIndex:t})),()=>{s(AK({zIndex:t}))}):bV,[s,t,a]);var i=va(e=>_c(e,t,n));if(!a)return r;if(!i)return null;var o=document.getElementById(i);return o?(0,ov.createPortal)(r,o):null}var DI=["labelRef"];function DL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function DF(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?DL(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function DB(){return(DB=Object.assign.bind()).apply(null,arguments)}var DU=(0,em.createContext)(null),Dz=(0,em.createContext)(null),DV=e=>"cx"in e&&bD(e.cx),D$={angle:0,offset:5,zIndex:SN.label,position:"middle",textBreakAll:!1};function DH(e){var t,r,a,n,s,i,o,l,c=_H(e,D$),{viewBox:d,position:u,value:h,children:f,content:p,className:m="",textBreakAll:g,labelRef:x}=c,b=(t=(0,em.useContext)(Dz),r=va(SU),t||r),y=(a=(0,em.useContext)(DU),n=v3(),a||v4(n));if(!(i=null==d?"center"===u?y:null!=b?b:y:DV(d)?d:v4(d))||null==h&&null==f&&!(0,em.isValidElement)(p)&&"function"!=typeof p)return null;var v=DF(DF({},c),{},{viewBox:i});if((0,em.isValidElement)(p)){var{labelRef:w}=v,k=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(v,DI);return(0,em.cloneElement)(p,k)}if("function"==typeof p){if(o=(0,em.createElement)(p,v),(0,em.isValidElement)(o))return o}else o=(e=>{var{value:t,formatter:r}=e,a=null==e.children?t:e.children;return"function"==typeof r?r(a):a})(c);var j=_a(c);if(DV(i)){if("insideStart"===u||"insideEnd"===u||"end"===u)return((e,t,r,a,n)=>{var s,i,{offset:o,className:l}=e,{cx:c,cy:d,innerRadius:u,outerRadius:h,startAngle:f,endAngle:p,clockWise:m}=n,g=(u+h)/2,x=b_(p-f)*Math.min(Math.abs(p-f),360),b=x>=0?1:-1;switch(t){case"insideStart":s=f+b*o,i=m;break;case"insideEnd":s=p-b*o,i=!m;break;case"end":s=p+b*o,i=m;break;default:throw Error("Unsupported position ".concat(t))}i=x<=0?i:!i;var y=Sk(c,d,g,s),v=Sk(c,d,g,s+(i?1:-1)*359),w="M".concat(y.x,",").concat(y.y,"\n    A").concat(g,",").concat(g,",0,1,").concat(+!i,",\n    ").concat(v.x,",").concat(v.y),k=null==e.id?bI("recharts-radial-line-"):e.id;return em.createElement("text",DB({},a,{dominantBaseline:"central",className:(0,vU.clsx)("recharts-radial-bar-label",l)}),em.createElement("defs",null,em.createElement("path",{id:k,d:w})),em.createElement("textPath",{xlinkHref:"#".concat(k)},r))})(c,u,o,j,i);l=((e,t,r)=>{var{cx:a,cy:n,innerRadius:s,outerRadius:i,startAngle:o,endAngle:l}=e,c=(o+l)/2;if("outside"===r){var{x:d,y:u}=Sk(a,n,i+t,c);return{x:d,y:u,textAnchor:d>=a?"start":"end",verticalAnchor:"middle"}}if("center"===r)return{x:a,y:n,textAnchor:"middle",verticalAnchor:"middle"};if("centerTop"===r)return{x:a,y:n,textAnchor:"middle",verticalAnchor:"start"};if("centerBottom"===r)return{x:a,y:n,textAnchor:"middle",verticalAnchor:"end"};var{x:h,y:f}=Sk(a,n,(s+i)/2,c);return{x:h,y:f,textAnchor:"middle",verticalAnchor:"middle"}})(i,c.offset,c.position)}else l=((e,t)=>{var r,{parentViewBox:a,offset:n,position:s}=e;null==a||DV(a)||(r=a);var{x:i,y:o,upperWidth:l,lowerWidth:c,height:d}=t,u=i+(l-c)/2,h=(i+u)/2,f=(l+c)/2,p=d>=0?1:-1,m=p*n,g=p>0?"end":"start",x=p>0?"start":"end",b=l>=0?1:-1,y=b*n,v=b>0?"end":"start",w=b>0?"start":"end";if("top"===s)return DF(DF({},{x:i+l/2,y:o-m,textAnchor:"middle",verticalAnchor:g}),r?{height:Math.max(o-r.y,0),width:l}:{});if("bottom"===s)return DF(DF({},{x:u+c/2,y:o+d+m,textAnchor:"middle",verticalAnchor:x}),r?{height:Math.max(r.y+r.height-(o+d),0),width:c}:{});if("left"===s){var k={x:h-y,y:o+d/2,textAnchor:v,verticalAnchor:"middle"};return DF(DF({},k),r?{width:Math.max(k.x-r.x,0),height:d}:{})}if("right"===s){var j={x:h+f+y,y:o+d/2,textAnchor:w,verticalAnchor:"middle"};return DF(DF({},j),r?{width:Math.max(r.x+r.width-j.x,0),height:d}:{})}var N=r?{width:f,height:d}:{};return"insideLeft"===s?DF({x:h+y,y:o+d/2,textAnchor:w,verticalAnchor:"middle"},N):"insideRight"===s?DF({x:h+f-y,y:o+d/2,textAnchor:v,verticalAnchor:"middle"},N):"insideTop"===s?DF({x:i+l/2,y:o+m,textAnchor:"middle",verticalAnchor:x},N):"insideBottom"===s?DF({x:u+c/2,y:o+d-m,textAnchor:"middle",verticalAnchor:g},N):"insideTopLeft"===s?DF({x:i+y,y:o+m,textAnchor:w,verticalAnchor:x},N):"insideTopRight"===s?DF({x:i+l-y,y:o+m,textAnchor:v,verticalAnchor:x},N):"insideBottomLeft"===s?DF({x:u+y,y:o+d-m,textAnchor:w,verticalAnchor:g},N):"insideBottomRight"===s?DF({x:u+c-y,y:o+d-m,textAnchor:v,verticalAnchor:g},N):s&&"object"==typeof s&&(bD(s.x)||bP(s.x))&&(bD(s.y)||bP(s.y))?DF({x:i+bL(s.x,f),y:o+bL(s.y,d),textAnchor:"end",verticalAnchor:"end"},N):DF({x:i+l/2,y:o+d/2,textAnchor:"middle",verticalAnchor:"middle"},N)})(c,i);return em.createElement(DM,{zIndex:c.zIndex},em.createElement(Pp,DB({ref:x,className:(0,vU.clsx)("recharts-label",m)},j,l,{textAnchor:"start"===(s=j.textAnchor)||"middle"===s||"end"===s||"inherit"===s?j.textAnchor:l.textAnchor,breakAll:g}),o))}DH.displayName="Label";var DW=["valueAccessor"],Dq=["dataKey","clockWise","id","textBreakAll","zIndex"];function DG(){return(DG=Object.assign.bind()).apply(null,arguments)}function DK(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var DX=e=>Array.isArray(e.value)?(0,DR.default)(e.value):e.value,DY=(0,em.createContext)(void 0);DY.Provider;var DQ=(0,em.createContext)(void 0),DJ=DQ.Provider;function DZ(e){var{valueAccessor:t=DX}=e,r=DK(e,DW),{dataKey:a,clockWise:n,id:s,textBreakAll:i,zIndex:o}=r,l=DK(r,Dq),c=(0,em.useContext)(DY),d=(0,em.useContext)(DQ),u=c||d;return u&&u.length?em.createElement(DM,{zIndex:null!=o?o:SN.label},em.createElement(Oc,{className:"recharts-label-list"},u.map((e,n)=>{var o,c=null==a?t(e,n):vg(e&&e.payload,a),d=null==s?{}:{id:"".concat(s,"-").concat(n)};return em.createElement(DH,DG({key:"label-".concat(n)},_a(e),l,d,{fill:null!=(o=r.fill)?o:e.fill,parentViewBox:e.parentViewBox,value:c,textBreakAll:i,viewBox:e.viewBox,index:n,zIndex:0}))}))):null}function D0(e){var{label:t}=e;return t?!0===t?em.createElement(DZ,{key:"labelList-implicit"}):em.isValidElement(t)||null!=t&&"function"==typeof t?em.createElement(DZ,{key:"labelList-implicit",content:t}):"object"==typeof t?em.createElement(DZ,DG({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}DZ.displayName="LabelList";var D1=["key"],D2=["onMouseEnter","onClick","onMouseLeave"],D5=["id"],D4=["id"];function D3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function D6(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D3(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D3(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function D8(){return(D8=Object.assign.bind()).apply(null,arguments)}function D7(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function D9(e){var t=(0,em.useMemo)(()=>Pw(e.children,Pm),[e.children]),r=va(r=>Os(r,e.id,t));return null==r?null:em.createElement(D_,{legendPayload:r})}var Re=em.memo(e=>{var{dataKey:t,nameKey:r,sectors:a,stroke:n,strokeWidth:s,fill:i,name:o,hide:l,tooltipType:c}=e,d={dataDefinedOnItem:a.map(e=>e.tooltipPayload),positions:a.map(e=>e.tooltipPosition),settings:{stroke:n,strokeWidth:s,fill:i,dataKey:t,nameKey:r,name:vj(o,t),hide:l,type:c,color:i,unit:""}};return em.createElement(DA,{tooltipEntrySettings:d})});function Rt(e){var{sectors:t,props:r,showLabels:a}=e,{label:n,labelLine:s,dataKey:i}=r;if(!a||!n||!t)return null;var o=_t(r),l=_r(n),c=_r(s),d="object"==typeof n&&"offsetRadius"in n&&"number"==typeof n.offsetRadius&&n.offsetRadius||20,u=t.map((e,t)=>{var r,a,u=(e.startAngle+e.endAngle)/2,h=Sk(e.cx,e.cy,e.outerRadius+d,u),f=D6(D6(D6(D6({},o),e),{},{stroke:"none"},l),{},{index:t,textAnchor:(r=h.x)>(a=e.cx)?"start":r<a?"end":"middle"},h),p=D6(D6(D6(D6({},o),e),{},{fill:"none",stroke:e.fill},c),{},{index:t,points:[Sk(e.cx,e.cy,e.outerRadius,u),h],key:"line"});return em.createElement(DM,{zIndex:SN.label,key:"label-".concat(e.startAngle,"-").concat(e.endAngle,"-").concat(e.midAngle,"-").concat(t)},em.createElement(Oc,null,s&&((e,t)=>{if(em.isValidElement(e))return em.cloneElement(e,t);if("function"==typeof e)return e(t);var r=(0,vU.clsx)("recharts-pie-label-line","boolean"!=typeof e?e.className:""),{key:a}=t,n=D7(t,D1);return em.createElement(OK,D8({},n,{type:"linear",className:r}))})(s,p),((e,t,r)=>{if(em.isValidElement(e))return em.cloneElement(e,t);var a=r;if("function"==typeof e&&(a=e(t),em.isValidElement(a)))return a;var n=(0,vU.clsx)("recharts-pie-label-text",e&&"object"==typeof e&&"className"in e&&"string"==typeof e.className?e.className:"");return em.createElement(Pp,D8({},t,{alignmentBaseline:"middle",className:n}),a)})(n,f,vg(e,i))))});return em.createElement(Oc,{className:"recharts-pie-labels"},u)}function Rr(e){var{sectors:t,props:r,showLabels:a}=e,{label:n}=r;return"object"==typeof n&&null!=n&&"position"in n?em.createElement(D0,{label:n}):em.createElement(Rt,{sectors:t,props:r,showLabels:a})}function Ra(e){var t,r,a,n,s,{sectors:i,activeShape:o,inactiveShape:l,allOtherPieProps:c,shape:d}=e,u=va(Ti),{onMouseEnter:h,onClick:f,onMouseLeave:p}=c,m=D7(c,D2),g=(t=c.dataKey,r=y9(),(e,a)=>n=>{null==h||h(e,a,n),r(yU({activeIndex:String(a),activeDataKey:t,activeCoordinate:e.tooltipPosition}))}),x=(a=y9(),(e,t)=>r=>{null==p||p(e,t,r),a(yz())}),b=(n=c.dataKey,s=y9(),(e,t)=>r=>{null==f||f(e,t,r),s(y$({activeIndex:String(t),activeDataKey:n,activeCoordinate:e.tooltipPosition}))});return null==i||0===i.length?null:em.createElement(em.Fragment,null,i.map((e,t)=>{if((null==e?void 0:e.startAngle)===0&&(null==e?void 0:e.endAngle)===0&&1!==i.length)return null;var r=String(t)===u,a=o&&r?o:u?l:null,n=D6(D6({},e),{},{stroke:e.stroke,tabIndex:-1,[v_]:t,[vO]:c.dataKey});return em.createElement(Oc,D8({key:"sector-".concat(null==e?void 0:e.startAngle,"-").concat(null==e?void 0:e.endAngle,"-").concat(e.midAngle,"-").concat(t),tabIndex:-1,className:"recharts-pie-sector"},OB(m,e,t),{onMouseEnter:g(e,t),onMouseLeave:x(e,t),onClick:b(e,t)}),em.createElement(DT,D8({option:null!=d?d:a,shapeType:"sector",isActive:r},n)))}))}function Rn(e){var{showLabels:t,sectors:r,children:a}=e,n=(0,em.useMemo)(()=>t&&r?r.map(e=>({value:e.value,payload:e.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:e.cx,cy:e.cy,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clockWise:!1},fill:e.fill})):[],[r,t]);return em.createElement(DJ,{value:t?n:void 0},a)}function Rs(e){var{props:t,previousSectorsRef:r}=e,{sectors:a,isAnimationActive:n,animationBegin:s,animationDuration:i,animationEasing:o,activeShape:l,inactiveShape:c,onAnimationStart:d,onAnimationEnd:u}=t,h=PH(t,"recharts-pie-"),f=r.current,[p,m]=(0,em.useState)(!1),g=(0,em.useCallback)(()=>{"function"==typeof u&&u(),m(!1)},[u]),x=(0,em.useCallback)(()=>{"function"==typeof d&&d(),m(!0)},[d]);return em.createElement(Rn,{showLabels:!p,sectors:a},em.createElement(P$,{animationId:h,begin:s,duration:i,isActive:n,easing:o,onAnimationStart:x,onAnimationEnd:g,key:h},e=>{var n=[],s=a&&a[0],i=null==s?void 0:s.startAngle;return null==a||a.forEach((t,r)=>{var a=f&&f[r],s=r>0?(0,bA.default)(t,"paddingAngle",0):0;if(a){var o=bB(a.endAngle-a.startAngle,t.endAngle-t.startAngle,e),l=D6(D6({},t),{},{startAngle:i+s,endAngle:i+o+s});n.push(l),i=l.endAngle}else{var{endAngle:c,startAngle:d}=t,u=bB(0,c-d,e),h=D6(D6({},t),{},{startAngle:i+s,endAngle:i+u+s});n.push(h),i=h.endAngle}}),r.current=n,em.createElement(Oc,null,em.createElement(Ra,{sectors:n,activeShape:l,inactiveShape:c,allOtherPieProps:t,shape:t.shape}))}),em.createElement(Rr,{showLabels:!p,sectors:a,props:t}),t.children)}var Ri={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Az.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:SN.area};function Ro(e){var{id:t}=e,r=D7(e,D5),{hide:a,className:n,rootTabIndex:s}=e,i=(0,em.useMemo)(()=>Pw(e.children,Pm),[e.children]),o=va(e=>Oi(e,t,i)),l=(0,em.useRef)(null),c=(0,vU.clsx)("recharts-pie",n);return a||null==o?(l.current=null,em.createElement(Oc,{tabIndex:s,className:c})):em.createElement(DM,{zIndex:e.zIndex},em.createElement(Re,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:o,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType}),em.createElement(Oc,{tabIndex:s,className:c},em.createElement(Rs,{props:D6(D6({},r),{},{sectors:o}),previousSectorsRef:l})))}function Rl(e){var t=_H(e,Ri),{id:r}=t,a=D7(t,D4),n=_t(a);return em.createElement(DP,{id:r,type:"pie"},e=>em.createElement(em.Fragment,null,em.createElement(DD,{type:"pie",id:e,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),em.createElement(D9,D8({},a,{id:e})),em.createElement(Ro,D8({},a,{id:e}))))}function Rc(){return(Rc=Object.assign.bind()).apply(null,arguments)}function Rd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Ru(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rd(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Rh(e){return Array.isArray(e)&&bR(e[0])&&bR(e[1])?e.join(" ~ "):e}Rl.displayName="Pie";var Rf=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:a={},labelStyle:n={},payload:s,formatter:i,itemSorter:o,wrapperClassName:l,labelClassName:c,label:d,labelFormatter:u,accessibilityLayer:h=!1}=e,f=Ru({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),p=Ru({margin:0},n),m=null!=d,g=m?d:"",x=(0,vU.clsx)("recharts-default-tooltip",l),b=(0,vU.clsx)("recharts-tooltip-label",c);return m&&u&&null!=s&&(g=u(d,s)),em.createElement("div",Rc({className:x,style:f},h?{role:"status","aria-live":"assertive"}:{}),em.createElement("p",{className:b,style:p},em.isValidElement(g)?g:"".concat(g)),(()=>{if(s&&s.length){var e=(o?(0,vn.default)(s,o):s).map((e,r)=>{if("none"===e.type)return null;var n=e.formatter||i||Rh,{value:o,name:l}=e,c=o,d=l;if(n){var u=n(o,l,e,r,s);if(Array.isArray(u))[c,d]=u;else{if(null==u)return null;c=u}}var h=Ru({display:"block",paddingTop:4,paddingBottom:4,color:e.color||"#000"},a);return em.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(r),style:h},bR(d)?em.createElement("span",{className:"recharts-tooltip-item-name"},d):null,bR(d)?em.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,em.createElement("span",{className:"recharts-tooltip-item-value"},c),em.createElement("span",{className:"recharts-tooltip-item-unit"},e.unit||""))});return em.createElement("ul",{className:"recharts-tooltip-item-list",style:{padding:0,margin:0}},e)}return null})())},Rp=em,Rm="recharts-tooltip-wrapper",Rg={visibility:"hidden"};function Rx(e){var{allowEscapeViewBox:t,coordinate:r,key:a,offsetTopLeft:n,position:s,reverseDirection:i,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=e;if(s&&bD(s[a]))return s[a];var d=r[a]-o-(n>0?n:0),u=r[a]+n;if(t[a])return i[a]?d:u;var h=l[a];return null==h?0:i[a]?d<h?Math.max(u,h):Math.max(d,h):null==c?0:u+o>h+c?Math.max(d,h):Math.max(u,h)}function Rb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Ry(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rb(Object(r),!0).forEach(function(t){Rv(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rb(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Rv(e,t,r){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Rw extends Rp.PureComponent{constructor(){super(...arguments),Rv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Rv(this,"handleKeyDown",e=>{if("Escape"===e.key){var t,r,a,n;this.setState({dismissed:!0,dismissedAtCoordinate:{x:null!=(t=null==(r=this.props.coordinate)?void 0:r.x)?t:0,y:null!=(a=null==(n=this.props.coordinate)?void 0:n.y)?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,t;this.state.dismissed&&((null==(e=this.props.coordinate)?void 0:e.x)!==this.state.dismissedAtCoordinate.x||(null==(t=this.props.coordinate)?void 0:t.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:t,animationDuration:r,animationEasing:a,children:n,coordinate:s,hasPayload:i,isAnimationActive:o,offset:l,position:c,reverseDirection:d,useTranslate3d:u,viewBox:h,wrapperStyle:f,lastBoundingBox:p,innerRef:m,hasPortalFromProps:g}=this.props,{cssClasses:x,cssProperties:b}=function(e){var t,r,a,{allowEscapeViewBox:n,coordinate:s,offsetTopLeft:i,position:o,reverseDirection:l,tooltipBox:c,useTranslate3d:d,viewBox:u}=e;return{cssProperties:t=c.height>0&&c.width>0&&s?function(e){var{translateX:t,translateY:r,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}({translateX:r=Rx({allowEscapeViewBox:n,coordinate:s,key:"x",offsetTopLeft:i,position:o,reverseDirection:l,tooltipDimension:c.width,viewBox:u,viewBoxDimension:u.width}),translateY:a=Rx({allowEscapeViewBox:n,coordinate:s,key:"y",offsetTopLeft:i,position:o,reverseDirection:l,tooltipDimension:c.height,viewBox:u,viewBoxDimension:u.height}),useTranslate3d:d}):Rg,cssClasses:function(e){var{coordinate:t,translateX:r,translateY:a}=e;return(0,vU.clsx)(Rm,{["".concat(Rm,"-right")]:bD(r)&&t&&bD(t.x)&&r>=t.x,["".concat(Rm,"-left")]:bD(r)&&t&&bD(t.x)&&r<t.x,["".concat(Rm,"-bottom")]:bD(a)&&t&&bD(t.y)&&a>=t.y,["".concat(Rm,"-top")]:bD(a)&&t&&bD(t.y)&&a<t.y})}({translateX:r,translateY:a,coordinate:s})}}({allowEscapeViewBox:t,coordinate:s,offsetTopLeft:l,position:c,reverseDirection:d,tooltipBox:{height:p.height,width:p.width},useTranslate3d:u,viewBox:h}),y=g?{}:Ry(Ry({transition:o&&e?"transform ".concat(r,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&i?"visible":"hidden",position:"absolute",top:0,left:0}),v=Ry(Ry({},y),{},{visibility:!this.state.dismissed&&e&&i?"visible":"hidden"},f);return Rp.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:x,style:v,ref:m},n)}}var Rk=e.i(73304);function Rj(e,t,r){return!0===t?(0,Rk.default)(e,r):"function"==typeof t?(0,Rk.default)(e,t):e}function RN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,r]=(0,em.useState)({height:0,left:0,top:0,width:0}),a=(0,em.useCallback)(e=>{if(null!=e){var a=e.getBoundingClientRect(),n={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(n.height-t.height)>1||Math.abs(n.left-t.left)>1||Math.abs(n.top-t.top)>1||Math.abs(n.width-t.width)>1)&&r({height:n.height,left:n.left,top:n.top,width:n.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}var RS=["x","y","top","left","width","height","className"];function RE(){return(RE=Object.assign.bind()).apply(null,arguments)}function RC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var RT=e=>{var{x:t=0,y:r=0,top:a=0,left:n=0,width:s=0,height:i=0,className:o}=e,l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RC(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RC(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({x:t,y:r,top:a,left:n,width:s,height:i},function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,RS));return bD(t)&&bD(r)&&bD(s)&&bD(i)&&bD(a)&&bD(n)?em.createElement("path",RE({},_a(l),{className:(0,vU.clsx)("recharts-cross",o),d:"M".concat(t,",").concat(a,"v").concat(i,"M").concat(n,",").concat(r,"h").concat(s)})):null};function RA(e){var{cx:t,cy:r,radius:a,startAngle:n,endAngle:s}=e;return{points:[Sk(t,r,a,n),Sk(t,r,a,s)],cx:t,cy:r,radius:a,startAngle:n,endAngle:s}}function R_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function RO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R_(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R_(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function RP(){return(RP=Object.assign.bind()).apply(null,arguments)}function RD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function RR(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RD(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RD(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function RM(e){var{cursor:t,cursorComp:r,cursorProps:a}=e;return(0,em.isValidElement)(t)?(0,em.cloneElement)(t,a):(0,em.createElement)(r,a)}function RI(e){var t,r,a,n,s,{coordinate:i,payload:o,index:l,offset:c,tooltipAxisBandSize:d,layout:u,cursor:h,tooltipEventType:f,chartName:p}=e;if(!h||!i||"ScatterChart"!==p&&"axis"!==f)return null;if("ScatterChart"===p)a=i,n=RT,s=SN.cursorLine;else if("BarChart"===p)t=d/2,a={stroke:"none",fill:"#ccc",x:"horizontal"===u?i.x-t:c.left+.5,y:"horizontal"===u?c.top+.5:i.y-t,width:"horizontal"===u?d:c.width-1,height:"horizontal"===u?c.height-1:d},n=PZ,s=SN.cursorRectangle;else if("radial"===u&&OF(i)){var{cx:m,cy:g,radius:x,startAngle:b,endAngle:y}=RA(i);a={cx:m,cy:g,startAngle:b,endAngle:y,innerRadius:x,outerRadius:x},n=De,s=SN.cursorLine}else a={points:function(e,t,r){if("horizontal"===e)return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if("vertical"===e)return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(OF(t)){if("centric"===e){var{cx:a,cy:n,innerRadius:s,outerRadius:i,angle:o}=t,l=Sk(a,n,s,o),c=Sk(a,n,i,o);return[{x:l.x,y:l.y},{x:c.x,y:c.y}]}return RA(t)}}(u,i,c)},n=OK,s=SN.cursorLine;var v="object"==typeof h&&"className"in h?h.className:void 0,w=RR(RR(RR(RR({stroke:"#ccc",pointerEvents:"none"},c),a),_r(h)),{},{payload:o,payloadIndex:l,className:(0,vU.clsx)("recharts-tooltip-cursor",v)});return em.createElement(DM,{zIndex:null!=(r=e.zIndex)?r:s},em.createElement(RM,{cursor:h,cursorComp:n,cursorProps:w}))}function RL(e){var t,r,a,n,s=(t=va(Em),r=va(Tt),a=va(C7),t&&a?vw(RO(RO({},t),{},{scale:a}),r):vw(void 0,r)),i=null!=(n=va(vR))?n:v6,o=va(v8),l=va(Sm);return null==s||null==i||null==o||null==l?null:em.createElement(RI,RP({},e,{offset:i,layout:o,tooltipAxisBandSize:s,chartName:l}))}function RF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function RB(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RF(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RF(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function RU(e){return e.dataKey}var Rz=[],RV={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Az.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function R$(e){var t,r,a,n,s,i,o,l,c,d,u=_H(e,RV),{active:h,allowEscapeViewBox:f,animationDuration:p,animationEasing:m,content:g,filterNull:x,isAnimationActive:b,offset:y,payloadUniqBy:v,position:w,reverseDirection:k,useTranslate3d:j,wrapperStyle:N,cursor:S,shared:E,trigger:C,defaultIndex:T,portal:A,axisId:_}=u,O=y9(),P="number"==typeof T?String(T):T;(0,em.useEffect)(()=>{O(yB({shared:E,trigger:C,axisId:_,active:h,defaultIndex:P}))},[O,E,C,_,h,P]);var D=v3(),R=A3(),M=va(e=>Cy(e,E)),{activeIndex:I,isActive:L}=null!=(c=va(e=>TT(e,M,C,P)))?c:{},F=va(e=>TC(e,M,C,P)),B=va(e=>TE(e,M,C,P)),U=va(e=>TS(e,M,C,P)),z=(0,em.useContext)(_E),V=null!=(d=null!=h?h:L)&&d,[H,W]=RN([F,V]),q="axis"===M?B:void 0;t=va(e=>((e,t,r)=>{if(null!=t){var a=CT(e);return"axis"===t?"hover"===r?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:"hover"===r?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}})(e,M,C)),r=va(Sb),a=va(Sg),n=va(Sx),i=null==(s=va(_k))?void 0:s.active,o=v3(),(0,em.useEffect)(()=>{if(!i&&null!=a&&null!=r){var e=yq({active:V,coordinate:U,dataKey:t,index:I,label:"number"==typeof q?String(q):q,sourceViewBox:o});_y.emit(_v,a,e,r)}},[i,U,t,I,q,r,a,n,V,o]);var G=null!=A?A:z;if(null==G||null==D||null==M)return null;var K=null!=F?F:Rz;V||(K=Rz),x&&K.length&&(K=Rj(K.filter(e=>null!=e.value&&(!0!==e.hide||u.includeHidden)),v,RU));var X=K.length>0,Y=em.createElement(Rw,{allowEscapeViewBox:f,animationDuration:p,animationEasing:m,isAnimationActive:b,active:V,coordinate:U,hasPayload:X,offset:y,position:w,reverseDirection:k,useTranslate3d:j,viewBox:D,wrapperStyle:N,lastBoundingBox:H,innerRef:W,hasPortalFromProps:!!A},(l=RB(RB({},u),{},{payload:K,label:q,active:V,activeIndex:I,coordinate:U,accessibilityLayer:R}),em.isValidElement(g)?em.cloneElement(g,l):"function"==typeof g?em.createElement(g,l):em.createElement(Rf,l)));return em.createElement(em.Fragment,null,(0,ov.createPortal)(Y,G),V&&em.createElement(RL,{cursor:S,tooltipEventType:M,coordinate:U,payload:K,index:I}))}function RH(){return(RH=Object.assign.bind()).apply(null,arguments)}function RW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var Rq={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function RG(e){var t,{data:r,iconType:a,inactiveColor:n}=e,s=32/6,i=32/3,o=r.inactive?n:r.color,l=null!=a?a:r.type;if("none"===l)return null;if("plainline"===l)return em.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:null==(t=r.payload)?void 0:t.strokeDasharray,x1:0,y1:16,x2:32,y2:16,className:"recharts-legend-icon"});if("line"===l)return em.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(16,"h").concat(i,"\n            A").concat(s,",").concat(s,",0,1,1,").concat(2*i,",").concat(16,"\n            H").concat(32,"M").concat(2*i,",").concat(16,"\n            A").concat(s,",").concat(s,",0,1,1,").concat(i,",").concat(16),className:"recharts-legend-icon"});if("rect"===l)return em.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(4,"h").concat(32,"v").concat(24,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(em.isValidElement(r.legendIcon)){var c=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RW(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RW(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},r);return delete c.legendIcon,em.cloneElement(r.legendIcon,c)}return em.createElement(Dk,{fill:o,cx:16,cy:16,size:32,sizeType:"diameter",type:l})}function RK(e){var{payload:t,iconSize:r,layout:a,formatter:n,inactiveColor:s,iconType:i}=e,o={x:0,y:0,width:32,height:32},l={display:"horizontal"===a?"inline-block":"block",marginRight:10},c={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((t,a)=>{var d=t.formatter||n,u=(0,vU.clsx)({"recharts-legend-item":!0,["legend-item-".concat(a)]:!0,inactive:t.inactive});if("none"===t.type)return null;var h=t.inactive?s:t.color,f=d?d(t.value,t,a):t.value;return em.createElement("li",RH({className:u,style:l,key:"legend-item-".concat(a)},OB(e,t,a)),em.createElement(_i,{width:r,height:r,viewBox:o,style:c,"aria-label":"".concat(f," legend icon")},em.createElement(RG,{data:t,iconType:i,inactiveColor:s})),em.createElement("span",{className:"recharts-legend-item-text",style:{color:h}},f))})}var RX=e=>{var t=_H(e,Rq),{payload:r,layout:a,align:n}=t;return r&&r.length?em.createElement("ul",{className:"recharts-default-legend",style:{padding:0,margin:0,textAlign:"horizontal"===a?n:"left"}},em.createElement(RK,RH({},t,{payload:r}))):null},RY=["contextPayload"];function RQ(){return(RQ=Object.assign.bind()).apply(null,arguments)}function RJ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function RZ(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RJ(Object(r),!0).forEach(function(t){var a,n,s;a=e,n=t,s=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in a?Object.defineProperty(a,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[n]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RJ(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function R0(e){return e.value}function R1(e){var{contextPayload:t}=e,r=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if(({}).hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,RY),a=Rj(t,e.payloadUniqBy,R0),n=RZ(RZ({},r),{},{payload:a});return em.isValidElement(e.content)?em.cloneElement(e.content,n):"function"==typeof e.content?em.createElement(e.content,n):em.createElement(RX,n)}function R2(e){var t=y9();return(0,em.useEffect)(()=>{t(Al(e))},[t,e]),null}function R5(e){var t=y9();return(0,em.useEffect)(()=>(t(Ao(e)),()=>{t(Ao({width:0,height:0}))}),[t,e]),null}var R4={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function R3(e){var t,r=_H(e,R4),a=va(vi),n=(0,em.useContext)(_C),s=va(e=>e.layout.margin),{width:i,height:o,wrapperStyle:l,portal:c}=r,[d,u]=RN([a]),h=va(vN),f=va(vS);if(null==h||null==f)return null;var p=h-((null==s?void 0:s.left)||0)-((null==s?void 0:s.right)||0),m=(t=r.layout,"vertical"===t&&bD(o)?{height:o}:"horizontal"===t?{width:i||p}:null),g=c?l:RZ(RZ({position:"absolute",width:(null==m?void 0:m.width)||i||"auto",height:(null==m?void 0:m.height)||o||"auto"},function(e,t,r,a,n,s){var i,o,{layout:l,align:c,verticalAlign:d}=t;return e&&(void 0!==e.left&&null!==e.left||void 0!==e.right&&null!==e.right)||(i="center"===c&&"vertical"===l?{left:((a||0)-s.width)/2}:"right"===c?{right:r&&r.right||0}:{left:r&&r.left||0}),e&&(void 0!==e.top&&null!==e.top||void 0!==e.bottom&&null!==e.bottom)||(o="middle"===d?{top:((n||0)-s.height)/2}:"bottom"===d?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),RZ(RZ({},i),o)}(l,r,s,h,f,d)),l),x=null!=c?c:n;if(null==x||null==a)return null;var b=em.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:u},em.createElement(R2,{layout:r.layout,align:r.align,verticalAlign:r.verticalAlign,itemSorter:r.itemSorter}),!c&&em.createElement(R5,{width:d.width,height:d.height}),em.createElement(R1,RQ({},r,m,{margin:s,chartWidth:h,chartHeight:f,contextPayload:a})));return(0,ov.createPortal)(b,x)}R3.displayName="Legend";var R6=em;function R8(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class R7 extends R6.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=iI(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function R9({children:e,isPresent:t,anchorX:r,root:a}){let n=(0,R6.useId)(),s=(0,R6.useRef)(null),i=(0,R6.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=(0,R6.useContext)(ax),l=function(...e){return em.useCallback(function(...e){return t=>{let r=!1,a=e.map(e=>{let a=R8(e,t);return r||"function"!=typeof a||(r=!0),a});if(r)return()=>{for(let t=0;t<a.length;t++){let r=a[t];"function"==typeof r?r():R8(e[t],null)}}}}(...e),e)}(s,e?.ref);return(0,R6.useInsertionEffect)(()=>{let{width:e,height:l,top:c,left:d,right:u}=i.current;if(t||!s.current||!e||!l)return;let h="left"===r?`left: ${d}`:`right: ${u}`;s.current.dataset.motionPopId=n;let f=document.createElement("style");o&&(f.nonce=o);let p=a??document.head;return p.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{p.contains(f)&&p.removeChild(f)}},[t]),(0,ep.jsx)(R7,{isPresent:t,childRef:s,sizeRef:i,children:R6.cloneElement(e,{ref:l})})}let Me=({children:e,initial:t,isPresent:r,onExitComplete:a,custom:n,presenceAffectsLayout:s,mode:i,anchorX:o,root:l})=>{let c=aC(Mt),d=(0,em.useId)(),u=!0,h=(0,em.useMemo)(()=>(u=!1,{id:d,initial:t,isPresent:r,custom:n,onExitComplete:e=>{for(let t of(c.set(e,!0),c.values()))if(!t)return;a&&a()},register:e=>(c.set(e,!1),()=>c.delete(e))}),[r,c,a]);return s&&u&&(h={...h}),(0,em.useMemo)(()=>{c.forEach((e,t)=>c.set(t,!1))},[r]),em.useEffect(()=>{r||c.size||!a||a()},[r]),"popLayout"===i&&(e=(0,ep.jsx)(R9,{isPresent:r,anchorX:o,root:l,children:e})),(0,ep.jsx)(aE.Provider,{value:h,children:e})};function Mt(){return new Map}let Mr=e=>e.key||"";function Ma(e){let t=[];return em.Children.forEach(e,e=>{(0,em.isValidElement)(e)&&t.push(e)}),t}let Mn=({children:e,custom:t,initial:r=!0,onExitComplete:a,presenceAffectsLayout:n=!0,mode:s="sync",propagate:i=!1,anchorX:o="left",root:l})=>{let[c,d]=s_(i),u=(0,em.useMemo)(()=>Ma(e),[e]),h=i&&!c?[]:u.map(Mr),f=(0,em.useRef)(!0),p=(0,em.useRef)(u),m=aC(()=>new Map),[g,x]=(0,em.useState)(u),[b,y]=(0,em.useState)(u);aI(()=>{f.current=!1,p.current=u;for(let e=0;e<b.length;e++){let t=Mr(b[e]);h.includes(t)?m.delete(t):!0!==m.get(t)&&m.set(t,!1)}},[b,h.length,h.join("-")]);let v=[];if(u!==g){let e=[...u];for(let t=0;t<b.length;t++){let r=b[t],a=Mr(r);h.includes(a)||(e.splice(t,0,r),v.push(r))}return"wait"===s&&v.length&&(e=v),y(Ma(e)),x(u),null}let{forceRender:w}=(0,em.useContext)(am);return(0,ep.jsx)(ep.Fragment,{children:b.map(e=>{let g=Mr(e),x=(!i||!!c)&&(u===b||h.includes(g));return(0,ep.jsx)(Me,{isPresent:x,initial:(!f.current||!!r)&&void 0,custom:t,presenceAffectsLayout:n,mode:s,root:l,onExitComplete:x?void 0:()=>{if(!m.has(g))return;m.set(g,!0);let e=!0;m.forEach(t=>{t||(e=!1)}),e&&(w?.(),y(p.current),i&&d?.(),a&&a())},anchorX:o,children:e},g)})})},Ms="#17C787",Mi="#C8376B",Mo="#1E88E5",Ml="#C62FA8",Mc="#F4C04A",Md={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3}};function Mu(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)(!0),[a,n]=(0,em.useState)([]),[s,i]=(0,em.useState)([]),[o,l]=(0,em.useState)([]),[c,d]=(0,em.useState)(""),[u,h]=(0,em.useState)(""),[f,p]=(0,em.useState)(""),[m,g]=(0,em.useState)(""),[x,b]=(0,em.useState)("");(0,em.useEffect)(()=>{y()},[]);let y=async()=>{try{r(!0);let[e,t,a]=await Promise.all([e_.api.users.list(),e_.api.employees.list(),e_.api.audits.list({ignoreDate:"true"})]);n(Array.isArray(e.data)?e.data:[]),i(Array.isArray(t.data)?t.data:[]),l(Array.isArray(a.data)?a.data:[])}catch(e){console.error("Error fetching data:",e),eO.toast.error("Error al cargar datos")}finally{r(!1)}},v=e=>{"departamento"===e?(h(""),p(""),b(""),g("")):"rol"===e?(b(""),g("")):"grupo"===e&&g("")},w=(0,em.useMemo)(()=>a.filter(e=>e.role?.toLowerCase()==="auditor"&&!1!==e.active).sort((e,t)=>(e.nombre||"").localeCompare(t.nombre||"")),[a]),k=(0,em.useMemo)(()=>a.filter(e=>e.role?.toLowerCase()==="administrativo"&&!1!==e.active).sort((e,t)=>(e.nombre||"").localeCompare(t.nombre||"")),[a]),j=(0,em.useMemo)(()=>a.filter(e=>(e.role?.toLowerCase()==="supervisor"||e.role?.toLowerCase()==="supervisor_reventa")&&!1!==e.active).sort((e,t)=>(e.nombre||"").localeCompare(t.nombre||"")),[a]),N=(0,em.useMemo)(()=>{let e=new Set;return a.forEach(t=>{t.numeroEquipo&&e.add(t.numeroEquipo)}),Array.from(e).sort((e,t)=>Number(e)-Number(t))},[a]),S=(0,em.useMemo)(()=>x?a.filter(e=>{let t=e.role?.toLowerCase();return("asesor"===t||"auditor"===t&&!!e.numeroEquipo)&&e.numeroEquipo===x&&!1!==e.active}).sort((e,t)=>(e.nombre||"").localeCompare(t.nombre||"")):[],[a,x]),E=(0,em.useMemo)(()=>a.find(e=>e._id===m),[a,m]),C=(0,em.useMemo)(()=>m?s.find(e=>("string"==typeof e.userId?e.userId:e.userId?._id)===m):null,[s,m]),T=["completa","aprobada","cargada","qr hecho"],A=["falta clave","falta documentacin","falta clave y documentacin","rechazada","cort","cada","rehacer vdeo","aprobada, pero no reconoce clave"],_=["aprobada","qr hecho"],O=["rechazada","cort","cada","no le llegan los mensajes","no atendi","tiene dudas"],P=(0,em.useMemo)(()=>{if(!m)return null;let e=e=>(e||"").toLowerCase().trim(),t=e=>e?"string"==typeof e?e:String(e._id||e):"",r=[],a=[],n=()=>!1;"corporativo"===c?"auditor"===u?(n=e=>t(e.auditor)===m,r=T,a=A):"admin"===u&&(n=e=>t(e.administrador)===m,r=["qr hecho"],a=[]):"ventas"===c&&("supervisor"===f?(n=e=>(e=>{if(e.supervisorSnapshot?._id)return String(e.supervisorSnapshot._id);let t=e.asesor;return t&&"object"==typeof t&&t.supervisor?._id?String(t.supervisor._id):""})(e)===m,r=_,a=O):"asesor"===f&&(n=e=>t(e.asesor)===m,r=_,a=O));let s=o.filter(n),i=s.filter(t=>r.includes(e(t.status))),l=s.filter(t=>a.includes(e(t.status))),d=new Date,h=new Date(d.getFullYear(),d.getMonth(),1),p=new Date(d.getFullYear(),d.getMonth()+1,0,23,59,59),g=e=>new Date(e.fechaCreacionQR?e.fechaCreacionQR:e.scheduledAt||""),x=i.filter(e=>{let t=g(e);return!isNaN(t.getTime())&&t>=h&&t<=p}).length,b=new Map;i.forEach(e=>{let t=g(e);if(!isNaN(t.getTime())){let e=`${t.getFullYear()}-${t.getMonth()}`;b.set(e,(b.get(e)||0)+1)}});let y=b.size>0?Math.max(...Array.from(b.values())):0,v=s.length,w=i.length,k=l.length,j=w+k>0?Math.round(w/(w+k)*100):0;return{total:v,successCount:w,failCount:k,successThisMonth:x,record:y,successRate:j,pieData:[{name:"Exitosas",value:w,color:Ms},{name:"Fallidas",value:k,color:Mi}]}},[o,m,c,u,f]),D=()=>"corporativo"===c&&"admin"===u?{total:"QR's hechos",thisMonth:"QR's hechos este mes",record:"Rcord de QR's"}:"corporativo"===c&&"auditor"===u?{total:"Auditoras",success:"Auditoras exitosas",fail:"Auditoras fallidas",thisMonth:"Auditoras completadas este mes",record:"Rcord de auditoras"}:{total:"Ventas",success:"Ventas exitosas",fail:"Ventas fallidas",thisMonth:"Ventas completadas este mes",record:"Rcord de ventas"};if(t)return(0,ep.jsx)("div",{className:"flex justify-center py-12",children:(0,ep.jsx)(e2.Loader2,{className:"w-8 h-8 animate-spin text-purple-500"})});let R=(0,eg.cn)("w-full px-4 py-3 rounded-xl border text-sm font-medium transition-all","dark"===e?"bg-white/5 border-white/10 text-white hover:bg-white/10":"bg-white border-gray-200 text-gray-800 hover:border-gray-300 shadow-sm"),M=(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm");return(0,ep.jsxs)("div",{className:"space-y-6",children:[(0,ep.jsxs)("div",{className:M,children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold mb-2","dark"===e?"text-white":"text-gray-800"),children:"Estadsticas por Departamento"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mb-6","dark"===e?"text-gray-400":"text-gray-600"),children:"Seleccione un departamento para comenzar"}),(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gg.Building2,{className:"w-4 h-4",style:{color:Mo}})," Elige un departamento"]}),(0,ep.jsxs)("select",{value:c,onChange:e=>{d(e.target.value),v("departamento")},className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar departamento..."}),(0,ep.jsx)("option",{value:"corporativo",children:"Corporativo"}),(0,ep.jsx)("option",{value:"ventas",children:"Ventas"})]})]}),(0,ep.jsxs)(Mn,{mode:"wait",children:["corporativo"===c&&(0,ep.jsxs)(iX.div,{...Md,children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gj,{className:"w-4 h-4",style:{color:Ml}})," Seleccione un rol"]}),(0,ep.jsxs)("select",{value:u,onChange:e=>{h(e.target.value),v("rol")},className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar rol..."}),(0,ep.jsx)("option",{value:"auditor",children:"Auditor"}),(0,ep.jsx)("option",{value:"admin",children:"Administrativo"})]})]},"corp-rol"),"ventas"===c&&(0,ep.jsxs)(iX.div,{...Md,children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gj,{className:"w-4 h-4",style:{color:Ml}})," Seleccione un rol"]}),(0,ep.jsxs)("select",{value:f,onChange:e=>{p(e.target.value),v("rol")},className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar rol..."}),(0,ep.jsx)("option",{value:"supervisor",children:"Supervisor"}),(0,ep.jsx)("option",{value:"asesor",children:"Asesor"})]})]},"ventas-rol")]}),(0,ep.jsxs)(Mn,{mode:"wait",children:["corporativo"===c&&"auditor"===u&&(0,ep.jsxs)(iX.div,{...Md,children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gy,{className:"w-4 h-4",style:{color:Ms}})," Seleccione un auditor"]}),(0,ep.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar auditor..."}),w.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre||e.email},e._id))]})]},"auditor-sel"),"corporativo"===c&&"admin"===u&&(0,ep.jsxs)(iX.div,{...Md,children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gb.UserCog,{className:"w-4 h-4",style:{color:Mc}})," Seleccione un administrativo"]}),(0,ep.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar administrativo..."}),k.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre||e.email},e._id))]})]},"admin-sel"),"ventas"===c&&"supervisor"===f&&(0,ep.jsxs)(iX.div,{...Md,children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(ew.Users,{className:"w-4 h-4",style:{color:Mo}})," Seleccione un supervisor"]}),(0,ep.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar supervisor..."}),j.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre||e.email," ",e.numeroEquipo?`(${e.numeroEquipo})`:""]},e._id))]})]},"sup-sel"),"ventas"===c&&"asesor"===f&&(0,ep.jsxs)(iX.div,{...Md,className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(ew.Users,{className:"w-4 h-4",style:{color:Mc}})," Seleccione un grupo"]}),(0,ep.jsxs)("select",{value:x,onChange:e=>{b(e.target.value),v("grupo")},className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar grupo..."}),N.map(e=>(0,ep.jsxs)("option",{value:e,children:["Grupo ",e]},e))]})]}),(0,ep.jsx)(Mn,{mode:"wait",children:x&&(0,ep.jsxs)(iX.div,{...Md,children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-xs font-medium mb-2 flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gx,{className:"w-4 h-4",style:{color:Ms}})," Seleccione un asesor"]}),(0,ep.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:R,children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar asesor..."}),S.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre||e.email},e._id))]})]},"asesor-sel")})]},"asesor-flow")]})]})]}),(0,ep.jsx)(Mn,{mode:"wait",children:m&&P&&(0,ep.jsx)(iX.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},exit:{opacity:0,y:-30},transition:{duration:.4},className:M,children:(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[("corporativo"!==c||"admin"!==u)&&(0,ep.jsxs)("div",{className:"flex-1 min-w-[280px]",children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("text-base font-semibold mb-4 flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)(gw,{className:"w-5 h-5",style:{color:Ms}})," Tasa de xito - ",(()=>{if("corporativo"===c){if("auditor"===u)return"Auditor";if("admin"===u)return"Administrativo"}else if("ventas"===c){if("supervisor"===f)return"Supervisor";if("asesor"===f)return"Asesor"}return""})()]}),(0,ep.jsx)("div",{className:"h-[250px]",children:(0,ep.jsx)(v5,{width:"100%",height:"100%",children:(0,ep.jsxs)(_Q,{children:[(0,ep.jsx)(Rl,{data:P.pieData,cx:"50%",cy:"50%",innerRadius:60,outerRadius:90,paddingAngle:2,dataKey:"value",label:({name:e,percent:t})=>`${e}: ${((t??0)*100).toFixed(0)}%`,labelLine:!1,children:P.pieData.map((e,t)=>(0,ep.jsx)(Pm,{fill:e.color},`cell-${t}`))}),(0,ep.jsx)(R$,{formatter:e=>[e,""],contentStyle:{backgroundColor:"dark"===e?"#1f2937":"#fff",border:"dark"===e?"1px solid rgba(255,255,255,0.1)":"1px solid #e5e7eb",borderRadius:"8px"}}),(0,ep.jsx)(R3,{})]})})}),(0,ep.jsxs)("div",{className:"text-center mt-2",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-3xl font-bold","dark"===e?"text-white":"text-gray-800"),children:[P.successRate,"%"]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm ml-2","dark"===e?"text-gray-400":"text-gray-500"),children:"tasa de xito"})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex-1 min-w-[280px] rounded-xl p-5","dark"===e?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("h3",{className:(0,eg.cn)("text-base font-semibold mb-4 flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)(gv,{className:"w-5 h-5",style:{color:Mc}})," Resumen - ",E?.nombre||"Usuario"]}),(0,ep.jsxs)("div",{className:"space-y-3",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(eS,{className:"w-4 h-4"})," Fecha de ingreso"]}),(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:C?.fechaIngreso?new Date(C.fechaIngreso).toLocaleDateString("es-AR"):"-"})]}),"corporativo"===c&&"admin"===u?(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:D().total}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Mo},children:P.successCount})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:D().thisMonth}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Ms},children:P.successThisMonth})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:D().record}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Mc},children:P.record})]})]}):(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:D().total}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Mo},children:P.total})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gw,{className:"w-4 h-4",style:{color:Ms}})," ",D().success]}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Ms},children:P.successCount})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gk,{className:"w-4 h-4",style:{color:Mi}})," ",D().fail]}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Mi},children:P.failCount})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2 border-b","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:D().thisMonth}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Ms},children:P.successThisMonth})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-between py-2","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm flex items-center gap-2","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,ep.jsx)(gv,{className:"w-4 h-4",style:{color:Mc}})," ",D().record]}),(0,ep.jsx)("span",{className:"font-bold",style:{color:Mc},children:P.record})]})]})]})]})]})},"stats")}),!m&&c&&(0,ep.jsx)(iX.div,{initial:{opacity:0},animate:{opacity:1},className:(0,eg.cn)("text-center py-12 rounded-2xl border","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Complete la seleccin para ver las estadsticas"})})]})}let Mh=(0,ek.default)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Mf=(0,ek.default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var Mp=e.i(97084),Mm=e.i(49601);let Mg={success:"#17C787",error:"#C8376B",primary:"#1E88E5",secondary:"#C62FA8",warning:"#F4C04A"},Mx={initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3}};function Mb(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)(!0),[a,n]=(0,em.useState)("supervisor"),[s,i]=(0,em.useState)(15>=new Date().getDate()),[o,l]=(0,em.useState)(null),[c,d]=(0,em.useState)(null),[u,h]=(0,em.useState)(!1);(0,em.useEffect)(()=>{f()},[]);let f=async()=>{try{r(!0);let[e,t]=await Promise.all([e_.api.lowPerformance.getCurrentPeriod(),e_.api.lowPerformance.getStats()]);l(e.data),d(t.data)}catch(e){console.error("Error fetching data:",e),eO.toast.error("Error al cargar datos de rendimiento")}finally{r(!1)}},p=async()=>{try{h(!0),await e_.api.lowPerformance.evaluate({}),eO.toast.success("Evaluacin histrica completada correctamente"),f()}catch(e){eO.toast.error("Error al evaluar historial")}finally{h(!1)}},m="supervisor"===a?o?.supervisors:o?.asesors,g="supervisor"===a?30:6,x="supervisor"===a?50:8,b=new Date().toLocaleDateString("es-ES",{month:"long"}),y=new Date().getDate()>15,v="supervisor"===a?c?.topSupervisors||[]:c?.topAsesors||[],w=(e,t,r)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-3 rounded-lg border transition-colors mb-2 last:mb-0","supervisor"===a?"bg-card/50 hover:bg-accent/5":"bg-card hover:bg-accent/5"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs","supervisor"===a?"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400":"bg-pink-100 dark:bg-pink-900/30 text-pink-600 dark:text-pink-400"),children:e.qrHechoCount}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:"font-medium text-sm",children:e.user.nombre}),"supervisor"===a&&void 0!==e.advisorCount&&(0,ep.jsxs)("p",{className:"text-[10px] italic text-muted-foreground/70",children:["Asesores asignados: ",e.advisorCount]}),e.user.numeroEquipo&&(0,ep.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Equipo ",e.user.numeroEquipo]})]})]}),(0,ep.jsxs)("div",{className:"text-right",children:[(0,ep.jsxs)("span",{className:"text-xs font-medium text-red-500",children:["Faltan ",e.deficit]}),(0,ep.jsx)("div",{className:"w-24 h-1.5 bg-secondary/20 rounded-full mt-1 overflow-hidden",children:(0,ep.jsx)("div",{className:(0,eg.cn)("h-full","supervisor"===a?"bg-orange-500":"bg-pink-500"),style:{width:`${Math.min(e.qrHechoCount/r*100,100)}%`}})})]})]},t),k=(e,t)=>{let r=e.reduce((e,t)=>{let r=t.user.numeroEquipo||"Sin Equipo";return e[r]||(e[r]=[]),e[r].push(t),e},{});return Object.keys(r).sort((e,t)=>"Sin Equipo"===e?1:"Sin Equipo"===t?-1:parseInt(e)-parseInt(t)).map(e=>(0,ep.jsxs)("div",{className:"mb-4 last:mb-0",children:[(0,ep.jsxs)("h4",{className:"text-xs font-semibold text-muted-foreground mb-2 flex items-center gap-2 pl-1 border-l-2 border-primary/40",children:["Equipo ",e]}),(0,ep.jsx)("div",{className:"space-y-1 pl-1",children:r[e].map((e,r)=>w(e,r,t))})]},e))};return t?(0,ep.jsxs)("div",{className:"flex items-center justify-center p-12",children:[(0,ep.jsx)(e2.Loader2,{className:"h-8 w-8 animate-spin text-primary"}),(0,ep.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Cargando anlisis de rendimiento..."})]}):(0,ep.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:"text-2xl font-bold tracking-tight bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Control de Bajo Rendimiento"}),(0,ep.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Monitoreo en tiempo real de metas quincenales y mensuales."})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2 bg-secondary/20 p-1 rounded-lg",children:[(0,ep.jsxs)("button",{onClick:()=>n("supervisor"),className:(0,eg.cn)("px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center gap-2","supervisor"===a?"bg-white dark:bg-zinc-800 shadow-sm text-primary ring-1 ring-primary/20":"text-muted-foreground hover:text-foreground"),children:[(0,ep.jsx)(ew.Users,{className:"w-4 h-4"}),"Supervisores"]}),(0,ep.jsxs)("button",{onClick:()=>n("asesor"),className:(0,eg.cn)("px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 flex items-center gap-2","asesor"===a?"bg-white dark:bg-zinc-800 shadow-sm text-pink-600 dark:text-pink-400 ring-1 ring-pink-500/20":"text-muted-foreground hover:text-foreground"),children:[(0,ep.jsx)(oo,{className:"w-4 h-4"}),"Asesores"]})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[!s&&y?(0,ep.jsxs)("div",{className:"bg-card rounded-xl border border-dashed shadow-sm flex flex-col items-center justify-center p-8 text-muted-foreground gap-3 min-h-[300px]",children:[(0,ep.jsx)(eV.Clock,{className:"w-10 h-10 opacity-20"}),(0,ep.jsx)("p",{className:"text-sm",children:"El periodo quincenal ha finalizado."}),(0,ep.jsx)("button",{onClick:()=>i(!0),className:"text-xs bg-secondary/50 hover:bg-secondary text-secondary-foreground px-3 py-1.5 rounded transition-colors",children:"Ver Histrico Quincena"})]}):(0,ep.jsxs)(iX.div,{className:"bg-card rounded-xl border shadow-sm overflow-hidden",initial:"initial",animate:"animate",variants:Mx,children:[(0,ep.jsxs)("div",{className:"p-4 border-b bg-gradient-to-r from-orange-50 to-transparent dark:from-orange-950/20 flex justify-between items-center",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 text-warning",children:[(0,ep.jsx)(eV.Clock,{className:"w-5 h-5"}),(0,ep.jsxs)("h3",{className:"font-semibold text-sm md:text-base capitalize",children:["Del 01 al 15 de ",b]})]}),(0,ep.jsxs)("div",{className:"text-xs font-mono bg-orange-100 dark:bg-orange-900/40 text-orange-700 dark:text-orange-400 px-2 py-1 rounded",children:["Meta: ",g]})]}),(0,ep.jsxs)("div",{className:"p-4",children:[m?.fortnight.length===0?(0,ep.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,ep.jsx)(Mh,{className:"w-12 h-12 mx-auto mb-2 opacity-20"}),(0,ep.jsx)("p",{children:"Todos cumplen la meta quincenal"})]}):(0,ep.jsx)("div",{className:"space-y-1 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:"asesor"===a?k(m.fortnight,g):m?.fortnight.map((e,t)=>w(e,t,g))}),(0,ep.jsxs)("div",{className:"mt-4 p-3 bg-secondary/10 rounded text-xs text-muted-foreground flex gap-2",children:[(0,ep.jsx)(Mp.Info,{className:"w-4 h-4 shrink-0"}),(0,ep.jsx)("p",{children:"Datos en tiempo real (1-15). No genera historial."})]})]})]}),(0,ep.jsxs)(iX.div,{className:"bg-card rounded-xl border shadow-sm overflow-hidden",initial:"initial",animate:"animate",variants:Mx,transition:{delay:.1},children:[(0,ep.jsxs)("div",{className:"p-4 border-b bg-gradient-to-r from-red-50 to-transparent dark:from-red-950/20 flex justify-between items-center",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 text-error",children:[(0,ep.jsx)(Mm.ShieldAlert,{className:"w-5 h-5"}),(0,ep.jsx)("h3",{className:"font-semibold text-sm md:text-base",children:"Cierre Mensual"})]}),(0,ep.jsxs)("div",{className:"text-xs font-mono bg-red-100 dark:bg-red-900/40 text-red-700 dark:text-red-400 px-2 py-1 rounded",children:["Meta: ",x]})]}),(0,ep.jsxs)("div",{className:"p-4",children:[m?.month.length===0?(0,ep.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,ep.jsx)(gv,{className:"w-12 h-12 mx-auto mb-2 opacity-20 text-success"}),(0,ep.jsx)("p",{children:"Todos cumplen la meta mensual actual"})]}):(0,ep.jsx)("div",{className:"space-y-1 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:"asesor"===a?k(m.month,x):m?.month.map((e,t)=>w(e,t,x))}),(0,ep.jsxs)("div",{className:"mt-4 pt-4 border-t flex justify-between items-center",children:[(0,ep.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:[b," ",new Date().getFullYear()]}),(0,ep.jsxs)("button",{onClick:p,disabled:u,className:"text-xs bg-primary/10 hover:bg-primary/20 text-primary px-3 py-1.5 rounded transition-colors flex items-center gap-1",children:[u?(0,ep.jsx)(e2.Loader2,{className:"w-3 h-3 animate-spin"}):(0,ep.jsx)(Mf,{className:"w-3 h-3"}),"Guardar Cierre Mes Anterior"]})]})]})]})]}),(0,ep.jsxs)(iX.div,{className:"mt-8 pt-8 border-t",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,ep.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,ep.jsx)(Mf,{className:"w-5 h-5 text-primary"}),"Historial de Incumplimientos (","supervisor"===a?"Supervisores":"Asesores",")"]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,ep.jsxs)("div",{className:"lg:col-span-1 bg-card border rounded-xl p-4 shadow-sm",children:[(0,ep.jsx)("h4",{className:"text-sm font-medium mb-4 text-center text-muted-foreground",children:"Ms Recurrentes (Acumulado)"}),(0,ep.jsx)("div",{className:"h-[300px] w-full",children:v.length>0?(0,ep.jsx)(v5,{width:"100%",height:"100%",children:(0,ep.jsxs)(_Q,{children:[(0,ep.jsx)(Rl,{data:v,dataKey:"appearances",nameKey:e=>e.user.nombre,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:2,children:v.map((e,t)=>(0,ep.jsx)(Pm,{fill:Object.values(Mg)[t%5]},`cell-${t}`))}),(0,ep.jsx)(R$,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),(0,ep.jsx)(R3,{layout:"horizontal",verticalAlign:"bottom",height:36,iconType:"circle"})]})}):(0,ep.jsx)("div",{className:"h-full flex items-center justify-center text-muted-foreground text-sm",children:"Sin datos histricos"})})]}),(0,ep.jsx)("div",{className:"lg:col-span-2 space-y-3",children:0===v.length?(0,ep.jsx)("div",{className:"text-center py-12 bg-secondary/5 rounded-xl border border-dashed",children:(0,ep.jsx)("p",{className:"text-muted-foreground",children:"No hay registros histricos de incumplimiento para este rol."})}):v.map((e,t)=>(0,ep.jsxs)("div",{className:"flex items-center justify-between p-4 bg-card border rounded-lg hover:shadow-md transition-shadow",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-4",children:[(0,ep.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center font-bold text-slate-600 dark:text-slate-300",children:t+1}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:"font-semibold text-foreground",children:e.user.nombre}),(0,ep.jsxs)("div",{className:"flex gap-4 text-sm text-muted-foreground mt-0.5",children:[(0,ep.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ep.jsx)(eJ.AlertTriangle,{className:"w-3 h-3 text-error"}),e.appearances," Fallos"]}),(0,ep.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ep.jsx)(gk,{className:"w-3 h-3"}),"Promedio QR: ",e.avgQrCount]})]})]})]}),(0,ep.jsxs)("div",{className:"text-right",children:[(0,ep.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Dficit Acumulado"}),(0,ep.jsxs)("span",{className:"text-lg font-bold text-error",children:["-",e.totalDeficit," QR"]})]})]},t))})]})]})]})}var My=e.i(42410),Mv=e.i(34885);let Mw=(0,ek.default)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Mk=(0,ek.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var Mj=e.i(36045);function MN({userId:e,teamHistory:t=[],currentNumeroEquipo:r,userCreatedAt:a,onUpdate:n}){let{theme:s}=(0,ex.useTheme)(),{user:i}=(0,i4.useAuth)(),o=i?.role?.toLowerCase()||"",l="gerencia"===o||o.includes("rrhh")||o.includes("rr.hh"),[c,d]=(0,em.useState)(!1),[u,h]=(0,em.useState)(""),[f,p]=(0,em.useState)(""),[m,g]=(0,em.useState)(""),[x,b]=(0,em.useState)(!1),y=async()=>{if(!u||!f)return void eO.toast.error("Equipo y fecha de inicio son requeridos");try{b(!0),await e_.api.users.addTeamChange(e,{nuevoEquipo:u,fechaInicio:f,notes:m}),eO.toast.success("Cambio de equipo registrado exitosamente"),d(!1),h(""),p(""),g(""),n()}catch(e){console.error("Error adding team change:",e),eO.toast.error(e.response?.data?.error||"Error al registrar cambio de equipo")}finally{b(!1)}};return(0,ep.jsxs)("div",{className:"space-y-3",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(ew.Users,{className:"w-4 h-4 text-purple-500"}),(0,ep.jsx)("h4",{className:(0,eg.cn)("font-medium","dark"===s?"text-white":"text-gray-800"),children:"Historial de Equipos"})]}),l&&(0,ep.jsxs)("button",{onClick:()=>d(!0),className:"flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium bg-purple-600 text-white hover:bg-purple-700 transition-colors",children:[(0,ep.jsx)(e0.Plus,{className:"w-3 h-3"}),"Cambiar Equipo"]})]}),0!==t.length||r?0===t.length&&r?(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:"dark"===s?"bg-white/5":"bg-gray-50",children:[(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Equipo"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Desde"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Hasta"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Notas"})]})}),(0,ep.jsx)("tbody",{children:(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-t","dark"===s?"border-white/5":"border-gray-200"),children:[(0,ep.jsx)("td",{className:"px-2 py-2",children:(0,ep.jsxs)("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-600",children:[r," (Actual)"]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:a?new Date(a).toLocaleDateString("es-AR"):"Desde creacin"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:"Equipo asignado al crear la cuenta"})]})})]})}):(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:"dark"===s?"bg-white/5":"bg-gray-50",children:[(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Equipo"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Desde"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Hasta"}),(0,ep.jsx)("th",{className:(0,eg.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Notas"})]})}),(0,ep.jsx)("tbody",{children:t.map(e=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-t","dark"===s?"border-white/5":"border-gray-200"),children:[(0,ep.jsx)("td",{className:"px-2 py-2",children:(0,ep.jsxs)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-xs font-medium",e.fechaFin?"dark"===s?"bg-white/10 text-gray-300":"bg-gray-100 text-gray-700":"bg-green-500/20 text-green-600"),children:[e.numeroEquipo," ",!e.fechaFin&&"(Actual)"]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:new Date(e.fechaInicio).toLocaleDateString("es-AR")}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:e.fechaFin?new Date(e.fechaFin).toLocaleDateString("es-AR"):"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:e.notes||"-"})]},e._id))})]})}):(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-lg border text-center text-sm","dark"===s?"bg-white/5 border-white/10 text-gray-400":"bg-gray-50 border-gray-200 text-gray-500"),children:[(0,ep.jsx)(eZ,{className:"w-5 h-5 mx-auto mb-2 opacity-50"}),"No hay historial de equipos registrado"]}),c&&(0,ep.jsx)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center p-4 pt-20 overflow-y-auto",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-md rounded-2xl border p-6 shadow-xl","dark"===s?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-semibold mb-4","dark"===s?"text-white":"text-gray-800"),children:"Cambiar Equipo"}),(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Nuevo Equipo (numeroEquipo) *"}),(0,ep.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Ej: 42",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Fecha de Inicio *"}),(0,ep.jsx)("input",{type:"date",value:f,onChange:e=>p(e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Notas (opcional)"}),(0,ep.jsx)("textarea",{rows:2,value:m,onChange:e=>g(e.target.value),placeholder:"Motivo del cambio...",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===s?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),r&&(0,ep.jsxs)("div",{className:"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20 text-yellow-600 dark:text-yellow-500 text-xs",children:[" El equipo actual (",r,") se cerrar automticamente el da anterior a la fecha de inicio."]})]}),(0,ep.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,ep.jsx)("button",{onClick:()=>d(!1),className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===s?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:y,disabled:x||!u||!f,className:"px-4 py-2 rounded-lg text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Guardando...":"Confirmar Cambio"})]})]})})]})}let MS={supervisor:"#17C787",auditor:"#1E88E5",asesor:"#F4C04A",admin:"#C62FA8","rr.hh":"#C8376B",gerencia:"#7C3AED"};function ME(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),r=t?.role?.toLowerCase()||"",a="gerencia"===r,n="rr.hh"===r,s=a||n||"supervisor"===r,i=a||n,o=["supervisor","supervisor_reventa"].includes(t?.role?.toLowerCase()||""),l=t?.numeroEquipo?String(t.numeroEquipo):null,[c,d]=(0,em.useState)([]),[u,h]=(0,em.useState)(!0),[f,p]=(0,em.useState)(""),[m,g]=(0,em.useState)(""),[x,b]=(0,em.useState)(!1),[y,v]=(0,em.useState)(null),[w,k]=(0,em.useState)(!1),[j,N]=(0,em.useState)({}),[S,E]=(0,em.useState)(!1),[C,T]=(0,em.useState)(null),[A,_]=(0,em.useState)(!1),[O,P]=(0,em.useState)(null),[D,R]=(0,em.useState)({suspensionStart:"",suspensionEnd:""}),[M,I]=(0,em.useState)(!1);(0,em.useEffect)(()=>{L()},[]);let L=async()=>{try{h(!0);let e=(await e_.api.employees.list()).data.filter(e=>e.activo);if(o&&l&&(e=e.filter(e=>{let t=e.userId?.numeroEquipo||e.numeroEquipo;return!!t&&String(t)===l})),d(e),y){let t=e.find(e=>e._id===y._id);t&&v(t)}}catch(e){console.error("Error fetching employees:",e),eO.toast.error("Error al cargar empleados")}finally{h(!1)}},F=async()=>{if(y)try{k(!0);let e=j.fotoDNI||y.fotoDNI||"";if(C){E(!0);try{e=(await e_.api.employees.uploadDNI(C)).data.fotoDNI||""}catch(e){console.error("Error uploading DNI:",e),eO.toast.error(e.response?.data?.message||"Error al subir foto de DNI"),E(!1),k(!1);return}E(!1)}await e_.api.employees.update(y._id,{...j,fotoDNI:e}),eO.toast.success("Empleado actualizado correctamente"),y.activo&&!j.activo&&eO.toast.warning("Empleado desactivado. El usuario asociado tambin ha sido desactivado."),b(!1),T(null),L()}catch(e){console.error("Error updating employee:",e),eO.toast.error("Error al actualizar empleado")}finally{k(!1)}},B=e=>e?`/api${e}`:null,U=async e=>{if(confirm("Ests seguro de eliminar este empleado? Esta accin no se puede deshacer."))try{await e_.api.employees.delete(e),eO.toast.success("Empleado eliminado"),L()}catch(e){console.error("Error deleting employee:",e),eO.toast.error("Error al eliminar empleado")}},z=async()=>{if(!O?.userId?._id)return;if(!D.suspensionStart||!D.suspensionEnd)return void eO.toast.error("Debe completar ambas fechas");let e=new Date(D.suspensionStart),t=new Date(D.suspensionEnd);if(t<=e)return void eO.toast.error("La fecha de fin debe ser posterior a la de inicio");try{I(!0),await e_.api.users.suspend(O.userId._id,{suspensionStart:D.suspensionStart,suspensionEnd:D.suspensionEnd}),eO.toast.success(`Usuario ${O.nombreCompleto} suspendido hasta ${t.toLocaleDateString("es-AR")}`),_(!1),P(null),L()}catch(e){console.error("Error suspending user:",e),eO.toast.error(e.response?.data?.error||"Error al suspender usuario")}finally{I(!1)}},V=async e=>{if(e.userId?._id&&confirm(`\xbfCancelar la suspensi\xf3n de ${e.nombreCompleto}?`))try{await e_.api.users.cancelSuspension(e.userId._id),eO.toast.success("Suspensin cancelada"),L()}catch(e){console.error("Error canceling suspension:",e),eO.toast.error(e.response?.data?.error||"Error al cancelar suspensin")}},H=c.filter(e=>{let t=e.nombreCompleto.toLowerCase().includes(f.toLowerCase())||e.userId?.email.toLowerCase().includes(f.toLowerCase())||e.userId?.nombre.toLowerCase().includes(f.toLowerCase()),r=e.userId?.numeroEquipo||e.numeroEquipo,a=!m||r===m;return t&&a}).reduce((e,t)=>{let r=t.userId?.numeroEquipo||t.numeroEquipo||"Sin Equipo";return e[r]||(e[r]=[]),e[r].push(t),e},{}),W=c.length,q=c.filter(e=>e.firmoContrato).length,G=new Set(c.map(e=>e.cargo)).size,K=[{label:"Total Activos",value:W,icon:My.UserCheck,color:"#17C787"},{label:"Con Contrato",value:q,icon:Mv.FileText,color:"#F4C04A"},{label:"Cargos Distintos",value:G,icon:Mw,color:"#C62FA8"}];return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsx)("div",{className:"flex flex-wrap gap-3",children:K.map((t,r)=>{let a=t.icon;return(0,ep.jsxs)("div",{className:(0,eg.cn)("flex-1 min-w-[140px] rounded-xl border p-4 flex items-center justify-between","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,ep.jsx)("p",{className:"text-2xl font-bold",style:{color:t.color},children:t.value})]}),(0,ep.jsx)(a,{className:"w-6 h-6",style:{color:t.color}})]},r)})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-2 mb-4 px-3 py-2 rounded-lg w-fit","bg-[#17C787]/10"),children:[(0,ep.jsx)(ou.CheckCircle,{className:"w-4 h-4",style:{color:"#17C787"}}),(0,ep.jsx)("span",{className:"text-sm",style:{color:"#17C787"},children:"Mostrando solo personal activo"})]}),(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,ep.jsxs)("div",{className:"flex-1 relative",children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email...",value:f,onChange:e=>p(e.target.value),className:(0,eg.cn)("w-full pl-10 pr-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,ep.jsxs)("select",{value:m,onChange:e=>g(e.target.value),className:(0,eg.cn)("px-4 py-2 rounded-lg border text-sm min-w-[180px]","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los equipos"}),Object.keys(H).sort().map(e=>(0,ep.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})]}),u&&(0,ep.jsx)("div",{className:"flex justify-center py-12",children:(0,ep.jsx)(eE.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}),!u&&0===c.length&&(0,ep.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No hay empleados activos registrados."}),!u&&Object.entries(H).map(([t,r])=>(0,ep.jsxs)("div",{className:"mb-6",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,ep.jsx)(ow.Filter,{className:"w-4 h-4",style:{color:"#1E88E5"}}),(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["Equipo ",t]})]}),(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-sm",children:[(0,ep.jsx)("thead",{children:(0,ep.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["NOMBRE","F. ENTREVISTA","F. INGRESO","CARGO","TELFONO","CONTRATO","ACTIVO","ACCIONES"].map(t=>(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-semibold text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:t},t))})}),(0,ep.jsx)("tbody",{children:r.map(t=>{let r;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:t.nombreCompleto}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","text-gray-500"),children:t.userId?.email})]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.fechaEntrevista?new Date(t.fechaEntrevista).toLocaleDateString():"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.fechaIngreso?new Date(t.fechaIngreso).toLocaleDateString():"-"}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium text-white capitalize",style:{backgroundColor:MS[t.cargo]||"#6B7280"},children:t.cargo})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.telefonoPersonal||"-"}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsx)(ou.CheckCircle,{className:"w-5 h-5",style:{color:t.firmoContrato?"#17C787":"#C8376B"}})}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsx)("span",{className:"text-xs font-medium",style:{color:"#17C787"},children:"S"})}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,ep.jsx)("button",{onClick:()=>{v(t),N({nombreCompleto:t.nombreCompleto,telefonoPersonal:t.telefonoPersonal,fechaEntrevista:t.fechaEntrevista,fechaIngreso:t.fechaIngreso?new Date(t.fechaIngreso).toISOString().split("T")[0]:"",firmoContrato:t.firmoContrato,activo:t.activo,notas:t.notas,fechaBaja:t.fechaBaja?new Date(t.fechaBaja).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],motivoBaja:t.motivoBaja||"",motivoBajaNormalizado:t.motivoBajaNormalizado||null}),b(!0)},className:(0,eg.cn)("p-1 rounded hover:bg-white/10 transition-colors","dark"===e?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),title:"Editar",children:(0,ep.jsx)(e1,{className:"w-4 h-4"})}),i&&(0,ep.jsx)("button",{onClick:()=>U(t._id),className:"p-1 rounded hover:bg-red-500/10 text-red-400 hover:text-red-500 transition-colors",title:"Eliminar",children:(0,ep.jsx)(eU.Trash2,{className:"w-4 h-4"})}),a&&(0,ep.jsx)(ep.Fragment,{children:(e=>{let t=e.userId;if(!t?.suspensionStart||!t?.suspensionEnd)return!1;let r=new Date,a=new Date(t.suspensionStart),n=new Date(t.suspensionEnd);return r>=a&&r<=n})(t)?(0,ep.jsx)("button",{onClick:()=>V(t),className:"p-1 rounded hover:bg-green-500/10 text-orange-400 hover:text-green-500 transition-colors",title:`Suspendido hasta ${(r=t.userId,r?.suspensionEnd?new Date(r.suspensionEnd).toLocaleDateString("es-AR"):null)} - Click para cancelar`,children:(0,ep.jsx)(eJ.AlertTriangle,{className:"w-4 h-4"})}):(0,ep.jsx)("button",{onClick:()=>(P(t),void(R({suspensionStart:new Date().toISOString().split("T")[0],suspensionEnd:new Date(Date.now()+864e5).toISOString().split("T")[0]}),_(!0))),className:"p-1 rounded hover:bg-orange-500/10 text-gray-400 hover:text-orange-500 transition-colors",title:"Suspender cuenta",children:(0,ep.jsx)(Mj.Ban,{className:"w-4 h-4"})})})]})})]},t._id)})})]})})]},t))]}),x&&y&&(0,ep.jsx)(MC,{children:(0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-xl flex flex-col max-h-[90vh]","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-6 flex-shrink-0",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Editar Empleado"}),(0,ep.jsx)("button",{onClick:()=>b(!1),className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Nombre Completo *"}),(0,ep.jsx)("input",{type:"text",value:j.nombreCompleto,onChange:e=>N({...j,nombreCompleto:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Telfono Personal"}),(0,ep.jsx)("input",{type:"text",value:j.telefonoPersonal,onChange:e=>N({...j,telefonoPersonal:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Cargo"}),(0,ep.jsx)("input",{type:"text",value:y.cargo,disabled:!0,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm capitalize","dark"===e?"bg-white/10 border-white/10 text-gray-400":"bg-gray-100 border-gray-200 text-gray-500")})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Entrevista"}),(0,ep.jsx)("input",{type:"date",value:j.fechaEntrevista?new Date(j.fechaEntrevista).toISOString().split("T")[0]:"",onChange:e=>N({...j,fechaEntrevista:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Ingreso"}),(0,ep.jsx)("input",{type:"date",value:j.fechaIngreso,onChange:e=>N({...j,fechaIngreso:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-6",children:[(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:j.firmoContrato,onChange:e=>N({...j,firmoContrato:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Firm el contrato?"})]}),(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:j.activo,onChange:e=>N({...j,activo:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Activo?"})]})]}),!j.activo&&(0,ep.jsxs)("div",{className:"space-y-4 animate-fade-in-up",children:[(0,ep.jsx)("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-500 text-xs",children:" Al desactivar el empleado, el usuario asociado tambin ser desactivado automticamente."}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Egreso *"}),(0,ep.jsx)("input",{type:"date",value:j.fechaBaja,onChange:e=>N({...j,fechaBaja:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Motivo de Baja *"}),(0,ep.jsxs)("select",{value:j.motivoBajaNormalizado||"",onChange:e=>N({...j,motivoBajaNormalizado:e.target.value||null}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar motivo..."}),(0,ep.jsx)("option",{value:"Renuncia",children:"Renuncia"}),(0,ep.jsx)("option",{value:"Despido por bajo rendimiento",children:"Despido por bajo rendimiento"}),(0,ep.jsx)("option",{value:"Despido por inasistencias",children:"Despido por inasistencias"})]})]})]})]}),y.userId&&(0,ep.jsx)(MN,{userId:y.userId._id,teamHistory:y.userId.teamHistory,currentNumeroEquipo:y.userId.numeroEquipo,userCreatedAt:y.userId.createdAt,onUpdate:L}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-lg border","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-2 text-sm font-medium mb-3","dark"===e?"text-gray-300":"text-gray-700"),children:[(0,ep.jsx)(Mk,{className:"w-4 h-4",style:{color:"#F4C04A"}}),"Foto del DNI"]}),(y.fotoDNI||C)&&(0,ep.jsxs)("div",{className:"mb-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("relative w-full max-w-[200px] aspect-[3/2] rounded-lg overflow-hidden border","dark"===e?"border-white/10":"border-gray-200"),children:C?(0,ep.jsx)("img",{src:URL.createObjectURL(C),alt:"Vista previa DNI",className:"w-full h-full object-cover"}):y.fotoDNI?(0,ep.jsx)("img",{src:B(y.fotoDNI)||"",alt:"Foto DNI",className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}):null}),C&&(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-green-400":"text-green-600"),children:[" Nueva imagen seleccionada: ",C.name]})]}),(0,ep.jsxs)("div",{className:"flex flex-wrap gap-2",children:[y.fotoDNI&&!C&&(0,ep.jsxs)("a",{href:B(y.fotoDNI)||"",target:"_blank",rel:"noopener noreferrer",download:!0,className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors","dark"===e?"bg-white/10 text-gray-300 hover:bg-white/20":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,ep.jsx)(i0.Download,{className:"w-3 h-3"}),"Descargar"]}),(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium cursor-pointer transition-colors",S?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-[#1E88E5]/20 text-[#1E88E5] hover:bg-[#1E88E5]/30":"bg-[#1E88E5]/10 text-[#1E88E5] hover:bg-[#1E88E5]/20"),children:[(0,ep.jsx)(eI.Upload,{className:"w-3 h-3"}),y.fotoDNI||C?"Cambiar imagen":"Subir imagen",(0,ep.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{let t=e.target.files?.[0];if(t){if(t.size>5242880)return void eO.toast.error("El archivo no puede superar 5MB");if(!["image/jpeg","image/jpg","image/png"].includes(t.type))return void eO.toast.error("Solo se permiten archivos JPG y PNG");T(t)}},disabled:S,className:"hidden"})]}),C&&(0,ep.jsxs)("button",{onClick:()=>T(null),className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors","dark"===e?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-red-100 text-red-600 hover:bg-red-200"),children:[(0,ep.jsx)(eT.X,{className:"w-3 h-3"}),"Cancelar"]})]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-2","text-gray-500"),children:"Mximo 5MB. Formatos: JPG, PNG"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,ep.jsx)("textarea",{rows:3,value:j.notas,onChange:e=>N({...j,notas:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),placeholder:"Observaciones adicionales..."})]})]}),(0,ep.jsxs)("div",{className:"flex justify-end gap-3 mt-6 flex-shrink-0",children:[(0,ep.jsx)("button",{onClick:()=>b(!1),className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:F,disabled:w,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",w?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#17C787"},children:S?"Subiendo DNI...":w?"Guardando...":"Guardar Cambios"})]})]})})}),A&&O&&(0,ep.jsx)(MC,{children:(0,ep.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:[(0,ep.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>_(!1)}),(0,ep.jsxs)("div",{className:(0,eg.cn)("relative w-full max-w-md rounded-2xl border p-6 shadow-xl","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,ep.jsx)("div",{className:"p-2 rounded-full bg-orange-500/10",children:(0,ep.jsx)(Mj.Ban,{className:"w-6 h-6 text-orange-500"})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Suspender Cuenta"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:O.nombreCompleto})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("p-3 rounded-lg mb-4 text-sm","dark"===e?"bg-orange-500/10 text-orange-300":"bg-orange-50 text-orange-700"),children:(0,ep.jsxs)("p",{className:"flex items-start gap-2",children:[(0,ep.jsx)(eJ.AlertTriangle,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),(0,ep.jsx)("span",{children:"El usuario no podr acceder a la plataforma durante el perodo de suspensin. Si est conectado, su sesin ser cerrada automticamente."})]})}),(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-2 text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:[(0,ep.jsx)(eS,{className:"w-4 h-4"}),"Fecha de inicio"]}),(0,ep.jsx)("input",{type:"date",value:D.suspensionStart,onChange:e=>R({...D,suspensionStart:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-2 text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:[(0,ep.jsx)(eS,{className:"w-4 h-4"}),"Fecha de fin"]}),(0,ep.jsx)("input",{type:"date",value:D.suspensionEnd,onChange:e=>R({...D,suspensionEnd:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,ep.jsx)("button",{onClick:()=>_(!1),className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:z,disabled:M,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",M?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#F97316"},children:M?(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)(e2.Loader2,{className:"w-4 h-4 animate-spin"}),"Suspendiendo..."]}):(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)(Mj.Ban,{className:"w-4 h-4"}),"Suspender"]})})]})]})]})})]})}function MC({children:t}){let[r,a]=(0,em.useState)(!1);if((0,em.useEffect)(()=>(a(!0),()=>a(!1)),[]),!r)return null;let{createPortal:n}=e.r(56667);return n(t,document.body)}var MT=e.i(44126);let MA={supervisor:"#17C787",auditor:"#1E88E5",asesor:"#F4C04A",admin:"#C62FA8",rrhh:"#C8376B",gerencia:"#7C3AED"};function M_(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),r=t?.role?.toLowerCase()||"",a="gerencia"===r,n="rr.hh"===r||"rrhh"===r,s="supervisor"===r,i=a||n||s,o=a||n,l=["supervisor","supervisor_reventa"].includes(r),c=t?.numeroEquipo?String(t.numeroEquipo):null,[d,u]=(0,em.useState)([]),[h,f]=(0,em.useState)(!0),[p,m]=(0,em.useState)(""),[g,x]=(0,em.useState)(""),[b,y]=(0,em.useState)(!1),[v,w]=(0,em.useState)(null),[k,j]=(0,em.useState)(!1),[N,S]=(0,em.useState)({}),[E,C]=(0,em.useState)(!1),[T,A]=(0,em.useState)(null);(0,em.useEffect)(()=>{_()},[]);let _=async()=>{try{f(!0);let e=(await e_.api.employees.list()).data.filter(e=>!e.activo);l&&c&&(e=e.filter(e=>{let t=e.userId?.numeroEquipo||e.numeroEquipo;return!!t&&String(t)===c})),u(e)}catch(e){console.error("Error fetching employees:",e),eO.toast.error("Error al cargar empleados")}finally{f(!1)}},O=async()=>{if(v)try{j(!0);let e=N.fotoDNI||v.fotoDNI||"";if(T){C(!0);try{e=(await e_.api.employees.uploadDNI(T)).data.fotoDNI||""}catch(e){console.error("Error uploading DNI:",e),eO.toast.error(e.response?.data?.message||"Error al subir foto de DNI"),C(!1),j(!1);return}C(!1)}await e_.api.employees.update(v._id,{...N,fotoDNI:e}),eO.toast.success("Empleado actualizado correctamente"),!v.activo&&N.activo&&eO.toast.success("Empleado reactivado. Recuerda reactivar el usuario manualmente si es necesario."),y(!1),A(null),_()}catch(e){console.error("Error updating employee:",e),eO.toast.error("Error al actualizar empleado")}finally{j(!1)}},P=e=>e?`/api${e}`:null,D=async e=>{if(confirm("Ests seguro de eliminar DEFINITIVAMENTE este empleado? Esta accin no se puede deshacer."))try{await e_.api.employees.delete(e),eO.toast.success("Empleado eliminado permanentemente"),_()}catch(e){console.error("Error deleting employee:",e),eO.toast.error("Error al eliminar empleado")}},R=d.filter(e=>{let t=e.nombreCompleto.toLowerCase().includes(p.toLowerCase())||e.userId?.email.toLowerCase().includes(p.toLowerCase())||e.userId?.nombre.toLowerCase().includes(p.toLowerCase()),r=!g||e.numeroEquipo===g;return t&&r}).reduce((e,t)=>{let r=t.numeroEquipo||"Sin Equipo";return e[r]||(e[r]=[]),e[r].push(t),e},{}),M=[{label:"Total Inactivos",value:d.length,icon:MT.UserX,color:"#C8376B"}];return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsx)("div",{className:"flex flex-wrap gap-3",children:M.map((t,r)=>{let a=t.icon;return(0,ep.jsxs)("div",{className:(0,eg.cn)("flex-1 min-w-[140px] rounded-xl border p-4 flex items-center justify-between","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,ep.jsx)("p",{className:"text-2xl font-bold",style:{color:t.color},children:t.value})]}),(0,ep.jsx)(a,{className:"w-6 h-6",style:{color:t.color}})]},r)})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-2 mb-4 px-3 py-2 rounded-lg w-fit","bg-[#C8376B]/10"),children:[(0,ep.jsx)(of.XCircle,{className:"w-4 h-4",style:{color:"#C8376B"}}),(0,ep.jsx)("span",{className:"text-sm",style:{color:"#C8376B"},children:"Mostrando solo personal inactivo"})]}),(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,ep.jsxs)("div",{className:"flex-1 relative",children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email...",value:p,onChange:e=>m(e.target.value),className:(0,eg.cn)("w-full pl-10 pr-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,ep.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:(0,eg.cn)("px-4 py-2 rounded-lg border text-sm min-w-[180px]","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los equipos"}),Object.keys(R).sort().map(e=>(0,ep.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})]}),h&&(0,ep.jsx)("div",{className:"flex justify-center py-12",children:(0,ep.jsx)(eE.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}),!h&&0===d.length&&(0,ep.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No hay empleados inactivos registrados."}),!h&&Object.entries(R).map(([t,r])=>(0,ep.jsxs)("div",{className:"mb-6",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,ep.jsx)(ow.Filter,{className:"w-4 h-4",style:{color:"#1E88E5"}}),(0,ep.jsxs)("h3",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["Equipo ",t]})]}),(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-sm",children:[(0,ep.jsx)("thead",{children:(0,ep.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["NOMBRE","F. BAJA","MOTIVO","CARGO","TELFONO","CONTRATO","ACTIVO","ACCIONES"].map(t=>(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-2 text-left font-semibold text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:t},t))})}),(0,ep.jsx)("tbody",{children:r.map(t=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:t.nombreCompleto}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","text-gray-500"),children:t.userId?.email})]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.fechaBaja?new Date(t.fechaBaja).toLocaleDateString():"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3 max-w-[150px] truncate","dark"===e?"text-gray-400":"text-gray-600"),children:t.motivoBaja||"-"}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium text-white capitalize",style:{backgroundColor:MA[t.cargo]||"#6B7280"},children:t.cargo})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.telefonoPersonal||"-"}),(0,ep.jsx)("td",{className:"px-3 py-3",children:t.firmoContrato?(0,ep.jsx)(ou.CheckCircle,{className:"w-5 h-5",style:{color:"#17C787"}}):(0,ep.jsx)(of.XCircle,{className:"w-5 h-5",style:{color:"#C8376B"}})}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium text-white",style:{backgroundColor:"#C8376B"},children:"No"})}),(0,ep.jsx)("td",{className:"px-3 py-3",children:(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[i&&(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)("button",{onClick:()=>{w(t),S({nombreCompleto:t.nombreCompleto,telefonoPersonal:t.telefonoPersonal,fechaEntrevista:t.fechaEntrevista,fechaIngreso:t.fechaIngreso?new Date(t.fechaIngreso).toISOString().split("T")[0]:"",firmoContrato:t.firmoContrato,activo:t.activo,notas:t.notas,motivoBaja:t.motivoBaja,motivoBajaNormalizado:t.motivoBajaNormalizado||null}),y(!0)},className:(0,eg.cn)("p-1 rounded hover:bg-white/10 transition-colors","dark"===e?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),title:"Editar",children:(0,ep.jsx)(e1,{className:"w-4 h-4"})}),(0,ep.jsx)("button",{onClick:async()=>{if(confirm(`\xbfEst\xe1s seguro de reactivar a ${t.nombreCompleto}? Esto tambi\xe9n reactivar\xe1 su usuario.`))try{await e_.api.employees.update(t._id,{activo:!0}),eO.toast.success("Empleado y usuario reactivados correctamente"),_()}catch(e){console.error("Error reactivating employee:",e),eO.toast.error("Error al reactivar empleado")}},className:"p-1 rounded hover:bg-green-500/10 text-green-400 hover:text-green-500 transition-colors",title:"Reactivar",children:(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"})})]}),o&&(0,ep.jsx)("button",{onClick:()=>D(t._id),className:"p-1 rounded hover:bg-red-500/10 text-red-400 hover:text-red-500 transition-colors",title:"Eliminar Definitivamente",children:(0,ep.jsx)(eU.Trash2,{className:"w-4 h-4"})})]})})]},t._id))})]})})]},t))]}),b&&v&&(0,ep.jsx)(MO,{children:(0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-xl flex flex-col max-h-[90vh]","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-6 flex-shrink-0",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Editar Empleado"}),(0,ep.jsx)("button",{onClick:()=>y(!1),className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Nombre Completo *"}),(0,ep.jsx)("input",{type:"text",value:N.nombreCompleto,onChange:e=>S({...N,nombreCompleto:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Telfono Personal"}),(0,ep.jsx)("input",{type:"text",value:N.telefonoPersonal,onChange:e=>S({...N,telefonoPersonal:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Cargo"}),(0,ep.jsx)("input",{type:"text",defaultValue:v.cargo,disabled:!0,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm capitalize","dark"===e?"bg-white/10 border-white/10 text-gray-400":"bg-gray-100 border-gray-200 text-gray-500")})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Entrevista"}),(0,ep.jsx)("input",{type:"date",value:N.fechaEntrevista?new Date(N.fechaEntrevista).toISOString().split("T")[0]:"",onChange:e=>S({...N,fechaEntrevista:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Ingreso"}),(0,ep.jsx)("input",{type:"date",value:N.fechaIngreso,onChange:e=>S({...N,fechaIngreso:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-6",children:[(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:N.firmoContrato,onChange:e=>S({...N,firmoContrato:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Firm el contrato?"})]}),(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:N.activo,onChange:e=>S({...N,activo:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Activo?"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Motivo de Baja"}),a?(0,ep.jsxs)("select",{value:N.motivoBajaNormalizado||"",onChange:e=>S({...N,motivoBajaNormalizado:e.target.value||null}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Sin asignar"}),(0,ep.jsx)("option",{value:"Renuncia",children:"Renuncia"}),(0,ep.jsx)("option",{value:"Despido por bajo rendimiento",children:"Despido por bajo rendimiento"}),(0,ep.jsx)("option",{value:"Despido por inasistencias",children:"Despido por inasistencias"})]}):(0,ep.jsx)("input",{type:"text",value:N.motivoBajaNormalizado||"Pendiente de normalizacin",disabled:!0,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/10 border-white/10 text-gray-400":"bg-gray-100 border-gray-200 text-gray-500")})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("p-4 rounded-lg border","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-2 text-sm font-medium mb-3","dark"===e?"text-gray-300":"text-gray-700"),children:[(0,ep.jsx)(Mk,{className:"w-4 h-4",style:{color:"#F4C04A"}}),"Foto del DNI"]}),(v.fotoDNI||T)&&(0,ep.jsxs)("div",{className:"mb-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("relative w-full max-w-[200px] aspect-[3/2] rounded-lg overflow-hidden border","dark"===e?"border-white/10":"border-gray-200"),children:T?(0,ep.jsx)("img",{src:URL.createObjectURL(T),alt:"Vista previa DNI",className:"w-full h-full object-cover"}):v.fotoDNI?(0,ep.jsx)("img",{src:P(v.fotoDNI)||"",alt:"Foto DNI",className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}}):null}),T&&(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-green-400":"text-green-600"),children:[" Nueva imagen seleccionada: ",T.name]})]}),(0,ep.jsxs)("div",{className:"flex flex-wrap gap-2",children:[v.fotoDNI&&!T&&(0,ep.jsxs)("a",{href:P(v.fotoDNI)||"",target:"_blank",rel:"noopener noreferrer",download:!0,className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors","dark"===e?"bg-white/10 text-gray-300 hover:bg-white/20":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,ep.jsx)(i0.Download,{className:"w-3 h-3"}),"Descargar"]}),(0,ep.jsxs)("label",{className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium cursor-pointer transition-colors",E?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-[#1E88E5]/20 text-[#1E88E5] hover:bg-[#1E88E5]/30":"bg-[#1E88E5]/10 text-[#1E88E5] hover:bg-[#1E88E5]/20"),children:[(0,ep.jsx)(eI.Upload,{className:"w-3 h-3"}),v.fotoDNI||T?"Cambiar imagen":"Subir imagen",(0,ep.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{let t=e.target.files?.[0];if(t){if(t.size>5242880)return void eO.toast.error("El archivo no puede superar 5MB");if(!["image/jpeg","image/jpg","image/png"].includes(t.type))return void eO.toast.error("Solo se permiten archivos JPG y PNG");A(t)}},disabled:E,className:"hidden"})]}),T&&(0,ep.jsxs)("button",{onClick:()=>A(null),className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors","dark"===e?"bg-red-500/20 text-red-400 hover:bg-red-500/30":"bg-red-100 text-red-600 hover:bg-red-200"),children:[(0,ep.jsx)(eT.X,{className:"w-3 h-3"}),"Cancelar"]})]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-2","text-gray-500"),children:"Mximo 5MB. Formatos: JPG, PNG"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,ep.jsx)("textarea",{rows:3,value:N.notas,onChange:e=>S({...N,notas:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),placeholder:"Observaciones adicionales..."})]})]}),(0,ep.jsxs)("div",{className:"flex justify-end gap-3 mt-6 flex-shrink-0",children:[(0,ep.jsx)("button",{onClick:()=>y(!1),className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:O,disabled:k,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",k?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#17C787"},children:E?"Subiendo DNI...":k?"Guardando...":"Guardar Cambios"})]})]})})})]})}function MO({children:t}){let[r,a]=(0,em.useState)(!1);if((0,em.useEffect)(()=>(a(!0),()=>a(!1)),[]),!r)return null;let{createPortal:n}=e.r(56667);return n(t,document.body)}var MP=e.i(50362),MD=e.i(22426);function MR(){let{theme:e}=(0,ex.useTheme)();(0,MD.useRouter)();let{user:t}=(0,i4.useAuth)(),r="supervisor"===(t?.role?.toLowerCase()||""),a=t?.numeroEquipo?String(t.numeroEquipo):null,[n,s]=(0,em.useState)(!1),[i,o]=(0,em.useState)([]),[l,c]=(0,em.useState)(new Set),[d,u]=(0,em.useState)(!0),[h,f]=(0,em.useState)(!1),[p,m]=(0,em.useState)({userId:"",nombreCompleto:"",telefonoPersonal:"",numeroEquipo:"",fechaEntrevista:"",fechaIngreso:new Date().toISOString().split("T")[0],cargo:"",firmoContrato:!1,activo:!0,fotoDNI:null,notas:""});(0,em.useEffect)(()=>{g()},[]);let g=async()=>{try{u(!0);let[e,t]=await Promise.all([e_.api.users.list(),e_.api.employees.list()]);o(e.data);let r=new Set(t.data.map(e=>e.userId?._id||e.userId));c(r)}catch(e){console.error("Error fetching data:",e),eO.toast.error("Error al cargar datos iniciales")}finally{u(!1)}},x=(e,t)=>{m(r=>({...r,[e]:t}))},b=()=>{m({userId:"",nombreCompleto:"",telefonoPersonal:"",numeroEquipo:"",fechaEntrevista:"",fechaIngreso:new Date().toISOString().split("T")[0],cargo:"",firmoContrato:!1,activo:!0,fotoDNI:null,notas:""})},y=async()=>{if(!p.userId)return void eO.toast.error("Debe seleccionar un usuario");if(!p.nombreCompleto)return void eO.toast.error("El nombre completo es obligatorio");try{s(!0);let e="";if(p.fotoDNI){f(!0);try{e=(await e_.api.employees.uploadDNI(p.fotoDNI)).data.fotoDNI||""}catch(e){console.error("Error uploading DNI:",e),eO.toast.error(e.response?.data?.message||"Error al subir foto de DNI"),f(!1),s(!1);return}f(!1)}let t={...p,fotoDNI:e};await e_.api.employees.create(t),eO.toast.success("Empleado creado exitosamente"),b(),g()}catch(e){console.error("Error creating employee:",e),eO.toast.error(e.response?.data?.message||"Error al crear empleado")}finally{s(!1)}},v=i.filter(e=>!l.has(e._id)&&(!r||!a||(e.numeroEquipo?String(e.numeroEquipo):null)===a));return d?(0,ep.jsx)("div",{className:"flex justify-center py-12",children:(0,ep.jsx)(e2.Loader2,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,ep.jsx)("div",{className:"space-y-6 animate-fade-in-up",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"mb-6",children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl font-semibold mb-1","dark"===e?"text-white":"text-gray-800"),children:"Nuevo Empleado"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Complete los datos del nuevo empleado asocindolo a una cuenta de usuario existente"})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl border p-4 mb-6","dark"===e?"bg-gradient-to-r from-[#1E88E5]/10 to-[#0E6FFF]/10 border-[#1E88E5]/30":"bg-gradient-to-r from-[#1E88E5]/5 to-[#0E6FFF]/5 border-[#1E88E5]/20"),children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-sm font-medium mb-2 block","dark"===e?"text-gray-300":"text-gray-700"),children:["Usuario de la Plataforma ",(0,ep.jsx)("span",{style:{color:"#C8376B"},children:"*"})]}),(0,ep.jsxs)("select",{value:p.userId,onChange:e=>{var t;let r;return t=e.target.value,void((r=i.find(e=>e._id===t))?m(e=>({...e,userId:t,nombreCompleto:r.nombre,numeroEquipo:r.numeroEquipo||"",cargo:r.role})):m(e=>({...e,userId:""})))},className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar usuario..."}),v.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," (",e.email,") - ",e.role]},e._id))]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-2","text-[#1E88E5]"),children:"Seleccione la cuenta de usuario que quedar asociada a este empleado. Solo se muestran usuarios sin ficha de empleado."})]}),(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:["Nombre Completo ",(0,ep.jsx)("span",{style:{color:"#C8376B"},children:"*"})]}),(0,ep.jsx)("input",{type:"text",value:p.nombreCompleto,onChange:e=>x("nombreCompleto",e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Telfono Personal"}),(0,ep.jsx)("input",{type:"text",placeholder:"Ej: 1112345678",value:p.telefonoPersonal,onChange:e=>x("telefonoPersonal",e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:["Nmero de Equipo",r&&(0,ep.jsx)(oh.Lock,{className:"w-3 h-3 inline ml-1 text-gray-400"})]}),(0,ep.jsx)("input",{type:"text",value:p.numeroEquipo,onChange:e=>x("numeroEquipo",e.target.value),disabled:r,className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400",r&&"opacity-60 cursor-not-allowed")}),r&&(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-amber-400":"text-amber-600"),children:[" Solo puedes crear empleados de tu equipo (",a,")"]})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Entrevista"}),(0,ep.jsx)("input",{type:"date",value:p.fechaEntrevista,onChange:e=>x("fechaEntrevista",e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Ingreso"}),(0,ep.jsx)("input",{type:"date",value:p.fechaIngreso,onChange:e=>x("fechaIngreso",e.target.value),className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","text-[#F4C04A]"),children:"Por defecto se asigna la fecha de creacin de la cuenta"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Cargo (Rol)"}),(0,ep.jsx)("div",{className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm capitalize","bg-[#17C787]/10 border-[#17C787]/30 text-[#17C787]"),children:p.cargo||"El cargo se obtiene automticamente del rol del usuario"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","text-gray-500"),children:"El cargo se obtiene automticamente del rol del usuario"})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-6 p-4 rounded-lg border","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:[(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:p.firmoContrato,onChange:e=>x("firmoContrato",e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-[#1E88E5] focus:ring-[#1E88E5]"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Firm el contrato?"})]}),(0,ep.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:p.activo,onChange:e=>x("activo",e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Activo?"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 flex items-center gap-1","dark"===e?"text-gray-300":"text-gray-700"),children:[(0,ep.jsx)(Mk,{className:"w-4 h-4",style:{color:"#F4C04A"}}),"Foto del DNI (.jpg, .png)"]}),(0,ep.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{e.target.files&&e.target.files[0]&&m(t=>({...t,fotoDNI:e.target.files[0]}))},disabled:n||h,className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm file:mr-4 file:py-1 file:px-3 file:rounded file:border-0 file:text-sm file:font-medium cursor-pointer","dark"===e?"bg-white/5 border-white/10 text-white file:bg-[#1E88E5]/20 file:text-[#1E88E5]":"bg-white border-gray-200 text-gray-800 file:bg-[#1E88E5]/10 file:text-[#1E88E5]",(n||h)&&"opacity-50 cursor-not-allowed")}),p.fotoDNI&&(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===e?"text-green-400":"text-green-600"),children:[" Archivo seleccionado: ",p.fotoDNI.name]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","text-gray-500"),children:"Mximo 5MB. Formatos aceptados: JPG, PNG"})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,ep.jsx)("textarea",{placeholder:"Observaciones adicionales...",value:p.notas,onChange:e=>x("notas",e.target.value),rows:4,className:(0,eg.cn)("w-full px-4 py-2.5 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex justify-end gap-3 mt-6 pt-6 border-t","dark"===e?"border-white/10":"border-gray-200"),children:[(0,ep.jsxs)("button",{onClick:b,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"}),"Limpiar Formulario"]}),(0,ep.jsxs)("button",{onClick:y,disabled:n,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors text-white",n?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#1E88E5"},children:[n?(0,ep.jsx)(e2.Loader2,{className:"w-4 h-4 animate-spin"}):(0,ep.jsx)(MP.UserPlus,{className:"w-4 h-4"}),h?"Subiendo DNI...":n?"Creando...":"Crear Empleado"]})]})]})})}var MM=e.i(77982);let MI=(0,ek.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var ML=e.i(14937),MF=e.i(67951);function MB(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),r=t?.role?.toLowerCase(),a="gerencia"===r,n="supervisor"===r,s="encargado"===r,[i,o]=(0,em.useState)([]),[l,c]=(0,em.useState)(null),[d,u]=(0,em.useState)(!0),[h,f]=(0,em.useState)(""),[p,m]=(0,em.useState)(null),[g,x]=(0,em.useState)(!1),[b,y]=(0,em.useState)(!1),[v,w]=(0,em.useState)(!1),[k,j]=(0,em.useState)(null),[N,S]=(0,em.useState)([]),[E,C]=(0,em.useState)([]),T=(0,em.useCallback)(async()=>{try{u(!0);let[e,t]=await Promise.all([e_.api.phones.list(),e_.api.phones.getStats()]);o(e.data),c(t.data)}catch(e){eO.toast.error(e.response?.data?.message||"Error al cargar telfonos")}finally{u(!1)}},[]),A=(0,em.useCallback)(async()=>{try{let e=await e_.api.users.getSupervisors();S(e.data)}catch(e){console.error("Error cargando supervisores:",e)}},[]),_=(0,em.useCallback)(async e=>{try{let t=await e_.api.phones.getAsesoresByEquipo(e);C(t.data)}catch(e){console.error("Error cargando asesores:",e)}},[]);(0,em.useEffect)(()=>{T(),(a||s)&&A()},[T,A,a,s]);let O=i.filter(e=>{if(!h)return!0;let t=h.toLowerCase();return e.numeroTelefono.toLowerCase().includes(t)||e.modelo.toLowerCase().includes(t)||e.supervisor?.nombre?.toLowerCase().includes(t)||e.asesorAsignado?.nombre?.toLowerCase().includes(t)||e.numeroEquipo?.toLowerCase().includes(t)}),P=O.reduce((e,t)=>{let r=t.numeroEquipo||"Sin equipo";return e[r]||(e[r]=[]),e[r].push(t),e},{}),D=e=>e?new Date(e).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",R=e=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e),M=e=>{if(!e.proximoVencimiento)return{status:"sin-recarga",label:"Sin recargas",color:"gray"};let t=new Date,r=(new Date(e.proximoVencimiento).getTime()-t.getTime())/36e5;return r<0?{status:"vencido",label:"Vencido",color:"red"}:r<=48?{status:"proximo",label:"Prximo a vencer",color:"yellow"}:{status:"vigente",label:"Vigente",color:"green"}};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-xl lg:text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)(MF.Smartphone,{className:"w-6 h-6"}),"Telfonos Corporativos"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Gestin de dispositivos y control de recargas"})]}),(0,ep.jsxs)("button",{onClick:()=>{n&&t?.numeroEquipo&&_(t.numeroEquipo),x(!0)},className:(0,eg.cn)("flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200","dark"===e?"bg-purple-600 hover:bg-purple-700 text-white":"bg-emerald-600 hover:bg-emerald-700 text-white"),children:[(0,ep.jsx)(e0.Plus,{className:"w-4 h-4"}),"Nuevo Telfono"]})]}),l&&(0,ep.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[(0,ep.jsx)(MU,{label:"Total",value:l.total,icon:(0,ep.jsx)(MM.Phone,{className:"w-4 h-4"}),color:"blue",theme:e}),(0,ep.jsx)(MU,{label:"Sin recarga",value:l.sinRecarga,icon:(0,ep.jsx)(eJ.AlertTriangle,{className:"w-4 h-4"}),color:"gray",theme:e}),(0,ep.jsx)(MU,{label:"Prximos a vencer",value:l.proximosAVencer,icon:(0,ep.jsx)(eV.Clock,{className:"w-4 h-4"}),color:"yellow",theme:e}),(0,ep.jsx)(MU,{label:"Vencidos",value:l.vencidos,icon:(0,ep.jsx)(eJ.AlertTriangle,{className:"w-4 h-4"}),color:"red",theme:e}),(0,ep.jsx)(MU,{label:"Gasto mensual",value:R(l.totalGastadoMes),icon:(0,ep.jsx)(ML.DollarSign,{className:"w-4 h-4"}),color:"green",theme:e,isText:!0})]}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por nmero, modelo, supervisor, asesor o equipo...",value:h,onChange:e=>f(e.target.value),className:(0,eg.cn)("w-full pl-10 pr-4 py-2 rounded-lg border transition-colors","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500":"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-emerald-500")}),h&&(0,ep.jsx)("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,ep.jsx)(eT.X,{className:"w-4 h-4 text-gray-400 hover:text-gray-600"})})]}),d?(0,ep.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,ep.jsx)(eE.RefreshCw,{className:(0,eg.cn)("w-8 h-8 animate-spin","dark"===e?"text-purple-500":"text-emerald-500")})}):0===O.length?(0,ep.jsxs)("div",{className:(0,eg.cn)("text-center py-12 rounded-lg border","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:[(0,ep.jsx)(MF.Smartphone,{className:(0,eg.cn)("w-12 h-12 mx-auto mb-3","dark"===e?"text-gray-600":"text-gray-400")}),(0,ep.jsx)("p",{className:"dark"===e?"text-gray-400":"text-gray-600",children:h?"No se encontraron telfonos":"No hay telfonos registrados"})]}):(0,ep.jsx)("div",{className:"space-y-6",children:Object.entries(P).sort(([e],[t])=>e.localeCompare(t)).map(([t,r])=>(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl border overflow-hidden","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("px-4 py-3 flex items-center gap-2","dark"===e?"bg-purple-500/10":"bg-emerald-50"),children:[(0,ep.jsx)(ew.Users,{className:(0,eg.cn)("w-4 h-4","dark"===e?"text-purple-400":"text-emerald-600")}),(0,ep.jsxs)("span",{className:(0,eg.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["Equipo ",t]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm px-2 py-0.5 rounded-full","dark"===e?"bg-purple-500/20 text-purple-300":"bg-emerald-100 text-emerald-700"),children:[r.length," telfono",1!==r.length?"s":""]})]}),(0,ep.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-white/10",children:r.map(t=>(0,ep.jsx)(Mz,{phone:t,theme:e,isGerencia:a,isExpanded:p===t._id,onToggleExpand:()=>m(p===t._id?null:t._id),onEdit:()=>{j(t),t.numeroEquipo&&_(t.numeroEquipo),y(!0)},onDelete:async()=>{if(confirm("Est seguro de eliminar este telfono?"))try{await e_.api.phones.delete(t._id),eO.toast.success("Telfono eliminado"),T()}catch(e){eO.toast.error(e.response?.data?.message||"Error al eliminar")}},onAddRecharge:()=>{j(t),w(!0)},formatDate:D,formatCurrency:R,getVencimientoStatus:M},t._id))})]},t))}),g&&(0,ep.jsx)(MV,{theme:e,isGerencia:a,isEncargado:s,supervisors:N,asesores:E,user:t,onClose:()=>x(!1),onSave:async e=>{try{await e_.api.phones.create(e),eO.toast.success("Telfono creado exitosamente"),x(!1),T()}catch(e){eO.toast.error(e.response?.data?.message||"Error al crear telfono")}},loadAsesores:_}),b&&k&&(0,ep.jsx)(MV,{theme:e,isGerencia:a,isEncargado:s,supervisors:N,asesores:E,user:t,phone:k,onClose:()=>{y(!1),j(null)},onSave:async e=>{try{await e_.api.phones.update(k._id,e),eO.toast.success("Telfono actualizado exitosamente"),y(!1),j(null),T()}catch(e){eO.toast.error(e.response?.data?.message||"Error al actualizar telfono")}},loadAsesores:_}),v&&k&&(0,ep.jsx)(M$,{theme:e,phone:k,onClose:()=>{w(!1),j(null)},onSave:async e=>{try{await e_.api.phones.addRecharge(k._id,e),eO.toast.success("Recarga registrada exitosamente"),w(!1),j(null),T()}catch(e){eO.toast.error(e.response?.data?.message||"Error al registrar recarga")}}})]})}function MU({label:e,value:t,icon:r,color:a,theme:n,isText:s=!1}){return(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg border transition-all duration-200","dark"===n?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("p-1 rounded",{blue:"dark"===n?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600",gray:"dark"===n?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-600",yellow:"dark"===n?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-600",red:"dark"===n?"bg-red-500/20 text-red-400":"bg-red-100 text-red-600",green:"dark"===n?"bg-emerald-500/20 text-emerald-400":"bg-emerald-100 text-emerald-600"}[a]),children:r}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===n?"text-gray-400":"text-gray-500"),children:e})]}),(0,ep.jsx)("p",{className:(0,eg.cn)(s?"text-sm font-semibold":"text-xl font-bold","dark"===n?"text-white":"text-gray-800"),children:t})]})}function Mz({phone:e,theme:t,isGerencia:r,isExpanded:a,onToggleExpand:n,onEdit:s,onDelete:i,onAddRecharge:o,formatDate:l,formatCurrency:c,getVencimientoStatus:d}){let u=d(e);return(0,ep.jsxs)("div",{className:"p-4",children:[(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3",children:[(0,ep.jsxs)("div",{className:"flex items-start gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-2 rounded-lg","dark"===t?"bg-purple-500/20":"bg-emerald-100"),children:(0,ep.jsx)(MF.Smartphone,{className:(0,eg.cn)("w-5 h-5","dark"===t?"text-purple-400":"text-emerald-600")})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h4",{className:(0,eg.cn)("font-semibold","dark"===t?"text-white":"text-gray-800"),children:e.numeroTelefono}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===t?"text-gray-400":"text-gray-500"),children:e.modelo}),(0,ep.jsxs)("div",{className:"flex flex-wrap gap-2 mt-1",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs px-2 py-0.5 rounded-full flex items-center gap-1","dark"===t?"bg-white/10 text-gray-300":"bg-gray-100 text-gray-600"),children:[(0,ep.jsx)(oo,{className:"w-3 h-3"}),e.asesorAsignado?.nombre||"Sin asignar"]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs px-2 py-0.5 rounded-full",{"sin-recarga":"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-600",vencido:"dark"===t?"bg-red-500/20 text-red-400":"bg-red-100 text-red-600",proximo:"dark"===t?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-600",vigente:"dark"===t?"bg-emerald-500/20 text-emerald-400":"bg-emerald-100 text-emerald-600"}[u.status]),children:u.label})]})]})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("button",{onClick:o,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===t?"hover:bg-emerald-500/20 text-emerald-400":"hover:bg-emerald-100 text-emerald-600"),title:"Agregar recarga",children:(0,ep.jsx)(ML.DollarSign,{className:"w-4 h-4"})}),(0,ep.jsx)("button",{onClick:s,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===t?"hover:bg-blue-500/20 text-blue-400":"hover:bg-blue-100 text-blue-600"),title:"Editar",children:(0,ep.jsx)(MI,{className:"w-4 h-4"})}),r&&(0,ep.jsx)("button",{onClick:i,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===t?"hover:bg-red-500/20 text-red-400":"hover:bg-red-100 text-red-600"),title:"Eliminar",children:(0,ep.jsx)(eU.Trash2,{className:"w-4 h-4"})}),(0,ep.jsx)("button",{onClick:n,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===t?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),title:a?"Ocultar historial":"Ver historial",children:a?(0,ep.jsx)(oj,{className:"w-4 h-4"}):(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})})]})]}),e.ultimaRecarga&&(0,ep.jsxs)("div",{className:(0,eg.cn)("mt-3 flex flex-wrap gap-4 text-xs","dark"===t?"text-gray-400":"text-gray-500"),children:[(0,ep.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ep.jsx)(eS,{className:"w-3 h-3"}),"ltima recarga: ",l(e.ultimaRecarga)]}),e.proximoVencimiento&&(0,ep.jsxs)("span",{className:"flex items-center gap-1",children:[(0,ep.jsx)(eV.Clock,{className:"w-3 h-3"}),"Vencimiento: ",l(e.proximoVencimiento)]})]}),a&&(0,ep.jsxs)("div",{className:(0,eg.cn)("mt-4 pt-4 border-t","dark"===t?"border-white/10":"border-gray-200"),children:[(0,ep.jsx)("h5",{className:(0,eg.cn)("text-sm font-medium mb-3","dark"===t?"text-white":"text-gray-700"),children:"Historial de Recargas y Gastos"}),0===e.historialRecargas.length?(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===t?"text-gray-500":"text-gray-400"),children:"No hay registros de recargas"}):(0,ep.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:e.historialRecargas.sort((e,t)=>new Date(t.fecha).getTime()-new Date(e.fecha).getTime()).map(e=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-2 rounded-lg","dark"===t?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm font-medium","dark"===t?"text-white":"text-gray-800"),children:[l(e.fecha),"  ","Recarga"===e.motivo?"Recarga":e.descripcion]}),e.registradoPor&&(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs block","dark"===t?"text-gray-500":"text-gray-400"),children:["Por: ",e.registradoPor.nombre]})]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-semibold","dark"===t?"text-emerald-400":"text-emerald-600"),children:c(e.monto)})]},e._id))})]})]})}function MV({theme:t,isGerencia:r,isEncargado:a,supervisors:n,asesores:s,user:i,phone:o,onClose:l,onSave:c,loadAsesores:d}){let[u,h]=(0,em.useState)({supervisor:o?.supervisor?._id||(r||a?"":i?._id)||"",modelo:o?.modelo||"",numeroTelefono:o?.numeroTelefono||"",asesorAsignado:o?.asesorAsignado?._id||"",notas:o?.notas||""}),[f,p]=(0,em.useState)(!1),[m,g]=(0,em.useState)(!1);(0,em.useEffect)(()=>(g(!0),()=>g(!1)),[]),(0,em.useEffect)(()=>{if((r||a)&&u.supervisor){let e=n.find(e=>e._id===u.supervisor);e?.numeroEquipo&&d(e.numeroEquipo)}},[u.supervisor,r,a,n,d]);let x=async e=>{if(e.preventDefault(),!u.modelo||!u.numeroTelefono)return void eO.toast.error("Complete los campos obligatorios");if(!u.supervisor)return void eO.toast.error("Debe seleccionar un supervisor");p(!0);try{await c({...u,asesorAsignado:u.asesorAsignado||null})}finally{p(!1)}};if(!m)return null;let{createPortal:b}=e.r(56667);return b((0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:e=>e.target===e.currentTarget&&l(),children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-md max-h-[90vh] overflow-y-auto rounded-xl p-6 shadow-xl border","dark"===t?"bg-gray-900 border-gray-700":"bg-white border-gray-200"),onClick:e=>e.stopPropagation(),children:[(0,ep.jsx)("button",{onClick:l,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10",children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})}),(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold mb-4 pr-8","dark"===t?"text-white":"text-gray-800"),children:o?"Editar Telfono":"Nuevo Telfono"}),(0,ep.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[r||a?(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Supervisor *"}),(0,ep.jsxs)("select",{value:u.supervisor,onChange:e=>{h({...u,supervisor:e.target.value,asesorAsignado:""})},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-900"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione supervisor"}),n.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," - Equipo ",e.numeroEquipo]},e._id))]})]}):(0,ep.jsx)("input",{type:"hidden",value:u.supervisor}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Modelo del dispositivo *"}),(0,ep.jsx)("input",{type:"text",value:u.modelo,onChange:e=>h({...u,modelo:e.target.value}),placeholder:"Ej: Samsung Galaxy A14",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Nmero de telfono *"}),(0,ep.jsx)("input",{type:"tel",value:u.numeroTelefono,onChange:e=>{let t=e.target.value.replace(/\D/g,"");h({...u,numeroTelefono:t})},placeholder:"Ej: 1189754312",disabled:!!o&&!r,title:o&&!r?"Solo Gerencia puede modificar el nmero":void 0,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400",!!o&&!r&&"opacity-60 cursor-not-allowed")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Asesor asignado"}),(0,ep.jsxs)("select",{value:u.asesorAsignado,onChange:e=>h({...u,asesorAsignado:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-900"),children:[(0,ep.jsx)("option",{value:"",children:"Sin asignar"}),s.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,ep.jsx)("textarea",{value:u.notas,onChange:e=>h({...u,notas:e.target.value}),rows:2,placeholder:"Observaciones adicionales...",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border resize-none","dark"===t?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400")})]}),(0,ep.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,ep.jsx)("button",{type:"button",onClick:l,className:(0,eg.cn)("flex-1 py-2 rounded-lg font-medium transition-colors","dark"===t?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Cancelar"}),(0,ep.jsx)("button",{type:"submit",disabled:f,className:(0,eg.cn)("flex-1 py-2 rounded-lg font-medium transition-colors disabled:opacity-50","dark"===t?"bg-purple-600 hover:bg-purple-700 text-white":"bg-emerald-600 hover:bg-emerald-700 text-white"),children:f?"Guardando...":"Guardar"})]})]})]})}),document.body)}function M$({theme:t,phone:r,onClose:a,onSave:n}){let[s,i]=(0,em.useState)({motivo:"Recarga",descripcion:"",monto:"",fecha:new Date().toISOString().split("T")[0]}),[o,l]=(0,em.useState)(!1),[c,d]=(0,em.useState)(!1);(0,em.useEffect)(()=>(d(!0),()=>d(!1)),[]);let u=async e=>{if(e.preventDefault(),!s.monto||0>=parseFloat(s.monto))return void eO.toast.error("Ingrese un monto vlido");if("Otro"===s.motivo&&!s.descripcion.trim())return void eO.toast.error("Ingrese una descripcin para el motivo");l(!0);try{await n({motivo:s.motivo,descripcion:s.descripcion,monto:parseFloat(s.monto),fecha:s.fecha})}finally{l(!1)}};if(!c)return null;let{createPortal:h}=e.r(56667);return h((0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:e=>e.target===e.currentTarget&&a(),children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-md max-h-[90vh] overflow-y-auto rounded-xl p-6 shadow-xl border","dark"===t?"bg-gray-900 border-gray-700":"bg-white border-gray-200"),onClick:e=>e.stopPropagation(),children:[(0,ep.jsx)("button",{onClick:a,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 z-10",children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})}),(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-bold mb-2 pr-8","dark"===t?"text-white":"text-gray-800"),children:"Nueva Recarga / Gasto"}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm mb-4","dark"===t?"text-gray-400":"text-gray-500"),children:[r.numeroTelefono," - ",r.modelo]}),(0,ep.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Motivo *"}),(0,ep.jsxs)("select",{value:s.motivo,onChange:e=>i({...s,motivo:e.target.value,descripcion:"Recarga"===e.target.value?"":s.descripcion}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-900"),children:[(0,ep.jsx)("option",{value:"Recarga",children:"Recarga"}),(0,ep.jsx)("option",{value:"Otro",children:"Otro"})]})]}),"Otro"===s.motivo&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Descripcin *"}),(0,ep.jsx)("textarea",{value:s.descripcion,onChange:e=>i({...s,descripcion:e.target.value}),rows:2,placeholder:"Describa el motivo del gasto...",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border resize-none","dark"===t?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Monto *"}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 text-sm","dark"===t?"text-gray-500":"text-gray-400"),children:"$"}),(0,ep.jsx)("input",{type:"number",value:s.monto,onChange:e=>i({...s,monto:e.target.value}),min:"0",step:"0.01",placeholder:"0.00",className:(0,eg.cn)("w-full pl-8 pr-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-900 placeholder:text-gray-400")})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===t?"text-gray-300":"text-gray-700"),children:"Fecha"}),(0,ep.jsx)("input",{type:"date",value:s.fecha,onChange:e=>i({...s,fecha:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border","dark"===t?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-900")})]}),(0,ep.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,ep.jsx)("button",{type:"button",onClick:a,className:(0,eg.cn)("flex-1 py-2 rounded-lg font-medium transition-colors","dark"===t?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Cancelar"}),(0,ep.jsx)("button",{type:"submit",disabled:o,className:(0,eg.cn)("flex-1 py-2 rounded-lg font-medium transition-colors disabled:opacity-50","bg-emerald-600 hover:bg-emerald-700 text-white"),children:o?"Guardando...":"Registrar"})]})]})]})}),document.body)}let MH=(0,ek.default)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),MW=[{value:"",label:"Sin asignar"},{value:"Renuncia",label:"Renuncia"},{value:"Despido por bajo rendimiento",label:"Despido por bajo rendimiento"},{value:"Despido por inasistencias",label:"Despido por inasistencias"}];function Mq(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),r=t?.role?.toLowerCase()==="gerencia",[a,n]=(0,em.useState)(!0),[s,i]=(0,em.useState)([]),[o,l]=(0,em.useState)([]),[c,d]=(0,em.useState)(""),[u,h]=(0,em.useState)(""),[f,p]=(0,em.useState)(null),[m,g]=(0,em.useState)(null);(0,em.useEffect)(()=>{x()},[]);let x=async()=>{try{n(!0);let e=await e_.api.separations.list();e.data.success&&(i(e.data.data.pendientes||[]),l(e.data.data.pagadas||[]),d(e.data.data.mesActual||""))}catch(e){console.error("Error fetching separations:",e),e.response?.status===403?eO.toast.error("No tienes permisos para ver esta seccin"):eO.toast.error("Error al cargar bajas y liquidaciones")}finally{n(!1)}},b=async(e,t)=>{if(confirm(`\xbfConfirmas que la liquidaci\xf3n de ${t} ha sido pagada?`))try{p(e),(await e_.api.separations.markPaid(e)).data.success&&(eO.toast.success(`Liquidaci\xf3n de ${t} marcada como pagada`),x())}catch(e){console.error("Error marking as paid:",e),eO.toast.error("Error al marcar como pagada")}finally{p(null)}},y=async(e,t)=>{try{g(e),(await e_.api.separations.updateMotivoBaja(e,t)).data.success&&(eO.toast.success("Motivo de baja actualizado"),x())}catch(e){console.error("Error updating motivo baja:",e),eO.toast.error("Error al actualizar motivo de baja")}finally{g(null)}},v=e=>{if(!u.trim())return e;let t=u.toLowerCase();return e.filter(e=>e.nombreEmpleado.toLowerCase().includes(t)||e.userId?.email?.toLowerCase().includes(t)||e.cargo?.toLowerCase().includes(t)||e.numeroEquipo?.toLowerCase().includes(t))},w=v(s),k=v(o),j=e=>e?new Date(e).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"UTC"}):"-",N=[{label:"Pendientes",value:s.length,icon:eV.Clock,color:"#F4C04A"},{label:"Pagadas (mes)",value:o.length,icon:ou.CheckCircle,color:"#17C787"},{label:"Total",value:s.length+o.length,icon:ML.DollarSign,color:"#7C3AED"}],S={supervisor:"#17C787",auditor:"#1E88E5",asesor:"#F4C04A",admin:"#C62FA8",rrhh:"#C8376B",gerencia:"#7C3AED",administrativo:"#FF6B6B",recuperador:"#00BCD4"},E=({separations:t,isPending:a,title:n,icon:s,color:i})=>(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${i}20`},children:(0,ep.jsx)(s,{className:"w-5 h-5",style:{color:i}})}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:n}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:[t.length," registros"]})]})]})}),0===t.length&&(0,ep.jsxs)("div",{className:"text-center py-12",children:[(0,ep.jsx)(eZ,{className:(0,eg.cn)("w-12 h-12 mx-auto mb-4","dark"===e?"text-gray-600":"text-gray-400")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-500":"text-gray-400"),children:a?"No hay liquidaciones pendientes este mes":"No hay liquidaciones pagadas este mes"})]}),t.length>0&&(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-sm",children:[(0,ep.jsx)("thead",{children:(0,ep.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["EMPLEADO","FECHA INGRESO","FECHA BAJA","MOTIVO","CORRESPONDE LIQ.","CARGO","EQUIPO","QR MES","QR TOTAL",a?"ACCIN":"PAGADO"].map(t=>(0,ep.jsx)("th",{className:(0,eg.cn)("px-3 py-3 text-left font-semibold text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:t},t))})}),(0,ep.jsx)("tbody",{children:t.map(t=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,ep.jsx)("td",{className:"px-3 py-4",children:(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold","dark"===e?"bg-purple-500/30":"bg-purple-100"),children:t.nombreEmpleado?.charAt(0)?.toUpperCase()||"?"}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:t.nombreEmpleado}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-500":"text-gray-400"),children:t.userId?.email||"-"})]})]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-4","dark"===e?"text-gray-400":"text-gray-600"),children:(0,ep.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ep.jsx)(MH,{className:"w-3 h-3"}),j(t.fechaInicio)]})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-3 py-4","dark"===e?"text-gray-400":"text-gray-600"),children:(0,ep.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ep.jsx)(MH,{className:"w-3 h-3 text-red-500"}),j(t.fechaBaja)]})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:r?(0,ep.jsx)("select",{value:t.motivoBajaNormalizado||"",onChange:e=>y(t._id,e.target.value||null),disabled:m===t._id,className:(0,eg.cn)("px-2 py-1 rounded-lg border text-xs font-medium min-w-[140px]",m===t._id&&"opacity-50 cursor-not-allowed",!t.motivoBajaNormalizado&&"italic","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:MW.map(e=>(0,ep.jsx)("option",{value:e.value,children:e.label},e.value))}):(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs",t.motivoBajaNormalizado?"dark"===e?"text-gray-300":"text-gray-700":"italic "+("dark"===e?"text-gray-500":"text-gray-400")),children:t.motivoBajaNormalizado||"Pendiente de normalizacin"})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-1 rounded text-xs font-medium","S"===t.correspondeLiquidacion?"dark"===e?"bg-green-500/20 text-green-400":"bg-green-100 text-green-700":"dark"===e?"bg-red-500/20 text-red-400":"bg-red-100 text-red-700"),children:t.correspondeLiquidacion||"No"})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:(0,ep.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium text-white capitalize",style:{backgroundColor:S[t.cargo?.toLowerCase()]||"#6B7280"},children:t.cargo||"-"})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:(0,ep.jsxs)("div",{className:"flex items-center gap-1",children:[(0,ep.jsx)(ew.Users,{className:"w-3 h-3",style:{color:"#1E88E5"}}),(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===e?"text-gray-300":"text-gray-700"),children:t.numeroEquipo||"S/E"})]})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-1 font-semibold",t.ventasQRMesBaja>0?"text-green-500":"text-gray-400"),children:[(0,ep.jsx)(gw,{className:"w-3 h-3"}),t.ventasQRMesBaja]})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center gap-1 font-bold","dark"===e?"text-purple-400":"text-purple-600"),children:[(0,ep.jsx)(ML.DollarSign,{className:"w-3 h-3"}),t.ventasQRHistorico]})}),(0,ep.jsx)("td",{className:"px-3 py-4",children:a?(0,ep.jsxs)("button",{onClick:()=>b(t._id,t.nombreEmpleado),disabled:f===t._id||"S"!==t.correspondeLiquidacion,title:"S"!==t.correspondeLiquidacion?"No corresponde liquidacin para este motivo de baja":"",className:(0,eg.cn)("flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all",f===t._id||"S"!==t.correspondeLiquidacion?"opacity-50 cursor-not-allowed":"hover:scale-105","dark"===e?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[f===t._id?(0,ep.jsx)(eE.RefreshCw,{className:"w-3 h-3 animate-spin"}):(0,ep.jsx)(ou.CheckCircle,{className:"w-3 h-3"}),f===t._id?"Procesando...":"Marcar pagada"]}):(0,ep.jsxs)("div",{className:"text-xs",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-1 text-green-500",children:[(0,ep.jsx)(ou.CheckCircle,{className:"w-3 h-3"}),"Pagada"]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-[10px] mt-1","dark"===e?"text-gray-500":"text-gray-400"),children:[j(t.fechaPagoLiquidacion||""),t.pagadaPor&&` por ${t.pagadaPor.nombre}`]})]})})]},t._id))})]})})]});return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)(ML.DollarSign,{className:"w-6 h-6",style:{color:"#7C3AED"}}),"Bajas y Liquidaciones"]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:["Gestin de liquidaciones del mes de"," ",(0,ep.jsx)("span",{className:"font-semibold",style:{color:"#7C3AED"},children:(e=>{if(!e)return"";let[t,r]=e.split("-");return`${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(r)-1]} ${t}`})(c)})]})]}),(0,ep.jsx)("div",{className:"flex-1 max-w-sm",children:(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)(ox.Search,{className:(0,eg.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email, cargo...",value:u,onChange:e=>h(e.target.value),className:(0,eg.cn)("w-full pl-10 pr-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]})})]}),(0,ep.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:N.map((t,r)=>{let a=t.icon;return(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl border p-4 flex items-center justify-between","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,ep.jsx)("p",{className:"text-2xl font-bold",style:{color:t.color},children:t.value})]}),(0,ep.jsx)("div",{className:"p-3 rounded-lg",style:{backgroundColor:`${t.color}20`},children:(0,ep.jsx)(a,{className:"w-6 h-6",style:{color:t.color}})})]},r)})}),a&&(0,ep.jsx)("div",{className:"flex justify-center py-12",children:(0,ep.jsx)(eE.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}),!a&&(0,ep.jsxs)("div",{className:"space-y-6",children:[(0,ep.jsx)(E,{separations:w,isPending:!0,title:"Liquidaciones Pendientes",icon:eV.Clock,color:"#F4C04A"}),(0,ep.jsx)(E,{separations:k,isPending:!1,title:"Liquidaciones Pagadas (mes actual)",icon:ou.CheckCircle,color:"#17C787"})]})]})}let MG=(0,ek.default)("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),MK=(0,ek.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var MX=e.i(85744);let MY={asesor:"#1E88E5",supervisor:"#17C787",auditor:"#F4C04A",administrativo:"#9C27B0",gerencia:"#C8376B","rr.hh":"#607D8B",recuperador:"#FF5722",encargado:"#19803bff",independiente:"#00ACC1"},MQ=["asesor","supervisor","auditor","administrativo","gerencia","RR.HH","recuperador","encargado","independiente"];function MJ(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)([]),[a,n]=(0,em.useState)(!0),[s,i]=(0,em.useState)(""),[o,l]=(0,em.useState)(""),[c,d]=(0,em.useState)("desc"),[u,h]=(0,em.useState)(1),[f,p]=(0,em.useState)(!1),[m,g]=(0,em.useState)(!1),[x,b]=(0,em.useState)(null),[y,v]=(0,em.useState)(null),[w,k]=(0,em.useState)(!1),[j,N]=(0,em.useState)({nombre:"",email:"",password:"",role:"asesor",numeroEquipo:""});(0,em.useEffect)(()=>{S()},[]);let S=async()=>{try{n(!0);let e=await e_.api.users.list();console.log("Usuarios fetched:",e.data),r(e.data)}catch(e){console.error("Error fetching users:",e),eO.toast.error("Error al cargar usuarios")}finally{n(!1)}},E=async()=>{try{await e_.api.users.create(j),eO.toast.success("Usuario creado correctamente"),g(!1),S(),O()}catch(e){console.error("Error creating user:",e),eO.toast.error(e.response?.data?.message||"Error al crear usuario")}},C=async()=>{if(y)try{let e={nombre:j.nombre,email:j.email,role:j.role};j.numeroEquipo&&""!==j.numeroEquipo.trim()&&(e.numeroEquipo=j.numeroEquipo),j.password&&""!==j.password.trim()&&(e.password=j.password),await e_.api.users.update(y._id,e),eO.toast.success("Usuario actualizado correctamente"),p(!1),S()}catch(e){console.error("Error updating user:",e),eO.toast.error(e.response?.data?.error||e.response?.data?.message||"Error al actualizar usuario")}},T=async e=>{if(confirm("Ests seguro de que deseas eliminar este usuario?"))try{await e_.api.users.delete(e),eO.toast.success("Usuario eliminado correctamente"),S()}catch(e){console.error("Error deleting user:",e),eO.toast.error(e.response?.data?.message||"Error al eliminar usuario")}},A=async e=>{try{await e_.api.users.update(e._id,{active:!e.active}),eO.toast.success(`Usuario ${e.active?"desactivado":"activado"} correctamente`),S()}catch(e){console.error("Error toggling user status:",e),eO.toast.error("Error al cambiar estado del usuario")}},_=async(e,t)=>{try{await e_.api.users.update(e._id,{role:t}),eO.toast.success("Rol actualizado correctamente"),b(null),S()}catch(e){console.error("Error changing role:",e),eO.toast.error("Error al cambiar rol")}},O=()=>{N({nombre:"",email:"",password:"",role:"asesor",numeroEquipo:""}),v(null)},P=t.filter(e=>{let t=e.nombre.toLowerCase().includes(s.toLowerCase())||e.email.toLowerCase().includes(s.toLowerCase()),r=!o||e.numeroEquipo===o;return t&&r}),D=Math.ceil(P.length/10),R=P.slice((u-1)*10,10*u),M=Array.from(new Set(t.map(e=>e.numeroEquipo).filter(Boolean))).sort();return a?(0,ep.jsx)("div",{className:"flex justify-center py-12",children:(0,ep.jsx)(e2.Loader2,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3",children:[(0,ep.jsx)(ew.Users,{className:"w-6 h-6",style:{color:"#1E88E5"}}),(0,ep.jsx)("h2",{className:(0,eg.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Gestin de Usuarios"})]}),(0,ep.jsxs)("button",{onClick:()=>{O(),g(!0)},className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors hover:opacity-90",style:{backgroundColor:"#17C787"},children:[(0,ep.jsx)(e0.Plus,{className:"w-4 h-4"}),"Nuevo Usuario"]})]}),(0,ep.jsx)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:(0,ep.jsx)("div",{className:"flex-1 relative",children:(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por nombre o email...",value:s,onChange:e=>i(e.target.value),className:(0,eg.cn)("w-full px-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})})}),(0,ep.jsx)("div",{className:"flex flex-wrap gap-3 mb-6",children:(0,ep.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los grupos"}),M.map(e=>(0,ep.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})}),(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-sm",children:[(0,ep.jsx)("thead",{children:(0,ep.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["Nombre","Email","Rol","Grupo","Estado","Acciones"].map(t=>(0,ep.jsx)("th",{className:(0,eg.cn)("px-4 py-3 text-center font-semibold","dark"===e?"text-gray-300":"text-gray-700"),children:t},t))})}),(0,ep.jsx)("tbody",{children:R.map(t=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-center","dark"===e?"text-cyan-400":"text-cyan-600"),children:t.nombre}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-center","dark"===e?"text-gray-400":"text-gray-600"),children:t.email}),(0,ep.jsxs)("td",{className:"px-4 py-3 text-center relative",children:[(0,ep.jsx)("button",{onClick:()=>{var e;b(x===(e=t._id)?null:e)},className:"px-3 py-1 rounded text-xs font-medium text-white cursor-pointer hover:opacity-80 transition-opacity capitalize",style:{backgroundColor:MY[t.role?.toLowerCase()]||"#6B7280"},children:t.role}),x===t._id&&(0,ov.createPortal)((0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-xs rounded-xl border p-4 shadow-2xl","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("h4",{className:(0,eg.cn)("text-sm font-semibold mb-3","dark"===e?"text-white":"text-gray-800"),children:["Cambiar rol de ",t.nombre]}),(0,ep.jsx)("div",{className:"space-y-1 max-h-[60vh] overflow-y-auto",children:MQ.map(r=>(0,ep.jsxs)("button",{onClick:()=>_(t,r),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg text-sm font-medium text-left transition-colors capitalize flex items-center justify-between",t.role===r?"dark"===e?"bg-white/10 text-white":"bg-gray-100 text-gray-800":"dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-600"),children:[r,t.role===r&&(0,ep.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"})]},r))}),(0,ep.jsx)("div",{className:"flex gap-2 mt-4 pt-3 border-t border-gray-100 dark:border-white/10",children:(0,ep.jsx)("button",{onClick:()=>b(null),className:(0,eg.cn)("flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-500 hover:bg-gray-50"),children:"Cancelar"})})]})}),document.body)]}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-4 py-3 text-center","dark"===e?"text-gray-400":"text-gray-600"),children:t.numeroEquipo||"-"}),(0,ep.jsx)("td",{className:"px-4 py-3 text-center",children:(0,ep.jsx)("span",{className:"text-xs font-medium",style:{color:t.active?"#17C787":"#C8376B"},children:t.active?"Activo":"Inactivo"})}),(0,ep.jsx)("td",{className:"px-4 py-3",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,ep.jsx)("button",{onClick:()=>A(t),className:"p-1.5 rounded transition-colors text-white",style:{backgroundColor:"#F4C04A"},title:t.active?"Desactivar":"Activar",children:(0,ep.jsx)(MG,{className:"w-4 h-4"})}),(0,ep.jsx)("button",{onClick:()=>{v(t),N({nombre:t.nombre,email:t.email,password:"",role:t.role,numeroEquipo:t.numeroEquipo||""}),p(!0)},className:"p-1.5 rounded transition-colors text-white",style:{backgroundColor:"#17C787"},title:"Editar",children:(0,ep.jsx)(e1,{className:"w-4 h-4"})}),(0,ep.jsx)("button",{onClick:()=>T(t._id),className:"p-1.5 rounded transition-colors text-white",style:{backgroundColor:"#C8376B"},title:"Eliminar",children:(0,ep.jsx)(eU.Trash2,{className:"w-4 h-4"})})]})})]},t._id))})]})}),D>1&&(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-4 mt-6",children:[(0,ep.jsxs)("button",{onClick:()=>h(Math.max(1,u-1)),disabled:1===u,className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors border disabled:opacity-50","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:[(0,ep.jsx)(MK,{className:"w-4 h-4"}),"Anterior"]}),(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:["Pgina ",u," de ",D]}),(0,ep.jsxs)("button",{onClick:()=>h(Math.min(D,u+1)),disabled:u===D,className:(0,eg.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors disabled:opacity-50","dark"===e?"bg-gray-700 text-white hover:bg-gray-600":"bg-gray-800 text-white hover:bg-gray-700"),children:["Siguiente",(0,ep.jsx)(gj,{className:"w-4 h-4"})]})]})]}),(f||m)&&(0,ov.createPortal)((0,ep.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("w-full max-w-md rounded-2xl border p-6 shadow-xl max-h-[85vh] overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(e1,{className:"w-5 h-5",style:{color:"#1E88E5"}}),(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:m?"Nuevo usuario":"Editar usuario"})]}),(0,ep.jsx)("button",{onClick:()=>{p(!1),g(!1)},className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Nombre"}),(0,ep.jsx)("input",{type:"text",value:j.nombre,onChange:e=>N({...j,nombre:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Email"}),(0,ep.jsx)("input",{type:"email",value:j.email,onChange:e=>N({...j,email:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:m?"Contrasea":"Nueva contrasea (opcional)"}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("input",{type:w?"text":"password",value:j.password,onChange:e=>N({...j,password:e.target.value}),placeholder:m?"********":"Dejar vaco para mantener actual",className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm pr-10","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,ep.jsx)("button",{type:"button",onClick:()=>k(!w),className:(0,eg.cn)("absolute right-3 top-1/2 -translate-y-1/2","dark"===e?"text-gray-500":"text-gray-400"),children:w?(0,ep.jsx)(MX.EyeOff,{className:"w-4 h-4"}):(0,ep.jsx)(ez.Eye,{className:"w-4 h-4"})})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Rol"}),(0,ep.jsx)("select",{value:j.role,onChange:e=>N({...j,role:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm capitalize","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:MQ.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Grupo (opcional)"}),(0,ep.jsx)("input",{type:"text",value:j.numeroEquipo,onChange:e=>N({...j,numeroEquipo:e.target.value}),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,ep.jsx)("button",{onClick:()=>{p(!1),g(!1)},className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white",style:{backgroundColor:"#1E88E5"},children:"Cancelar"}),(0,ep.jsx)("button",{onClick:m?E:C,className:"px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors",style:{backgroundColor:"#17C787"},children:"Guardar"})]})]})}),document.body)]})}let MZ=(0,ek.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),M0=["Pendiente","QR hecho","QR hecho (Temporal)","QR hecho pero pendiente de aprobacin","Hacer QR","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrn","En revisin","Remuneracin no vlida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vdeo","Rechazada","Falta documentacin","Falta clave","Falta clave y documentacin","El afiliado cambi la clave","Autovinculacin","Cada","Completa"],M1={"Hacer QR":"Pendiente","QR hecho (Temporal)":"Baja laboral sin nueva alta"};function M2({isOpen:t,onClose:r,audit:a,onSave:n}){let{theme:s}=(0,ex.useTheme)(),{user:i}=(0,i4.useAuth)(),o=e=>{if(!e)return"";let t=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(t)return`${t[1]}-${t[2]}-${t[3]}`;let r=new Date(e),a=r.getUTCFullYear(),n=String(r.getUTCMonth()+1).padStart(2,"0"),s=String(r.getUTCDate()).padStart(2,"0");return`${a}-${n}-${s}`},l="gerencia"===i?.role?.toLowerCase(),[c,d]=(0,em.useState)({cuil:a.cuil||"",cuit:a.cuit||"",fecha:o(a.fechaCreacionQR||a.scheduledAt),fechaQR:a.fechaCreacionQR?o(a.fechaCreacionQR):"",aporte:a.aporte?.toString()||"",observacionPrivada:a.observacionPrivada||"",clave:a.clave||"",email:a.email||"",status:a.statusAdministrativo||a.status||"",administrador:a.administrador?._id||"",supervisor:a.supervisorSnapshot?._id||"",asesor:a.asesor?._id||"",datosExtra:a.datosExtra||"",mesPadron:a.mesPadron||"",disponibleParaVenta:a.disponibleParaVenta||!1}),[u,h]=(0,em.useState)(!1),[f,p]=(0,em.useState)("details"),[m,g]=(0,em.useState)([]),[x,b]=(0,em.useState)([]),[y,v]=(0,em.useState)([]);(0,em.useEffect)(()=>{t&&(d({cuil:a.cuil||"",cuit:a.cuit||"",fecha:o(a.fechaCreacionQR||a.scheduledAt),fechaQR:a.fechaCreacionQR?o(a.fechaCreacionQR):"",aporte:a.aporte?.toString()||"",observacionPrivada:a.observacionPrivada||"",clave:a.clave||"",email:a.email||"",status:a.statusAdministrativo||a.status||"",administrador:a.administrador?._id||"",supervisor:a.supervisorSnapshot?._id||"",asesor:a.asesor?._id||"",datosExtra:a.datosExtra||"",mesPadron:a.mesPadron||"",disponibleParaVenta:a.disponibleParaVenta||!1}),w())},[t,a]);let w=async()=>{try{let e=(await e_.api.users.list("includeAllAuditors=true")).data||[];g(e.filter(e=>!1!==e.active)),b(e.filter(e=>"supervisor"===e.role&&!1!==e.active)),v(e.filter(e=>"administrativo"===e.role&&!1!==e.active))}catch(e){console.error("Error fetching filter options:",e),g([]),b([]),v([])}},k=(0,em.useMemo)(()=>{if(!c.supervisor)return m.filter(e=>"asesor"===e.role||"Asesor"===e.role||("auditor"===e.role||"Auditor"===e.role)&&e.numeroEquipo);let e=x.find(e=>e._id===c.supervisor);return e?.numeroEquipo?m.filter(t=>t.numeroEquipo===e.numeroEquipo&&("asesor"===t.role||"Asesor"===t.role||("auditor"===t.role||"Auditor"===t.role)&&t.numeroEquipo)):m},[m,c.supervisor,x]);if(!t)return null;let j=e=>{let{name:t,value:r,type:a}=e.target,n=e.target.checked;"supervisor"===t?d(e=>({...e,supervisor:r,asesor:""})):d(e=>({...e,[t]:"checkbox"===a?n:r}))},N=async()=>{if("Padrn"===c.status&&!c.mesPadron)return void eO.toast.error("Debe indicar el mes de liberacin del padrn");try{h(!0);let e=M1[c.status]||c.status,t={cuil:c.cuil,cuit:c.cuit,aporte:c.aporte?parseFloat(c.aporte):null,observacionPrivada:c.observacionPrivada,clave:c.clave,email:c.email,status:e,statusAdministrativo:c.status,datosExtra:c.datosExtra,mesPadron:"Padrn"===c.status?c.mesPadron:null,disponibleParaVenta:(c.status?.toLowerCase()==="afip"||c.status?.toLowerCase()==="padrn")&&c.disponibleParaVenta};c.fechaQR?t.fechaCreacionQR=new Date(c.fechaQR).toISOString():"QR hecho"===c.status&&"QR hecho"!==a.status?t.fechaCreacionQR=new Date().toISOString():t.fechaCreacionQR=null;let s=a.administrador?._id||a.administrador,o=s&&s===i?._id;(!s||l||o)&&(t.administrador=c.administrador||null),l&&(c.supervisor&&(t.supervisor=c.supervisor),c.asesor&&(t.asesor=c.asesor));let d=await e_.api.audits.update(a._id,t);eO.toast.success("Registro actualizado correctamente"),n(d.data),r()}catch(e){console.error("Error updating audit:",e),eO.toast.error(e.response?.data?.message||"Error al actualizar registro")}finally{h(!1)}},[S,E]=(0,em.useState)(!1);if((0,em.useEffect)(()=>(E(!0),()=>E(!1)),[]),!S)return null;let{createPortal:C}=e.r(56667);return(a.administrador?._id||a.administrador)&&i?._id,C((0,ep.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:[(0,ep.jsx)("div",{className:"fixed inset-0 bg-black/50",onClick:r}),(0,ep.jsxs)("div",{className:(0,eg.cn)("relative w-full max-w-4xl rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]","dark"===s?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("px-6 py-4 border-b flex items-center justify-between","dark"===s?"border-white/10":"border-gray-100"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h2",{className:(0,eg.cn)("text-lg font-semibold","dark"===s?"text-white":"text-gray-800"),children:"Editar Registro de Venta"}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-500"),children:[a.nombre," - ",a.cuil]})]}),(0,ep.jsx)("button",{onClick:r,className:(0,eg.cn)("p-2 rounded-lg transition-colors","dark"===s?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("flex border-b","dark"===s?"border-white/10":"border-gray-100"),children:[(0,ep.jsx)("button",{onClick:()=>p("details"),className:(0,eg.cn)("flex-1 px-4 py-3 text-sm font-medium transition-colors border-b-2","details"===f?"dark"===s?"border-purple-500 text-purple-400":"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Detalles"}),(0,ep.jsx)("button",{onClick:()=>p("history"),className:(0,eg.cn)("flex-1 px-4 py-3 text-sm font-medium transition-colors border-b-2","history"===f?"dark"===s?"border-purple-500 text-purple-400":"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Historial"})]}),(0,ep.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:"details"===f?(0,ep.jsxs)("div",{className:"space-y-4",children:[(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"CUIL"}),(0,ep.jsx)("input",{name:"cuil",value:c.cuil,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"CUIT"}),(0,ep.jsx)("input",{name:"cuit",value:c.cuit,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Fecha"}),(0,ep.jsx)("input",{type:"date",name:"fecha",value:c.fecha,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Fecha de QR"}),(0,ep.jsx)("input",{type:"date",name:"fechaQR",value:c.fechaQR,onChange:j,disabled:"QR hecho"!==c.status&&!l,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","QR hecho"!==c.status&&!l&&"opacity-50 cursor-not-allowed","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===s?"text-gray-400":"text-gray-500"),children:"QR hecho"===c.status||l?"Se asigna automticamente al pasar a 'QR hecho' si est vaco":"Se habilita solo en estado 'QR hecho' (o Gerencia)"})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Aporte"}),(0,ep.jsx)("input",{name:"aporte",type:"number",value:c.aporte,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Clave"}),(0,ep.jsx)("input",{name:"clave",value:c.clave,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Email"}),(0,ep.jsx)("input",{name:"email",type:"email",value:c.email,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Estado"}),(0,ep.jsxs)("select",{name:"status",value:c.status,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccionar estado..."}),c.status&&!M0.includes(c.status)&&(0,ep.jsx)("option",{value:c.status,children:c.status}),M0.map(e=>(0,ep.jsx)("option",{value:e,children:e},e))]}),(c.status?.toLowerCase()==="afip"||c.status?.toLowerCase()==="padrn")&&(0,ep.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,ep.jsx)("input",{type:"checkbox",name:"disponibleParaVenta",checked:c.disponibleParaVenta,onChange:j,className:"w-4 h-4 rounded border-gray-300 text-green-600 focus:ring-green-500"}),(0,ep.jsx)("label",{className:(0,eg.cn)("text-sm","dark"===s?"text-gray-300":"text-gray-700"),children:"Disponible para venta"})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Administrativo"}),(0,ep.jsxs)("select",{name:"administrador",value:c.administrador,onChange:j,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),y.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]})]}),"Padrn"===c.status&&(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:["Mes de Liberacin del Padrn ",(0,ep.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,ep.jsxs)("select",{value:c.mesPadron&&c.mesPadron.split("-")[1]||"",onChange:e=>{let t=c.mesPadron?c.mesPadron.split("-")[0]:new Date().getFullYear().toString(),r=e.target.value;r&&d(e=>({...e,mesPadron:`${t}-${r}`}))},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Mes"}),(0,ep.jsx)("option",{value:"01",children:"Enero"}),(0,ep.jsx)("option",{value:"02",children:"Febrero"}),(0,ep.jsx)("option",{value:"03",children:"Marzo"}),(0,ep.jsx)("option",{value:"04",children:"Abril"}),(0,ep.jsx)("option",{value:"05",children:"Mayo"}),(0,ep.jsx)("option",{value:"06",children:"Junio"}),(0,ep.jsx)("option",{value:"07",children:"Julio"}),(0,ep.jsx)("option",{value:"08",children:"Agosto"}),(0,ep.jsx)("option",{value:"09",children:"Septiembre"}),(0,ep.jsx)("option",{value:"10",children:"Octubre"}),(0,ep.jsx)("option",{value:"11",children:"Noviembre"}),(0,ep.jsx)("option",{value:"12",children:"Diciembre"})]}),(0,ep.jsxs)("select",{value:c.mesPadron&&c.mesPadron.split("-")[0]||"",onChange:e=>{let t=c.mesPadron?c.mesPadron.split("-")[1]:"01",r=e.target.value;r&&d(e=>({...e,mesPadron:`${r}-${t||"01"}`}))},className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Ao"}),Array.from({length:10},(e,t)=>{let r=new Date().getFullYear()+t;return(0,ep.jsx)("option",{value:r,children:r},r)})]})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:["Supervisor",!l&&(0,ep.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(Solo lectura)"})]}),(0,ep.jsxs)("select",{name:"supervisor",value:c.supervisor,onChange:j,disabled:!l,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",!l&&"opacity-60 cursor-not-allowed","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),x.map(e=>(0,ep.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:["Asesor",!l&&(0,ep.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(Solo lectura)"})]}),(0,ep.jsxs)("select",{name:"asesor",value:c.asesor,onChange:j,disabled:!l,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm",!l&&"opacity-60 cursor-not-allowed","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Seleccione"}),k.map(e=>(0,ep.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]})]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Datos Extra (aparecer en Seguimiento)"}),(0,ep.jsx)("textarea",{name:"datosExtra",value:c.datosExtra,onChange:j,rows:2,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:(0,eg.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Observacin (exclusivo de Registro de Ventas)"}),(0,ep.jsx)("textarea",{name:"observacionPrivada",value:c.observacionPrivada,onChange:j,rows:3,className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}):(0,ep.jsxs)("div",{className:"space-y-6",children:[a.statusHistory&&a.statusHistory.length>0&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3","dark"===s?"text-white":"text-gray-800"),children:"Historial de Estados"}),(0,ep.jsx)("div",{className:"space-y-2",children:a.statusHistory.map((e,t)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-3 rounded-lg","dark"===s?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium","dark"===s?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"),children:e.value}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===s?"text-gray-400":"text-gray-500"),children:["por ",e.updatedBy?.nombre||"Sistema"]})]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-500":"text-gray-400"),children:e.updatedAt?new Date(e.updatedAt).toLocaleString("es-AR"):"-"})]},t))})]}),a.datosExtraHistory&&a.datosExtraHistory.length>0&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3","dark"===s?"text-white":"text-gray-800"),children:"Historial de Datos Extra"}),(0,ep.jsx)("div",{className:"space-y-2",children:a.datosExtraHistory.map((e,t)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg","dark"===s?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===s?"text-white":"text-gray-800"),children:e.value||"(vaco)"}),(0,ep.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-400":"text-gray-500"),children:["por ",e.updatedBy?.nombre||"Sistema"]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-500":"text-gray-400"),children:e.updatedAt?new Date(e.updatedAt).toLocaleString("es-AR"):"-"})]})]},t))})]}),a.administradorHistory&&a.administradorHistory.length>0&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3","dark"===s?"text-white":"text-gray-800"),children:"Historial de Administrativo"}),(0,ep.jsx)("div",{className:"space-y-2 mb-6",children:a.administradorHistory?.slice().reverse().map((e,t)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg","dark"===s?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===s?"text-gray-200":"text-gray-800"),children:[e.previousAdmin?.nombre||e.previousAdmin?.name||"Sin Admin","  ",e.newAdmin?.nombre||e.newAdmin?.name||"Sin Admin"]}),(0,ep.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-400":"text-gray-500"),children:["por ",e.changedBy?.nombre||"Sistema"]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-500":"text-gray-400"),children:e.changedAt?new Date(e.changedAt).toLocaleString("es-AR"):"-"})]})]},t))})]}),a.asesorHistory&&a.asesorHistory.length>0&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3","dark"===s?"text-white":"text-gray-800"),children:"Historial de Cambios de Asesor"}),(0,ep.jsx)("div",{className:"space-y-2",children:a.asesorHistory.map((e,t)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("p-3 rounded-lg","dark"===s?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-600"),children:e.previousAsesor?.nombre||e.previousAsesor?.name||"N/A"}),(0,ep.jsx)("span",{className:"dark"===s?"text-gray-500":"text-gray-400",children:""}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-sm font-medium","dark"===s?"text-white":"text-gray-800"),children:e.newAsesor?.nombre||e.newAsesor?.name||"N/A"})]}),(0,ep.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-400":"text-gray-500"),children:["por ",e.changedBy?.nombre||e.changedBy?.name||"Sistema"]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-500":"text-gray-400"),children:new Date(e.changedAt).toLocaleString("es-AR")})]})]},t))})]}),a.fechaQRHistory&&a.fechaQRHistory.length>0&&(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-sm font-semibold mb-3","dark"===s?"text-white":"text-gray-800"),children:"Historial de Fecha de QR"}),(0,ep.jsx)("div",{className:"space-y-2",children:a.fechaQRHistory.map((e,t)=>(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between p-3 rounded-lg","dark"===s?"bg-white/5":"bg-gray-50"),children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium","dark"===s?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"),children:e.value?(e=>{if(!e)return"-";let t=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(t){let[,e,r,a]=t;return`${parseInt(a)}/${parseInt(r)}/${e}`}let r=new Date(e);return`${r.getUTCDate()}/${r.getUTCMonth()+1}/${r.getUTCFullYear()}`})(e.value):"-"}),(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ml-2",e.isAutomatic?"dark"===s?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"dark"===s?"bg-green-500/20 text-green-400":"bg-green-100 text-green-800"),children:e.isAutomatic?"Automtico":"Manual"}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mt-1","dark"===s?"text-gray-400":"text-gray-500"),children:["por ",e.updatedBy?.nombre||"Sistema"]})]}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs","dark"===s?"text-gray-500":"text-gray-400"),children:e.updatedAt?new Date(e.updatedAt).toLocaleString("es-AR"):"-"})]},t))})]}),(!a.statusHistory||0===a.statusHistory.length)&&(!a.datosExtraHistory||0===a.datosExtraHistory.length)&&(!a.asesorHistory||0===a.asesorHistory.length)&&(!a.fechaQRHistory||0===a.fechaQRHistory.length)&&(0,ep.jsx)("div",{className:"text-center py-8",children:(0,ep.jsx)("p",{className:"dark"===s?"text-gray-400":"text-gray-600",children:"No hay historial disponible"})})]})}),(0,ep.jsxs)("div",{className:(0,eg.cn)("px-6 py-4 border-t flex items-center justify-end gap-3","dark"===s?"border-white/10":"border-gray-100"),children:[(0,ep.jsx)("button",{onClick:r,className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===s?"bg-white/5 hover:bg-white/10 text-gray-300":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Cancelar"}),(0,ep.jsxs)("button",{onClick:N,disabled:u,className:(0,eg.cn)("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors","bg-purple-600 hover:bg-purple-700 text-white",u&&"opacity-50 cursor-not-allowed"),children:[(0,ep.jsx)(eB.Save,{className:"w-4 h-4"}),u?"Guardando...":"Guardar"]})]})]})]}),document.body)}let M5=["Pendiente","QR hecho","QR hecho (Temporal)","QR hecho pero pendiente de aprobacin","Hacer QR","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrn","En revisin","Remuneracin no vlida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vdeo","Rechazada","Falta documentacin","Falta clave","Falta clave y documentacin","El afiliado cambi la clave","Autovinculacin","Cada","Completa"],M4=e=>{if(!e)return"-";let t=e.split("T")[0];if(!t)return"-";let[r,a,n]=t.split("-");return r&&a&&n?`${n}/${a}/${r}`:"-"},M3=e=>{let t=e.scheduledAt||e.fechaCreacionQR;return t&&t.split("T")[0]||""},M6=()=>{let e=new Date(new Date().toLocaleString("en-US",{timeZone:"America/Argentina/Buenos_Aires"})),t=e.getDay(),r=e.getHours(),a=e.getMinutes(),n=new Date(e),s=new Date(e);4===t&&(r>23||23===r&&a>=1)?n.setDate(e.getDate()+1):5===t?n.setDate(e.getDate()):6===t?n.setDate(e.getDate()-1):0===t?n.setDate(e.getDate()-2):n.setDate(e.getDate()-t-2),n.setHours(0,0,0,0),(s=new Date(n)).setDate(n.getDate()+6),s.setHours(23,1,0,0);let i=e=>{let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`};return{dateFrom:i(n),dateTo:i(s)}},M8={"qr hecho":{badge:{light:"bg-green-100 text-green-700",dark:"bg-green-500/30 text-green-300"},row:{light:"bg-green-50 hover:bg-green-100",dark:"bg-green-900/20 hover:bg-green-900/30"}},aprobada:{badge:{light:"bg-teal-100 text-teal-700",dark:"bg-teal-500/30 text-teal-300"},row:{light:"bg-teal-50 hover:bg-teal-100",dark:"bg-teal-900/20 hover:bg-teal-900/30"}},pendiente:{badge:{light:"bg-stone-100 text-stone-600",dark:"bg-stone-500/30 text-stone-300"},row:{light:"bg-stone-50 hover:bg-stone-100",dark:"bg-stone-800/20 hover:bg-stone-800/30"}},cargada:{badge:{light:"bg-indigo-100 text-indigo-700",dark:"bg-indigo-500/30 text-indigo-300"},row:{light:"bg-indigo-50 hover:bg-indigo-100",dark:"bg-indigo-900/20 hover:bg-indigo-900/30"}},rechazada:{badge:{light:"bg-red-100 text-red-700",dark:"bg-red-500/30 text-red-300"},row:{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"}},padrn:{badge:{light:"bg-amber-100 text-amber-700",dark:"bg-amber-500/30 text-amber-300"},row:{light:"bg-amber-50 hover:bg-amber-100",dark:"bg-amber-900/20 hover:bg-amber-900/30"}},"remuneracin no vlida":{badge:{light:"bg-red-200 text-red-800",dark:"bg-red-700/30 text-red-400"},row:{light:"bg-red-100 hover:bg-red-200",dark:"bg-red-900/30 hover:bg-red-900/40"}},autovinculacin:{badge:{light:"bg-pink-100 text-pink-700",dark:"bg-pink-500/30 text-pink-300"},row:{light:"bg-pink-50 hover:bg-pink-100",dark:"bg-pink-900/20 hover:bg-pink-900/30"}},cada:{badge:{light:"bg-rose-200 text-rose-800",dark:"bg-rose-800/40 text-rose-300"},row:{light:"bg-rose-100 hover:bg-rose-200",dark:"bg-rose-900/30 hover:bg-rose-900/40"}},"en revisin":{badge:{light:"bg-slate-100 text-slate-600",dark:"bg-slate-500/30 text-slate-300"},row:{light:"bg-slate-50 hover:bg-slate-100",dark:"bg-slate-800/20 hover:bg-slate-800/30"}},afip:{badge:{light:"bg-slate-200 text-slate-700",dark:"bg-slate-500/30 text-slate-300"},row:{light:"bg-slate-100 hover:bg-slate-200",dark:"bg-slate-700/30 hover:bg-slate-700/40"}},"hacer qr":{badge:{light:"bg-yellow-100 text-yellow-700",dark:"bg-yellow-500/30 text-yellow-300"},row:{light:"bg-yellow-50 hover:bg-yellow-100",dark:"bg-yellow-900/20 hover:bg-yellow-900/30"}},"qr hecho (temporal)":{badge:{light:"bg-lime-100 text-lime-700",dark:"bg-lime-500/30 text-lime-300"},row:{light:"bg-lime-50 hover:bg-lime-100",dark:"bg-lime-900/20 hover:bg-lime-900/30"}},"qr hecho pero pendiente de aprobacin":{badge:{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-500/20 text-emerald-400"},row:{light:"bg-emerald-50 hover:bg-emerald-100",dark:"bg-emerald-900/20 hover:bg-emerald-900/30"}},"baja laboral con nueva alta":{badge:{light:"bg-blue-100 text-blue-800",dark:"bg-blue-500/20 text-blue-400"},row:{light:"bg-blue-50 hover:bg-blue-100",dark:"bg-blue-900/20 hover:bg-blue-900/30"}},"baja laboral sin nueva alta":{badge:{light:"bg-slate-100 text-slate-800",dark:"bg-slate-500/20 text-slate-400"},row:{light:"bg-slate-50 hover:bg-slate-100",dark:"bg-slate-900/20 hover:bg-slate-900/30"}},"aprobada, pero no reconoce clave":{badge:{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},row:{light:"bg-yellow-50 hover:bg-yellow-100",dark:"bg-yellow-900/20 hover:bg-yellow-900/30"}},"rehacer vdeo":{badge:{light:"bg-red-300 text-red-900",dark:"bg-red-500/20 text-red-400"},row:{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"}},"falta documentacin":{badge:{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},row:{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"}},"falta clave":{badge:{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},row:{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"}},"falta clave (por arca)":{badge:{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-500/20 text-indigo-400"},row:{light:"bg-indigo-50 hover:bg-indigo-100",dark:"bg-indigo-900/20 hover:bg-indigo-900/30"}},"falta clave y documentacin":{badge:{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},row:{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"}},"el afiliado cambi la clave":{badge:{light:"bg-orange-200 text-orange-900",dark:"bg-orange-500/20 text-orange-400"},row:{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"}},completa:{badge:{light:"bg-lime-600 text-white",dark:"bg-lime-500/30 text-lime-300"},row:{light:"bg-lime-50 hover:bg-lime-100",dark:"bg-lime-900/20 hover:bg-lime-900/30"}}},M7=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-",M9=async(e,t,r,a)=>{try{let n=e.map(e=>"nombre"===t?e.nombre?.toUpperCase()||"":"aporte"===t?e.aporte?String(e.aporte):"":String(e[t]||"")).filter(e=>e&&""!==e.trim());if(0===n.length)return void a.error("No hay datos para copiar");let s=n.join("\n");if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(s);else{let e=document.createElement("textarea");e.value=s,e.style.position="fixed",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}a.success(`${n.length} ${r} copiados`,{duration:1500})}catch(e){console.error("Error copiando columna:",e),a.error("Error al copiar - verifique permisos del navegador")}};function Ie(){let e,t,r,n,s,{theme:i}=(0,ex.useTheme)(),{user:o}=(0,i4.useAuth)(),[l,c]=(0,em.useState)([]),[d,u]=(0,em.useState)(!1),[h,f]=(0,em.useState)(!0),[p,m]=(0,em.useState)({afiliado:"",cuil:"",cuit:"",obraVendida:"",estado:"",asesor:"",supervisor:"",administrador:""}),g=M6(),[x,b]=(0,em.useState)(g.dateFrom),[y,v]=(0,em.useState)(g.dateTo),[w,k]=(0,em.useState)([]),[j,N]=(0,em.useState)([]),[S,E]=(0,em.useState)([]),[C,T]=(0,em.useState)([]),[A,_]=(0,em.useState)(!1),[O,P]=(0,em.useState)(!1),[D,R]=(0,em.useState)(!1),[M,I]=(0,em.useState)(!1),[L,F]=(0,em.useState)([]),[B,U]=(0,em.useState)([]),[z,V]=(0,em.useState)([]),[H,W]=(0,em.useState)(null),[q,G]=(0,em.useState)(!1),[K,X]=(0,em.useState)(!1),[Y,Q]=(0,em.useState)(null),[J,Z]=(0,em.useState)({total:0,processed:0,success:0,errors:0,status:"idle",rejectedRecords:[]}),et=(0,em.useRef)(null),er=(0,em.useRef)(null),ea=(0,em.useRef)(null),en=(0,em.useRef)(null),es=o?.role?.toLowerCase()==="gerencia",ei=(0,em.useMemo)(()=>{if(0===S.length)return L;let e=new Set;return(S.forEach(t=>{let r=B.find(e=>e.nombre===t);r?.numeroEquipo&&e.add(r.numeroEquipo)}),0===e.size)?L:L.filter(t=>t.numeroEquipo&&e.has(t.numeroEquipo))},[L,S,B]),eo=w.some(e=>"qr hecho"===e.toLowerCase()),el=(0,em.useMemo)(()=>eo?l:l.filter(e=>"qr hecho"!==(e.statusAdministrativo||e.status||"").toLowerCase().trim()),[l,eo]),ec=(e,t)=>{let r=(e||"").trim();r&&t(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])},ed=(e,t,r)=>0===e.length?t:1===e.length?e[0]:`${e.length} ${r}`,eu=async()=>{try{u(!0);let e=(()=>{let e={...p};if(w.length>0&&(e.estado=w.map(e=>e.trim()).join(",")),j.length>0&&(e.asesor=j.map(e=>e.trim()).filter(Boolean).join(",")),S.length>0&&(e.supervisor=S.map(e=>e.trim()).filter(Boolean).join(",")),C.length>0&&(e.administrador=C.map(e=>e.trim()).filter(Boolean).join(",")),p.cuil&&""!==p.cuil.trim())delete e.dateFrom,delete e.dateTo,delete e.date;else if(x&&y)e.dateFrom=x,e.dateTo=y;else{let t=M6();e.dateFrom=t.dateFrom,e.dateTo=t.dateTo}return Object.keys(e).forEach(t=>{(""===e[t]||null===e[t]||void 0===e[t])&&delete e[t]}),e})(),{data:t}=await e_.api.audits.list(e),r=Array.isArray(t)?t:[],a=["completa","falta clave","falta clave (por arca)","rehacer vdeo","falta clave y documentacin","falta documentacin","autovinculacin"],n=r.filter(e=>{let t=(e.status||"").toLowerCase().trim();return!!("qr hecho"===t||"qr hecho (temporal)"===t||"qr hecho pero pendiente de aprobacin"===t||"cargada"===t||"aprobada"===t||a.includes(t))||!!(e.statusHistory&&Array.isArray(e.statusHistory))&&e.statusHistory.some(e=>a.includes((e.value||"").toLowerCase()))});c(n)}catch(e){console.error(e),eO.toast.error("Error al cargar registros de ventas"),c([])}finally{u(!1)}},eh=async()=>{try{let e=await e_.api.users.list("includeAllAuditors=true"),t=Array.isArray(e.data)?e.data:[],r=t.filter(e=>{let t=e?.active!==!1,r="asesor"===e.role||"Asesor"===e.role,a=("auditor"===e.role||"Auditor"===e.role)&&e.numeroEquipo;return t&&(r||a)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));F(r);let a=t.filter(e=>e?.active!==!1&&("supervisor"===e.role||"Supervisor"===e.role||"encargado"===e.role||"Encargado"===e.role)&&e.nombre).sort((e,t)=>e.nombre.localeCompare(t.nombre));U(a);let n=t.filter(e=>{let t=e?.active!==!1,r=(e.role||"").toLowerCase();return t&&"administrativo"===r&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));V(n)}catch(e){console.error("Error al cargar opciones de filtros:",e)}},ef=(e,t)=>{m(r=>({...r,[e]:t}))},eb=async e=>{if(confirm("Ests seguro de eliminar este registro? Se notificar a Gerencia."))try{await e_.api.audits.delete(e),eO.toast.success("Registro eliminado"),eu()}catch(e){console.error("Error deleting audit:",e),eO.toast.error("Error al eliminar registro")}},ey=async()=>{if(Y){Z(e=>({...e,status:"processing"}));try{let e=await Y.arrayBuffer(),t=function e(t,r){oP();var n,s,i,o,l,c,d,u=r||{};if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer)return e(new Uint8Array(t),((u=lq(u)).type="array",u));"undefined"!=typeof Uint8Array&&t instanceof Uint8Array&&!u.type&&(u.type="undefined"!=typeof Deno?"buffer":"array");var h=t,f=[0,0,0,0],p=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),f7={},u.dateNF&&(f7.dateNF=u.dateNF),u.type||(u.type=oz&&oN.Buffer.isBuffer(t)?"buffer":"base64"),"file"==u.type&&(u.type=oz?"buffer":"binary",h=function(e){if(void 0!==a)return a.readFileSync(e);if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw Error("Cannot access file "+e)}(t),"undefined"==typeof Uint8Array||oz||(u.type="array")),"string"==u.type&&(p=!0,u.type="binary",u.codepage=65001,h=t.match(/[^\x00-\x7F]/)?cj(t):t),"array"==u.type&&"undefined"!=typeof Uint8Array&&t instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var m=new Uint8Array(new ArrayBuffer(3));if(m.foo="bar",!m.foo)return(u=lq(u)).type="array",e(oK(h),u)}switch((f=mx(h,u))[0]){case 208:if(207===f[1]&&17===f[2]&&224===f[3]&&161===f[4]&&177===f[5]&&26===f[6]&&225===f[7])return i=lA.read(h,u),o=u,lA.find(i,"EncryptedPackage")?function(e,t){var r=t||{},a="Workbook",n=lA.find(e,a);try{if(a="/!DataSpaces/Version",!(n=lA.find(e,a))||!n.content||(s=n.content,(i={}).id=s.read_shift(0,"lpp4"),i.R=hK(s,4),i.U=hK(s,4),i.W=hK(s,4),a="/!DataSpaces/DataSpaceMap",!(n=lA.find(e,a))||!n.content))throw Error("ECMA-376 Encrypted file missing "+a);var s,i,o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(function(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}(e));return t}(n.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=lA.find(e,a))||!n.content)throw Error("ECMA-376 Encrypted file missing "+a);var l=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(n.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=lA.find(e,a))||!n.content)throw Error("ECMA-376 Encrypted file missing "+a);!function(e){var t,r=(t={},e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=hK(e,4),t.U=hK(e,4),t.W=hK(e,4),t);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),4!=e.read_shift(4))throw Error("Bad !Primary record")}(n.content)}catch(e){}if(a="/EncryptionInfo",!(n=lA.find(e,a))||!n.content)throw Error("ECMA-376 Encrypted file missing "+a);var c=function(e){var t,r,a,n,s=hK(e);switch(s.Minor){case 2:return[s.Minor,function(e){if((63&e.read_shift(4))!=36)throw Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:hX(e,t),v:hY(e,e.length-e.l)}}(e,s)];case 3:return[s.Minor,function(){throw Error("File is password-protected: ECMA-376 Extensible")}(e,s)];case 4:return[s.Minor,(t=e,r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"],t.l+=4,a=t.read_shift(t.length-t.l,"utf8"),n={},a.replace(cr,function(e){var t=cs(e);switch(ci(t[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":r.forEach(function(e){n[e]=t[e]});break;case"<dataIntegrity":n.encryptedHmacKey=t.encryptedHmacKey,n.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=t.uri;break;case"<encryptedKey":n.encs.push(t);break;default:throw t[0]}}),n)]}throw Error("ECMA-376 Encrypted file unrecognized Version: "+s.Minor)}(n.content);if(a="/EncryptedPackage",!(n=lA.find(e,a))||!n.content)throw Error("ECMA-376 Encrypted file missing "+a);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],n.content,r.password||"",r);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],n.content,r.password||"",r);throw Error("File is password-protected")}(i,o):pq(i,o);break;case 9:if(f[1]<=8)return pq(h,u);break;case 60:return pB(h,u);case 73:if(73===f[1]&&42===f[2]&&0===f[3])throw Error("TIFF Image File is not a spreadsheet");if(68===f[1]){var g=h,x=u,b=x||{},y=!!b.WTF;b.WTF=!0;try{var v=h_.to_workbook(g,b);return b.WTF=y,v}catch(e){if(b.WTF=y,!e.message.match(/SYLK bad record ID/)&&y)throw e;return hD.to_workbook(g,x)}}break;case 84:if(65===f[1]&&66===f[2]&&76===f[3])return hO.to_workbook(h,u);break;case 80:return 75===f[1]&&f[2]<9&&f[3]<9?(n=h,(s=u||{}).type||(s.type=oz&&oN.Buffer.isBuffer(n)?"buffer":"base64"),function(e,t){if(lS(),mp(t=t||{}),l0(e,"META-INF/manifest.xml")||l0(e,"objectdata.xml")){var r=e,a=t;a=a||{},l0(r,"META-INF/manifest.xml")&&function(e,t){for(var r,a,n=cM(e);r=cI.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(a=cs(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==a.type)throw Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(l2(r,"META-INF/manifest.xml"),a);var n=l5(r,"content.xml");if(!n)throw Error("Missing content.xml in ODS / UOF file");var s=p0(ck(n),a);return l0(r,"meta.xml")&&(s.Props=uA(l2(r,"meta.xml"))),s}if(l0(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return mh(e);var i,o,l,c,d,u,h,f,p,m,g,x,b,y=lA.utils.cfb_new();return l4(e).forEach(function(t){l3(y,t,function e(t,r,a){if(!a)return lZ(l1(t,r));if(!r)return null;try{return e(t,r)}catch(e){return null}}(e,t))}),mh(y)}if(!l0(e,"[Content_Types].xml")){if(l0(e,"index.xml.gz"))throw Error("Unsupported NUMBERS 08 file");if(l0(e,"index.xml"))throw Error("Unsupported NUMBERS 09 file");throw Error("Unsupported ZIP file")}var v=l4(e),w=function(e){var t=ur();if(!e||!e.match)return t;var r={};if((e.match(cr)||[]).forEach(function(e){var a=cs(e);switch(a[0].replace(ca,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":void 0!==t[ue[a.ContentType]]&&t[ue[a.ContentType]].push(a.PartName)}}),t.xmlns!==cL)throw Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(l5(e,"[Content_Types].xml")),k=!1;if(0===w.workbooks.length&&l2(e,g="xl/workbook.xml",!0)&&w.workbooks.push(g),0===w.workbooks.length){if(!l2(e,g="xl/workbook.bin",!0))throw Error("Could not find workbook");w.workbooks.push(g),k=!0}"bin"==w.workbooks[0].slice(-3)&&(k=!0);var j={},N={};if(!t.bookSheets&&!t.bookProps){if(f8=[],w.sst)try{f8=function(e,t,r){if(".bin"===t.slice(-4)){var a,n;return a=[],n=!1,db(e,function(e,t,s){switch(s){case 159:a.Count=e[0],a.Unique=e[1];break;case 19:a.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(t.T,!n||r.WTF)throw Error("Unexpected record 0x"+s.toString(16))}}),a}return function(e,t){var r=[],a="";if(!e)return r;var n=e.match(hz);if(n){a=n[2].replace(hV,"").split(h$);for(var s=0;s!=a.length;++s){var i=hU(a[s].trim(),t);null!=i&&(r[r.length]=i)}r.Count=(n=cs(n[1])).count,r.Unique=n.uniqueCount}return r}(e,r)}(l2(e,mg(w.sst)),w.sst,t)}catch(e){if(t.WTF)throw e}t.cellStyles&&w.themes.length&&(i=l5(e,w.themes[0].replace(/^\//,""),!0)||"",w.themes[0],j=fv(i,t)),w.style&&(N=function(e,t,r,a){if(".bin"===t.slice(-4)){var n={};for(var s in n.NumberFmt=[],o6)n.NumberFmt[s]=o6[s];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return db(e,function(e,t,s){switch(s){case 44:n.NumberFmt[e[0]]=e[1],lj(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(e.color.rgb=h5(r.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&n.CellXf.push(e);break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(s),o=!0;break;case 38:i.pop(),o=!1;break;default:if(t.T>0)i.push(s);else if(t.T<0)i.pop();else if(!o||a.WTF&&37!=i[i.length-1])throw Error("Unexpected record 0x"+s.toString(16))}}),n}return fi(e,r,a)}(l2(e,mg(w.style)),w.style,j,t))}w.links.map(function(r){try{uk(l5(e,uw(mg(r))),r);var a=l2(e,mg(r)),n=r,s=t;if(".bin"===n.slice(-4)){if(!a)return a;var i=s||{},o=!1;return void db(a,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(t.T);else if(!o||i.WTF)throw Error("Unexpected record 0x"+r.toString(16))}},i)}return}catch(e){}});var S=function(e,t,r){if(".bin"===t.slice(-4)){var a,n,s,i,o,l;return n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],i=!1,(a=r)||(a={}),a.biff=12,o=[],(l=[[]]).SheetNames=[],l.XTI=[],pG[16]={n:"BrtFRTArchID$",f:pR},db(e,function(e,t,r){switch(r){case 156:l.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(a.SID=e.Sheet),e.Ref=fZ(e.Ptg,null,null,l,a),delete a.SID,delete e.Ptg,o.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:l[0].length?l.push([r,e]):l[0]=[r,e],l[l.length-1].XTI=[];break;case 362:0===l.length&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(e),l.XTI=l.XTI.concat(e);break;case 35:case 37:s.push(r),i=!0;break;case 36:case 38:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&37!=s[s.length-1]&&35!=s[s.length-1])throw Error("Unexpected record 0x"+r.toString(16))}},a),pA(n),n.Names=o,n.supbooks=l,n}return function(e,t){if(!e)throw Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(cr,function(o,l){var c=cs(o);switch(ci(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(pP)&&(n="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[n];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":pj.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=cx(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=ck(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=cc(ck(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":a=!1;break;case"<definedName":(s={}).Name=ck(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),cx(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=cc(ck(e.slice(i,l))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!a&&t.WTF)throw Error("unrecognized "+c[0]+" in workbook")}return o}),-1===cV.indexOf(r.xmlns))throw Error("Unknown Namespace: "+r.xmlns);return pA(r),r}(e,r)}(l2(e,mg(w.workbooks[0])),w.workbooks[0],t),E={},C="";w.coreprops.length&&((C=l2(e,mg(w.coreprops[0]),!0))&&(E=uA(C)),0!==w.extprops.length)&&(C=l2(e,mg(w.extprops[0]),!0))&&(o=C,l=E,c=t,d={},l||(l={}),o=ck(o),uP.forEach(function(e){var t=(o.match(cN(e[0]))||[])[1];switch(e[2]){case"string":t&&(l[e[1]]=cc(t));break;case"bool":l[e[1]]="true"===t;break;case"raw":var r=o.match(RegExp("<"+e[0]+"[^>]*>([\\s\\S]*?)</"+e[0]+">"));r&&r.length>0&&(d[e[1]]=r[1])}}),d.HeadingPairs&&d.TitlesOfParts&&uR(d.HeadingPairs,d.TitlesOfParts,l,c));var T={};(!t.bookSheets||t.bookProps)&&0!==w.custprops.length&&(C=l5(e,mg(w.custprops[0]),!0))&&(T=function(e,t){var r={},a="",n=e.match(uI);if(n)for(var s=0;s!=n.length;++s){var i=n[s],o=cs(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":a=cc(o.name);break;case"</property>":a=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[a]=cc(d);break;case"bool":r[a]=cx(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(d);break;case"filetime":case"date":r[a]=lH(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw Error(i)}}return r}(C,t));var A={};if((t.bookSheets||t.bookProps)&&(S.Sheets?m=S.Sheets.map(function(e){return e.name}):E.Worksheets&&E.SheetNames.length>0&&(m=E.SheetNames),t.bookProps&&(A.Props=E,A.Custprops=T),t.bookSheets&&void 0!==m&&(A.SheetNames=m),t.bookSheets?A.SheetNames:t.bookProps))return A;m={};var _={};t.bookDeps&&w.calcchain&&(_=function(e,t,r){if(".bin"===t.slice(-4)){var a;return a=[],db(e,function(e,t,r){if(63===r)a.push(e);else if(t.T);else if(1)throw Error("Unexpected record 0x"+r.toString(16))}),a}var n=[];if(!e)return n;var s=1;return(e.match(cr)||[]).forEach(function(e){var t=cs(e);switch(t[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete t[0],t.i?s=t.i:t.i=s,n.push(t)}}),n}(l2(e,mg(w.calcchain)),w.calcchain,0));var O=0,P={},D=S.Sheets;E.Worksheets=D.length,E.SheetNames=[];for(var R=0;R!=D.length;++R)E.SheetNames[R]=D[R].name;var M=k?"bin":"xml",I=w.workbooks[0].lastIndexOf("/"),L=(w.workbooks[0].slice(0,I+1)+"_rels/"+w.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");l0(e,L)||(L="xl/_rels/workbook."+M+".rels");var F=uk(l5(e,L,!0),L.replace(/_rels.*/,"s5s"));(w.metadata||[]).length>=1&&(t.xlmeta=function(e,t,r){if(".bin"===t.slice(-4)){var a,n,s,i,o;return a={Types:[],Cell:[],Value:[]},n=r||{},s=[],i=!1,o=2,db(e,function(e,t,r){switch(r){case 335:a.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?a.Cell.push({type:a.Types[e[0]-1].name,index:e[1]}):0==o&&a.Value.push({type:a.Types[e[0]-1].name,index:e[1]})});break;case 337:o=+!!e;break;case 338:o=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||n.WTF&&35!=s[s.length-1])throw Error("Unexpected record 0x"+r.toString(16))}}),a}var l,c={Types:[],Cell:[],Value:[]};if(!e)return c;var d=!1,u=2;return e.replace(cr,function(e){var t=cs(e);switch(ci(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":c.Types.push({name:t.name});break;case"<futureMetadata":for(var a=0;a<c.Types.length;++a)c.Types[a].name==t.name&&(l=c.Types[a]);break;case"<rc":1==u?c.Cell.push({type:c.Types[t.t-1].name,index:+t.v}):0==u&&c.Value.push({type:c.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":u=1;break;case"</cellMetadata>":case"</valueMetadata>":u=2;break;case"<valueMetadata":u=0;break;case"<ext":d=!0;break;case"</ext>":d=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+t.i);break;default:if(!d&&r.WTF)throw Error("unrecognized "+t[0]+" in metadata")}return e}),c}(l2(e,mg(w.metadata[0])),w.metadata[0],t)),(w.people||[]).length>=1&&(t.people=(u=l2(e,mg(w.people[0])),h=t,f=[],p=!1,u.replace(cr,function(e){var t=cs(e);switch(ci(t[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":f.push({name:t.displayname,id:t.id});break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(!p&&h.WTF)throw Error("unrecognized "+t[0]+" in threaded comments")}return e}),f)),F&&(F=function(e,t){if(!e)return 0;try{e=t.map(function(t){var r;return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,um.indexOf(r)>-1?"sheet":up&&r==up?"chart":ug&&r==ug?"dialog":ux&&r==ux?"macro":r&&r.length?r:"sheet")]})}catch(e){return null}return e&&0!==e.length?e:null}(F,S.Sheets));var B=+!!l2(e,"xl/worksheets/sheet.xml",!0);for(O=0;O!=E.Worksheets;++O){var U="sheet";if(F&&F[O]?(l0(e,x="xl/"+F[O][1].replace(/[\/]?xl\//,""))||(x=F[O][1]),l0(e,x)||(x=L.replace(/_rels\/.*$/,"")+F[O][1]),U=F[O][2]):x=(x="xl/worksheets/sheet"+(O+1-B)+"."+M).replace(/sheet0\./,"sheet."),b=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(O!=t.sheets)continue;break;case"string":if(E.SheetNames[O].toLowerCase()!=t.sheets.toLowerCase())continue;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,V=0;V!=t.sheets.length;++V)"number"==typeof t.sheets[V]&&t.sheets[V]==O&&(z=1),"string"==typeof t.sheets[V]&&t.sheets[V].toLowerCase()==E.SheetNames[O].toLowerCase()&&(z=1);if(!z)continue}}!function(e,t,r,a,n,s,i,o,l,c,d,u){try{s[a]=uk(l5(e,r,!0),t);var h,f,p=l2(e,t);switch(o){case"sheet":h=s[a],f=".bin"===t.slice(-4)?function(e,t,r,a,n,s,i){if(!e)return e;var o,l,c,d,u,h,f,p,m,g,x,b,y=t||{};a||(a={"!id":{}});var v=y.dense?[]:{},w={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=[],j=!1,N=!1,S=[];y.biff=12,y["!row"]=0;var E=0,C=!1,T=[],A={},_=y.supbooks||n.supbooks||[[]];if(_.sharedf=A,_.arrayf=T,_.SheetNames=n.SheetNames||n.Sheets.map(function(e){return e.name}),!y.supbooks&&(y.supbooks=_,n.Names))for(var O=0;O<n.Names.length;++O)_[0][O+1]=n.Names[O];var P=[],D=[],R=!1;if(pG[16]={n:"BrtShortReal",f:pw},db(e,function(e,t,O){if(!N)switch(O){case 148:o=e;break;case 0:l=e,y.sheetRows&&y.sheetRows<=l.r&&(N=!0),m=dE(u=l.r),y["!row"]=l.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=fr(e.hpt)),D[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(c={t:e[2]},e[2]){case"n":c.v=e[1];break;case"s":p=f8[e[1]],c.v=p.t,c.r=p.r;break;case"b":c.v=!!e[1];break;case"e":c.v=e[1],!1!==y.cellText&&(c.w=d7[c.v]);break;case"str":c.t="s",c.v=e[1];break;case"is":c.t="s",c.v=e[1].t}if((d=i.CellXf[e[0].iStyleRef])&&pn(c,d.numFmtId,null,y,s,i),h=-1==e[0].c?h+1:e[0].c,y.dense?(v[u]||(v[u]=[]),v[u][h]=c):v[dT(h)+m]=c,y.cellFormula){for(E=0,C=!1;E<T.length;++E){var M=T[E];l.r>=M[0].s.r&&l.r<=M[0].e.r&&h>=M[0].s.c&&h<=M[0].e.c&&(c.F=dP(M[0]),C=!0)}!C&&e.length>3&&(c.f=e[3])}if(w.s.r>l.r&&(w.s.r=l.r),w.s.c>h&&(w.s.c=h),w.e.r<l.r&&(w.e.r=l.r),w.e.c<h&&(w.e.c=h),y.cellDates&&d&&"n"==c.t&&ly(o6[d.numFmtId])){var I=le(c.v);I&&(c.t="d",c.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}x&&("XLDAPR"==x.type&&(c.D=!0),x=void 0),b&&(b=void 0);break;case 1:case 12:if(!y.sheetStubs||j)break;c={t:"z",v:void 0},h=-1==e[0].c?h+1:e[0].c,y.dense?(v[u]||(v[u]=[]),v[u][h]=c):v[dT(h)+m]=c,w.s.r>l.r&&(w.s.r=l.r),w.s.c>h&&(w.s.c=h),w.e.r<l.r&&(w.e.r=l.r),w.e.c<h&&(w.e.c=h),x&&("XLDAPR"==x.type&&(c.D=!0),x=void 0),b&&(b=void 0);break;case 176:S.push(e);break;case 49:x=((y.xlmeta||{}).Cell||[])[e-1];break;case 494:var L=a["!id"][e.relId];for(L?(e.Target=L.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=L):""==e.relId&&(e.Target="#"+e.loc),u=e.rfx.s.r;u<=e.rfx.e.r;++u)for(h=e.rfx.s.c;h<=e.rfx.e.c;++h)y.dense?(v[u]||(v[u]=[]),v[u][h]||(v[u][h]={t:"z",v:void 0}),v[u][h].l=e):(v[f=d_({c:h,r:u})]||(v[f]={t:"z",v:void 0}),v[f].l=e);break;case 426:if(!y.cellFormula)break;T.push(e),(g=y.dense?v[u][h]:v[dT(h)+m]).f=fZ(e[1],w,{r:l.r,c:h},_,y),g.F=dP(e[0]);break;case 427:if(!y.cellFormula)break;A[d_(e[0].s)]=e[1],(g=y.dense?v[u][h]:v[dT(h)+m]).f=fZ(e[1],w,{r:l.r,c:h},_,y);break;case 60:if(!y.cellStyles)break;for(;e.e>=e.s;)P[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},R||(R=!0,h9(e.w/256)),fe(P[e.e+1]);break;case 161:v["!autofilter"]={ref:dP(e)};break;case 476:v["!margins"]=e;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),e.name&&(n.Sheets[r].CodeName=e.name),(e.above||e.left)&&(v["!outline"]={above:e.above,left:e.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),e.RTL&&(n.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:j=!0;break;case 36:j=!1;break;case 37:k.push(O),j=!0;break;case 38:k.pop(),j=!1;break;default:if(t.T);else if(!j||y.WTF)throw Error("Unexpected record 0x"+O.toString(16))}},y),delete y.supbooks,delete y["!row"],!v["!ref"]&&(w.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(v["!ref"]=dP(o||w)),y.sheetRows&&v["!ref"]){var M=dD(v["!ref"]);y.sheetRows<=+M.e.r&&(M.e.r=y.sheetRows-1,M.e.r>w.e.r&&(M.e.r=w.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>w.e.c&&(M.e.c=w.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),v["!fullref"]=v["!ref"],v["!ref"]=dP(M))}return S.length>0&&(v["!merges"]=S),P.length>0&&(v["!cols"]=P),D.length>0&&(v["!rows"]=D),v}(p,l,n,h,c,d,u):function(e,t,r,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(pi);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var h=c.match(ph);h?pm(h[0],o,n,r):(h=c.match(pf))&&(p=h[0],m=h[1],g=o,x=n,b=r,pm(p.slice(0,p.indexOf(">")),g,x,b));var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p,m,g,x,b,y,v=c.slice(f,f+50).match(pl);v&&(y=dD(v[1])).s.r<=y.e.r&&y.s.c<=y.e.c&&y.s.r>=0&&y.s.c>=0&&(o["!ref"]=dP(y))}var w=c.match(pp);w&&w[1]&&function(e,t){t.Views||(t.Views=[{}]),(e.match(pb)||[]).forEach(function(e,r){var a=cs(e);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),cx(a.rightToLeft)&&(t.Views[r].RTL=!0)})}(w[1],n);var k=[];if(t.cellStyles){var j=c.match(pc);j&&function(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=cs(t[a],!0);n.hidden&&(n.hidden=cx(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,h9(n.width)),fe(n);s<=i;)e[s++]=lq(n)}}(k,j)}u&&py(u[1],o,t,l,s,i);var N=d.match(pd);N&&(o["!autofilter"]={ref:(N[0].match(/ref="([^"]*)"/)||[])[1]});var S=[],E=d.match(ps);if(E)for(f=0;f!=E.length;++f)S[f]=dD(E[f].slice(E[f].indexOf('"')+1));var C=d.match(po);C&&function(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=cs(ck(t[n]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+cc(s.location))):(s.Target="#"+cc(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=dD(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=d_({c:c,r:l});a?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}(o,C,a);var T=d.match(pu);if(T&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}(cs(T[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=dP(l)),t.sheetRows>0&&o["!ref"]){var A=dD(o["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>l.e.r&&(A.e.r=l.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>l.e.c&&(A.e.c=l.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=dP(A))}return k.length>0&&(o["!cols"]=k),S.length>0&&(o["!merges"]=S),o}(p,l,n,h,c,d,u);break;case"chart":if(!(f=function(e,t,r,a,n,s,i,o){if(".bin"===t.slice(-4)){var l=n;if(!e)return e;l||(l={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},d=[],u=!1;return db(e,function(e,t,n){switch(n){case 550:c["!rel"]=e;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),e.name&&(s.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:d.push(n);break;case 38:d.pop();break;default:if(t.T>0)d.push(n);else if(t.T<0)d.pop();else if(!u||a.WTF)throw Error("Unexpected record 0x"+n.toString(16))}},a),l["!id"][c["!rel"]]&&(c["!drawel"]=l["!id"][c["!rel"]]),c}var h=n;if(!e)return e;h||(h={"!id":{}});var f,p={"!type":"chart","!drawel":null,"!rel":""},m=e.match(ph);return m&&pm(m[0],p,s,r),(f=e.match(/drawing r:id="(.*?)"/))&&(p["!rel"]=f[1]),h["!id"][p["!rel"]]&&(p["!drawel"]=h["!id"][p["!rel"]]),p}(p,t,n,l,s[a],c,0,0))||!f["!drawel"])break;var m=l7(f["!drawel"].Target,t),g=uw(m),x=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(l5(e,m,!0),uk(l5(e,g,!0),m)),b=l7(x,m),y=uw(b);f=function(e,t,r,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t,r,a,n,s=(r=[],a=e.match(/^<c:numCache>/),(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=a?+t[2]:t[2])}),n=cc((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]),(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,n,t]);d.s.r=d.s.c=0,d.e.c=o,c=dT(o),s[0].forEach(function(e,t){i[c+dE(t)]={t:"n",v:e,z:s[1]},l=t}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=dP(d)),i}(l5(e,b,!0),0,0,uk(l5(e,y,!0),b),0,f);break;case"macro":s[a],t.slice(-4),f={"!type":"macro"};break;case"dialog":s[a],t.slice(-4),f={"!type":"dialog"};break;default:throw Error("Unrecognized sheet type "+o)}i[a]=f;var v=[];s&&s[a]&&lO(s[a]).forEach(function(r){var n,i,o,c,d,u="";if(s[a][r].Type==uo){u=l7(s[a][r].Target,t);var h=function(e,t,r){if(".bin"===t.slice(-4)){var a,n,s,i;return a=[],n=[],s={},i=!1,db(e,function(e,t,o){switch(o){case 632:n.push(e);break;case 635:s=e;break;case 637:s.t=e.t,s.h=e.h,s.r=e.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,r.sheetRows&&s.rfx&&r.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,a.push(s);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||r.WTF)throw Error("Unexpected record 0x"+o.toString(16))}}),a}if(e.match(/<(?:\w+:)?comments *\/>/))return[];var o=[],l=[],c=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);c&&c[1]&&c[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&o.push(t[1])}});var d=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return d&&d[1]&&d[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?comment[^>]*>/);if(t){var a=cs(t[0]),n={author:a.authorId&&o[a.authorId]||"sheetjsghost",ref:a.ref,guid:a.guid},s=dA(a.ref);if(!r.sheetRows||!(r.sheetRows<=s.r)){var i=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!i&&!!i[1]&&hU(i[1])||{r:"",t:"",h:""};n.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),n.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(n.h=c.h),l.push(n)}}}}),l}(l2(e,u,!0),u,l);if(!h||!h.length)return;fS(f,h,!1)}s[a][r].Type==uy&&(u=l7(s[a][r].Target,t),v=v.concat((n=l2(e,u,!0),i=[],o=!1,c={},d=0,n.replace(cr,function(e,t){var r=cs(e);switch(ci(r[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":c={author:r.personId,guid:r.id,ref:r.ref,T:1};break;case"</threadedComment>":null!=c.t&&i.push(c);break;case"<text>":case"<text":d=t+e.length;break;case"</text>":c.t=n.slice(d,t).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":o=!0;break;case"</mentions>":case"</ext>":o=!1;break;default:if(!o&&l.WTF)throw Error("unrecognized "+r[0]+" in threaded comments")}return e}),i)))}),v&&v.length&&fS(f,v,!0,l.people||[])}catch(e){if(l.WTF)throw e}}(e,x,b,E.SheetNames[O],O,P,m,U,t,S,j,N)}return A={Directory:w,Workbook:S,Props:E,Custprops:T,Deps:_,Sheets:m,SheetNames:E.SheetNames,Strings:f8,Styles:N,Themes:j,SSF:lq(o6)},t&&t.bookFiles&&(e.files?(A.keys=v,A.files=e.files):(A.keys=[],A.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),A.keys.push(t),A.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(w.vba.length>0?A.vbaraw=l2(e,mg(w.vba[0]),!0):w.defaults&&"application/vnd.ms-office.vbaProject"===w.defaults.bin&&(A.vbaraw=l2(e,"xl/vbaProject.bin",!0))),A}(l8(n,s),s)):my(t,h,u,p);case 239:return 60===f[3]?pB(h,u):my(t,h,u,p);case 255:if(254===f[1])return l=h,c=u,d=l,"base64"==c.type&&(d=oU(d)),d=ee.utils.decode(1200,d.slice(2),"str"),c.type="binary",mb(d,c);if(0===f[1]&&2===f[2]&&0===f[3])return hR.to_workbook(h,u);break;case 0:if(0===f[1]&&(f[2]>=2&&0===f[3]||0===f[2]&&(8===f[3]||9===f[3])))return hR.to_workbook(h,u);break;case 3:case 131:case 139:case 140:return hA.to_workbook(h,u);case 123:if(92===f[1]&&114===f[2]&&116===f[3])return h1.to_workbook(h,u);break;case 10:case 13:case 32:var w=h,k=u,j="",N=mx(w,k);switch(k.type){case"base64":j=oU(w);break;case"binary":j=w;break;case"buffer":j=w.toString("binary");break;case"array":j=lW(w);break;default:throw Error("Unrecognized type "+k.type)}return 239==N[0]&&187==N[1]&&191==N[2]&&(j=ck(j)),k.type="binary",mb(j,k);case 137:if(80===f[1]&&78===f[2]&&71===f[3])throw Error("PNG Image File is not a spreadsheet")}return hT.indexOf(f[0])>-1&&f[2]<=12&&f[3]<=31?hA.to_workbook(h,u):my(t,h,u,p)}(e,{type:"array"}),r=t.SheetNames[0],n=t.Sheets[r],s=mN(n,{defval:""});if(0===s.length){eO.toast.error("El archivo est vaco"),Z(e=>({...e,status:"error"}));return}Z(e=>({...e,total:s.length}));let i={nombre:"nombre","apellido y nombre":"nombre",afiliado:"nombre",cuil:"cuil",telefono:"telefono",telfono:"telefono",tel:"telefono",tipo:"tipoVenta","tipo venta":"tipoVenta",tipoventa:"tipoVenta","obra social anterior":"obraSocialAnterior","os anterior":"obraSocialAnterior",osanterior:"obraSocialAnterior","obra social vendida":"obraSocialVendida","os vendida":"obraSocialVendida",osvendida:"obraSocialVendida","obra social":"obraSocialVendida",supervisor:"supervisor",sup:"supervisor",asesor:"asesor",administrativo:"administrativo",admin:"administrativo",estado:"estado",status:"estado",aporte:"aporte",cuit:"cuit","datos extra":"datosExtra",datosextra:"datosExtra",datos:"datosExtra",observacion:"observacionPrivada",observacin:"observacionPrivada",obs:"observacionPrivada","observacion privada":"observacionPrivada",clave:"clave",email:"email",correo:"email","fecha turno":"fechaTurno",fechaturno:"fechaTurno",fecha:"fechaTurno"},o=s.map(e=>{let t={};return Object.keys(e).forEach(r=>{let a=r.toLowerCase().trim();t[i[a]||a]=e[r]}),t}),l=[];for(let e=0;e<o.length;e+=500)l.push(o.slice(e,e+500));let c=0,d=0,u=[],h=0;for(let e of l){try{let t=await e_.api.audits.bulkImport({records:e});c+=t.data.successCount||0,d+=t.data.errorCount||0,t.data.errors&&(u=[...u,...t.data.errors.map(e=>({row:e.row+h,data:e.data,reason:e.reasons?.join(", ")||"Error desconocido"}))])}catch(t){d+=e.length,e.forEach((r,a)=>{u.push({row:h+a+2,data:e[a],reason:t.message||"Error de conexin"})})}h+=e.length,Z(e=>({...e,processed:h,success:c,errors:d}))}Z(e=>({...e,status:"complete",rejectedRecords:u})),c>0&&(eO.toast.success(`${c} registros importados correctamente`),eu()),d>0&&eO.toast.warning(`${d} registros con errores`)}catch(e){console.error("Error processing file:",e),eO.toast.error("Error al procesar el archivo: "+e.message),Z(e=>({...e,status:"error"}))}}};return(0,em.useEffect)(()=>{eu(),eh();let e=(0,iQ.connectSocket)();e.emit("audits:subscribeAll");let t=e=>{c(t=>{let r=t.findIndex(t=>t._id===e._id);if(-1===r)return"Completa"===e.status?[e,...t]:t;let a=[...t];return a[r]={...t[r],...e},a}),W(t=>t&&t._id===e._id?{...t,...e}:t)},r=e=>{c(t=>t.filter(t=>t._id!==e._id)),H&&H._id===e._id&&(G(!1),W(null),eO.toast.info("El registro ha sido eliminado"))};return e.on("audit:updated",t),e.on("audit:deleted",r),()=>{e.off("audit:updated",t),e.off("audit:deleted",r)}},[]),(0,em.useEffect)(()=>{eu()},[p,w,j,S,C,x,y]),(0,em.useEffect)(()=>{let e=e=>{et.current&&!et.current.contains(e.target)&&_(!1),er.current&&!er.current.contains(e.target)&&P(!1),ea.current&&!ea.current.contains(e.target)&&R(!1),en.current&&!en.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm relative z-20","dark"===i?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,ep.jsx)(ow.Filter,{className:(0,eg.cn)("w-5 h-5","dark"===i?"text-purple-400":"text-purple-500")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("font-semibold","dark"===i?"text-white":"text-gray-800"),children:"Filtros"})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3 mb-3",children:[(0,ep.jsx)("input",{type:"text",placeholder:"Buscar afiliado",value:p.afiliado,onChange:e=>ef("afiliado",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar CUIL",value:p.cuil,onChange:e=>ef("cuil",e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsxs)("div",{ref:et,className:"relative",children:[(0,ep.jsxs)("button",{onClick:()=>_(!A),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:ed(w,"Estado","estados")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),A&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>k(M5),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),w.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>k([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),M5.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:w.includes(e),onChange:()=>ec(e,k),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e})]},e))]})]}),(0,ep.jsxs)("div",{ref:ea,className:"relative",children:[(0,ep.jsxs)("button",{onClick:()=>R(!D),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:ed(S,"Supervisor","supervisores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),D&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>E(B.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),S.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>E([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),B.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:S.includes(e.nombre),onChange:()=>ec(e.nombre,E),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,ep.jsxs)("div",{ref:er,className:"relative",children:[(0,ep.jsxs)("button",{onClick:()=>P(!O),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:ed(j,"Asesor","asesores")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),O&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>N(ei.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),j.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>N([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),ei.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:j.includes(e.nombre),onChange:()=>ec(e.nombre,N),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,ep.jsxs)("div",{ref:en,className:"relative",children:[(0,ep.jsxs)("button",{onClick:()=>I(!M),className:(0,eg.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("span",{className:"truncate",children:ed(C,"Administrativo","admins")}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})]}),M&&(0,ep.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,ep.jsx)("button",{type:"button",onClick:()=>T(z.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),C.length>0&&(0,ep.jsx)("button",{type:"button",onClick:()=>T([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),z.map(e=>(0,ep.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,ep.jsx)("input",{type:"checkbox",checked:C.includes(e.nombre),onChange:()=>ec(e.nombre,T),className:"accent-blue-600"}),(0,ep.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]})]}),(0,ep.jsxs)("div",{className:"flex flex-wrap items-end gap-3 mt-3",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs block mb-1","dark"===i?"text-gray-400":"text-gray-500"),children:"Desde"}),(0,ep.jsx)("input",{type:"date",value:x,onChange:e=>b(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs block mb-1","dark"===i?"text-gray-400":"text-gray-500"),children:"Hasta"}),(0,ep.jsx)("input",{type:"date",value:y,onChange:e=>v(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===i?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsx)("div",{className:"flex-1"}),(0,ep.jsx)("button",{onClick:()=>{m({afiliado:"",cuil:"",cuit:"",obraVendida:"",estado:"",asesor:"",supervisor:"",administrador:""}),b(""),v(""),k([]),N([]),E([]),T([])},className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===i?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Limpiar"}),(0,ep.jsxs)("button",{onClick:()=>{if(!l||0===l.length)return void eO.toast.info("No hay datos para exportar");let e=mA(l.map((e,t)=>({Cantidad:t+1,Fecha:e.fechaCreacionQR?M4(e.fechaCreacionQR):e.scheduledAt?M4(e.scheduledAt):"-","Apellido y Nombre":e.nombre||"-",CUIL:e.cuil||"-",Telfono:e.telefono||"-","Obra Social Vendida":e.obraSocialVendida||"-",Supervisor:M7(e),Asesor:e.asesor?.nombre||"-",Estado:e.status||"-",Aporte:e.aporte||"-",CUIT:e.cuit||"-","Datos Extra":e.datosExtra||"-","Observacin Privada":e.observacionPrivada||"-",Clave:e.clave||"-",Email:e.email||"-",Administrativo:e.administrador?.nombre||"-"}))),t=m_();mO(t,e,"Registro de Ventas");let r=new Date().toISOString().slice(0,10);mj(t,`registro_ventas_${x||r}.xlsx`),eO.toast.success("Exportado correctamente")},className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2",style:{backgroundColor:"#17C787"},children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar"]}),es&&(0,ep.jsxs)("button",{onClick:()=>X(!0),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2 bg-purple-600 hover:bg-purple-700",children:[(0,ep.jsx)(eI.Upload,{className:"w-4 h-4"}),"Carga Masiva"]})]})]}),l.length>0&&(e={},l.forEach(t=>{let r=t.statusAdministrativo||t.status||"Sin estado";e[r]=(e[r]||0)+1}),t=l.length,r=Object.entries(e).sort((e,t)=>t[1]-e[1]),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-3 mb-4","dark"===i?"bg-gradient-to-r from-blue-900/20 to-indigo-900/20 border-blue-700/30":"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"),children:(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("font-bold","dark"===i?"text-gray-200":"text-gray-800"),children:["Total: ",(0,ep.jsx)("span",{className:"dark"===i?"text-blue-400":"text-blue-600",children:t})]}),r.map(([e,t])=>(0,ep.jsxs)("span",{className:"dark"===i?"text-gray-300":"text-gray-700",children:[(0,ep.jsxs)("span",{className:"font-semibold",children:[e,":"]})," ",(0,ep.jsx)("span",{className:"dark"===i?"text-indigo-400":"text-indigo-600",children:t})]},e))]})})),el.length>0&&(n={},el.forEach(e=>{let t=e.administrador?.nombre||"Sin asignar";n[t]=(n[t]||0)+1}),s=Object.entries(n).sort((e,t)=>t[1]-e[1]),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-3 mb-4","dark"===i?"bg-gradient-to-r from-purple-900/20 to-fuchsia-900/20 border-purple-700/30":"bg-gradient-to-r from-purple-50 to-fuchsia-50 border-purple-200"),children:(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("font-bold","dark"===i?"text-gray-200":"text-gray-800"),children:"Por Administrativo:"}),s.map(([e,t])=>(0,ep.jsxs)("span",{className:"dark"===i?"text-gray-300":"text-gray-700",children:[(0,ep.jsxs)("span",{className:"font-semibold",children:[e,":"]})," ",(0,ep.jsx)("span",{className:"dark"===i?"text-purple-400":"text-purple-600",children:t})]},e))]})})),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===i?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{className:(0,eg.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===i?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,ep.jsxs)("tr",{children:[(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:"Fecha"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center min-w-[150px]",children:(0,ep.jsxs)("button",{onClick:()=>M9(el,"nombre","Afiliados",eO.toast),className:"inline-flex items-center gap-1 hover:text-blue-500 dark:hover:text-blue-400 transition-colors group/hdr",title:"Copiar toda la columna",children:["Afiliado",(0,ep.jsx)(MZ,{className:"w-3 h-3 opacity-0 group-hover/hdr:opacity-70 transition-opacity"})]})}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:(0,ep.jsxs)("button",{onClick:()=>M9(el,"cuil","CUILs",eO.toast),className:"inline-flex items-center gap-1 hover:text-blue-500 dark:hover:text-blue-400 transition-colors group/hdr",title:"Copiar toda la columna",children:["CUIL",(0,ep.jsx)(MZ,{className:"w-3 h-3 opacity-0 group-hover/hdr:opacity-70 transition-opacity"})]})}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:(0,ep.jsxs)("button",{onClick:()=>M9(el,"telefono","Telfonos",eO.toast),className:"inline-flex items-center gap-1 hover:text-blue-500 dark:hover:text-blue-400 transition-colors group/hdr",title:"Copiar toda la columna",children:["Telfono",(0,ep.jsx)(MZ,{className:"w-3 h-3 opacity-0 group-hover/hdr:opacity-70 transition-opacity"})]})}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[90px]",children:"O.S. Ven"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center min-w-[100px]",children:"Supervisor"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center min-w-[100px]",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center min-w-[100px]",children:"Estado"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[80px]",children:(0,ep.jsxs)("button",{onClick:()=>M9(el,"aporte","Aportes",eO.toast),className:"inline-flex items-center gap-1 hover:text-blue-500 dark:hover:text-blue-400 transition-colors group/hdr",title:"Copiar toda la columna",children:["Aporte",(0,ep.jsx)(MZ,{className:"w-3 h-3 opacity-0 group-hover/hdr:opacity-70 transition-opacity"})]})}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:(0,ep.jsxs)("button",{onClick:()=>M9(el,"cuit","CUITs",eO.toast),className:"inline-flex items-center gap-1 hover:text-blue-500 dark:hover:text-blue-400 transition-colors group/hdr",title:"Copiar toda la columna",children:["CUIT",(0,ep.jsx)(MZ,{className:"w-3 h-3 opacity-0 group-hover/hdr:opacity-70 transition-opacity"})]})}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:"Datos Extra"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:"Obs. Privada"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[80px]",children:"Clave"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[100px]",children:(0,ep.jsxs)("button",{onClick:()=>M9(el,"email","Emails",eO.toast),className:"inline-flex items-center gap-1 hover:text-blue-500 dark:hover:text-blue-400 transition-colors group/hdr",title:"Copiar toda la columna",children:["Email",(0,ep.jsx)(MZ,{className:"w-3 h-3 opacity-0 group-hover/hdr:opacity-70 transition-opacity"})]})}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center min-w-[100px]",children:"Admin"}),(0,ep.jsx)("th",{className:"px-2 py-2 text-center w-[80px]",children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:d?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:16,className:"px-4 py-8 text-center opacity-50",children:(0,ep.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando registros..."]})})}):0===el.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:16,className:"px-4 py-8 text-center opacity-50",children:l.length>0&&!eo?(0,ep.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,ep.jsx)(mV.CheckCircle2,{className:"w-8 h-8 text-green-500"}),(0,ep.jsx)("span",{children:'Todos los registros estn en estado "QR hecho"'}),(0,ep.jsx)("span",{className:"text-xs",children:"Filtra por estado para verlos"})]}):"No se encontraron registros"})}):el.map((e,t)=>{var r,a,n;let s,o,l=M3(e),c=t>0?el[t-1]:null,d=c?M3(c):null,u=0===t||l!==d;return(0,ep.jsxs)(ep.Fragment,{children:[u&&l&&(0,ep.jsx)("tr",{className:"sticky top-[41px] z-[5]",children:(0,ep.jsx)("td",{colSpan:16,className:(0,eg.cn)("px-0 py-0","dark"===i?"bg-gray-900":"bg-white"),children:(0,ep.jsxs)("div",{className:(0,eg.cn)("relative px-4 py-3 font-bold text-sm overflow-hidden","border-y-2 shadow-md","dark"===i?"bg-gradient-to-r from-indigo-900/80 via-purple-900/60 to-indigo-900/80 text-white border-indigo-400/50":"bg-gradient-to-r from-indigo-500 via-purple-500 to-indigo-500 text-white border-indigo-300"),children:[(0,ep.jsx)("div",{className:"absolute inset-0 bg-[linear-gradient(90deg,transparent_0%,rgba(255,255,255,0.1)_50%,transparent_100%)] animate-shimmer"}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("p-1.5 rounded-lg","dark"===i?"bg-white/20":"bg-white/30"),children:(0,ep.jsx)(eS,{className:"w-5 h-5"})}),(0,ep.jsx)("span",{className:"tracking-wide",children:(e=>{if(!e)return"";let[t,r,a]=e.split("-");if(!t||!r||!a)return e;let n=["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"][new Date(parseInt(t),parseInt(r)-1,parseInt(a)).getDay()];return`${n} ${a}/${r}/${t}`})(l)}),(0,ep.jsx)("div",{className:"flex-1"}),(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs px-2 py-1 rounded-full","dark"===i?"bg-white/20":"bg-white/30"),children:[el.filter(e=>M3(e)===l).length," registros"]})]})]})})},`day-${l}-${t}`),(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors group",((e,t)=>{if(!e)return"";let r=M8[e.toLowerCase()];return r?"dark"===t?r.row.dark:r.row.light:""})(e.statusAdministrativo||e.status,i)||(t%2==0?"":"dark"===i?"bg-white/[0.02]":"bg-gray-50/50")),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center","dark"===i?"text-gray-400":"text-gray-500"),children:e.fechaCreacionQR?(0,ep.jsxs)("div",{className:"flex flex-col items-center",children:[(0,ep.jsx)("span",{className:"text-purple-500 font-medium",children:M4(e.fechaCreacionQR)}),(0,ep.jsx)("span",{className:"text-[10px] text-gray-400",children:"(QR)"})]}):(e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`})(e.scheduledAt)}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center font-medium truncate max-w-[150px]",title:e.nombre,children:e.nombre?e.nombre.toUpperCase():"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center font-mono truncate","dark"===i?"text-gray-400":"text-gray-500"),children:e.cuil||"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center font-mono truncate","dark"===i?"text-gray-400":"text-gray-500"),children:e.telefono||"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[80px]",(r=e.obraSocialVendida,s=({binimed:{light:"bg-blue-100 text-blue-800",dark:"bg-blue-500/20 text-blue-400"},meplife:{light:"bg-green-100 text-green-800",dark:"bg-green-500/20 text-green-400"},turf:{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},ras:{light:"bg-red-100 text-red-800",dark:"bg-red-500/20 text-red-400"},medicenter:{light:"bg-gray-100 text-gray-800",dark:"bg-gray-500/20 text-gray-400"}})[(r||"").toLowerCase()]||{light:"bg-gray-100 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"dark"===i?s.dark:s.light)),children:e.obraSocialVendida||"-"})}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px] inline-block",((e,t)=>{if(!e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=e.toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";if(r.includes("belen")&&r.includes("salaverry"))return"dark"===t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800";if(r.includes("analia")&&r.includes("suarez"))return"dark"===t?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800";if(r.includes("erika")&&r.includes("cardozo"))return"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800";if(r.includes("aryel")&&r.includes("puiggros"))return"dark"===t?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800";if(r.includes("joaquin")&&r.includes("valdez")||r.includes("joquin")&&r.includes("valdez"))return"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800";if(r.includes("luciano")&&r.includes("carugno"))return"dark"===t?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800";if(r.includes("alejandro")&&r.includes("mejail"))return"dark"===t?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800";if(r.includes("gaston")&&r.includes("sarmiento"))return"dark"===t?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-900 text-rose-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-900 text-indigo-200"}],n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);let s=Math.abs(n)%a.length,i=a[s];return"dark"===t?i.dark:i.light})(M7(e),i)),title:M7(e),children:M7(e)})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center","dark"===i?"text-gray-300":"text-gray-700"),children:e.asesor?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px]",(a=e.statusAdministrativo||e.status,(o=M8[(a||"").toLowerCase()])?"dark"===i?o.badge.dark:o.badge.light:"dark"===i?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700")),title:e.statusAdministrativo||e.status,children:e.statusAdministrativo||e.status||"-"})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center font-semibold",(n=e.aporte,null==n?"":n<35e3?"dark"===i?"text-red-400":"text-red-600":"dark"===i?"text-green-400":"text-green-600")),children:e.aporte?`$${e.aporte.toLocaleString()}`:"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center font-mono truncate","dark"===i?"text-gray-400":"text-gray-500"),children:e.cuit||"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center max-w-[100px] truncate",title:e.datosExtra,children:e.datosExtra?e.datosExtra.charAt(0).toUpperCase()+e.datosExtra.slice(1).toLowerCase():"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center max-w-[100px] truncate",title:e.observacionPrivada,children:e.observacionPrivada?e.observacionPrivada.charAt(0).toUpperCase()+e.observacionPrivada.slice(1).toLowerCase():"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center",children:e.clave||"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center max-w-[100px] truncate",title:e.email,children:e.email||"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2 text-center","dark"===i?"text-gray-400":"text-gray-600"),children:e.administrador?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-2 py-2 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1 transition-opacity",children:[(0,ep.jsx)("button",{onClick:()=>{W(e),G(!0)},className:"p-1 hover:bg-blue-100 text-blue-600 rounded dark:hover:bg-blue-900/30 dark:text-blue-400",title:"Editar",children:(0,ep.jsx)(e1,{className:"w-3 h-3"})}),es&&(0,ep.jsx)("button",{onClick:()=>eb(e._id),className:"p-1 hover:bg-red-100 text-red-600 rounded dark:hover:bg-red-900/30 dark:text-red-400",title:"Eliminar",children:(0,ep.jsx)(eU.Trash2,{className:"w-3 h-3"})})]})})]},e._id)]})})})]})})}),H&&(0,ep.jsx)(M2,{isOpen:q,onClose:()=>{G(!1),W(null)},audit:H,onSave:e=>{c(t=>t.map(t=>t._id===e._id?e:t)),G(!1),W(null)}}),(0,ep.jsx)("div",{className:(0,eg.cn)("fixed top-0 right-0 h-full z-40 transition-transform duration-300 ease-out","w-full sm:w-[420px] max-w-[90vw]",K?"translate-x-0":"translate-x-full"),children:(0,ep.jsxs)("div",{className:(0,eg.cn)("h-full overflow-y-auto shadow-2xl border-l","dark"===i?"bg-gray-900 border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"sticky top-0 z-10 px-4 py-3 border-b flex items-center justify-between",style:{background:"dark"===i?"rgb(17, 24, 39)":"white"},children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-base font-bold flex items-center gap-2","dark"===i?"text-white":"text-gray-800"),children:[(0,ep.jsx)(eC,{className:"w-5 h-5 text-purple-500"}),"Carga Masiva"]}),(0,ep.jsx)("button",{onClick:()=>{X(!1),Q(null),Z({total:0,processed:0,success:0,errors:0,status:"idle",rejectedRecords:[]})},className:(0,eg.cn)("p-1.5 rounded-lg transition-colors","dark"===i?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsxs)("div",{className:"p-4 space-y-4",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-lg border-2 border-dashed p-4 text-center transition-colors","dark"===i?"border-white/20 hover:border-purple-500/50 bg-white/5":"border-gray-300 hover:border-purple-400 bg-gray-50"),children:[(0,ep.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{let t=e.target.files?.[0];t&&(Q(t),Z({total:0,processed:0,success:0,errors:0,status:"idle",rejectedRecords:[]}))},className:"hidden",id:"bulk-file-input"}),(0,ep.jsxs)("label",{htmlFor:"bulk-file-input",className:"cursor-pointer block",children:[(0,ep.jsx)(eI.Upload,{className:(0,eg.cn)("w-8 h-8 mx-auto mb-2","dark"===i?"text-gray-500":"text-gray-400")}),(0,ep.jsx)("p",{className:(0,eg.cn)("font-medium text-sm","dark"===i?"text-white":"text-gray-700"),children:Y?Y.name:"Seleccionar archivo Excel"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-xs mt-1","text-gray-500"),children:".xlsx o .xls (hasta 100k registros)"})]})]}),Y&&"idle"===J.status&&(0,ep.jsxs)("button",{onClick:ey,className:"w-full px-4 py-2.5 rounded-lg font-medium text-white bg-purple-600 hover:bg-purple-700 transition-colors flex items-center justify-center gap-2 text-sm",children:[(0,ep.jsx)(eI.Upload,{className:"w-4 h-4"}),"Iniciar Importacin"]}),"processing"===J.status&&(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-lg p-3","dark"===i?"bg-white/5":"bg-gray-100"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs font-medium","dark"===i?"text-white":"text-gray-700"),children:"Procesando..."}),(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs","dark"===i?"text-gray-400":"text-gray-500"),children:[J.processed," / ",J.total]})]}),(0,ep.jsx)("div",{className:"w-full h-1.5 rounded-full bg-gray-300 dark:bg-gray-700 overflow-hidden",children:(0,ep.jsx)("div",{className:"h-full bg-purple-500 transition-all duration-300",style:{width:`${J.total>0?J.processed/J.total*100:0}%`}})}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-xs",children:[(0,ep.jsxs)("span",{className:"text-green-500",children:[" ",J.success]}),J.errors>0&&(0,ep.jsxs)("span",{className:"text-red-500",children:[" ",J.errors]})]})]}),"complete"===J.status&&(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-lg p-3","dark"===i?"bg-green-900/20 border border-green-500/30":"bg-green-50 border border-green-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,ep.jsx)(mV.CheckCircle2,{className:"w-4 h-4 text-green-500"}),(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium text-sm","dark"===i?"text-green-300":"text-green-700"),children:"Completado"})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,ep.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:[" ",J.success," importados"]}),J.errors>0&&(0,ep.jsxs)("span",{className:"text-red-500",children:[" ",J.errors," rechazados"]})]}),J.rejectedRecords.length>0&&(0,ep.jsxs)("button",{onClick:()=>{if(0===J.rejectedRecords.length)return;let e=mA(J.rejectedRecords.map(e=>({Fila:e.row,Nombre:e.data?.nombre||"",CUIL:e.data?.cuil||"",Telefono:e.data?.telefono||"","Obra Social Vendida":e.data?.obraSocialVendida||"",Supervisor:e.data?.supervisor||"",Asesor:e.data?.asesor||"",Estado:e.data?.estado||"","Motivo Rechazo":e.reason}))),t=m_();mO(t,e,"Rechazados"),mj(t,`registros_rechazados_${new Date().toISOString().slice(0,10)}.xlsx`)},className:"mt-2 px-2 py-1.5 rounded text-xs font-medium border flex items-center gap-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 border-red-300 dark:border-red-500/30",children:[(0,ep.jsx)(i1,{className:"w-3 h-3"}),"Descargar Rechazados (",J.rejectedRecords.length,")"]})]}),"error"===J.status&&(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-lg p-3 border","dark"===i?"bg-red-900/20 border-red-500/30":"bg-red-50 border-red-200"),children:(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(eZ,{className:"w-4 h-4 text-red-500"}),(0,ep.jsx)("span",{className:"text-red-600 dark:text-red-400 font-medium text-sm",children:"Error al procesar"})]})}),(0,ep.jsxs)("details",{className:(0,eg.cn)("rounded-lg border overflow-hidden","dark"===i?"bg-white/5 border-white/10":"bg-blue-50/50 border-blue-200"),children:[(0,ep.jsxs)("summary",{className:(0,eg.cn)("px-3 py-2 cursor-pointer text-sm font-medium flex items-center gap-2 select-none","dark"===i?"text-blue-300 hover:bg-white/5":"text-blue-700 hover:bg-blue-100/50"),children:[(0,ep.jsx)(Mp.Info,{className:"w-4 h-4"}),"Formato del archivo"]}),(0,ep.jsxs)("div",{className:"px-3 pb-3 pt-1 space-y-1 text-xs",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,ep.jsx)("span",{className:"px-1 py-0.5 rounded bg-red-500/20 text-red-400 text-[10px]",children:"*"}),(0,ep.jsx)("span",{className:"dark"===i?"text-gray-300":"text-gray-700",children:"nombre"})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,ep.jsx)("span",{className:"px-1 py-0.5 rounded bg-red-500/20 text-red-400 text-[10px]",children:"*"}),(0,ep.jsx)("span",{className:"dark"===i?"text-gray-300":"text-gray-700",children:"telefono"})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,ep.jsx)("span",{className:"px-1 py-0.5 rounded bg-red-500/20 text-red-400 text-[10px]",children:"*"}),(0,ep.jsx)("span",{className:"dark"===i?"text-gray-300":"text-gray-700",children:"obraSocialVendida"})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("pt-1 text-[11px]","text-gray-500"),children:"Opcionales: cuil, supervisor, asesor, administrativo, estado, aporte, cuit, clave, email"})]})]})]})]})})]})}function It(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)([]),[a,n]=(0,em.useState)(!1),[s,i]=(0,em.useState)(0);(0,em.useEffect)(()=>{o()},[]);let o=async()=>{n(!0);try{let{data:e}=await e_.api.affiliates.getFresh();r(e.data||[]),i(e.total||0)}catch(e){console.error("Error fetching fresh data:",e),eO.toast.error("Error al cargar datos frescos")}finally{n(!1)}};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)("span",{className:"p-2 rounded-lg bg-emerald-500/20 text-emerald-500",children:(0,ep.jsx)(eY.Sparkles,{className:"w-6 h-6"})}),"Datos Frescos"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:"Afiliados sin registros en Auditoras o Contactar Afiliados"})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("button",{onClick:o,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"),children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,ep.jsxs)("button",{onClick:()=>{if(0===t.length)return void eO.toast.info("No hay datos para exportar");let e=mA(t.map(e=>({Nombre:e.nombre,CUIL:e.cuil,"Obra Social":e.obraSocial,Telfono:e.telefono,Localidad:e.localidad}))),r=m_();mO(r,e,"Datos Frescos"),mj(r,`datos_frescos_${new Date().toISOString().slice(0,10)}.xlsx`),eO.toast.success("Archivo exportado exitosamente")},disabled:0===t.length,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2",0===t.length?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar"]})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Total de datos frescos"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-3xl font-bold mt-1","dark"===e?"text-white":"text-gray-900"),children:s})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("p-4 rounded-xl","dark"===e?"bg-emerald-500/10":"bg-emerald-50"),children:(0,ep.jsx)(eY.Sparkles,{className:(0,eg.cn)("w-8 h-8","dark"===e?"text-emerald-400":"text-emerald-600")})})]})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:(0,eg.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,ep.jsx)("th",{className:"px-6 py-4",children:"Nombre"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Obra Social"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Telfono"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Localidad"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:a?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-5 h-5 animate-spin text-emerald-500"}),(0,ep.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===t.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"No hay datos frescos disponibles"})}):t.map(t=>(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,ep.jsx)("td",{className:"px-6 py-4 font-medium",children:t.nombre}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.cuil}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.obraSocial}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.telefono}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.localidad})]},t._id))})]})})})]})}function Ir(){let{theme:e}=(0,ex.useTheme)(),[t,r]=(0,em.useState)([]),[a,n]=(0,em.useState)(!1),[s,i]=(0,em.useState)(0);(0,em.useEffect)(()=>{o()},[]);let o=async()=>{n(!0);try{let{data:e}=await e_.api.affiliates.getReusableData();r(e.data||[]),i(e.total||0)}catch(e){console.error("Error fetching reusable data:",e),eO.toast.error("Error al cargar datos reutilizables")}finally{n(!1)}};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)("span",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-500",children:(0,ep.jsx)(os.Recycle,{className:"w-6 h-6"})}),"Datos Reutilizables"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:"Registros de auditoras en suspenso o sin contacto establecido"})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("button",{onClick:o,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"),children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,ep.jsxs)("button",{onClick:()=>{if(0===t.length)return void eO.toast.info("No hay datos para exportar");let e=mA(t.map(e=>({Nombre:e.nombre,CUIL:e.cuil,Telfono:e.telefono,"Obra Social":e.obraSocial,Localidad:e.localidad,Estado:e.estado}))),r=m_();mO(r,e,"Datos Reutilizables"),mj(r,`datos_reutilizables_${new Date().toISOString().slice(0,10)}.xlsx`),eO.toast.success("Archivo exportado exitosamente")},disabled:0===t.length,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2",0===t.length?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar"]})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border p-6","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Total de registros reutilizables"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-3xl font-bold mt-1","dark"===e?"text-white":"text-gray-900"),children:s})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("p-4 rounded-xl","dark"===e?"bg-blue-500/10":"bg-blue-50"),children:(0,ep.jsx)(os.Recycle,{className:(0,eg.cn)("w-8 h-8","dark"===e?"text-blue-400":"text-blue-600")})})]})}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:(0,eg.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,ep.jsx)("th",{className:"px-6 py-4",children:"Nombre"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Telfono"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Obra Social"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Localidad"}),(0,ep.jsx)("th",{className:"px-6 py-4",children:"Estado"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:a?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-5 h-5 animate-spin text-blue-500"}),(0,ep.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===t.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No hay datos reutilizables disponibles"})}):t.map(t=>{var r;let a;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,ep.jsx)("td",{className:"px-6 py-4 font-medium",children:t.nombre}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.cuil}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.telefono}),(0,ep.jsx)("td",{className:"px-6 py-4",children:t.obraSocial}),(0,ep.jsx)("td",{className:"px-6 py-4",children:"DESCONOCIDO"===t.localidad?(0,ep.jsx)("span",{className:"italic text-gray-400",children:t.localidad}):t.localidad}),(0,ep.jsx)("td",{className:"px-6 py-4",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-1 rounded-md text-xs font-medium",(r=t.estado,"no atendi"===(a=r.toLowerCase())?"dark"===e?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800":"reprogramada (falta confirmar hora)"===a?"dark"===e?"bg-violet-500/20 text-violet-400":"bg-violet-100 text-violet-800":"tiene dudas"===a?"dark"===e?"bg-pink-500/20 text-pink-400":"bg-pink-100 text-pink-800":"dark"===e?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800")),children:t.estado})})]},t._id)})})]})})})]})}let Ia=(0,ek.default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),In=(0,ek.default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);function Is(){let{theme:e}=(0,ex.useTheme)(),t=(0,MD.useRouter)(),[r,a]=(0,em.useState)([]),[n,s]=(0,em.useState)(!1),[i,o]=(0,em.useState)("pending");(0,em.useEffect)(()=>{l()},[i]);let l=async()=>{s(!0);try{let{data:e}=await e_.api.affiliates.getAssigned({status:i});a(e.affiliates)}catch(e){eO.toast.error("Error cargando asignaciones")}finally{s(!1)}},c=async(e,n,s="")=>{try{if(a(t=>t.map(t=>t._id===e?{...t,leadStatus:n}:t)),await e_.api.affiliates.updateStatus(e,{status:n,note:s}),eO.toast.success(`Estado actualizado: ${n}`),"Venta"===n){let a=r.find(t=>t._id===e);a&&(sessionStorage.setItem("prefillAudit",JSON.stringify({nombre:a.nombre,cuil:a.cuil,telefono:a.telefono1,obraSocialAnterior:a.obraSocial,localidad:a.localidad})),t.push("/dashboard/audits/follow-up?action=create"))}else"pending"===i&&["No interesado","Fallido"].includes(n)&&setTimeout(l,500)}catch(e){eO.toast.error("Error actualizando estado"),l()}};return(0,ep.jsxs)("div",{className:"space-y-6 p-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h1",{className:(0,eg.cn)("text-2xl font-bold","dark"===e?"text-white":"text-gray-900"),children:"Contactar Afiliados"}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Gestiona tus leads asignados"})]}),(0,ep.jsxs)("div",{className:"flex bg-gray-100 dark:bg-white/5 p-1 rounded-lg",children:[(0,ep.jsx)("button",{onClick:()=>o("pending"),className:(0,eg.cn)("px-4 py-2 text-sm font-medium rounded-md transition-all","pending"===i?"bg-white dark:bg-gray-800 shadow text-purple-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400"),children:"Pendientes"}),(0,ep.jsx)("button",{onClick:()=>o("all"),className:(0,eg.cn)("px-4 py-2 text-sm font-medium rounded-md transition-all","all"===i?"bg-white dark:bg-gray-800 shadow text-purple-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400"),children:"Todos"})]})]}),n?(0,ep.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Cargando asignaciones..."}):0===r.length?(0,ep.jsxs)("div",{className:"text-center py-12 text-gray-500 bg-gray-50 dark:bg-white/5 rounded-xl border border-dashed border-gray-200 dark:border-white/10",children:[(0,ep.jsx)("p",{className:"text-lg font-medium",children:"No tienes leads asignados"}),(0,ep.jsx)("p",{className:"text-sm",children:"Solicita nuevos leads a tu supervisor"})]}):(0,ep.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(t=>(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-xl border p-5 transition-all hover:shadow-lg","dark"===e?"bg-[#1a1333] border-white/10 hover:border-purple-500/50":"bg-white border-gray-200 hover:border-purple-200"),children:[(0,ep.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,ep.jsxs)("div",{children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("font-bold text-lg","dark"===e?"text-white":"text-gray-900"),children:t.nombre}),(0,ep.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs px-2 py-0.5 rounded-full border","dark"===e?"border-white/10 bg-white/5 text-gray-300":"border-gray-200 bg-gray-50 text-gray-600"),children:t.cuil}),(0,ep.jsx)("span",{className:(0,eg.cn)("text-xs font-medium px-2 py-0.5 rounded-full","Pendiente"===t.leadStatus?"bg-yellow-100 text-yellow-800":"Asignado"===t.leadStatus?"bg-blue-100 text-blue-800":"No contesta"===t.leadStatus?"bg-orange-100 text-orange-800":"Venta"===t.leadStatus?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.leadStatus})]})]})}),(0,ep.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,ep.jsx)(MM.Phone,{className:"w-4 h-4 text-gray-400"}),(0,ep.jsx)("a",{href:`tel:${t.telefono1}`,className:"hover:underline text-purple-600 font-medium",children:t.telefono1})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,ep.jsx)(In,{className:"w-4 h-4 text-gray-400"}),(0,ep.jsx)("span",{className:"dark"===e?"text-gray-300":"text-gray-700",children:t.obraSocial})]}),(0,ep.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,ep.jsx)(Ia,{className:"w-4 h-4 text-gray-400"}),(0,ep.jsx)("span",{className:"dark"===e?"text-gray-300":"text-gray-700",children:t.localidad})]})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,ep.jsxs)("button",{onClick:()=>c(t._id,"Venta"),className:"col-span-2 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",children:[(0,ep.jsx)(ou.CheckCircle,{className:"w-4 h-4"}),"Venta Exitosa"]}),(0,ep.jsxs)("button",{onClick:()=>c(t._id,"No contesta"),className:(0,eg.cn)("py-2 rounded-lg text-sm font-medium border transition-colors flex items-center justify-center gap-2","dark"===e?"border-orange-500/30 text-orange-400 hover:bg-orange-500/10":"border-orange-200 text-orange-700 hover:bg-orange-50"),children:[(0,ep.jsx)(eV.Clock,{className:"w-4 h-4"}),"No contesta"]}),(0,ep.jsxs)("button",{onClick:()=>c(t._id,"No interesado"),className:(0,eg.cn)("py-2 rounded-lg text-sm font-medium border transition-colors flex items-center justify-center gap-2","dark"===e?"border-red-500/30 text-red-400 hover:bg-red-500/10":"border-red-200 text-red-700 hover:bg-red-50"),children:[(0,ep.jsx)(of.XCircle,{className:"w-4 h-4"}),"No interesado"]})]})]},t._id))})]})}let Ii=e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`};function Io(){let{theme:e}=(0,ex.useTheme)(),{user:t}=(0,i4.useAuth)(),[r,a]=(0,em.useState)([]),[n,s]=(0,em.useState)(!1),[i,o]=(0,em.useState)(!0),[l,c]=(0,em.useState)(1),[d,u]=(0,em.useState)(1),[h,f]=(0,em.useState)({}),[p,m]=(0,em.useState)(!1),[g,x]=(0,em.useState)(""),[b,y]=(0,em.useState)({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),[v,w]=(0,em.useState)(!1),[k,j]=(0,em.useState)(!1),[N,S]=(0,em.useState)([]),[E,C]=(0,em.useState)([]),T=(0,em.useRef)(null),A=(0,em.useRef)(null);(0,em.useEffect)(()=>{_(),O()},[]),(0,em.useEffect)(()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&w(!1),A.current&&!A.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let _=async()=>{try{let e=await e_.api.users.list(),t=Array.isArray(e.data)?e.data:[],r=t.filter(e=>!1!==e.active&&("asesor"===e.role||"Asesor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));S(r);let a=t.filter(e=>!1!==e.active&&("supervisor"===e.role||"Supervisor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));C(a)}catch(e){console.error("Error loading filter options:",e)}},O=async()=>{try{s(!0);let{data:e}=await e_.api.affiliates.getFailed({page:l,limit:100}),t=e.affiliates||[];e.stats&&f(e.stats),b.asesor&&(t=t.filter(e=>e.assignedTo?.nombre?.toLowerCase().includes(b.asesor.toLowerCase()))),b.supervisor&&(t=t.filter(e=>e.supervisor?.toLowerCase().includes(b.supervisor.toLowerCase()))),b.cuil&&(t=t.filter(e=>e.cuil.includes(b.cuil))),a(t),u(e.pages)}catch(e){console.error(e),eO.toast.error("Error al cargar afiliaciones fallidas")}finally{s(!1)}},P=(e,t)=>{y(r=>({...r,[e]:t}))};return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,ep.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,ep.jsxs)("div",{children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,ep.jsx)("span",{className:"p-2 rounded-lg bg-red-500/20 text-red-500",children:(0,ep.jsx)(eZ,{className:"w-6 h-6"})}),"Afiliaciones Fallidas"]}),(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:"Listado de ventas cadas, rechazadas y leads fallidos"})]}),(0,ep.jsx)("div",{className:"flex gap-2",children:(0,ep.jsxs)("button",{onClick:()=>{if(!r.length)return void eO.toast.info("No hay datos para exportar");let e=mA(r.map(e=>({Fecha:Ii(e.lastInteraction),Nombre:e.nombre,CUIL:e.cuil,Telfono:e.telefono,Estado:e.leadStatus,Motivo:e.motivo,Asesor:e.assignedTo?.nombre||"-",Supervisor:e.supervisor||"-",Origen:"audit"===e.source?"Auditora":"Base de Datos"}))),t=m_();mO(t,e,"Afiliaciones Fallidas"),mj(t,`afiliaciones_fallidas_${new Date().toISOString().slice(0,10)}.xlsx`)},className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,ep.jsx)(i0.Download,{className:"w-4 h-4"}),"Exportar"]})})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 transition-all duration-300","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(ow.Filter,{className:(0,eg.cn)("w-4 h-4","dark"===e?"text-purple-400":"text-purple-600")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("font-medium","dark"===e?"text-gray-200":"text-gray-700"),children:"Filtros"})]}),(0,ep.jsx)("button",{onClick:()=>o(!i),className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-gray-100"),children:i?(0,ep.jsx)(oj,{className:"w-4 h-4"}):(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4"})})]}),i&&(0,ep.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,ep.jsxs)("div",{className:"relative",ref:T,children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Asesor"}),(0,ep.jsxs)("div",{onClick:()=>w(!v),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,ep.jsx)("span",{className:"truncate",children:b.asesor||"Todos los asesores"}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),v&&(0,ep.jsxs)("div",{className:(0,eg.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,ep.jsx)("div",{onClick:()=>{P("asesor",""),w(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los asesores"}),N.map(t=>(0,ep.jsx)("div",{onClick:()=>{P("asesor",t.nombre),w(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",b.asesor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,ep.jsxs)("div",{className:"relative",ref:A,children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Supervisor"}),(0,ep.jsxs)("div",{onClick:()=>j(!k),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,ep.jsx)("span",{className:"truncate",children:b.supervisor||"Todos los supervisores"}),(0,ep.jsx)(ok.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),k&&(0,ep.jsxs)("div",{className:(0,eg.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,ep.jsx)("div",{onClick:()=>{P("supervisor",""),j(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los supervisores"}),E.map(t=>(0,ep.jsx)("div",{onClick:()=>{P("supervisor",t.nombre),j(!1)},className:(0,eg.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",b.supervisor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,ep.jsxs)("div",{children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"CUIL"}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("input",{type:"text",value:b.cuil,onChange:e=>P("cuil",e.target.value),placeholder:"Buscar por CUIL...",className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border pl-9 transition-all outline-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-purple-300")}),(0,ep.jsx)(ox.Search,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Desde"}),(0,ep.jsx)("input",{type:"date",value:b.dateFrom,onChange:e=>P("dateFrom",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]}),(0,ep.jsxs)("div",{className:"flex-1",children:[(0,ep.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Hasta"}),(0,ep.jsx)("input",{type:"date",value:b.dateTo,onChange:e=>P("dateTo",e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]})]})]}),(0,ep.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,ep.jsx)("button",{onClick:()=>{y({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),O()},className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-colors","dark"===e?"text-gray-400 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:"Limpiar filtros"}),(0,ep.jsx)("button",{onClick:O,className:(0,eg.cn)("px-4 py-2 rounded-xl text-sm font-medium text-white shadow-lg shadow-purple-500/20 transition-all hover:scale-105 active:scale-95","bg-gradient-to-r from-purple-600 to-blue-600"),children:"Aplicar filtros"})]})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full",children:[(0,ep.jsx)("thead",{children:(0,ep.jsxs)("tr",{className:(0,eg.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,ep.jsx)("th",{className:"px-4 py-3",children:"Fecha"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"Afiliado"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"Telfono"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"Estado"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"Motivo"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"Asesor"}),(0,ep.jsx)("th",{className:"px-4 py-3",children:"Supervisor"})]})}),(0,ep.jsx)("tbody",{className:(0,eg.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:n?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:8,className:"px-4 py-3 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-5 h-5 animate-spin text-purple-500"}),(0,ep.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===r.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:8,className:"px-4 py-6 text-center text-gray-500",children:"No se encontraron afiliaciones fallidas"})}):r.map(t=>{var r;let a;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:Ii(t.lastInteraction)}),(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap font-medium text-xs",children:t.nombre.toUpperCase()}),(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:t.cuil||"-"}),(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:t.telefono||"-"}),(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded-md text-xs font-medium",(r=t.leadStatus,(a=r?.toLowerCase()||"").includes("fallido")||a.includes("rechazada")||a.includes("cada")?"dark"===e?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":a.includes("interesado")?"dark"===e?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800":a.includes("cort")?"dark"===e?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800":"dark"===e?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800")),children:t.leadStatus})}),(0,ep.jsx)("td",{className:"px-4 py-3",children:t.motivo&&"-"!==t.motivo?(0,ep.jsxs)("button",{onClick:()=>{x((e=>{if(!e||"-"===e)return"-";let t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)})(t.motivo)),m(!0)},className:(0,eg.cn)("flex items-center gap-1 px-2 py-0.5 rounded-md text-xs font-medium transition-colors","dark"===e?"bg-purple-500/20 text-purple-300 hover:bg-purple-500/30":"bg-purple-100 text-purple-700 hover:bg-purple-200"),children:[(0,ep.jsx)(ez.Eye,{className:"w-3 h-3"}),"Ver"]}):(0,ep.jsx)("span",{className:"text-gray-400 text-xs",children:"-"})}),(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:t.assignedTo?.nombre||"-"}),(0,ep.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded-md text-xs font-medium",((e,t)=>{let r=(e||"").toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";if(r.includes("belen")&&r.includes("salaverry"))return"dark"===t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800";if(r.includes("analia")&&r.includes("suarez"))return"dark"===t?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800";if(r.includes("erika")&&r.includes("cardozo"))return"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800";if(r.includes("aryel")&&r.includes("puiggros"))return"dark"===t?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800";if(r.includes("joaquin")&&r.includes("valdez")||r.includes("joquin")&&r.includes("vald ez"))return"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800";if(r.includes("luciano")&&r.includes("carugno"))return"dark"===t?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800";if(r.includes("alejandro")&&r.includes("mejail"))return"dark"===t?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800";if(r.includes("gaston")&&r.includes("sarmiento"))return"dark"===t?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-900 text-rose-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-900 text-indigo-200"}],n=e.length%a.length;return"dark"===t?a[n].dark:a[n].light})(t.supervisor||"",e)),children:t.supervisor||"-"})})]},t._id)})})]})})}),p&&(0,ov.createPortal)((0,ep.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-in fade-in duration-200",onClick:()=>m(!1),children:(0,ep.jsxs)("div",{onClick:e=>e.stopPropagation(),className:(0,eg.cn)("animate-in zoom-in-95 fade-in duration-200","relative max-w-lg w-full rounded-2xl shadow-2xl border p-6","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ep.jsx)("h3",{className:(0,eg.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Motivo del Estado"}),(0,ep.jsx)("button",{onClick:()=>m(!1),className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400 hover:text-white":"hover:bg-gray-100 text-gray-500 hover:text-gray-700"),children:(0,ep.jsx)(eT.X,{className:"w-5 h-5"})})]}),(0,ep.jsx)("div",{className:(0,eg.cn)("p-4 rounded-lg","dark"===e?"bg-white/5":"bg-gray-50"),children:(0,ep.jsx)("p",{className:(0,eg.cn)("text-sm whitespace-pre-wrap","dark"===e?"text-gray-300":"text-gray-700"),children:g})})]})}),document.body)]})}var Il=e.i(59173),Ic=e.i(20095);let Id=(0,ek.default)("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var Iu=e.i(8554),Ih=e.i(86470);let If=e=>e?e<1024?`${e.toFixed(0)} KB`:`${(e/1024).toFixed(2)} MB`:"-",Ip={incompleta:{badge:{light:"bg-stone-100 text-stone-600",dark:"bg-stone-500/30 text-stone-300"}},en_proceso:{badge:{light:"bg-amber-100 text-amber-700",dark:"bg-amber-500/30 text-amber-300"}},terminada:{badge:{light:"bg-green-100 text-green-700",dark:"bg-green-500/30 text-green-300"}}},Im={incompleta:"Incompleta",en_proceso:"En Proceso",terminada:"Terminada"},Ig={"qr hecho":{light:"bg-green-100 text-green-700",dark:"bg-green-500/30 text-green-300"},aprobada:{light:"bg-teal-100 text-teal-700",dark:"bg-teal-500/30 text-teal-300"},pendiente:{light:"bg-stone-100 text-stone-600",dark:"bg-stone-500/30 text-stone-300"},cargada:{light:"bg-indigo-100 text-indigo-700",dark:"bg-indigo-500/30 text-indigo-300"},rechazada:{light:"bg-red-100 text-red-700",dark:"bg-red-500/30 text-red-300"},padrn:{light:"bg-amber-100 text-amber-700",dark:"bg-amber-500/30 text-amber-300"},"remuneracin no vlida":{light:"bg-red-200 text-red-800",dark:"bg-red-700/30 text-red-400"},autovinculacin:{light:"bg-pink-100 text-pink-700",dark:"bg-pink-500/30 text-pink-300"},cada:{light:"bg-rose-200 text-rose-800",dark:"bg-rose-800/40 text-rose-300"},"en revisin":{light:"bg-slate-100 text-slate-600",dark:"bg-slate-500/30 text-slate-300"},afip:{light:"bg-slate-200 text-slate-700",dark:"bg-slate-500/30 text-slate-300"},"hacer qr":{light:"bg-yellow-100 text-yellow-700",dark:"bg-yellow-500/30 text-yellow-300"},"qr hecho (temporal)":{light:"bg-lime-100 text-lime-700",dark:"bg-lime-500/30 text-lime-300"},"qr hecho pero pendiente de aprobacin":{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-500/20 text-emerald-400"},"baja laboral con nueva alta":{light:"bg-blue-100 text-blue-800",dark:"bg-blue-500/20 text-blue-400"},"baja laboral sin nueva alta":{light:"bg-slate-100 text-slate-800",dark:"bg-slate-500/20 text-slate-400"},"aprobada, pero no reconoce clave":{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},"rehacer vdeo":{light:"bg-red-300 text-red-900",dark:"bg-red-500/20 text-red-400"},"falta documentacin":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"falta clave":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"falta clave (por arca)":{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-500/20 text-indigo-400"},"falta clave y documentacin":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"el afiliado cambi la clave":{light:"bg-orange-200 text-orange-900",dark:"bg-orange-500/20 text-orange-400"},completa:{light:"bg-lime-600 text-white",dark:"bg-lime-500/30 text-lime-300"}};function Ix(){let e,t,{theme:r}=(0,ex.useTheme)(),{user:a}=(0,i4.useAuth)(),[n,s]=(0,em.useState)([]),[i,o]=(0,em.useState)(!1),[l,c]=(0,em.useState)(""),[d,u]=(0,em.useState)(""),[h,f]=(0,em.useState)(""),[p,m]=(0,em.useState)(""),[g,x]=(0,em.useState)(""),[b,y]=(0,em.useState)(""),[v,w]=(0,em.useState)(""),[k,j]=(0,em.useState)(1),[N,S]=(0,em.useState)(0),[E,C]=(0,em.useState)(1),[T,A]=(0,em.useState)(!1),[_,O]=(0,em.useState)(0),[P,D]=(0,em.useState)(null),[R,M]=(0,em.useState)(""),[I,L]=(0,em.useState)(null),[F,B]=(0,em.useState)(!1),U=(0,em.useRef)(null),z=(0,em.useRef)(null),[V,H]=(0,em.useState)(!1),[W,q]=(0,em.useState)(0),[G,K]=(0,em.useState)(null),[X,Y]=(0,em.useState)(""),Q=(0,em.useRef)(null);(0,em.useEffect)(()=>{let e=setTimeout(()=>{u(l),j(1)},400);return()=>clearTimeout(e)},[l]),(0,em.useEffect)(()=>{let e=setTimeout(()=>{m(h),j(1)},400);return()=>clearTimeout(e)},[h]),(0,em.useEffect)(()=>{j(1)},[g,b,v]),(0,em.useEffect)(()=>{if(!T)return;let e=e=>{z.current&&!z.current.contains(e.target)&&ee()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[T]),(0,em.useEffect)(()=>{if(!V)return;let e=e=>{Q.current&&!Q.current.contains(e.target)&&(H(!1),K(null),Y(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[V]);let J=(0,em.useCallback)(async()=>{try{if(o(!0),"en_proceso"===g||"terminada"===g){let e={estado:g};d.trim()&&(e.nombre=d.trim());let t=await Ih.getEvidencias(e),r=(Array.isArray(t.evidencias)?t.evidencias:[]).filter(e=>null!=e.ventaId).map(e=>{let t="object"==typeof e.ventaId?e.ventaId:null;return{ventaId:t?._id||e.ventaId,nombre:t?.nombre||"Venta desconocida",cuil:t?.cuil||"",status:t?.status||"",fecha:null,estado:e.estado,filePath:e.filePath,originalName:e.originalName,fileSizeKB:e.fileSizeKB,isLocked:e.isLocked,evidenciaId:e._id}});s(r),S(r.length),C(1),j(1)}else{let e={page:k,limit:50};d.trim()&&(e.nombre=d.trim()),p.trim()&&(e.cuil=p.trim()),b&&(e.fechaDesde=b),v&&(e.fechaHasta=v);let[t,r]=await Promise.all([Ih.getVentasElegibles(e),Ih.getEvidencias()]),a=Array.isArray(t.ventas)?t.ventas:[],n=Array.isArray(r.evidencias)?r.evidencias:[],i=new Map;n.forEach(e=>{let t="object"==typeof e.ventaId?e.ventaId._id:e.ventaId;t&&i.set(t,e)});let o=a.map(e=>{let t=i.get(e._id);return{ventaId:e._id,nombre:e.nombre,cuil:e.cuil||"",status:e.status,fecha:e.fechaCreacionQR||e.createdAt||null,estado:t?.estado||"incompleta",filePath:t?.filePath||null,originalName:t?.originalName||null,fileSizeKB:t?.fileSizeKB||null,isLocked:!!t&&t.isLocked,evidenciaId:t?._id||null}}),l="incompleta"===g?o.filter(e=>"incompleta"===e.estado):o;s(l),S(t.total||0),C(t.totalPages||1)}}catch(e){console.error(e),eO.toast.error(e.response?.data?.message||"Error al cargar datos"),s([])}finally{o(!1)}},[d,p,g,b,v,k]);(0,em.useEffect)(()=>{J()},[J]);let Z=async()=>{if(I&&P){if(!I.name.toLowerCase().endsWith(".zip"))return void eO.toast.error("Solo se permiten archivos ZIP");if(I.size>0x6400000)return void eO.toast.error("El archivo no puede superar 100 MB");try{B(!0),await Ih.uploadZip(P,I),eO.toast.success("Archivo subido correctamente"),ee(),J()}catch(e){eO.toast.error(e.response?.data?.message||"Error al subir archivo")}finally{B(!1)}}},ee=()=>{A(!1),L(null),D(null),M("")},et=async()=>{if(G)try{await Ih.markAsComplete(G),eO.toast.success("Evidencia marcada como terminada"),H(!1),K(null),Y(""),J()}catch(e){eO.toast.error(e.response?.data?.message||"Error al marcar como terminada")}},er=async(e,t)=>{try{await Ih.downloadZip(e,t||"evidencia.zip"),eO.toast.success("Descarga iniciada")}catch(e){eO.toast.error(e.response?.data?.message||"Error al descargar archivo")}},ea=e=>"QR hecho"===e.status&&"terminada"!==e.estado&&!!e.filePath;return(0,ep.jsxs)("div",{className:"space-y-6 animate-fade-in-up relative",children:[(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-6 backdrop-blur-sm relative z-20","dark"===r?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,ep.jsx)(ow.Filter,{className:(0,eg.cn)("w-5 h-5","dark"===r?"text-purple-400":"text-[#00C794]")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("font-semibold","dark"===r?"text-white":"text-gray-800"),children:"Filtros"})]}),(0,ep.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 mb-3",children:[(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por nombre",value:l,onChange:e=>c(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===r?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsx)("input",{type:"text",placeholder:"Buscar por CUIL",value:h,onChange:e=>f(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===r?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,ep.jsxs)("select",{value:g,onChange:e=>x(e.target.value),className:(0,eg.cn)("px-3 py-2 rounded-lg border text-sm","dark"===r?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,ep.jsx)("option",{value:"",children:"Todos los estados"}),(0,ep.jsx)("option",{value:"incompleta",children:"Incompleta"}),(0,ep.jsx)("option",{value:"en_proceso",children:"En Proceso"}),(0,ep.jsx)("option",{value:"terminada",children:"Terminada"})]}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("label",{className:(0,eg.cn)("absolute -top-2 left-2 text-[9px] px-1 z-10","dark"===r?"text-gray-400 bg-gray-900":"text-gray-500 bg-white"),children:"Desde"}),(0,ep.jsx)("input",{type:"date",value:b,onChange:e=>y(e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===r?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,ep.jsxs)("div",{className:"relative",children:[(0,ep.jsx)("label",{className:(0,eg.cn)("absolute -top-2 left-2 text-[9px] px-1 z-10","dark"===r?"text-gray-400 bg-gray-900":"text-gray-500 bg-white"),children:"Hasta"}),(0,ep.jsx)("input",{type:"date",value:v,onChange:e=>w(e.target.value),className:(0,eg.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===r?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,ep.jsxs)("div",{className:"flex gap-3",children:[(0,ep.jsx)("button",{onClick:()=>{c(""),f(""),x(""),y(""),w("")},className:(0,eg.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===r?"bg-white/5 hover:bg-white/10 text-white border border-white/10":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Limpiar"}),(0,ep.jsxs)("button",{onClick:J,disabled:i,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center justify-center gap-2",style:{backgroundColor:"#17C787"},children:[(0,ep.jsx)(eE.RefreshCw,{className:(0,eg.cn)("w-4 h-4",i&&"animate-spin")}),"Actualizar"]})]})]}),(N>0||n.length>0)&&(e={},n.forEach(t=>{let r=Im[t.estado]||t.estado;e[r]=(e[r]||0)+1}),t=n.filter(e=>e.isLocked).length,(0,ep.jsx)("div",{className:(0,eg.cn)("rounded-xl border p-3","dark"===r?"bg-gradient-to-r from-blue-900/20 to-indigo-900/20 border-blue-700/30":"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"),children:(0,ep.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("font-bold","dark"===r?"text-gray-200":"text-gray-800"),children:["Total: ",(0,ep.jsx)("span",{className:"dark"===r?"text-blue-400":"text-blue-600",children:N.toLocaleString()})]}),(0,ep.jsx)("span",{className:"dark"===r?"text-gray-500":"text-gray-400",children:"|"}),(0,ep.jsxs)("span",{className:(0,eg.cn)("font-medium","dark"===r?"text-gray-300":"text-gray-600"),children:["En esta pgina: ",n.length]}),Object.entries(e).sort((e,t)=>t[1]-e[1]).map(([e,t])=>(0,ep.jsxs)("span",{className:"dark"===r?"text-gray-300":"text-gray-700",children:[(0,ep.jsxs)("span",{className:"font-semibold",children:[e,":"]})," ",(0,ep.jsx)("span",{className:"dark"===r?"text-indigo-400":"text-indigo-600",children:t})]},e)),t>0&&(0,ep.jsxs)("span",{className:"dark"===r?"text-gray-300":"text-gray-700",children:[(0,ep.jsx)("span",{className:"font-semibold",children:"Bloqueadas:"})," ",(0,ep.jsx)("span",{className:"dark"===r?"text-red-400":"text-red-600",children:t})]})]})})),(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border overflow-hidden","dark"===r?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,ep.jsx)("div",{className:"overflow-x-auto",children:(0,ep.jsxs)("table",{className:"w-full text-xs",children:[(0,ep.jsx)("thead",{className:(0,eg.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===r?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,ep.jsxs)("tr",{children:[(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center min-w-[150px]",children:"Afiliado"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center w-[110px]",children:"CUIL"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center w-[90px]",children:"Fecha"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center w-[130px]",children:"Estado Venta"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center w-[110px]",children:"Evidencia"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center min-w-[150px]",children:"Archivo"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center w-[90px]",children:"Bloqueo"}),(0,ep.jsx)("th",{className:"px-2 py-2.5 text-center w-[120px]",children:"Acciones"})]})}),(0,ep.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:i?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:8,className:"px-4 py-8 text-center opacity-50",children:(0,ep.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando evidencias..."]})})}):0===n.length?(0,ep.jsx)("tr",{children:(0,ep.jsx)("td",{colSpan:8,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron evidencias"})}):n.map(e=>{var t;let a,n;return(0,ep.jsxs)("tr",{className:(0,eg.cn)("transition-colors","terminada"===e.estado?"dark"===r?"bg-green-900/20 hover:bg-green-900/30":"bg-green-50 hover:bg-green-100":"dark"===r?"hover:bg-white/5":"hover:bg-gray-50"),children:[(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2.5 text-center","dark"===r?"text-white":"text-gray-800"),children:e.nombre}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2.5 text-center font-mono","dark"===r?"text-gray-300":"text-gray-600"),children:e.cuil||"-"}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2.5 text-center","dark"===r?"text-gray-400":"text-gray-500"),children:(e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return"-"}})(e.fecha)}),(0,ep.jsx)("td",{className:"px-2 py-2.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px]",(t=e.status,(a=Ig[(t||"").toLowerCase()])?"dark"===r?a.dark:a.light:"dark"===r?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700")),title:e.status,children:e.status||"-"})}),(0,ep.jsx)("td",{className:"px-2 py-2.5 text-center",children:(0,ep.jsx)("span",{className:(0,eg.cn)("px-2 py-0.5 rounded-md text-[10px] font-medium inline-block",(n=Ip[e.estado])?"dark"===r?n.badge.dark:n.badge.light:"dark"===r?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700"),children:Im[e.estado]||e.estado})}),(0,ep.jsx)("td",{className:(0,eg.cn)("px-2 py-2.5 text-center","dark"===r?"text-gray-300":"text-gray-600"),children:e.originalName?(0,ep.jsxs)("div",{children:[(0,ep.jsx)("div",{className:"truncate max-w-[180px] mx-auto",children:e.originalName}),(0,ep.jsx)("div",{className:(0,eg.cn)("text-[10px]","dark"===r?"text-gray-500":"text-gray-400"),children:If(e.fileSizeKB)})]}):(0,ep.jsx)("span",{className:"dark"===r?"text-gray-600":"text-gray-400",children:"Sin archivo"})}),(0,ep.jsx)("td",{className:"px-2 py-2.5 text-center",children:e.isLocked?(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-1 px-2 py-0.5 rounded-md text-[10px] font-medium","dark"===r?"bg-red-500/30 text-red-300":"bg-red-100 text-red-700"),children:[(0,ep.jsx)(oh.Lock,{className:"w-3 h-3"}),"S"]}):(0,ep.jsxs)("span",{className:(0,eg.cn)("inline-flex items-center gap-1 px-2 py-0.5 rounded-md text-[10px] font-medium","dark"===r?"bg-emerald-500/20 text-emerald-400":"bg-emerald-50 text-emerald-600"),children:[(0,ep.jsx)(Id,{className:"w-3 h-3"}),"No"]})}),(0,ep.jsx)("td",{className:"px-2 py-2.5 text-center",children:(0,ep.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,ep.jsx)("button",{onClick:t=>{var r,a;return r=e.ventaId,a=e.nombre,void(O(Math.max(16,Math.min(t.currentTarget.getBoundingClientRect().top+window.scrollY,document.documentElement.scrollHeight-320-16))),D(r),M(a),L(null),A(!0))},disabled:!!e.isLocked,title:e.isLocked?"Bloqueada: venta en 'QR hecho'":"Subir/Reemplazar ZIP",className:(0,eg.cn)("p-1.5 rounded-lg transition-colors",e.isLocked?"opacity-30 cursor-not-allowed":"dark"===r?"bg-teal-500/20 hover:bg-teal-500/30 text-teal-300":"bg-teal-100 hover:bg-teal-200 text-teal-700"),children:(0,ep.jsx)(eI.Upload,{className:"w-3.5 h-3.5"})}),(0,ep.jsx)("button",{onClick:t=>{var r,a;return r=e.ventaId,a=e.nombre,void(q(Math.max(16,Math.min(t.currentTarget.getBoundingClientRect().top+window.scrollY,document.documentElement.scrollHeight-220-16))),K(r),Y(a),H(!0))},disabled:!ea(e),title:ea(e)?"Marcar Terminada":"QR hecho"!==e.status?"Solo si venta est en 'QR hecho'":e.filePath?"Ya est terminada":"Debe subir archivo ZIP primero",className:(0,eg.cn)("p-1.5 rounded-lg transition-colors",ea(e)?"dark"===r?"bg-green-500/20 hover:bg-green-500/30 text-green-300":"bg-green-100 hover:bg-green-200 text-green-700":"opacity-30 cursor-not-allowed"),children:(0,ep.jsx)(mV.CheckCircle2,{className:"w-3.5 h-3.5"})}),(0,ep.jsx)("button",{onClick:()=>er(e.ventaId,e.originalName),disabled:!e.filePath,title:e.filePath?"Descargar ZIP":"Sin archivo",className:(0,eg.cn)("p-1.5 rounded-lg transition-colors",e.filePath?"dark"===r?"bg-indigo-500/20 hover:bg-indigo-500/30 text-indigo-300":"bg-indigo-100 hover:bg-indigo-200 text-indigo-700":"opacity-30 cursor-not-allowed"),children:(0,ep.jsx)(i0.Download,{className:"w-3.5 h-3.5"})})]})})]},e.ventaId)})})]})}),E>1&&(0,ep.jsxs)("div",{className:(0,eg.cn)("flex items-center justify-between px-4 py-3 border-t","dark"===r?"border-white/10":"border-gray-200"),children:[(0,ep.jsxs)("span",{className:(0,eg.cn)("text-xs","dark"===r?"text-gray-400":"text-gray-500"),children:["Pgina ",k," de ",E," (",N.toLocaleString()," registros)"]}),(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)("button",{onClick:()=>j(e=>Math.max(1,e-1)),disabled:k<=1||i,className:(0,eg.cn)("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",k<=1||i?"opacity-40 cursor-not-allowed":"dark"===r?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Anterior"}),(0,ep.jsx)("button",{onClick:()=>j(e=>Math.min(E,e+1)),disabled:k>=E||i,className:(0,eg.cn)("px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",k>=E||i?"opacity-40 cursor-not-allowed":"text-white"),style:k<E&&!i?{backgroundColor:"#17C787"}:void 0,children:"Siguiente"})]})]})]}),T&&(0,ep.jsxs)("div",{ref:z,className:(0,eg.cn)("absolute right-4 z-50 w-[400px] rounded-2xl p-6 border-2 animate-[modalPop_0.2s_ease-out]","dark"===r?"bg-gray-900 border-teal-500/40 shadow-[0_8px_40px_rgba(0,199,148,0.15)]":"bg-white border-teal-300 shadow-[0_8px_40px_rgba(0,199,148,0.18)]"),style:{top:_},children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(eI.Upload,{className:(0,eg.cn)("w-5 h-5","dark"===r?"text-purple-400":"text-[#00C794]")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("text-base font-semibold","dark"===r?"text-white":"text-gray-800"),children:"Subir ZIP"})]}),(0,ep.jsx)("button",{onClick:ee,className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-4 h-4"})})]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mb-3","dark"===r?"text-gray-400":"text-gray-500"),children:["Venta: ",(0,ep.jsx)("span",{className:"font-medium",children:R})]}),(0,ep.jsx)("input",{ref:U,type:"file",accept:".zip",onChange:e=>L(e.target.files?.[0]||null),className:"hidden"}),(0,ep.jsxs)("button",{type:"button",onClick:()=>U.current?.click(),className:(0,eg.cn)("w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-dashed mb-3 transition-colors text-sm font-medium",I?"dark"===r?"border-emerald-500/40 bg-emerald-500/10 text-emerald-300":"border-emerald-300 bg-emerald-50 text-emerald-700":"dark"===r?"border-white/20 hover:border-white/40 bg-white/5 text-gray-300 hover:text-white":"border-gray-300 hover:border-gray-400 bg-gray-50 text-gray-600 hover:text-gray-800"),children:[(0,ep.jsx)(Iu.FileArchive,{className:"w-4 h-4"}),I?I.name:"Seleccionar archivo ZIP"]}),I&&(0,ep.jsxs)("div",{className:(0,eg.cn)("text-xs mb-3 px-3 py-2 rounded-lg","dark"===r?"bg-white/5 text-gray-300":"bg-gray-50 text-gray-600"),children:["Tamao: ",If(I.size/1024)]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsx)("button",{onClick:ee,disabled:F,className:(0,eg.cn)("flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors","dark"===r?"bg-white/5 hover:bg-white/10 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:Z,disabled:!I||F,className:(0,eg.cn)("flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center justify-center gap-2",I&&!F?"":"opacity-50 cursor-not-allowed"),style:{backgroundColor:I&&!F?"#17C787":"#9CA3AF"},children:F?(0,ep.jsxs)(ep.Fragment,{children:[(0,ep.jsx)(eE.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Subiendo..."]}):"Subir"})]})]}),V&&(0,ep.jsxs)("div",{ref:Q,className:(0,eg.cn)("absolute right-4 z-50 w-[400px] rounded-2xl p-6 border-2 animate-[modalPop_0.2s_ease-out]","dark"===r?"bg-gray-900 border-green-500/40 shadow-[0_8px_40px_rgba(34,197,94,0.15)]":"bg-white border-green-300 shadow-[0_8px_40px_rgba(34,197,94,0.18)]"),style:{top:W},children:[(0,ep.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-2",children:[(0,ep.jsx)(mV.CheckCircle2,{className:(0,eg.cn)("w-5 h-5","dark"===r?"text-green-400":"text-green-600")}),(0,ep.jsx)("h3",{className:(0,eg.cn)("text-base font-semibold","dark"===r?"text-white":"text-gray-800"),children:"Confirmar Accin"})]}),(0,ep.jsx)("button",{onClick:()=>{H(!1),K(null),Y("")},className:(0,eg.cn)("p-1 rounded-lg transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,ep.jsx)(eT.X,{className:"w-4 h-4"})})]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs mb-4","dark"===r?"text-gray-300":"text-gray-600"),children:["Confirmas que deseas marcar la evidencia de ",(0,ep.jsx)("span",{className:"font-semibold",children:X})," como ",(0,ep.jsx)("span",{className:"font-semibold text-green-600",children:"Terminada"}),"? Esta accin bloquear futuras modificaciones mientras la venta est en 'QR hecho'."]}),(0,ep.jsxs)("div",{className:"flex gap-2",children:[(0,ep.jsx)("button",{onClick:()=>{H(!1),K(null),Y("")},className:(0,eg.cn)("flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors","dark"===r?"bg-white/5 hover:bg-white/10 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Cancelar"}),(0,ep.jsx)("button",{onClick:et,className:"flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors text-white",style:{backgroundColor:"#17C787"},children:"Confirmar"})]})]})]})}let Ib={"reportes-globales":"Reportes de Mensajera","mensajeria-masiva":"Mensajera Masiva","base-afiliados":"Base de Afiliados","base-afiliados-estadistica":"Estadstica","base-afiliados-exitosas":"Afiliaciones exitosas","base-afiliados-exportaciones":"Exportaciones","base-afiliados-configuracion":"Configuracin de envos","base-afiliados-lista":"Lista de afiliados","base-afiliados-cargar":"Cargar archivo","base-afiliados-frescos":"Datos frescos","base-afiliados-reutilizables":"Datos reutilizables","base-afiliados-fallidas":"Afiliaciones fallidas","contactar-afiliados":"Contactar Afiliados","contactar-afiliados-administracion":"Administracin de datos","contactar-afiliados-datos-dia":"Datos del da","palabras-prohibidas":"Palabras Prohibidas","palabras-prohibidas-lista":"Lista de palabras","palabras-prohibidas-detecciones":"Detecciones","palabras-prohibidas-agregar":"Agregar palabra",auditorias:"Auditoras","auditorias-seguimiento":"Seguimiento","auditorias-crear-turno":"Crear turno","auditorias-liquidacion":"Liquidacin","auditorias-falta-clave":"Falta Clave","auditorias-rechazada":"Rechazada","auditorias-pendiente":"Pendiente","auditorias-afip-padron":"AFIP y Padrn","recursos-humanos":"Recursos Humanos","rrhh-estadisticas":"Estadsticas de Empleados","rrhh-bajo-rendimiento":"Bajo Rendimiento","rrhh-activos":"Personal Activo","rrhh-bajas-liquidaciones":"Bajas y Liquidaciones","rrhh-inactivos":"Personal Inactivo","rrhh-agregar":"Aadir Empleado","rrhh-telefonos":"Telfonos Corporativos",administracion:"Administracin","administracion-registro-ventas":"Registro de Ventas","administracion-evidencias":"Evidencias","gestion-usuarios":"Gestin de Usuarios"};function Iy({activeSection:e,onSectionChange:t}){let{theme:r}=(0,ex.useTheme)(),{user:a}=(0,i4.useAuth)(),n=e||"",s="reportes-globales"===n||n.startsWith("base-afiliados")||n.startsWith("palabras-prohibidas")||n.startsWith("auditorias")||n.startsWith("rrhh")||"gestion-usuarios"===n||n.startsWith("mensajeria")||n.startsWith("administracion"),i="mensajeria-masiva"===n,[o,l]=(0,em.useState)(!1),c=(0,iQ.useSocket)(),[d,u]=(0,em.useState)(0);(0,em.useEffect)(()=>{h()},[]),(0,em.useEffect)(()=>(c&&c.on("new_message",()=>{h()}),()=>{c&&c.off("new_message")}),[c]);let h=async()=>{try{let e=await e_.api.internalMessages.getUnreadCount();u(e.data.unreadCount)}catch(e){console.error("Error loading unread count",e)}};return(0,ep.jsxs)("main",{className:"flex-1 p-4 pt-20 lg:pt-8 lg:p-8 overflow-auto w-full",children:[(0,ep.jsxs)("div",{className:"mb-6 lg:mb-8",children:[(0,ep.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,ep.jsx)("div",{className:(0,eg.cn)("w-8 h-8 lg:w-10 lg:h-10 rounded-lg flex items-center justify-center","dark"===r?"bg-gradient-to-br from-purple-500/20 to-blue-500/20":"bg-gradient-to-br from-[#00C794]/20 to-[#0078A0]/20"),children:(0,ep.jsx)("span",{className:"text-xl lg:text-2xl",children:""})}),(0,ep.jsx)("h1",{className:(0,eg.cn)("text-2xl lg:text-3xl font-bold","dark"===r?"text-white":"text-gray-700"),children:"Somos equipo, somos solucin"})]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm lg:text-base","dark"===r?"text-gray-400":"text-gray-600"),children:["Bienvenido,"," ",(0,ep.jsx)("span",{className:(0,eg.cn)("font-medium","dark"===r?"text-purple-400":"text-[#00C794]"),children:a?.nombre||"Usuario"}),". Selecciona una opcin en el men lateral."]})]}),(0,ep.jsxs)("div",{className:(0,eg.cn)("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6 mb-6 lg:mb-8 transition-all duration-500 ease-out overflow-hidden",s?"max-h-0 opacity-0 mb-0 pointer-events-none":"max-h-[500px] opacity-100"),children:[(0,ep.jsx)(ey,{title:"Mensajes enviados hoy",value:165,icon:ev.Send,color:"primary",delay:1}),(0,ep.jsx)(ey,{title:"Usuarios activos",value:13,icon:ew.Users,color:"secondary",delay:2}),(0,ep.jsx)(ey,{title:"Contactos cargados",value:383,icon:ej,color:"accent",delay:3})]}),(()=>{if("reportes-globales"===e)return(0,ep.jsx)(eM,{});if(i)return(0,ep.jsx)(i6,{});if("base-afiliados-estadistica"===e)return(0,ep.jsx)(oi,{});if("base-afiliados-exitosas"===e)return(0,ep.jsx)(mR,{});if("base-afiliados-exportaciones"===e)return(0,ep.jsx)(oc,{});if("base-afiliados-configuracion"===e)return(0,ep.jsx)(og,{});if("base-afiliados-lista"===e)return(0,ep.jsx)(ob,{});if("base-afiliados-cargar"===e)return(0,ep.jsx)(oy,{});if("base-afiliados-frescos"===e)return(0,ep.jsx)(It,{});if("base-afiliados-reutilizables"===e)return(0,ep.jsx)(Ir,{});if("base-afiliados-fallidas"===e)return(0,ep.jsx)(Io,{});if("contactar-afiliados"===e)return(0,ep.jsx)(Is,{});if("contactar-afiliados-administracion"===e){let e=a?.role?.toLowerCase();return"supervisor"!==e&&"gerencia"!==e&&"supervisor_reventa"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para supervisores."})]}):(0,ep.jsx)(Il.ContactarAdministracion,{})}if("contactar-afiliados-datos-dia"===e){let e=a?.role?.toLowerCase(),t=!!a?.numeroEquipo;return"asesor"===e||"gerencia"===e||"supervisor"===e||"auditor"===e&&t?(0,ep.jsx)(Ic.ContactarDatosDia,{}):(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"No tienes permisos para acceder a esta seccin."})]})}if("palabras-prohibidas-lista"===e)return(0,ep.jsx)(mz,{});if("palabras-prohibidas-detecciones"===e)return(0,ep.jsx)(mH,{});if("palabras-prohibidas-agregar"===e)return(0,ep.jsx)(mK,{});if("auditorias-seguimiento"===e)return(0,ep.jsx)(m7,{});if("auditorias-crear-turno"===e)return(0,ep.jsx)(gr,{});if("auditorias-liquidacion"===e)return(0,ep.jsx)(gi,{});if("auditorias-falta-clave"===e){let e=a?.role?.toLowerCase();return"gerencia"!==e&&"recuperador"!==e&&"encargado"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia, Recuperadores y Encargados."})]}):(0,ep.jsx)(gh,{})}if("auditorias-rechazada"===e){let e=a?.role?.toLowerCase();return"gerencia"!==e&&"recuperador"!==e&&"encargado"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia, Recuperadores y Encargados."})]}):(0,ep.jsx)(gf,{})}if("auditorias-pendiente"===e){let e=a?.role?.toLowerCase();return"gerencia"!==e&&"recuperador"!==e&&"encargado"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia, Recuperadores y Encargados."})]}):(0,ep.jsx)(gp,{})}if("auditorias-afip-padron"===e){let e=a?.role?.toLowerCase();return"gerencia"!==e&&"recuperador"!==e&&"encargado"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia, Recuperadores y Encargados."})]}):(0,ep.jsx)(gm,{})}if("rrhh-estadisticas"===e)return(0,ep.jsx)(Mu,{});if("rrhh-bajo-rendimiento"===e)return"gerencia"!==a?.role?.toLowerCase()?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia."})]}):(0,ep.jsx)(Mb,{});if("rrhh-activos"===e)return(0,ep.jsx)(ME,{});if("rrhh-bajas-liquidaciones"===e)return"gerencia"!==a?.role?.toLowerCase()?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia."})]}):(0,ep.jsx)(Mq,{});if("rrhh-inactivos"===e)return(0,ep.jsx)(M_,{});if("rrhh-agregar"===e)return(0,ep.jsx)(MR,{});if("rrhh-telefonos"===e){let e=a?.role?.toLowerCase();return"supervisor"!==e&&"gerencia"!==e&&"encargado"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Supervisores, Gerencia y Encargados."})]}):(0,ep.jsx)(MB,{})}if("gestion-usuarios"===e)return(0,ep.jsx)(MJ,{});if("administracion-registro-ventas"===e){let e=a?.role?.toLowerCase();return"gerencia"!==e&&"administrativo"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia y Administrativos."})]}):(0,ep.jsx)(Ie,{})}if("administracion-evidencias"===e){let e=a?.role?.toLowerCase();return"gerencia"!==e&&"administrativo"!==e?(0,ep.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-center",children:[(0,ep.jsx)("p",{className:"text-red-500 text-lg font-semibold",children:" Acceso Denegado"}),(0,ep.jsx)("p",{className:"text-gray-500 mt-2",children:"Esta seccin es exclusiva para Gerencia y Administrativos."})]}):(0,ep.jsx)(Ix,{})}return n.startsWith("base-afiliados")?(0,ep.jsx)("div",{className:"animate-fade-in-up",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===r?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-[#F5F0E8] to-white border-[#00C794]/20 shadow-lg shadow-[#00C794]/10"),children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold mb-4 flex items-center gap-2","dark"===r?"text-white":"text-gray-700"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("w-2 h-2 rounded-full animate-pulse","dark"===r?"bg-purple-500":"bg-[#00C794]")}),Ib[e]||"Base de Afiliados"]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-xs lg:text-sm leading-relaxed","dark"===r?"text-gray-400":"text-gray-600"),children:["Ests viendo la seccin de"," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===r?"text-purple-400":"text-[#00C794]"),children:Ib[e]}),". Prximamente disponible."]})]})}):(0,ep.jsx)("div",{className:"animate-fade-in-up",children:(0,ep.jsxs)("div",{className:(0,eg.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===r?"bg-gradient-to-br from-white/5 to-transparent border border-white/5 hover:border-purple-500/30 hover:shadow-purple-500/10":"bg-gradient-to-br from-[#F5F0E8] to-white border border-[#00C794]/20 hover:border-[#00C794]/50 hover:shadow-[#00C794]/20"),children:[(0,ep.jsxs)("h2",{className:(0,eg.cn)("text-lg lg:text-xl font-semibold mb-4 flex items-center gap-2","dark"===r?"text-white":"text-gray-700"),children:[(0,ep.jsx)("span",{className:(0,eg.cn)("w-2 h-2 rounded-full animate-pulse","dark"===r?"bg-purple-500":"bg-[#00C794]")}),Ib[e]||"Somos equipo, somos solucin"]}),(0,ep.jsxs)("p",{className:(0,eg.cn)("text-sm lg:text-base","dark"===r?"text-gray-400":"text-gray-600"),children:["Ests viendo la seccin de"," ",(0,ep.jsx)("span",{className:(0,eg.cn)("dark"===r?"text-purple-400":"text-[#00C794]"),children:Ib[e]}),". Aqu podrs gestionar todas las funcionalidades relacionadas con esta rea."]}),(0,ep.jsx)("div",{className:"mt-4 lg:mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4",children:[1,2,3,4].map(e=>(0,ep.jsx)("div",{className:(0,eg.cn)("h-24 lg:h-32 rounded-xl flex items-center justify-center group transition-all duration-300 hover:shadow-lg","dark"===r?"bg-gradient-to-br from-white/5 to-transparent border border-white/5 hover:border-purple-500/30 hover:shadow-purple-500/10":"bg-gradient-to-br from-[#F5F0E8] to-white border border-[#00C794]/20 hover:border-[#00C794]/50 hover:shadow-[#00C794]/20"),children:(0,ep.jsxs)("span",{className:(0,eg.cn)("text-sm transition-colors","dark"===r?"text-gray-600 group-hover:text-gray-400":"text-gray-400 group-hover:text-[#00C794]"),children:["Contenido ",e]})},e))})]})})})(),(0,ep.jsxs)("button",{onClick:()=>l(!0),className:(0,eg.cn)("fixed bottom-6 right-6 lg:bottom-10 lg:right-10 w-12 h-12 lg:w-14 lg:h-14 rounded-full text-white shadow-lg flex items-center justify-center hover:scale-110 transition-transform duration-300 animate-float z-[100]","dark"===r?"bg-gradient-to-br from-purple-600 to-blue-600 shadow-purple-500/30":"bg-gradient-to-br from-[#00C794] to-[#0078A0] shadow-[#00C794]/30"),children:[(0,ep.jsx)(eN.Mail,{className:"w-5 h-5 lg:w-6 lg:h-6"}),d>0&&(0,ep.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-sm ring-2 ring-white dark:ring-gray-900 animate-bounce",children:d>99?"99+":d})]}),(0,ep.jsx)(or,{isOpen:o,onClose:()=>{l(!1),h()}})]})}e.s(["DashboardContent",()=>Iy],55387)}]);