(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96877,e=>{e.v({cardAccentLight:"stats-card-module__J8wmDG__cardAccentLight",cardPrimaryLight:"stats-card-module__J8wmDG__cardPrimaryLight",cardSecondaryLight:"stats-card-module__J8wmDG__cardSecondaryLight",glowAccentLight:"stats-card-module__J8wmDG__glowAccentLight",glowPrimaryLight:"stats-card-module__J8wmDG__glowPrimaryLight",glowSecondaryLight:"stats-card-module__J8wmDG__glowSecondaryLight",iconAccentLight:"stats-card-module__J8wmDG__iconAccentLight",iconPrimaryLight:"stats-card-module__J8wmDG__iconPrimaryLight",iconSecondaryLight:"stats-card-module__J8wmDG__iconSecondaryLight",progressAccentLight:"stats-card-module__J8wmDG__progressAccentLight",progressPrimaryLight:"stats-card-module__J8wmDG__progressPrimaryLight",progressSecondaryLight:"stats-card-module__J8wmDG__progressSecondaryLight",textAccentLight:"stats-card-module__J8wmDG__textAccentLight",textPrimaryLight:"stats-card-module__J8wmDG__textPrimaryLight",textSecondaryLight:"stats-card-module__J8wmDG__textSecondaryLight"})},36657,(e,t,r)=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},80807,(e,t,r)=>{"use strict";var a=e.r(36657);function s(){}function n(){}n.resetWarningCache=s,t.exports=function(){function e(e,t,r,s,n,i){if(i!==a){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:n,resetWarningCache:s};return r.PropTypes=r,r}},46502,(e,t,r)=>{t.exports=e.r(80807)()},93619,(e,t,r)=>{t.exports={L:1,M:0,Q:3,H:2}},51736,(e,t,r)=>{t.exports={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}},89380,(e,t,r)=>{var a=e.r(51736);function s(e){this.mode=a.MODE_8BIT_BYTE,this.data=e}s.prototype={getLength:function(e){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++)e.put(this.data.charCodeAt(t),8)}},t.exports=s},69244,(e,t,r)=>{var a=e.r(93619);function s(e,t){this.totalCount=e,this.dataCount=t}s.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],s.getRSBlocks=function(e,t){var r=s.getRsBlockTable(e,t);if(void 0==r)throw Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var a=r.length/3,n=[],i=0;i<a;i++)for(var o=r[3*i+0],l=r[3*i+1],c=r[3*i+2],d=0;d<o;d++)n.push(new s(l,c));return n},s.getRsBlockTable=function(e,t){switch(t){case a.L:return s.RS_BLOCK_TABLE[(e-1)*4+0];case a.M:return s.RS_BLOCK_TABLE[(e-1)*4+1];case a.Q:return s.RS_BLOCK_TABLE[(e-1)*4+2];case a.H:return s.RS_BLOCK_TABLE[(e-1)*4+3];default:return}},t.exports=s},72900,(e,t,r)=>{function a(){this.buffer=[],this.length=0}a.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},t.exports=a},15762,(e,t,r)=>{for(var a={glog:function(e){if(e<1)throw Error("glog("+e+")");return a.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return a.EXP_TABLE[e]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},s=0;s<8;s++)a.EXP_TABLE[s]=1<<s;for(var s=8;s<256;s++)a.EXP_TABLE[s]=a.EXP_TABLE[s-4]^a.EXP_TABLE[s-5]^a.EXP_TABLE[s-6]^a.EXP_TABLE[s-8];for(var s=0;s<255;s++)a.LOG_TABLE[a.EXP_TABLE[s]]=s;t.exports=a},97992,(e,t,r)=>{var a=e.r(15762);function s(e,t){if(void 0==e.length)throw Error(e.length+"/"+t);for(var r=0;r<e.length&&0==e[r];)r++;this.num=Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}s.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var n=0;n<e.getLength();n++)t[r+n]^=a.gexp(a.glog(this.get(r))+a.glog(e.get(n)));return new s(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=a.glog(this.get(0))-a.glog(e.get(0)),r=Array(this.getLength()),n=0;n<this.getLength();n++)r[n]=this.get(n);for(var n=0;n<e.getLength();n++)r[n]^=a.gexp(a.glog(e.get(n))+t);return new s(r,0).mod(e)}},t.exports=s},37287,(e,t,r)=>{var a=e.r(51736),s=e.r(97992),n=e.r(15762),i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;i.getBCHDigit(t)-i.getBCHDigit(i.G15)>=0;)t^=i.G15<<i.getBCHDigit(t)-i.getBCHDigit(i.G15);return(e<<10|t)^i.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;i.getBCHDigit(t)-i.getBCHDigit(i.G18)>=0;)t^=i.G18<<i.getBCHDigit(t)-i.getBCHDigit(i.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return i.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case 0:return(t+r)%2==0;case 1:return t%2==0;case 2:return r%3==0;case 3:return(t+r)%3==0;case 4:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case 5:return t*r%2+t*r%3==0;case 6:return(t*r%2+t*r%3)%2==0;case 7:return(t*r%3+(t+r)%2)%2==0;default:throw Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new s([1],0),r=0;r<e;r++)t=t.multiply(new s([1,n.gexp(r)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case a.MODE_NUMBER:return 10;case a.MODE_ALPHA_NUM:return 9;case a.MODE_8BIT_BYTE:case a.MODE_KANJI:return 8;default:throw Error("mode:"+e)}if(t<27)switch(e){case a.MODE_NUMBER:return 12;case a.MODE_ALPHA_NUM:return 11;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 10;default:throw Error("mode:"+e)}if(t<41)switch(e){case a.MODE_NUMBER:return 14;case a.MODE_ALPHA_NUM:return 13;case a.MODE_8BIT_BYTE:return 16;case a.MODE_KANJI:return 12;default:throw Error("mode:"+e)}throw Error("type:"+t)},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0;a<t;a++)for(var s=0;s<t;s++){for(var n=0,i=e.isDark(a,s),o=-1;o<=1;o++)if(!(a+o<0)&&!(t<=a+o))for(var l=-1;l<=1;l++)!(s+l<0)&&!(t<=s+l)&&(0!=o||0!=l)&&i==e.isDark(a+o,s+l)&&n++;n>5&&(r+=3+n-5)}for(var a=0;a<t-1;a++)for(var s=0;s<t-1;s++){var c=0;e.isDark(a,s)&&c++,e.isDark(a+1,s)&&c++,e.isDark(a,s+1)&&c++,e.isDark(a+1,s+1)&&c++,(0==c||4==c)&&(r+=3)}for(var a=0;a<t;a++)for(var s=0;s<t-6;s++)e.isDark(a,s)&&!e.isDark(a,s+1)&&e.isDark(a,s+2)&&e.isDark(a,s+3)&&e.isDark(a,s+4)&&!e.isDark(a,s+5)&&e.isDark(a,s+6)&&(r+=40);for(var s=0;s<t;s++)for(var a=0;a<t-6;a++)e.isDark(a,s)&&!e.isDark(a+1,s)&&e.isDark(a+2,s)&&e.isDark(a+3,s)&&e.isDark(a+4,s)&&!e.isDark(a+5,s)&&e.isDark(a+6,s)&&(r+=40);for(var d=0,s=0;s<t;s++)for(var a=0;a<t;a++)e.isDark(a,s)&&d++;return r+10*(Math.abs(100*d/t/t-50)/5)}};t.exports=i},15877,(e,t,r)=>{var a=e.r(89380),s=e.r(69244),n=e.r(72900),i=e.r(37287),o=e.r(97992);function l(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var c=l.prototype;c.addData=function(e){var t=new a(e);this.dataList.push(t),this.dataCache=null},c.isDark=function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw Error(e+","+t);return this.modules[e][t]},c.getModuleCount=function(){return this.moduleCount},c.make=function(){if(this.typeNumber<1){var e=1;for(e=1;e<40;e++){for(var t=s.getRSBlocks(e,this.errorCorrectLevel),r=new n,a=0,o=0;o<t.length;o++)a+=t[o].dataCount;for(var o=0;o<this.dataList.length;o++){var l=this.dataList[o];r.put(l.mode,4),r.put(l.getLength(),i.getLengthInBits(l.mode,e)),l.write(r)}if(r.getLengthInBits()<=8*a)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())},c.makeImpl=function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[r][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},c.setupPositionProbePattern=function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1)&&!(this.moduleCount<=e+r))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(0<=r&&r<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=a&&a<=4?this.modules[e+r][t+a]=!0:this.modules[e+r][t+a]=!1)},c.getBestMaskPattern=function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var a=i.getLostPoint(this);(0==r||e>a)&&(e=a,t=r)}return t},c.createMovieClip=function(e,t,r){var a=e.createEmptyMovieClip(t,r);this.make();for(var s=0;s<this.modules.length;s++)for(var n=+s,i=0;i<this.modules[s].length;i++){var o=+i;this.modules[s][i]&&(a.beginFill(0,100),a.moveTo(o,n),a.lineTo(o+1,n),a.lineTo(o+1,n+1),a.lineTo(o,n+1),a.endFill())}return a},c.setupTimingPattern=function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},c.setupPositionAdjustPattern=function(){for(var e=i.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var a=e[t],s=e[r];if(null==this.modules[a][s])for(var n=-2;n<=2;n++)for(var o=-2;o<=2;o++)-2==n||2==n||-2==o||2==o||0==n&&0==o?this.modules[a+n][s+o]=!0:this.modules[a+n][s+o]=!1}},c.setupTypeNumber=function(e){for(var t=i.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var a=!e&&(t>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=a}for(var r=0;r<18;r++){var a=!e&&(t>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=a}},c.setupTypeInfo=function(e,t){for(var r=this.errorCorrectLevel<<3|t,a=i.getBCHTypeInfo(r),s=0;s<15;s++){var n=!e&&(a>>s&1)==1;s<6?this.modules[s][8]=n:s<8?this.modules[s+1][8]=n:this.modules[this.moduleCount-15+s][8]=n}for(var s=0;s<15;s++){var n=!e&&(a>>s&1)==1;s<8?this.modules[8][this.moduleCount-s-1]=n:s<9?this.modules[8][15-s-1+1]=n:this.modules[8][15-s-1]=n}this.modules[this.moduleCount-8][8]=!e},c.mapData=function(e,t){for(var r=-1,a=this.moduleCount-1,s=7,n=0,o=this.moduleCount-1;o>0;o-=2)for(6==o&&o--;;){for(var l=0;l<2;l++)if(null==this.modules[a][o-l]){var c=!1;n<e.length&&(c=(e[n]>>>s&1)==1),i.getMask(t,a,o-l)&&(c=!c),this.modules[a][o-l]=c,-1==--s&&(n++,s=7)}if((a+=r)<0||this.moduleCount<=a){a-=r,r=-r;break}}},l.PAD0=236,l.PAD1=17,l.createData=function(e,t,r){for(var a=s.getRSBlocks(e,t),o=new n,c=0;c<r.length;c++){var d=r[c];o.put(d.mode,4),o.put(d.getLength(),i.getLengthInBits(d.mode,e)),d.write(o)}for(var h=0,c=0;c<a.length;c++)h+=a[c].dataCount;if(o.getLengthInBits()>8*h)throw Error("code length overflow. ("+o.getLengthInBits()+">"+8*h+")");for(o.getLengthInBits()+4<=8*h&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*h)&&(o.put(l.PAD0,8),!(o.getLengthInBits()>=8*h));){;o.put(l.PAD1,8)}return l.createBytes(o,a)},l.createBytes=function(e,t){for(var r=0,a=0,s=0,n=Array(t.length),l=Array(t.length),c=0;c<t.length;c++){var d=t[c].dataCount,h=t[c].totalCount-d;a=Math.max(a,d),s=Math.max(s,h),n[c]=Array(d);for(var u=0;u<n[c].length;u++)n[c][u]=255&e.buffer[u+r];r+=d;var m=i.getErrorCorrectPolynomial(h),p=new o(n[c],m.getLength()-1).mod(m);l[c]=Array(m.getLength()-1);for(var u=0;u<l[c].length;u++){var f=u+p.getLength()-l[c].length;l[c][u]=f>=0?p.get(f):0}}for(var g=0,u=0;u<t.length;u++)g+=t[u].totalCount;for(var x=Array(g),b=0,u=0;u<a;u++)for(var c=0;c<t.length;c++)u<n[c].length&&(x[b++]=n[c][u]);for(var u=0;u<s;u++)for(var c=0;c<t.length;c++)u<l[c].length&&(x[b++]=l[c][u]);return x},t.exports=l},85458,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},s=o(e.r(46502)),n=e.r(91447),i=o(n);function o(e){return e&&e.__esModule?e:{default:e}}var l={bgColor:s.default.oneOfType([s.default.object,s.default.string]).isRequired,bgD:s.default.string.isRequired,fgColor:s.default.oneOfType([s.default.object,s.default.string]).isRequired,fgD:s.default.string.isRequired,size:s.default.number.isRequired,title:s.default.string,viewBoxSize:s.default.number.isRequired,xmlns:s.default.string},c=(0,n.forwardRef)(function(e,t){var r=e.bgColor,s=e.bgD,n=e.fgD,o=e.fgColor,l=e.size,c=e.title,d=e.viewBoxSize,h=e.xmlns,u=function(e,t){var r={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}(e,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",a({},u,{height:l,ref:t,viewBox:"0 0 "+d+" "+d,width:l,xmlns:void 0===h?"http://www.w3.org/2000/svg":h}),c?i.default.createElement("title",null,c):null,i.default.createElement("path",{d:s,fill:r}),i.default.createElement("path",{d:n,fill:o}))});c.displayName="QRCodeSvg",c.propTypes=l,r.default=c},10504,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QRCode=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},s=d(e.r(46502)),n=d(e.r(93619)),i=d(e.r(15877)),o=e.r(91447),l=d(o),c=d(e.r(85458));function d(e){return e&&e.__esModule?e:{default:e}}var h={bgColor:s.default.oneOfType([s.default.object,s.default.string]),fgColor:s.default.oneOfType([s.default.object,s.default.string]),level:s.default.string,size:s.default.number,value:s.default.string.isRequired},u=(0,o.forwardRef)(function(e,t){var r=e.bgColor,s=e.fgColor,o=e.level,d=e.size,h=e.value,u=function(e,t){var r={};for(var a in e)!(t.indexOf(a)>=0)&&Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a]);return r}(e,["bgColor","fgColor","level","size","value"]),m=new i.default(-1,n.default[void 0===o?"L":o]);m.addData(h),m.make();var p=m.modules;return l.default.createElement(c.default,a({},u,{bgColor:void 0===r?"#FFFFFF":r,bgD:p.map(function(e,t){return e.map(function(e,r){return e?"":"M "+r+" "+t+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:void 0===s?"#000000":s,fgD:p.map(function(e,t){return e.map(function(e,r){return e?"M "+r+" "+t+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:t,size:void 0===d?256:d,viewBoxSize:p.length}))});r.QRCode=u,u.displayName="QRCode",u.propTypes=h,r.default=u},55387,e=>{"use strict";let t,r,a,s;var n,i,o,l,c,d,h,u,m,p,f,g,x,b,y,v,w,N,j,k,E,S,T,C,A,R,O,_,D,P,I,L,M,F,B=e.i(13161),U=e.i(91447),V=e.i(31981),z=e.i(72079),H=e.i(96877);function W({title:e,value:t,icon:r,color:a,delay:s=0}){let[n,i]=(0,U.useState)(0),{theme:o}=(0,z.useTheme)();(0,U.useEffect)(()=>{let e=Date.now(),r=100*s,a=setTimeout(()=>{let a=setInterval(()=>{let s=Math.min((Date.now()-e-r)/1500,1);i(Math.floor((1-Math.pow(1-s,4))*t)),s>=1&&(clearInterval(a),i(t))},16);return()=>clearInterval(a)},r);return()=>clearTimeout(a)},[t,s]);let l="dark"===o;return(0,B.jsxs)("div",{className:(0,V.cn)("relative rounded-2xl bg-gradient-to-br border p-4 lg:p-6 backdrop-blur-sm overflow-hidden","opacity-0 animate-fade-in-up group hover:scale-[1.02] transition-all duration-300","hover:shadow-lg",l&&"primary"===a&&"from-purple-500/20 to-purple-600/10",l&&"secondary"===a&&"from-blue-500/20 to-blue-600/10",l&&"accent"===a&&"from-pink-500/20 to-pink-600/10",!l&&"primary"===a&&H.default.cardPrimaryLight,!l&&"secondary"===a&&H.default.cardSecondaryLight,!l&&"accent"===a&&H.default.cardAccentLight,l&&"primary"===a&&"shadow-purple-500/20",l&&"secondary"===a&&"shadow-blue-500/20",l&&"accent"===a&&"shadow-pink-500/20",l?"border-white/10 hover:border-white/20":"border-gray-200/50 hover:border-gray-300/50"),children:[(0,B.jsx)("div",{className:(0,V.cn)("absolute -top-10 -right-10 w-24 lg:w-32 h-24 lg:h-32 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity","bg-gradient-to-br",l&&"primary"===a&&"from-purple-500 to-purple-600",l&&"secondary"===a&&"from-blue-500 to-blue-600",l&&"accent"===a&&"from-pink-500 to-pink-600",!l&&"primary"===a&&H.default.glowPrimaryLight,!l&&"secondary"===a&&H.default.glowSecondaryLight,!l&&"accent"===a&&H.default.glowAccentLight)}),(0,B.jsxs)("div",{className:"relative flex items-start justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs lg:text-sm mb-1 lg:mb-2",l?"text-gray-400":"text-gray-600"),children:e}),(0,B.jsx)("p",{className:(0,V.cn)("text-3xl lg:text-4xl font-bold",l&&"primary"===a&&"text-purple-400",l&&"secondary"===a&&"text-blue-400",l&&"accent"===a&&"text-pink-400",!l&&"primary"===a&&H.default.textPrimaryLight,!l&&"secondary"===a&&H.default.textSecondaryLight,!l&&"accent"===a&&H.default.textAccentLight),children:n.toLocaleString()})]}),(0,B.jsx)("div",{className:(0,V.cn)("w-10 h-10 lg:w-12 lg:h-12 rounded-xl bg-gradient-to-br flex items-center justify-center","group-hover:scale-110 transition-transform duration-300",l&&"primary"===a&&"from-purple-500 to-purple-600",l&&"secondary"===a&&"from-blue-500 to-blue-600",l&&"accent"===a&&"from-pink-500 to-pink-600",!l&&"primary"===a&&H.default.iconPrimaryLight,!l&&"secondary"===a&&H.default.iconSecondaryLight,!l&&"accent"===a&&H.default.iconAccentLight),children:(0,B.jsx)(r,{className:"w-5 h-5 lg:w-6 lg:h-6 text-white"})})]}),(0,B.jsx)("div",{className:(0,V.cn)("mt-3 lg:mt-4 h-1 rounded-full overflow-hidden",l?"bg-white/5":"bg-gray-100"),children:(0,B.jsx)("div",{className:(0,V.cn)("h-full rounded-full bg-gradient-to-r transition-all duration-1000",l&&"primary"===a&&"from-purple-500 to-purple-600",l&&"secondary"===a&&"from-blue-500 to-blue-600",l&&"accent"===a&&"from-pink-500 to-pink-600",!l&&"primary"===a&&H.default.progressPrimaryLight,!l&&"secondary"===a&&H.default.progressSecondaryLight,!l&&"accent"===a&&H.default.progressAccentLight),style:{width:`${Math.min(n/t*100,100)}%`}})})]})}var G=e.i(98275),q=e.i(7020),Y=e.i(49163);let X=(0,Y.default)("ContactRound",[["path",{d:"M16 2v2",key:"scm5qe"}],["path",{d:"M17.915 22a6 6 0 0 0-12 0",key:"suqz9p"}],["path",{d:"M8 2v2",key:"pbkmx"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",key:"12vinp"}]]);var K=e.i(90167),Q=e.i(26374),J=e.i(32905);let Z=(0,Y.default)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var ee=e.i(20483),et=e.i(15942),er=e.i(32575),ea=e.i(8950);let es={completed:{dark:"bg-[#A8E6CF]/20 text-[#A8E6CF] border-[#A8E6CF]/30",light:"bg-[#A8E6CF]/30 text-[#2D5F3F] border-[#A8E6CF]/40"},paused:{dark:"bg-[#FFE89E]/20 text-[#FFE89E] border-[#FFE89E]/30",light:"bg-[#FFE89E]/40 text-[#8B7000] border-[#FFE89E]/50"},descanso:{dark:"bg-[#FFCBA4]/20 text-[#FFCBA4] border-[#FFCBA4]/30",light:"bg-[#FFCBA4]/40 text-[#A0522D] border-[#FFCBA4]/50"},pending:{dark:"bg-[#D3D3D3]/20 text-[#D3D3D3] border-[#D3D3D3]/30",light:"bg-[#D3D3D3]/40 text-[#696969] border-[#D3D3D3]/50"},running:{dark:"bg-[#AED6F1]/20 text-[#AED6F1] border-[#AED6F1]/30",light:"bg-[#AED6F1]/40 text-[#1F618D] border-[#AED6F1]/50"}};function en(e){let t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleString("es-AR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})}function ei(e){return({completado:"completed",completed:"completed",pausado:"paused",paused:"paused",descanso:"descanso",pendiente:"pending",pending:"pending","en proceso":"running",running:"running"})[e.toLowerCase()]||"running"}function eo(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!0),n=new Date().toISOString().split("T")[0],[i,o]=(0,U.useState)(n),[l,c]=(0,U.useState)("all");(0,U.useEffect)(()=>{d()},[]);let d=async()=>{try{s(!0);let e=await er.api.sendJobs.list();r(e.data||[])}catch(e){console.error("Error fetching campaigns:",e),ea.toast.error("Error al cargar campañas")}finally{s(!1)}},h=async e=>{try{let t=await er.api.sendJobs.export(e),r=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.setAttribute("download",`campa\xf1a_${e}_detalle.xlsx`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(a),ea.toast.success("✅ Excel descargado")}catch(e){console.error("Error exporting campaign:",e),ea.toast.error("Error al descargar Excel")}},u=(0,U.useMemo)(()=>{let e=t.filter(e=>"fallido"!==e.status.toLowerCase()&&"failed"!==e.status.toLowerCase());return i&&(e=e.filter(e=>new Date(e.scheduledFor||e.createdAt).toISOString().split("T")[0]===i)),"all"!==l&&(e=e.filter(e=>ei(e.status)===l)),e.sort((e,t)=>new Date(t.scheduledFor||t.createdAt).getTime()-new Date(e.scheduledFor||e.createdAt).getTime())},[t,l,i]);return a?(0,B.jsx)("div",{className:"animate-fade-in-up flex items-center justify-center h-64",children:(0,B.jsxs)("div",{className:"text-center",children:[(0,B.jsx)("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Cargando campañas..."})]})}):(0,B.jsxs)("div",{className:"animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"mb-6",children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-xl lg:text-2xl font-bold mb-1","dark"===e?"text-white":"text-gray-700"),children:"Reportes de Mensajería"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Historial completo de campañas de mensajería"})]}),(0,B.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,B.jsxs)("div",{className:"relative flex-1 sm:flex-initial sm:min-w-[180px]",children:[(0,B.jsx)("input",{type:"date",value:i,onChange:e=>o(e.target.value),placeholder:"dd/mm/aaaa",className:(0,V.cn)("w-full pl-4 pr-10 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/30":"bg-white border-purple-200/50 text-gray-700 placeholder:text-gray-400 focus:border-purple-400 focus:ring-1 focus:ring-purple-200")}),(0,B.jsx)(Q.Calendar,{className:(0,V.cn)("absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")})]}),(0,B.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:(0,V.cn)("flex-1 sm:flex-initial sm:min-w-[180px] px-4 py-2.5 rounded-lg border text-sm transition-all appearance-none cursor-pointer","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/30":"bg-white border-purple-200/50 text-gray-700 focus:border-purple-400 focus:ring-1 focus:ring-purple-200"),children:[(0,B.jsx)("option",{value:"all",children:"Todos los estados"}),(0,B.jsx)("option",{value:"completed",children:"Completado"}),(0,B.jsx)("option",{value:"paused",children:"Pausado"}),(0,B.jsx)("option",{value:"descanso",children:"Descanso"}),(0,B.jsx)("option",{value:"pending",children:"Pendiente"}),(0,B.jsx)("option",{value:"running",children:"En proceso"})]})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("button",{onClick:d,className:(0,V.cn)("flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all","dark"===e?"bg-cyan-500 hover:bg-cyan-400 text-white":"bg-purple-500 hover:bg-purple-400 text-white"),children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,B.jsx)("button",{onClick:()=>{o(new Date().toISOString().split("T")[0]),c("all")},className:(0,V.cn)("flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all","dark"===e?"bg-white/10 hover:bg-white/20 text-gray-300":"bg-gray-100 hover:bg-gray-200 text-gray-600"),children:"Limpiar filtros"})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border overflow-hidden","dark"===e?"bg-[#0d1526]/80 border-white/10":"bg-white border-purple-200/30 shadow-lg shadow-purple-100/20"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full min-w-[900px]",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:(0,V.cn)("text-left text-xs uppercase tracking-wider","dark"===e?"text-gray-400 bg-white/5":"text-gray-500 bg-purple-50/50"),children:[(0,B.jsx)("th",{className:"px-4 py-3 font-medium",children:"Fecha de inicio"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium",children:"Campaña"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium",children:"Asesor"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Contactos"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Enviados"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Fallidos"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Respuestas"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Estado"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium",children:"Fecha de finalización"}),(0,B.jsx)("th",{className:"px-4 py-3 font-medium text-center",children:"Acciones"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===e?"divide-white/5":"divide-purple-100/50"),children:u.map((t,r)=>{var a,s;let n=ei(t.status);return(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-purple-50/30","animate-fade-in-up"),style:{animationDelay:`${50*r}ms`},children:[(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-sm","dark"===e?"text-gray-300":"text-gray-600"),children:en(t.scheduledFor||t.createdAt)}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-sm font-medium","dark"===e?"text-white":"text-gray-700"),children:(a=t.name)?a.charAt(0).toUpperCase()+a.slice(1).toLowerCase():""}),(0,B.jsx)("td",{className:"px-4 py-3",children:(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-sm font-medium","dark"===e?"text-white":"text-gray-700"),children:t.createdBy?.nombre||"N/A"}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-500":"text-gray-400"),children:t.createdBy?.numeroEquipo?`Equipo ${t.createdBy.numeroEquipo}`:""})]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-sm text-center","dark"===e?"text-gray-300":"text-gray-600"),children:t.totalContacts||0}),(0,B.jsx)("td",{className:"px-4 py-3 text-center",children:(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium","dark"===e?"bg-[#17C787]/20 text-[#17C787]":"bg-[#17C787]/10 text-[#17C787]"),children:[(0,B.jsx)(K.Mail,{className:"w-3 h-3"}),t.sentCount||0]})}),(0,B.jsx)("td",{className:"px-4 py-3 text-center",children:(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium","dark"===e?"bg-[#C8376B]/20 text-[#C8376B]":"bg-[#C8376B]/10 text-[#C8376B]"),children:[(0,B.jsx)(ee.X,{className:"w-3 h-3"}),t.failedCount||0]})}),(0,B.jsx)("td",{className:"px-4 py-3 text-center",children:(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium","dark"===e?"bg-[#1E88E5]/20 text-[#1E88E5]":"bg-[#1E88E5]/10 text-[#1E88E5]"),children:[(0,B.jsx)(et.MessageSquare,{className:"w-3 h-3"}),t.repliesCount||0]})}),(0,B.jsx)("td",{className:"px-4 py-3 text-center",children:(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md text-xs font-medium border",es[n][e]),children:[(0,B.jsx)(K.Mail,{className:"w-3 h-3"}),{completado:"Completado",completed:"Completado",pausado:"Pausado",paused:"Pausado",descanso:"Descanso","en proceso":"En proceso",running:"En proceso",pendiente:"Pendiente",pending:"Pendiente"}[(s=t.status).toLowerCase()]||s]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-sm","dark"===e?"text-gray-300":"text-gray-600"),children:t.completedAt?en(t.completedAt):"-"}),(0,B.jsx)("td",{className:"px-4 py-3 text-center",children:(0,B.jsxs)("button",{onClick:()=>h(t._id),className:(0,V.cn)("inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:scale-105","dark"===e?"bg-blue-500/20 text-blue-400 hover:bg-blue-500/30":"bg-blue-100 text-blue-600 hover:bg-blue-200"),children:[(0,B.jsx)(Z,{className:"w-3.5 h-3.5"}),"Excel"]})})]},t._id)})})]})})})]})}var el=e.i(8074);let ec=(0,Y.default)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var ed=e.i(20277),eh=e.i(96241),eu=e.i(51444),em=e.i(45155),ep=e.i(2372),ef=e.i(81114);let eg=(0,Y.default)("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),ex=(0,Y.default)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),eb=(0,Y.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),ey=(0,Y.default)("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]),ev=(0,Y.default)("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),ew=(0,Y.default)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);var eN=e.i(5872);let ej=(0,Y.default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),ek=(0,Y.default)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var eE=e.i(316);let eS=(0,Y.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),eT=(0,Y.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function eC({isOpen:e,onClose:t}){let{theme:r}=(0,z.useTheme)(),[a,s]=(0,U.useState)(""),[n,i]=(0,U.useState)(""),[o,l]=(0,U.useState)("contains"),[c,d]=(0,U.useState)(!1),[h,u]=(0,U.useState)(!0),[m,p]=(0,U.useState)([]),[f,g]=(0,U.useState)(!1),[x,b]=(0,U.useState)(!1),[y,v]=(0,U.useState)(null);(0,U.useEffect)(()=>{e&&w()},[e]);let w=async()=>{g(!0);try{let e=await er.api.autoResponses.list();p(e.data||[])}catch(e){console.error("Error loading autoresponses:",e),ea.toast.error("Error al cargar auto-respuestas")}finally{g(!1)}},N=async()=>{if(!n.trim())return void ea.toast.error("La respuesta es obligatoria");if(!c&&!a.trim())return void ea.toast.error("La palabra clave es obligatoria (o marca como comodín)");b(!0);try{let e={keyword:c?null:a.trim(),response:n.trim(),matchType:c?null:o,isFallback:c,active:h};y?(await er.api.autoResponses.update(y,e),ea.toast.success("Auto-respuesta actualizada"),v(null)):(await er.api.autoResponses.create(e),ea.toast.success("Auto-respuesta creada")),s(""),i(""),d(!1),u(!0),l("contains"),w()}catch(e){console.error("Error creating/updating autoresponse:",e),ea.toast.error(e.response?.data?.error||`Error al ${y?"actualizar":"crear"} auto-respuesta`)}finally{b(!1)}},j=async e=>{if(confirm("¿Estás seguro de eliminar esta auto-respuesta?"))try{await er.api.autoResponses.delete(e),ea.toast.success("Auto-respuesta eliminada"),w()}catch(e){console.error("Error deleting autoresponse:",e),ea.toast.error("Error al eliminar auto-respuesta")}},k=async e=>{try{await er.api.autoResponses.toggle(e),w()}catch(e){console.error("Error toggling autoresponse:",e),ea.toast.error("Error al cambiar estado")}};return e?(0,B.jsx)("div",{className:"fixed top-24 right-4 z-50 w-full max-w-2xl animate-in slide-in-from-right-10 fade-in duration-300",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full overflow-hidden rounded-2xl border shadow-2xl","dark"===r?"bg-[#0f0a1e]/95 backdrop-blur-md border-white/10 shadow-black/50":"bg-white/95 backdrop-blur-md border-purple-200/50 shadow-purple-500/10"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-4 border-b","dark"===r?"border-white/10":"border-purple-100"),children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-lg font-semibold","dark"===r?"text-white":"text-gray-700"),children:"Auto-respuestas"}),(0,B.jsx)("button",{onClick:t,className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-60px)]",children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex gap-3 p-3 rounded-xl mb-4 border","dark"===r?"bg-[#1E88E5]/10 border-[#1E88E5]/30":"bg-blue-50 border-blue-200"),children:[(0,B.jsx)(ek,{className:(0,V.cn)("w-5 h-5 flex-shrink-0 mt-0.5","dark"===r?"text-[#1E88E5]":"text-blue-500")}),(0,B.jsxs)("div",{className:"text-xs space-y-1",children:[(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===r?"text-[#1E88E5]":"text-blue-700"),children:"Ventana anti-spam activa: 30 minutos"}),(0,B.jsx)("p",{className:"dark"===r?"text-gray-400":"text-gray-600",children:"Durante esta ventana, solo se envía una auto-respuesta por contacto."})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("space-y-3 mb-6 p-4 rounded-xl border","dark"===r?"bg-white/5 border-white/10":"bg-purple-50/50 border-purple-100"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-sm font-medium mb-2","dark"===r?"text-gray-300":"text-gray-700"),children:y?"Editar Regla":"Nueva Regla"}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,B.jsx)("input",{type:"text",value:a,onChange:e=>s(e.target.value),placeholder:"Palabra clave (ej: precio, info)",disabled:c,className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2 disabled:opacity-50","dark"===r?"bg-black/20 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")}),(0,B.jsxs)("select",{value:o,onChange:e=>l(e.target.value),disabled:c,className:(0,V.cn)("px-3 py-2 rounded-lg text-sm border transition-all disabled:opacity-50","dark"===r?"bg-black/20 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700"),children:[(0,B.jsx)("option",{value:"contains",children:"Contiene"}),(0,B.jsx)("option",{value:"exact",children:"Exacto"}),(0,B.jsx)("option",{value:"startsWith",children:"Empieza con"}),(0,B.jsx)("option",{value:"endsWith",children:"Termina con"})]})]}),(0,B.jsx)("textarea",{value:n,onChange:e=>i(e.target.value),placeholder:"Respuesta automática...",rows:3,className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2 resize-none","dark"===r?"bg-black/20 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")}),(0,B.jsxs)("div",{className:"flex flex-wrap items-center gap-4 pt-2",children:[(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,B.jsx)("input",{type:"checkbox",checked:c,onChange:e=>d(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-purple-500 focus:ring-purple-500"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===r?"text-gray-300":"text-gray-600"),children:"Es respuesta por defecto (Fallback)"})]}),(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[(0,B.jsx)("input",{type:"checkbox",checked:h,onChange:e=>u(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-purple-500 focus:ring-purple-500"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===r?"text-gray-300":"text-gray-600"),children:"Activa"})]}),(0,B.jsxs)("button",{onClick:N,disabled:x,className:(0,V.cn)("ml-auto flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all disabled:opacity-50","dark"===r?"bg-[#17C787] hover:bg-[#17C787]/80 text-white":"bg-emerald-500 hover:bg-emerald-600 text-white"),children:[x?(0,B.jsx)(eT,{className:"w-4 h-4 animate-spin"}):(0,B.jsx)(eE.Plus,{className:"w-4 h-4"}),y?"Actualizar":"Crear Regla"]})]})]}),(0,B.jsx)("div",{className:"overflow-x-auto rounded-xl border overflow-hidden",children:(0,B.jsxs)("table",{className:(0,V.cn)("w-full text-xs","dark"===r?"border-white/10":"border-purple-100"),children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:"dark"===r?"bg-white/5":"bg-purple-50",children:[(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Keyword"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Respuesta"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Tipo"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-center font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Estado"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-center font-medium","dark"===r?"text-gray-400":"text-gray-600"),children:"Acciones"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===r?"divide-white/5":"divide-purple-100"),children:f?(0,B.jsx)("tr",{children:(0,B.jsxs)("td",{colSpan:5,className:"p-8 text-center",children:[(0,B.jsx)(eT,{className:(0,V.cn)("w-6 h-6 animate-spin mx-auto mb-2","dark"===r?"text-purple-400":"text-purple-600")}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===r?"text-gray-500":"text-gray-400"),children:"Cargando reglas..."})]})}):0===m.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:5,className:"p-8 text-center",children:(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===r?"text-gray-500":"text-gray-400"),children:"No hay auto-respuestas configuradas"})})}):m.map(e=>(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors","dark"===r?"hover:bg-white/5":"hover:bg-purple-50/50"),children:[(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-2 font-medium","dark"===r?"text-white":"text-gray-700"),children:e.isFallback?(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-[10px]","dark"===r?"bg-rose-500/20 text-rose-300":"bg-rose-100 text-rose-600"),children:"FALLBACK"}):e.keyword}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-2 max-w-[200px] truncate","dark"===r?"text-gray-300":"text-gray-600"),children:e.response}),(0,B.jsx)("td",{className:"px-3 py-2",children:!e.isFallback&&(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-[10px]","dark"===r?"bg-blue-500/20 text-blue-300":"bg-blue-100 text-blue-600"),children:e.matchType})}),(0,B.jsx)("td",{className:"px-3 py-2 text-center",children:(0,B.jsx)("button",{onClick:()=>k(e._id),className:(0,V.cn)("px-2 py-0.5 rounded text-[10px] transition-colors",e.active?"dark"===r?"bg-emerald-500/20 text-emerald-300 hover:bg-emerald-500/30":"bg-emerald-100 text-emerald-600 hover:bg-emerald-200":"dark"===r?"bg-gray-500/20 text-gray-400 hover:bg-gray-500/30":"bg-gray-100 text-gray-500 hover:bg-gray-200"),children:e.active?"Activa":"Inactiva"})}),(0,B.jsx)("td",{className:"px-3 py-2",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,B.jsx)("button",{onClick:()=>{s(e.isFallback?"":e.keyword),i(e.response),l(e.matchType||"contains"),d(e.isFallback),u(e.active),v(e._id)},className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"bg-blue-500/10 text-blue-400 hover:bg-blue-500/20":"bg-blue-50 text-blue-600 hover:bg-blue-100"),children:(0,B.jsx)(eS,{className:"w-3.5 h-3.5"})}),(0,B.jsx)("button",{onClick:()=>j(e._id),className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"bg-rose-500/10 text-rose-400 hover:bg-rose-500/20":"bg-rose-50 text-rose-600 hover:bg-rose-100"),children:(0,B.jsx)(eu.Trash2,{className:"w-3.5 h-3.5"})})]})})]},e._id))})]})})]})]})}):null}function eA({isOpen:e,onClose:t,onInsert:r}){let{theme:a}=(0,z.useTheme)(),[s,n]=(0,U.useState)(["",""]);if(!e)return null;let i=()=>{n(["",""]),t()};return(0,B.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-2xl animate-scale-in","dark"===a?"bg-gradient-to-br from-gray-900 to-gray-800 border-white/10":"bg-white border-purple-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-lg","dark"===a?"bg-purple-500/20":"bg-purple-100"),children:(0,B.jsx)(eN.Sparkles,{className:(0,V.cn)("w-5 h-5","dark"===a?"text-purple-400":"text-purple-600")})}),(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-bold","dark"===a?"text-white":"text-gray-800"),children:"Crear Spintax"})]}),(0,B.jsx)("button",{onClick:i,className:(0,V.cn)("p-2 rounded-lg transition-colors","dark"===a?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("mb-4 p-3 rounded-lg text-sm","dark"===a?"bg-blue-500/10 text-blue-300 border border-blue-500/20":"bg-blue-50 text-blue-700 border border-blue-200"),children:[(0,B.jsx)("p",{className:"font-medium mb-1",children:"¿Qué es Spintax?"}),(0,B.jsx)("p",{className:"text-xs opacity-90",children:"Spintax permite crear variaciones de texto. El sistema elegirá aleatoriamente una de las opciones que ingreses, haciendo cada mensaje único y evitando que parezcan automáticos."})]}),(0,B.jsx)("div",{className:"space-y-3 mb-4 max-h-[300px] overflow-y-auto",children:s.map((e,t)=>(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-xs font-medium mb-1","dark"===a?"text-gray-400":"text-gray-600"),children:["Opción ",t+1]}),(0,B.jsx)("input",{type:"text",value:e,onChange:e=>{var r;let a;return r=e.target.value,void((a=[...s])[t]=r,n(a))},placeholder:`Ejemplo: "${0===t?"Hola":1===t?"Buenos días":"Saludos"}"`,className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2","dark"===a?"bg-white/5 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")})]}),s.length>2&&(0,B.jsx)("button",{onClick:()=>{s.length>2&&n(s.filter((e,r)=>r!==t))},className:(0,V.cn)("mt-6 p-2 rounded-lg transition-colors","dark"===a?"hover:bg-red-500/20 text-red-400":"hover:bg-red-100 text-red-600"),title:"Eliminar opción",children:(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"})})]},t))}),(0,B.jsxs)("button",{onClick:()=>{n([...s,""])},className:(0,V.cn)("w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all mb-4","dark"===a?"bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10":"bg-gray-50 hover:bg-gray-100 text-gray-700 border border-gray-200"),children:[(0,B.jsx)(eE.Plus,{className:"w-4 h-4"}),"Agregar opción"]}),s.filter(e=>""!==e.trim()).length>=2&&(0,B.jsxs)("div",{className:(0,V.cn)("mb-4 p-3 rounded-lg text-sm","dark"===a?"bg-green-500/10 border border-green-500/20":"bg-green-50 border border-green-200"),children:[(0,B.jsx)("p",{className:(0,V.cn)("font-medium mb-1","dark"===a?"text-green-300":"text-green-700"),children:"Vista previa:"}),(0,B.jsx)("code",{className:(0,V.cn)("text-xs","dark"===a?"text-green-200":"text-green-600"),children:`{${s.filter(e=>""!==e.trim()).join("|")}}`})]}),(0,B.jsxs)("div",{className:"flex gap-3",children:[(0,B.jsx)("button",{onClick:i,className:(0,V.cn)("flex-1 px-4 py-2.5 rounded-lg text-sm font-medium transition-all","dark"===a?"bg-white/5 hover:bg-white/10 text-gray-300 border border-white/10":"bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-200"),children:"Cancelar"}),(0,B.jsx)("button",{onClick:()=>{let e=s.filter(e=>""!==e.trim());e.length<2?alert("Debes ingresar al menos 2 opciones"):(r(`{${e.join("|")}}`),n(["",""]),t())},className:(0,V.cn)("flex-1 px-4 py-2.5 rounded-lg text-sm font-semibold transition-all","dark"===a?"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white shadow-lg shadow-purple-500/20":"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white shadow-lg shadow-purple-200/50"),children:"Insertar Spintax"})]})]})})}let eR=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],eO=new Set(eR),e_=e=>180*e/Math.PI,eD=e=>eI(e_(Math.atan2(e[1],e[0]))),eP={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:eD,rotateZ:eD,skewX:e=>e_(Math.atan(e[1])),skewY:e=>e_(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},eI=e=>((e%=360)<0&&(e+=360),e),eL=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),eM=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),eF={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:eL,scaleY:eM,scale:e=>(eL(e)+eM(e))/2,rotateX:e=>eI(e_(Math.atan2(e[6],e[5]))),rotateY:e=>eI(e_(Math.atan2(-e[2],e[0]))),rotateZ:eD,rotate:eD,skewX:e=>e_(Math.atan(e[4])),skewY:e=>e_(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function eB(e){return+!!e.includes("scale")}function eU(e,t){let r,a;if(!e||"none"===e)return eB(t);let s=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);if(s)r=eF,a=s;else{let t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=eP,a=t}if(!a)return eB(t);let n=r[t],i=a[1].split(",").map(eV);return"function"==typeof n?n(i):i[n]}function eV(e){return parseFloat(e.trim())}let ez=e=>t=>"string"==typeof t&&t.startsWith(e),eH=ez("--"),eW=ez("var(--"),e$=e=>!!eW(e)&&eG.test(e.split("/*")[0].trim()),eG=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function eq({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}let eY=(e,t,r)=>e+(t-e)*r;function eX(e){return void 0===e||1===e}function eK({scale:e,scaleX:t,scaleY:r}){return!eX(e)||!eX(t)||!eX(r)}function eQ(e){return eK(e)||eJ(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function eJ(e){var t,r;return(t=e.x)&&"0%"!==t||(r=e.y)&&"0%"!==r}function eZ(e,t,r,a,s){return void 0!==s&&(e=a+s*(e-a)),a+r*(e-a)+t}function e0(e,t=0,r=1,a,s){e.min=eZ(e.min,t,r,a,s),e.max=eZ(e.max,t,r,a,s)}function e1(e,{x:t,y:r}){e0(e.x,t.translate,t.scale,t.originPoint),e0(e.y,r.translate,r.scale,r.originPoint)}function e2(e,t){e.min=e.min+t,e.max=e.max+t}function e5(e,t,r,a,s=.5){let n=eY(e.min,e.max,s);e0(e,t,r,n,a)}function e4(e,t){e5(e.x,t.x,t.scaleX,t.scale,t.originX),e5(e.y,t.y,t.scaleY,t.scale,t.originY)}function e3(e,t){return eq(function(e,t){if(!t)return e;let r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}(e.getBoundingClientRect(),t))}let e6=new Set(["width","height","top","left","right","bottom",...eR]),e8=(e,t,r)=>r>t?t:r<e?e:r,e7={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},e9={...e7,transform:e=>e8(0,1,e)},te={...e7,default:1},tt=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),tr=tt("deg"),ta=tt("%"),ts=tt("px"),tn=tt("vh"),ti=tt("vw"),to={...ta,parse:e=>ta.parse(e)/100,transform:e=>ta.transform(100*e)},tl=e=>t=>t.test(e),tc=[e7,ts,ta,tr,ti,tn,{test:e=>"auto"===e,parse:e=>e}],td=e=>tc.find(tl(e));var th=e.i(57954);let tu=()=>{},tm=()=>{},tp=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u,tf=e=>e===e7||e===ts,tg=new Set(["x","y","z"]),tx=eR.filter(e=>!tg.has(e)),tb={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>eU(t,"x"),y:(e,{transform:t})=>eU(t,"y")};tb.translateX=tb.x,tb.translateY=tb.y;let ty=e=>e,tv={},tw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function tN(e,t){let r=!1,a=!0,s={delta:0,timestamp:0,isProcessing:!1},n=()=>r=!0,i=tw.reduce((e,r)=>(e[r]=function(e,t){let r=new Set,a=new Set,s=!1,n=!1,i=new WeakSet,o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){i.has(t)&&(d.schedule(t),e()),l++,t(o)}let d={schedule:(e,t=!1,n=!1)=>{let o=n&&s?r:a;return t&&i.add(e),o.has(e)||o.add(e),e},cancel:e=>{a.delete(e),i.delete(e)},process:e=>{if(o=e,s){n=!0;return}s=!0,[r,a]=[a,r],r.forEach(c),t,l=0,r.clear(),s=!1,n&&(n=!1,d.process(e))}};return d}(n,t?r:void 0),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:h,preRender:u,render:m,postRender:p}=i,f=()=>{let n=tv.useManualTiming?s.timestamp:performance.now();r=!1,tv.useManualTiming||(s.delta=a?1e3/60:Math.max(Math.min(n-s.timestamp,40),1)),s.timestamp=n,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),d.process(s),h.process(s),u.process(s),m.process(s),p.process(s),s.isProcessing=!1,r&&t&&(a=!1,e(f))};return{schedule:tw.reduce((t,n)=>{let o=i[n];return t[n]=(t,n=!1,i=!1)=>(!r&&(r=!0,a=!0,s.isProcessing||e(f)),o.schedule(t,n,i)),t},{}),cancel:e=>{for(let t=0;t<tw.length;t++)i[tw[t]].cancel(e)},state:s,steps:i}}let{schedule:tj,cancel:tk,state:tE,steps:tS}=tN("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:ty,!0),tT=new Set,tC=!1,tA=!1,tR=!1;function tO(){if(tA){let e=Array.from(tT).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),r=new Map;t.forEach(e=>{let t,a=(t=[],tx.forEach(r=>{let a=e.getValue(r);void 0!==a&&(t.push([r,a.get()]),a.set(+!!r.startsWith("scale")))}),t);a.length&&(r.set(e,a),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();let t=r.get(e);t&&t.forEach(([t,r])=>{e.getValue(t)?.set(r)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}tA=!1,tC=!1,tT.forEach(e=>e.complete(tR)),tT.clear()}function t_(){tT.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(tA=!0)})}class tD{constructor(e,t,r,a,s,n=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=a,this.element=s,this.isAsync=n}scheduleResolve(){this.state="scheduled",this.isAsync?(tT.add(this),tC||(tC=!0,tj.read(t_),tj.resolveKeyframes(tO))):(this.readKeyframes(),this.complete())}readKeyframes(){let{unresolvedKeyframes:e,name:t,element:r,motionValue:a}=this;if(null===e[0]){let s=a?.get(),n=e[e.length-1];if(void 0!==s)e[0]=s;else if(r&&t){let a=r.readValue(t,n);null!=a&&(e[0]=a)}void 0===e[0]&&(e[0]=n),a&&void 0===s&&a.set(e[0])}for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),tT.delete(this)}cancel(){"scheduled"===this.state&&(tT.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}let tP=e=>Math.round(1e5*e)/1e5,tI=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,tL=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,tM=(e,t)=>r=>!!("string"==typeof r&&tL.test(r)&&r.startsWith(e)||t&&null!=r&&Object.prototype.hasOwnProperty.call(r,t)),tF=(e,t,r)=>a=>{if("string"!=typeof a)return a;let[s,n,i,o]=a.match(tI);return{[e]:parseFloat(s),[t]:parseFloat(n),[r]:parseFloat(i),alpha:void 0!==o?parseFloat(o):1}},tB={...e7,transform:e=>Math.round(e8(0,255,e))},tU={test:tM("rgb","red"),parse:tF("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+tB.transform(e)+", "+tB.transform(t)+", "+tB.transform(r)+", "+tP(e9.transform(a))+")"},tV={test:tM("#"),parse:function(e){let t="",r="",a="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,a+=a,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:s?parseInt(s,16)/255:1}},transform:tU.transform},tz={test:tM("hsl","hue"),parse:tF("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+ta.transform(tP(t))+", "+ta.transform(tP(r))+", "+tP(e9.transform(a))+")"},tH={test:e=>tU.test(e)||tV.test(e)||tz.test(e),parse:e=>tU.test(e)?tU.parse(e):tz.test(e)?tz.parse(e):tV.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?tU.transform(e):tz.transform(e),getAnimatableNone:e=>{let t=tH.parse(e);return t.alpha=0,tH.transform(t)}},tW=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,t$="number",tG="color",tq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function tY(e){let t=e.toString(),r=[],a={color:[],number:[],var:[]},s=[],n=0,i=t.replace(tq,e=>(tH.test(e)?(a.color.push(n),s.push(tG),r.push(tH.parse(e))):e.startsWith("var(")?(a.var.push(n),s.push("var"),r.push(e)):(a.number.push(n),s.push(t$),r.push(parseFloat(e))),++n,"${}")).split("${}");return{values:r,split:i,indexes:a,types:s}}function tX(e){return tY(e).values}function tK(e){let{split:t,types:r}=tY(e),a=t.length;return e=>{let s="";for(let n=0;n<a;n++)if(s+=t[n],void 0!==e[n]){let t=r[n];t===t$?s+=tP(e[n]):t===tG?s+=tH.transform(e[n]):s+=e[n]}return s}}let tQ=e=>"number"==typeof e?0:tH.test(e)?tH.getAnimatableNone(e):e,tJ={test:function(e){return isNaN(e)&&"string"==typeof e&&(e.match(tI)?.length||0)+(e.match(tW)?.length||0)>0},parse:tX,createTransformer:tK,getAnimatableNone:function(e){let t=tX(e);return tK(e)(t.map(tQ))}},tZ=new Set(["brightness","contrast","saturate","opacity"]);function t0(e){let[t,r]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[a]=r.match(tI)||[];if(!a)return e;let s=r.replace(a,""),n=+!!tZ.has(t);return a!==r&&(n*=100),t+"("+n+s+")"}let t1=/\b([a-z-]*)\(.*?\)/gu,t2={...tJ,getAnimatableNone:e=>{let t=e.match(t1);return t?t.map(t0).join(" "):e}},t5={...e7,transform:Math.round},t4={borderWidth:ts,borderTopWidth:ts,borderRightWidth:ts,borderBottomWidth:ts,borderLeftWidth:ts,borderRadius:ts,radius:ts,borderTopLeftRadius:ts,borderTopRightRadius:ts,borderBottomRightRadius:ts,borderBottomLeftRadius:ts,width:ts,maxWidth:ts,height:ts,maxHeight:ts,top:ts,right:ts,bottom:ts,left:ts,padding:ts,paddingTop:ts,paddingRight:ts,paddingBottom:ts,paddingLeft:ts,margin:ts,marginTop:ts,marginRight:ts,marginBottom:ts,marginLeft:ts,backgroundPositionX:ts,backgroundPositionY:ts,rotate:tr,rotateX:tr,rotateY:tr,rotateZ:tr,scale:te,scaleX:te,scaleY:te,scaleZ:te,skew:tr,skewX:tr,skewY:tr,distance:ts,translateX:ts,translateY:ts,translateZ:ts,x:ts,y:ts,z:ts,perspective:ts,transformPerspective:ts,opacity:e9,originX:to,originY:to,originZ:ts,zIndex:t5,fillOpacity:e9,strokeOpacity:e9,numOctaves:t5},t3={...t4,color:tH,backgroundColor:tH,outlineColor:tH,fill:tH,stroke:tH,borderColor:tH,borderTopColor:tH,borderRightColor:tH,borderBottomColor:tH,borderLeftColor:tH,filter:t2,WebkitFilter:t2},t6=e=>t3[e];function t8(e,t){let r=t6(e);return r!==t2&&(r=tJ),r.getAnimatableNone?r.getAnimatableNone(t):void 0}let t7=new Set(["auto","none","0"]);class t9 extends tD{constructor(e,t,r,a,s){super(e,t,r,a,s,!0)}readKeyframes(){let{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let r=0;r<e.length;r++){let a=e[r];if("string"==typeof a&&e$(a=a.trim())){let s=function e(t,r,a=1){tm(a<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`,"max-css-var-depth");let[s,n]=function(e){let t=tp.exec(e);if(!t)return[,];let[,r,a,s]=t;return[`--${r??a}`,s]}(t);if(!s)return;let i=window.getComputedStyle(r).getPropertyValue(s);if(i){let e=i.trim();return/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e)?parseFloat(e):e}return e$(n)?e(n,r,a+1):n}(a,t.current);void 0!==s&&(e[r]=s),r===e.length-1&&(this.finalKeyframe=a)}}if(this.resolveNoneKeyframes(),!e6.has(r)||2!==e.length)return;let[a,s]=e,n=td(a),i=td(s);if(n!==i)if(tf(n)&&tf(i))for(let t=0;t<e.length;t++){let r=e[t];"string"==typeof r&&(e[t]=parseFloat(r))}else tb[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){let{unresolvedKeyframes:e,name:t}=this,r=[];for(let t=0;t<e.length;t++)(null===e[t]||function(e){if("number"==typeof e)return 0===e;if(null===e)return!0;return"none"===e||"0"===e||/^0[^.\s]+$/u.test(e)}(e[t]))&&r.push(t);r.length&&function(e,t,r){let a,s=0;for(;s<e.length&&!a;){let t=e[s];"string"==typeof t&&!t7.has(t)&&tY(t).values.length&&(a=e[s]),s++}if(a&&r)for(let s of t)e[s]=t8(r,a)}(e,r,t)}measureInitialState(){let{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;"height"===r&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tb[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;let a=t[t.length-1];void 0!==a&&e.getValue(r,a).jump(a,!1)}measureEndState(){let{element:e,name:t,unresolvedKeyframes:r}=this;if(!e||!e.current)return;let a=e.getValue(t);a&&a.jump(this.measuredOrigin,!1);let s=r.length-1,n=r[s];r[s]=tb[t](e.measureViewportBox(),window.getComputedStyle(e.current)),null!==n&&void 0===this.finalKeyframe&&(this.finalKeyframe=n),this.removedTransforms?.length&&this.removedTransforms.forEach(([t,r])=>{e.getValue(t).set(r)}),this.resolveNoneKeyframes()}}let re=e=>!!(e&&e.getVelocity);function rt(){t=void 0}let rr={now:()=>(void 0===t&&rr.set(tE.isProcessing||tv.useManualTiming?tE.timestamp:performance.now()),t),set:e=>{t=e,queueMicrotask(rt)}};function ra(e,t){-1===e.indexOf(t)&&e.push(t)}function rs(e,t){let r=e.indexOf(t);r>-1&&e.splice(r,1)}class rn{constructor(){this.subscriptions=[]}add(e){return ra(this.subscriptions,e),()=>rs(this.subscriptions,e)}notify(e,t,r){let a=this.subscriptions.length;if(a)if(1===a)this.subscriptions[0](e,t,r);else for(let s=0;s<a;s++){let a=this.subscriptions[s];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}class ri{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{let t=rr.now();if(this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(let e of this.dependents)e.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=rr.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=!isNaN(parseFloat(this.current)))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new rn);let r=this.events[e].add(t);return"change"===e?()=>{r(),tj.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return s&&s.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e;let t=rr.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;let r=Math.min(this.updatedAt-this.prevUpdatedAt,30);return e=parseFloat(this.current)-parseFloat(this.prevFrameValue),r?1e3/r*e:0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ro(e,t){return new ri(e,t)}let rl=[...tc,tH,tJ],{schedule:rc}=tN(queueMicrotask,!1),rd={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},rh={};for(let e in rd)rh[e]={isEnabled:t=>rd[e].some(e=>!!t[e])};let ru=()=>({translate:0,scale:1,origin:0,originPoint:0}),rm=()=>({x:ru(),y:ru()}),rp=()=>({min:0,max:0}),rf=()=>({x:rp(),y:rp()}),rg="undefined"!=typeof window,rx={current:null},rb={current:!1},ry=new WeakMap;function rv(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function rw(e){return"string"==typeof e||Array.isArray(e)}let rN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],rj=["initial",...rN];function rk(e){return rv(e.animate)||rj.some(t=>rw(e[t]))}function rE(e){return!!(rk(e)||e.variants)}function rS(e){let t=[{},{}];return e?.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function rT(e,t,r,a){if("function"==typeof t){let[s,n]=rS(a);t=t(void 0!==r?r:e.custom,s,n)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){let[s,n]=rS(a);t=t(void 0!==r?r:e.custom,s,n)}return t}let rC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class rA{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:a,blockInitialAnimation:s,visualState:n},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=tD,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{let e=rr.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,tj.render(this.render,!1,!0))};const{latestValues:o,renderState:l}=n;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!s,this.isControllingVariants=rk(t),this.isVariantNode=rE(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const e in d){const t=d[e];void 0!==o[e]&&re(t)&&t.set(o[e])}}mount(e){this.current=e,ry.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),rb.current||function(){if(rb.current=!0,rg)if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>rx.current=e.matches;e.addEventListener("change",t),t()}else rx.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||rx.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in this.projection&&this.projection.unmount(),tk(this.notifyUpdate),tk(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this),this.events)this.events[e].clear();for(let e in this.features){let t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){let r;this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();let a=eO.has(e);a&&this.onBindTransform&&this.onBindTransform();let s=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&tj.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});window.MotionCheckAppearSync&&(r=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),r&&r(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in rh){let t=rh[e];if(!t)continue;let{isEnabled:r,Feature:a}=t;if(!this.features[e]&&a&&r(this.props)&&(this.features[e]=new a(this)),this.features[e]){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rf()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<rC.length;t++){let r=rC[t];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);let a=e["on"+r];a&&(this.propEventSubscriptions[r]=this.on(r,a))}this.prevMotionValues=function(e,t,r){for(let a in t){let s=t[a],n=r[a];if(re(s))e.addValue(a,s);else if(re(n))e.addValue(a,ro(s,{owner:e}));else if(n!==s)if(e.hasValue(a)){let t=e.getValue(a);!0===t.liveStyle?t.jump(s):t.hasAnimated||t.set(s)}else{let t=e.getStaticValue(a);e.addValue(a,ro(void 0!==t?t:s,{owner:e}))}}for(let a in r)void 0===t[a]&&e.removeValue(a);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){let r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return void 0===r&&void 0!==t&&(r=ro(null===t?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];if(null!=r){let a,s;if("string"==typeof r&&(a=r,/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(a)||(s=r,/^0[^.\s]+$/u.test(s))))r=parseFloat(r);else{let a;a=r,!rl.find(tl(a))&&tJ.test(t)&&(r=t8(e,t))}this.setBaseTarget(e,re(r)?r.get():r)}return re(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){let t,{initial:r}=this.props;if("string"==typeof r||"object"==typeof r){let a=rT(this.props,r,this.presenceContext?.custom);a&&(t=a[e])}if(r&&void 0!==t)return t;let a=this.getBaseTargetFromProps(this.props,e);return void 0===a||re(a)?void 0!==this.initialValues[e]&&void 0===t?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new rn),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){rc.render(this.render)}}class rR extends rA{constructor(){super(...arguments),this.KeyframeResolver=t9}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;re(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}let rO=(e,t)=>t&&"number"==typeof e?t.transform(e):e,r_={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},rD=eR.length;function rP(e,t,r){let{style:a,vars:s,transformOrigin:n}=e,i=!1,o=!1;for(let e in t){let r=t[e];if(eO.has(e)){i=!0;continue}if(eH(e)){s[e]=r;continue}{let t=rO(r,t4[e]);e.startsWith("origin")?(o=!0,n[e]=t):a[e]=t}}if(!t.transform&&(i||r?a.transform=function(e,t,r){let a="",s=!0;for(let n=0;n<rD;n++){let i=eR[n],o=e[i];if(void 0===o)continue;let l=!0;if(!(l="number"==typeof o?o===+!!i.startsWith("scale"):0===parseFloat(o))||r){let e=rO(o,t4[i]);if(!l){s=!1;let t=r_[i]||i;a+=`${t}(${e}) `}r&&(t[i]=e)}}return a=a.trim(),r?a=r(t,s?"":a):s&&(a="none"),a}(t,e.transform,r):a.transform&&(a.transform="none")),o){let{originX:e="50%",originY:t="50%",originZ:r=0}=n;a.transformOrigin=`${e} ${t} ${r}`}}function rI(e,{style:t,vars:r},a,s){let n,i=e.style;for(n in t)i[n]=t[n];for(n in s?.applyProjectionStyles(i,a),r)i.setProperty(n,r[n])}let rL={};function rM(e,{layout:t,layoutId:r}){return eO.has(e)||e.startsWith("origin")||(t||void 0!==r)&&(!!rL[e]||"opacity"===e)}function rF(e,t,r){let{style:a}=e,s={};for(let n in a)(re(a[n])||t.style&&re(t.style[n])||rM(n,e)||r?.getValue(n)?.liveStyle!==void 0)&&(s[n]=a[n]);return s}class rB extends rR{constructor(){super(...arguments),this.type="html",this.renderInstance=rI}readValueFromInstance(e,t){if(eO.has(t))return this.projection?.isProjecting?eB(t):((e,t)=>{let{transform:r="none"}=getComputedStyle(e);return eU(r,t)})(e,t);{let r=window.getComputedStyle(e),a=(eH(t)?r.getPropertyValue(t):r[t])||0;return"string"==typeof a?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:t}){return e3(e,t)}build(e,t,r){rP(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return rF(e,t,r)}}let rU=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),rV={offset:"stroke-dashoffset",array:"stroke-dasharray"},rz={offset:"strokeDashoffset",array:"strokeDasharray"};function rH(e,{attrX:t,attrY:r,attrScale:a,pathLength:s,pathSpacing:n=1,pathOffset:i=0,...o},l,c,d){if(rP(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:h,style:u}=e;h.transform&&(u.transform=h.transform,delete h.transform),(u.transform||h.transformOrigin)&&(u.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),u.transform&&(u.transformBox=d?.transformBox??"fill-box",delete h.transformBox),void 0!==t&&(h.x=t),void 0!==r&&(h.y=r),void 0!==a&&(h.scale=a),void 0!==s&&function(e,t,r=1,a=0,s=!0){e.pathLength=1;let n=s?rV:rz;e[n.offset]=ts.transform(-a);let i=ts.transform(t),o=ts.transform(r);e[n.array]=`${i} ${o}`}(h,s,n,i,!1)}let rW=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),r$=e=>"string"==typeof e&&"svg"===e.toLowerCase();function rG(e,t,r){let a=rF(e,t,r);for(let r in e)(re(e[r])||re(t[r]))&&(a[-1!==eR.indexOf(r)?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r]=e[r]);return a}class rq extends rR{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=rf}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(eO.has(t)){let e=t6(t);return e&&e.default||0}return t=rW.has(t)?t:rU(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return rG(e,t,r)}build(e,t,r){rH(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,a){for(let r in rI(e,t,void 0,a),t.attrs)e.setAttribute(rW.has(r)?r:rU(r),t.attrs[r])}mount(e){this.isSVGTag=r$(e.tagName),super.mount(e)}}let rY=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function rX(e){if("string"!=typeof e||e.includes("-"));else if(rY.indexOf(e)>-1||/[A-Z]/u.test(e))return!0;return!1}let rK=(0,U.createContext)({}),rQ=(0,U.createContext)({strict:!1}),rJ=(0,U.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),rZ=(0,U.createContext)({});function r0(e){return Array.isArray(e)?e.join(" "):e}let r1=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function r2(e,t,r){for(let a in t)re(t[a])||rM(a,r)||(e[a]=t[a])}let r5=()=>({...r1(),attrs:{}}),r4=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function r3(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||r4.has(e)}let r6=e=>!r3(e);try{n=(()=>{let e=Error("Cannot find module '@emotion/is-prop-valid'");throw e.code="MODULE_NOT_FOUND",e})().default,"function"==typeof n&&(r6=e=>e.startsWith("on")?!r3(e):n(e))}catch{}let r8=(0,U.createContext)(null);function r7(e){return re(e)?e.get():e}let r9=e=>(t,r)=>{let a,s=(0,U.useContext)(rZ),n=(0,U.useContext)(r8),i=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t},r,a,s){return{latestValues:function(e,t,r,a){let s={},n=a(e,{});for(let e in n)s[e]=r7(n[e]);let{initial:i,animate:o}=e,l=rk(e),c=rE(e);t&&c&&!l&&!1!==e.inherit&&(void 0===i&&(i=t.initial),void 0===o&&(o=t.animate));let d=!!r&&!1===r.initial,h=(d=d||!1===i)?o:i;if(h&&"boolean"!=typeof h&&!rv(h)){let t=Array.isArray(h)?h:[h];for(let r=0;r<t.length;r++){let a=rT(e,t[r]);if(a){let{transitionEnd:e,transition:t,...r}=a;for(let e in r){let t=r[e];if(Array.isArray(t)){let e=d?t.length-1:0;t=t[e]}null!==t&&(s[e]=t)}for(let t in e)s[t]=e[t]}}}return s}(r,a,s,e),renderState:t()}})(e,t,s,n);return r?i():(null===(a=(0,U.useRef)(null)).current&&(a.current=i()),a.current)},ae=r9({scrapeMotionValuesFromProps:rF,createRenderState:r1}),at=r9({scrapeMotionValuesFromProps:rG,createRenderState:r5}),ar=Symbol.for("motionComponentSymbol");function aa(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}let as="data-"+rU("framerAppearId"),an=(0,U.createContext)({}),ai=rg?U.useLayoutEffect:U.useEffect;function ao(e,{forwardMotionProps:t=!1}={},r,a){r&&function(e){for(let t in e)rh[t]={...rh[t],...e[t]}}(r);let s=rX(e)?at:ae;function n(r,n){var i;let o,l={...(0,U.useContext)(rJ),...r,layoutId:function({layoutId:e}){let t=(0,U.useContext)(rK).id;return t&&void 0!==e?t+"-"+e:e}(r)},{isStatic:c}=l,d=function(e){let{initial:t,animate:r}=function(e,t){if(rk(e)){let{initial:t,animate:r}=e;return{initial:!1===t||rw(t)?t:void 0,animate:rw(r)?r:void 0}}return!1!==e.inherit?t:{}}(e,(0,U.useContext)(rZ));return(0,U.useMemo)(()=>({initial:t,animate:r}),[r0(t),r0(r)])}(r),h=s(r,c);if(!c&&rg){(0,U.useContext)(rQ).strict;let t=function(e){let{drag:t,layout:r}=rh;if(!t&&!r)return{};let a={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}(l);o=t.MeasureLayout,d.visualElement=function(e,t,r,a,s){let{visualElement:n}=(0,U.useContext)(rZ),i=(0,U.useContext)(rQ),o=(0,U.useContext)(r8),l=(0,U.useContext)(rJ).reducedMotion,c=(0,U.useRef)(null);a=a||i.renderer,!c.current&&a&&(c.current=a(e,{visualState:t,parent:n,props:r,presenceContext:o,blockInitialAnimation:!!o&&!1===o.initial,reducedMotionConfig:l}));let d=c.current,h=(0,U.useContext)(an);d&&!d.projection&&s&&("html"===d.type||"svg"===d.type)&&function(e,t,r,a){let{layoutId:s,layout:n,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:function e(t){if(t)return!1!==t.options.allowProjection?t.projection:e(t.parent)}(e.parent)),e.projection.setOptions({layoutId:s,layout:n,alwaysMeasureLayout:!!i||o&&aa(o),visualElement:e,animationType:"string"==typeof n?n:"both",initialPromotionConfig:a,crossfade:d,layoutScroll:l,layoutRoot:c})}(c.current,r,s,h);let u=(0,U.useRef)(!1);(0,U.useInsertionEffect)(()=>{d&&u.current&&d.update(r,o)});let m=r[as],p=(0,U.useRef)(!!m&&!window.MotionHandoffIsComplete?.(m)&&window.MotionHasOptimisedAnimation?.(m));return ai(()=>{d&&(u.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),p.current&&d.animationState&&d.animationState.animateChanges())}),(0,U.useEffect)(()=>{d&&(!p.current&&d.animationState&&d.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(m)}),p.current=!1),d.enteringChildren=void 0)}),d}(e,h,l,a,t.ProjectionNode)}return(0,B.jsxs)(rZ.Provider,{value:d,children:[o&&d.visualElement?(0,B.jsx)(o,{visualElement:d.visualElement,...l}):null,function(e,t,r,{latestValues:a},s,n=!1){let i=(rX(e)?function(e,t,r,a){let s=(0,U.useMemo)(()=>{let r=r5();return rH(r,t,r$(a),e.transformTemplate,e.style),{...r.attrs,style:{...r.style}}},[t]);if(e.style){let t={};r2(t,e.style,e),s.style={...t,...s.style}}return s}:function(e,t){let r,a,s={},n=(r=e.style||{},r2(a={},r,e),Object.assign(a,function({transformTemplate:e},t){return(0,U.useMemo)(()=>{let r=r1();return rP(r,t,e),Object.assign({},r.vars,r.style)},[t])}(e,t)),a);return e.drag&&!1!==e.dragListener&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=n,s})(t,a,s,e),o=function(e,t,r){let a={};for(let s in e)("values"!==s||"object"!=typeof e.values)&&(r6(s)||!0===r&&r3(s)||!t&&!r3(s)||e.draggable&&s.startsWith("onDrag"))&&(a[s]=e[s]);return a}(t,"string"==typeof e,n),l=e!==U.Fragment?{...o,...i,ref:r}:{},{children:c}=t,d=(0,U.useMemo)(()=>re(c)?c.get():c,[c]);return(0,U.createElement)(e,{...l,children:d})}(e,r,(i=d.visualElement,(0,U.useCallback)(e=>{e&&h.onMount&&h.onMount(e),i&&(e?i.mount(e):i.unmount()),n&&("function"==typeof n?n(e):aa(n)&&(n.current=e))},[i])),h,c,t)]})}n.displayName=`motion.${"string"==typeof e?e:`create(${e.displayName??e.name??""})`}`;let i=(0,U.forwardRef)(n);return i[ar]=e,i}function al(e,t,r){let a=e.getProps();return rT(a,t,void 0!==r?r:a.custom,e)}function ac(e,t){return e?.[t]??e?.default??e}let ad=e=>Array.isArray(e);function ah(e,t){let r=e.getValue("willChange");if(re(r)&&r.add)return r.add(t);if(!r&&tv.WillChange){let r=new tv.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function au(e){e.duration=0,e.type="keyframes"}let am=(e,t)=>r=>t(e(r)),ap=(...e)=>e.reduce(am),af=e=>1e3*e,ag={layout:0,mainThread:0,waapi:0};function ax(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function ab(e,t){return r=>r>0?t:e}let ay=(e,t,r)=>{let a=e*e,s=r*(t*t-a)+a;return s<0?0:Math.sqrt(s)},av=[tV,tU,tz];function aw(e){let t=av.find(t=>t.test(e));if(tu(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!t)return!1;let r=t.parse(e);return t===tz&&(r=function({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,r/=100;let s=0,n=0,i=0;if(t/=100){let a=r<.5?r*(1+t):r+t-r*t,o=2*r-a;s=ax(o,a,e+1/3),n=ax(o,a,e),i=ax(o,a,e-1/3)}else s=n=i=r;return{red:Math.round(255*s),green:Math.round(255*n),blue:Math.round(255*i),alpha:a}}(r)),r}let aN=(e,t)=>{let r=aw(e),a=aw(t);if(!r||!a)return ab(e,t);let s={...r};return e=>(s.red=ay(r.red,a.red,e),s.green=ay(r.green,a.green,e),s.blue=ay(r.blue,a.blue,e),s.alpha=eY(r.alpha,a.alpha,e),tU.transform(s))},aj=new Set(["none","hidden"]);function ak(e,t){return r=>eY(e,t,r)}function aE(e){return"number"==typeof e?ak:"string"==typeof e?e$(e)?ab:tH.test(e)?aN:aC:Array.isArray(e)?aS:"object"==typeof e?tH.test(e)?aN:aT:ab}function aS(e,t){let r=[...e],a=r.length,s=e.map((e,r)=>aE(e)(e,t[r]));return e=>{for(let t=0;t<a;t++)r[t]=s[t](e);return r}}function aT(e,t){let r={...e,...t},a={};for(let s in r)void 0!==e[s]&&void 0!==t[s]&&(a[s]=aE(e[s])(e[s],t[s]));return e=>{for(let t in a)r[t]=a[t](e);return r}}let aC=(e,t)=>{let r=tJ.createTransformer(t),a=tY(e),s=tY(t);if(!(a.indexes.var.length===s.indexes.var.length&&a.indexes.color.length===s.indexes.color.length&&a.indexes.number.length>=s.indexes.number.length))return tu(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),ab(e,t);if(aj.has(e)&&!s.values.length||aj.has(t)&&!a.values.length)return aj.has(e)?r=>r<=0?e:t:r=>r>=1?t:e;return ap(aS(function(e,t){let r=[],a={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){let n=t.types[s],i=e.indexes[n][a[n]],o=e.values[i]??0;r[s]=o,a[n]++}return r}(a,s),s.values),r)};function aA(e,t,r){return"number"==typeof e&&"number"==typeof t&&"number"==typeof r?eY(e,t,r):aE(e)(e,t)}let aR=e=>{let t=({timestamp:t})=>e(t);return{start:(e=!0)=>tj.update(t,e),stop:()=>tk(t),now:()=>tE.isProcessing?tE.timestamp:rr.now()}},aO=(e,t,r=10)=>{let a="",s=Math.max(Math.round(t/r),2);for(let t=0;t<s;t++)a+=Math.round(1e4*e(t/(s-1)))/1e4+", ";return`linear(${a.substring(0,a.length-2)})`};function a_(e){let t=0,r=e.next(t);for(;!r.done&&t<2e4;)t+=50,r=e.next(t);return t>=2e4?1/0:t}function aD(e,t,r){var a,s;let n=Math.max(t-5,0);return a=r-e(n),(s=t-n)?1e3/s*a:0}let aP=.01,aI=2,aL=.005,aM=.5;function aF(e,t){return e*Math.sqrt(1-t*t)}let aB=["duration","bounce"],aU=["stiffness","damping","mass"];function aV(e,t){return t.some(t=>void 0!==e[t])}function az(e=.3,t=.3){let r,a="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e,{restSpeed:s,restDelta:n}=a,i=a.keyframes[0],o=a.keyframes[a.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:d,mass:h,duration:u,velocity:m,isResolvedFromDuration:p}=function(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!aV(e,aU)&&aV(e,aB))if(e.visualDuration){let r=2*Math.PI/(1.2*e.visualDuration),a=r*r,s=2*e8(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:1,stiffness:a,damping:s}}else{let r=function({duration:e=800,bounce:t=.3,velocity:r=0,mass:a=1}){let s,n;tu(e<=af(10),"Spring duration must be 10 seconds or less","spring-duration-limit");let i=1-t;i=e8(.05,1,i),e=e8(.01,10,e/1e3),i<1?(s=t=>{let a=t*i,s=a*e;return .001-(a-r)/aF(t,i)*Math.exp(-s)},n=t=>{let a=t*i*e,n=Math.pow(i,2)*Math.pow(t,2)*e,o=Math.exp(-a),l=aF(Math.pow(t,2),i);return(a*r+r-n)*o*(-s(t)+.001>0?-1:1)/l}):(s=t=>-.001+Math.exp(-t*e)*((t-r)*e+1),n=t=>e*e*(r-t)*Math.exp(-t*e));let o=function(e,t,r){let a=r;for(let r=1;r<12;r++)a-=e(a)/t(a);return a}(s,n,5/e);if(e=af(e),isNaN(o))return{stiffness:100,damping:10,duration:e};{let t=Math.pow(o,2)*a;return{stiffness:t,damping:2*i*Math.sqrt(a*t),duration:e}}}(e);(t={...t,...r,mass:1}).isResolvedFromDuration=!0}return t}({...a,velocity:-((a.velocity||0)/1e3)}),f=m||0,g=d/(2*Math.sqrt(c*h)),x=o-i,b=Math.sqrt(c/h)/1e3,y=5>Math.abs(x);if(s||(s=y?aP:aI),n||(n=y?aL:aM),g<1){let e=aF(b,g);r=t=>o-Math.exp(-g*b*t)*((f+g*b*x)/e*Math.sin(e*t)+x*Math.cos(e*t))}else if(1===g)r=e=>o-Math.exp(-b*e)*(x+(f+b*x)*e);else{let e=b*Math.sqrt(g*g-1);r=t=>{let r=Math.exp(-g*b*t),a=Math.min(e*t,300);return o-r*((f+g*b*x)*Math.sinh(a)+e*x*Math.cosh(a))/e}}let v={calculatedDuration:p&&u||null,next:e=>{let t=r(e);if(p)l.done=e>=u;else{let a=0===e?f:0;g<1&&(a=0===e?af(f):aD(r,e,t));let i=Math.abs(o-t)<=n;l.done=Math.abs(a)<=s&&i}return l.value=l.done?o:t,l},toString:()=>{let e=Math.min(a_(v),2e4),t=aO(t=>v.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return v}function aH({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:s=10,bounceStiffness:n=500,modifyTarget:i,min:o,max:l,restDelta:c=.5,restSpeed:d}){let h,u,m=e[0],p={done:!1,value:m},f=r*t,g=m+f,x=void 0===i?g:i(g);x!==g&&(f=x-m);let b=e=>-f*Math.exp(-e/a),y=e=>x+b(e),v=e=>{let t=b(e),r=y(e);p.done=Math.abs(t)<=c,p.value=p.done?x:r},w=e=>{let t;if(t=p.value,void 0!==o&&t<o||void 0!==l&&t>l){var r;h=e,u=az({keyframes:[p.value,(r=p.value,void 0===o?l:void 0===l||Math.abs(o-r)<Math.abs(l-r)?o:l)],velocity:aD(y,e,p.value),damping:s,stiffness:n,restDelta:c,restSpeed:d})}};return w(0),{calculatedDuration:null,next:e=>{let t=!1;return(u||void 0!==h||(t=!0,v(e),w(e)),void 0!==h&&e>=h)?u.next(e-h):(t||v(e),p)}}}az.applyToOptions=e=>{let t=function(e,t=100,r){let a=r({...e,keyframes:[0,t]}),s=Math.min(a_(a),2e4);return{type:"keyframes",ease:e=>a.next(s*e).value/t,duration:s/1e3}}(e,100,az);return e.ease=t.ease,e.duration=af(t.duration),e.type="keyframes",e};let aW=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e;function a$(e,t,r,a){return e===t&&r===a?ty:s=>0===s||1===s?s:aW(function(e,t,r,a,s){let n,i,o=0;do(n=aW(i=t+(r-t)/2,a,s)-e)>0?r=i:t=i;while(Math.abs(n)>1e-7&&++o<12)return i}(s,0,1,e,r),t,a)}let aG=a$(.42,0,1,1),aq=a$(0,0,.58,1),aY=a$(.42,0,.58,1),aX=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,aK=e=>t=>1-e(1-t),aQ=a$(.33,1.53,.69,.99),aJ=aK(aQ),aZ=aX(aJ),a0=e=>(e*=2)<1?.5*aJ(e):.5*(2-Math.pow(2,-10*(e-1))),a1=e=>1-Math.sin(Math.acos(e)),a2=aK(a1),a5=aX(a1),a4=e=>Array.isArray(e)&&"number"==typeof e[0],a3={linear:ty,easeIn:aG,easeInOut:aY,easeOut:aq,circIn:a1,circInOut:a5,circOut:a2,backIn:aJ,backInOut:aZ,backOut:aQ,anticipate:a0},a6=e=>{if(a4(e)){tm(4===e.length,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");let[t,r,a,s]=e;return a$(t,r,a,s)}return"string"==typeof e?(tm(void 0!==a3[e],`Invalid easing type '${e}'`,"invalid-easing-type"),a3[e]):e},a8=(e,t,r)=>{let a=t-e;return 0===a?1:(r-e)/a};function a7({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){var s;let n,i=Array.isArray(a)&&"number"!=typeof a[0]?a.map(a6):a6(a),o={done:!1,value:t[0]},l=function(e,t,{clamp:r=!0,ease:a,mixer:s}={}){let n=e.length;if(tm(n===t.length,"Both input and output ranges must be the same length","range-length"),1===n)return()=>t[0];if(2===n&&t[0]===t[1])return()=>t[1];let i=e[0]===e[1];e[0]>e[n-1]&&(e=[...e].reverse(),t=[...t].reverse());let o=function(e,t,r){let a=[],s=r||tv.mix||aA,n=e.length-1;for(let r=0;r<n;r++){let n=s(e[r],e[r+1]);t&&(n=ap(Array.isArray(t)?t[r]||ty:t,n)),a.push(n)}return a}(t,a,s),l=o.length,c=r=>{if(i&&r<e[0])return t[0];let a=0;if(l>1)for(;a<e.length-2&&!(r<e[a+1]);a++);let s=a8(e[a],e[a+1],r);return o[a](s)};return r?t=>c(e8(e[0],e[n-1],t)):c}((s=r&&r.length===t.length?r:(!function(e,t){let r=e[e.length-1];for(let a=1;a<=t;a++){let s=a8(0,t,a);e.push(eY(r,1,s))}}(n=[0],t.length-1),n),s.map(t=>t*e)),t,{ease:Array.isArray(i)?i:t.map(()=>i||aY).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(o.value=l(t),o.done=t>=e,o)}}let a9=e=>null!==e;function se(e,{repeat:t,repeatType:r="loop"},a,s=1){let n=e.filter(a9),i=s<0||t&&"loop"!==r&&t%2==1?0:n.length-1;return i&&void 0!==a?a:n[i]}let st={decay:aH,inertia:aH,tween:a7,keyframes:a7,spring:az};function sr(e){"string"==typeof e.type&&(e.type=st[e.type])}class sa{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}let ss=e=>e/100;class sn extends sa{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{let{motionValue:e}=this.options;e&&e.updatedAt!==rr.now()&&this.tick(rr.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},ag.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){let{options:e}=this;sr(e);let{type:t=a7,repeat:r=0,repeatDelay:a=0,repeatType:s,velocity:n=0}=e,{keyframes:i}=e,o=t||a7;o!==a7&&"number"!=typeof i[0]&&(this.mixKeyframes=ap(ss,aA(i[0],i[1])),i=[0,100]);let l=o({...e,keyframes:i});"mirror"===s&&(this.mirroredGenerator=o({...e,keyframes:[...i].reverse(),velocity:-n})),null===l.calculatedDuration&&(l.calculatedDuration=a_(l));let{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+a,this.totalDuration=this.resolvedDuration*(r+1)-a,this.generator=l}updateTime(e){let t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){let{generator:r,totalDuration:a,mixKeyframes:s,mirroredGenerator:n,resolvedDuration:i,calculatedDuration:o}=this;if(null===this.startTime)return r.next(0);let{delay:l=0,keyframes:c,repeat:d,repeatType:h,repeatDelay:u,type:m,onUpdate:p,finalKeyframe:f}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);let g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?g<0:g>a;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=a);let b=this.currentTime,y=r;if(d){let e=Math.min(this.currentTime,a)/i,t=Math.floor(e),r=e%1;!r&&e>=1&&(r=1),1===r&&t--,(t=Math.min(t,d+1))%2&&("reverse"===h?(r=1-r,u&&(r-=u/i)):"mirror"===h&&(y=n)),b=e8(0,1,r)*i}let v=x?{done:!1,value:c[0]}:y.next(b);s&&(v.value=s(v.value));let{done:w}=v;x||null===o||(w=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);let N=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return N&&m!==aH&&(v.value=se(c,this.options,f,this.speed)),p&&p(v.value),N&&this.finish(),v}then(e,t){return this.finished.then(e,t)}get duration(){return this.calculatedDuration/1e3}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+e/1e3}get time(){return this.currentTime/1e3}set time(e){e=af(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(rr.now());let t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=this.currentTime/1e3)}play(){if(this.isStopped)return;let{driver:e=aR,startTime:t}=this.options;this.driver||(this.driver=e(e=>this.tick(e))),this.options.onPlay?.();let r=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=r):null!==this.holdTime?this.startTime=r-this.holdTime:this.startTime||(this.startTime=t??r),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(rr.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,ag.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function si(e){let t;return()=>(void 0===t&&(t=e()),t)}let so=si(()=>void 0!==window.ScrollTimeline),sl={},sc=(r=si(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0}),()=>sl.linearEasing??r()),sd=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,sh={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sd([0,.65,.55,1]),circOut:sd([.55,0,1,.45]),backIn:sd([.31,.01,.66,-.59]),backOut:sd([.33,1.53,.69,.99])};function su(e){return"function"==typeof e&&"applyToOptions"in e}class sm extends sa{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:a,pseudoElement:s,allowFlatten:n=!1,finalKeyframe:i,onComplete:o}=e;this.isPseudoElement=!!s,this.allowFlatten=n,this.options=e,tm("string"!=typeof e.type,'Mini animate() doesn\'t support "type" as a string.',"mini-spring");const l=function({type:e,...t}){return su(e)&&sc()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=function(e,t,r,{delay:a=0,duration:s=300,repeat:n=0,repeatType:i="loop",ease:o="easeOut",times:l}={},c){let d={[t]:r};l&&(d.offset=l);let h=function e(t,r){if(t)return"function"==typeof t?sc()?aO(t,r):"ease-out":a4(t)?sd(t):Array.isArray(t)?t.map(t=>e(t,r)||sh.easeOut):sh[t]}(o,s);Array.isArray(h)&&(d.easing=h);let u={delay:a,duration:s,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:n+1,direction:"reverse"===i?"alternate":"normal"};c&&(u.pseudoElement=c);let m=e.animate(d,u);return m}(t,r,a,l,s),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){let e=se(a,this.options,i,this.speed);this.updateMotionValue?this.updateMotionValue(e):r.startsWith("--")?t.style.setProperty(r,e):t.style[r]=e,this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;let{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){return Number(this.animation.effect?.getComputedTiming?.().duration||0)/1e3}get iterationDuration(){let{delay:e=0}=this.options||{};return this.duration+e/1e3}get time(){return(Number(this.animation.currentTime)||0)/1e3}set time(e){this.finishedTime=null,this.animation.currentTime=af(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){return(this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&so())?(this.animation.timeline=e,ty):t(this)}}let sp={anticipate:a0,backInOut:aZ,circInOut:a5};class sf extends sm{constructor(e){!function(e){"string"==typeof e.ease&&e.ease in sp&&(e.ease=sp[e.ease])}(e),sr(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){let{motionValue:t,onUpdate:r,onComplete:a,element:s,...n}=this.options;if(!t)return;if(void 0!==e)return void t.set(e);let i=new sn({...n,autoplay:!1}),o=af(this.finishedTime??this.time);t.setWithVelocity(i.sample(o-10).value,i.sample(o).value,10),i.stop()}}let sg=(e,t)=>"zIndex"!==t&&!!("number"==typeof e||Array.isArray(e)||"string"==typeof e&&(tJ.test(e)||"0"===e)&&!e.startsWith("url(")),sx=new Set(["opacity","clipPath","filter","transform"]),sb=si(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class sy extends sa{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:a=0,repeatDelay:s=0,repeatType:n="loop",keyframes:i,name:o,motionValue:l,element:c,...d}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=rr.now();const h={autoplay:e,delay:t,type:r,repeat:a,repeatDelay:s,repeatType:n,name:o,motionValue:l,element:c,...d},u=c?.KeyframeResolver||tD;this.keyframeResolver=new u(i,(e,t,r)=>this.onKeyframesResolved(e,t,h,!r),o,l,c),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,t,r,a){this.keyframeResolver=void 0;let{name:s,type:n,velocity:i,delay:o,isHandoff:l,onUpdate:c}=r;this.resolvedAt=rr.now(),!function(e,t,r,a){let s=e[0];if(null===s)return!1;if("display"===t||"visibility"===t)return!0;let n=e[e.length-1],i=sg(s,t),o=sg(n,t);return tu(i===o,`You are trying to animate ${t} from "${s}" to "${n}". "${i?n:s}" is not an animatable value.`,"value-not-animatable"),!!i&&!!o&&(function(e){let t=e[0];if(1===e.length)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}(e)||("spring"===r||su(r))&&a)}(e,s,n,i)&&((tv.instantAnimations||!o)&&c?.(se(e,r,t)),e[0]=e[e.length-1],au(r),r.repeat=0);let d={startTime:a?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},h=!l&&function(e){let{motionValue:t,name:r,repeatDelay:a,repeatType:s,damping:n,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;let{onUpdate:o,transformTemplate:l}=t.owner.getProps();return sb()&&r&&sx.has(r)&&("transform"!==r||!l)&&!o&&!a&&"mirror"!==s&&0!==n&&"inertia"!==i}(d)?new sf({...d,element:d.motionValue.owner.current}):new sn(d);h.finished.then(()=>this.notifyFinished()).catch(ty),this.pendingTimeline&&(this.stopTimeline=h.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=h}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),tR=!0,t_(),tO(),tR=!1),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}let sv=e=>null!==e,sw={type:"spring",stiffness:500,damping:25,restSpeed:10},sN={type:"keyframes",duration:.8},sj={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},sk=(e,t,r,a={},s,n)=>i=>{let o=ac(a,e)||{},l=o.delay||a.delay||0,{elapsed:c=0}=a;c-=af(l);let d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:n?void 0:s};!function({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:s,repeat:n,repeatType:i,repeatDelay:o,from:l,elapsed:c,...d}){return!!Object.keys(d).length}(o)&&Object.assign(d,((e,{keyframes:t})=>t.length>2?sN:eO.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:sw:sj)(e,d)),d.duration&&(d.duration=af(d.duration)),d.repeatDelay&&(d.repeatDelay=af(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let h=!1;if(!1!==d.type&&(0!==d.duration||d.repeatDelay)||(au(d),0===d.delay&&(h=!0)),(tv.instantAnimations||tv.skipAnimations)&&(h=!0,au(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,h&&!n&&void 0!==t.get()){let e=function(e,{repeat:t,repeatType:r="loop"},a){let s=e.filter(sv),n=t&&"loop"!==r&&t%2==1?0:s.length-1;return s[n]}(d.keyframes,o);if(void 0!==e)return void tj.update(()=>{d.onUpdate(e),d.onComplete()})}return o.isSync?new sn(d):new sy(d)};function sE(e,t,{delay:r=0,transitionOverride:a,type:s}={}){let{transition:n=e.getDefaultTransition(),transitionEnd:i,...o}=t;a&&(n=a);let l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(let t in o){let a=e.getValue(t,e.latestValues[t]??null),s=o[t];if(void 0===s||c&&function({protectedKeys:e,needsAnimating:t},r){let a=e.hasOwnProperty(r)&&!0!==t[r];return t[r]=!1,a}(c,t))continue;let i={delay:r,...ac(n||{},t)},d=a.get();if(void 0!==d&&!a.isAnimating&&!Array.isArray(s)&&s===d&&!i.velocity)continue;let h=!1;if(window.MotionHandoffAnimation){let r=e.props[as];if(r){let e=window.MotionHandoffAnimation(r,t,tj);null!==e&&(i.startTime=e,h=!0)}}ah(e,t),a.start(sk(t,a,s,e.shouldReduceMotion&&e6.has(t)?{type:!1}:i,e,h));let u=a.animation;u&&l.push(u)}return i&&Promise.all(l).then(()=>{tj.update(()=>{i&&function(e,t){let{transitionEnd:r={},transition:a={},...s}=al(e,t)||{};for(let t in s={...s,...r}){var n;let r=ad(n=s[t])?n[n.length-1]||0:n;e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,ro(r))}}(e,i)})}),l}function sS(e,t,r,a=0,s=1){let n=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),i=e.size,o=(i-1)*a;return"function"==typeof r?r(n,i):1===s?n*a:o-n*a}function sT(e,t,r={}){let a=al(e,t,"exit"===r.type?e.presenceContext?.custom:void 0),{transition:s=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(s=r.transitionOverride);let n=a?()=>Promise.all(sE(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(a=0)=>{let{delayChildren:n=0,staggerChildren:i,staggerDirection:o}=s;return function(e,t,r=0,a=0,s=0,n=1,i){let o=[];for(let l of e.variantChildren)l.notify("AnimationStart",t),o.push(sT(l,t,{...i,delay:r+("function"==typeof a?0:a)+sS(e.variantChildren,l,a,s,n)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,a,n,i,o,r)}:()=>Promise.resolve(),{when:o}=s;if(!o)return Promise.all([n(),i(r.delay)]);{let[e,t]="beforeChildren"===o?[n,i]:[i,n];return e().then(()=>t())}}function sC(e,t){if(!Array.isArray(t))return!1;let r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}let sA=rj.length,sR=[...rN].reverse(),sO=rN.length;function s_(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function sD(){return{animate:s_(!0),whileInView:s_(),whileHover:s_(),whileTap:s_(),whileDrag:s_(),whileFocus:s_(),exit:s_()}}class sP{constructor(e){this.isMounted=!1,this.node=e}update(){}}let sI=0,sL={x:!1,y:!1};function sM(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}let sF=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function sB(e){return{point:{x:e.pageX,y:e.pageY}}}function sU(e,t,r,a){return sM(e,t,e=>sF(e)&&r(e,sB(e)),a)}function sV(e){return e.max-e.min}function sz(e,t,r,a=.5){e.origin=a,e.originPoint=eY(t.min,t.max,e.origin),e.scale=sV(r)/sV(t),e.translate=eY(r.min,r.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function sH(e,t,r,a){sz(e.x,t.x,r.x,a?a.originX:void 0),sz(e.y,t.y,r.y,a?a.originY:void 0)}function sW(e,t,r){e.min=r.min+t.min,e.max=e.min+sV(t)}function s$(e,t,r){e.min=t.min-r.min,e.max=e.min+sV(t)}function sG(e,t,r){s$(e.x,t.x,r.x),s$(e.y,t.y,r.y)}function sq(e){return[e("x"),e("y")]}let sY=({current:e})=>e?e.ownerDocument.defaultView:null,sX=(e,t)=>Math.abs(e-t);class sK{constructor(e,t,{transformPagePoint:r,contextWindow:a=window,dragSnapToOrigin:s=!1,distanceThreshold:n=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{var e,t;if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let r=sZ(this.lastMoveEventInfo,this.history),a=null!==this.startEvent,s=(e=r.offset,t={x:0,y:0},Math.sqrt(sX(e.x,t.x)**2+sX(e.y,t.y)**2)>=this.distanceThreshold);if(!a&&!s)return;let{point:n}=r,{timestamp:i}=tE;this.history.push({...n,timestamp:i});let{onStart:o,onMove:l}=this.handlers;a||(o&&o(this.lastMoveEvent,r),this.startEvent=this.lastMoveEvent),l&&l(this.lastMoveEvent,r)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=sQ(t,this.transformPagePoint),tj.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();let{onEnd:r,onSessionEnd:a,resumeAnimation:s}=this.handlers;if(this.dragSnapToOrigin&&s&&s(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let n=sZ("pointercancel"===e.type?this.lastMoveEventInfo:sQ(t,this.transformPagePoint),this.history);this.startEvent&&r&&r(e,n),a&&a(e,n)},!sF(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=n,this.contextWindow=a||window;const i=sQ(sB(e),this.transformPagePoint),{point:o}=i,{timestamp:l}=tE;this.history=[{...o,timestamp:l}];const{onSessionStart:c}=t;c&&c(e,sZ(i,this.history)),this.removeListeners=ap(sU(this.contextWindow,"pointermove",this.handlePointerMove),sU(this.contextWindow,"pointerup",this.handlePointerUp),sU(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),tk(this.updatePoint)}}function sQ(e,t){return t?{point:t(e.point)}:e}function sJ(e,t){return{x:e.x-t.x,y:e.y-t.y}}function sZ({point:e},t){return{point:e,delta:sJ(e,s0(t)),offset:sJ(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null,s=s0(e);for(;r>=0&&(a=e[r],!(s.timestamp-a.timestamp>af(.1)));)r--;if(!a)return{x:0,y:0};let n=(s.timestamp-a.timestamp)/1e3;if(0===n)return{x:0,y:0};let i={x:(s.x-a.x)/n,y:(s.y-a.y)/n};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}(t,.1)}}function s0(e){return e[e.length-1]}function s1(e,t,r){return{min:void 0!==t?e.min+t:void 0,max:void 0!==r?e.max+r-(e.max-e.min):void 0}}function s2(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function s5(e,t,r){return{min:s4(e,t),max:s4(e,r)}}function s4(e,t){return"number"==typeof e?e:e[t]||0}let s3=new WeakMap;class s6{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rf(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){let{presenceContext:a}=this.visualElement;if(a&&!1===a.isPresent)return;let s=e=>{let{dragSnapToOrigin:r}=this.getProps();r?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(sB(e).point)},n=(e,t)=>{let{drag:r,dragPropagation:a,onDragStart:s}=this.getProps();if(r&&!a&&(this.openDragLock&&this.openDragLock(),this.openDragLock=function(e){if("x"===e||"y"===e)if(sL[e])return null;else return sL[e]=!0,()=>{sL[e]=!1};return sL.x||sL.y?null:(sL.x=sL.y=!0,()=>{sL.x=sL.y=!1})}(r),!this.openDragLock))return;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),sq(e=>{let t=this.getAxisMotionValue(e).get()||0;if(ta.test(t)){let{projection:r}=this.visualElement;if(r&&r.layout){let a=r.layout.layoutBox[e];a&&(t=sV(a)*(parseFloat(t)/100))}}this.originPoint[e]=t}),s&&tj.postRender(()=>s(e,t)),ah(this.visualElement,"transform");let{animationState:n}=this.visualElement;n&&n.setActive("whileDrag",!0)},i=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;let{dragPropagation:r,dragDirectionLock:a,onDirectionLock:s,onDrag:n}=this.getProps();if(!r&&!this.openDragLock)return;let{offset:i}=t;if(a&&null===this.currentDirection){this.currentDirection=function(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}(i),null!==this.currentDirection&&s&&s(this.currentDirection);return}this.updateAxis("x",t.point,i),this.updateAxis("y",t.point,i),this.visualElement.render(),n&&n(e,t)},o=(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},l=()=>sq(e=>"paused"===this.getAnimationState(e)&&this.getAxisMotionValue(e).animation?.play()),{dragSnapToOrigin:c}=this.getProps();this.panSession=new sK(e,{onSessionStart:s,onStart:n,onMove:i,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,distanceThreshold:r,contextWindow:sY(this.visualElement)})}stop(e,t){let r=e||this.latestPointerEvent,a=t||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!a||!r)return;let{velocity:n}=a;this.startAnimation(n);let{onDragEnd:i}=this.getProps();i&&tj.postRender(()=>i(r,a))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){let{drag:a}=this.getProps();if(!r||!s8(e,a,this.currentDirection))return;let s=this.getAxisMotionValue(e),n=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(n=function(e,{min:t,max:r},a){return void 0!==t&&e<t?e=a?eY(t,e,a.min):Math.max(e,t):void 0!==r&&e>r&&(e=a?eY(r,e,a.max):Math.min(e,r)),e}(n,this.constraints[e],this.elastic[e])),s.set(n)}resolveConstraints(){let{dragConstraints:e,dragElastic:t}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,a=this.constraints;e&&aa(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&r?this.constraints=function(e,{top:t,left:r,bottom:a,right:s}){return{x:s1(e.x,r,s),y:s1(e.y,t,a)}}(r.layoutBox,e):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:s5(e,"left","right"),y:s5(e,"top","bottom")}}(t),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&sq(e=>{var t,a;let s;!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=(t=r.layoutBox[e],a=this.constraints[e],s={},void 0!==a.min&&(s.min=a.min-t.min),void 0!==a.max&&(s.max=a.max-t.min),s))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!aa(t))return!1;let a=t.current;tm(null!==a,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");let{projection:s}=this.visualElement;if(!s||!s.layout)return!1;let n=function(e,t,r){let a=e3(e,r),{scroll:s}=t;return s&&(e2(a.x,s.offset.x),e2(a.y,s.offset.y)),a}(a,s.root,this.visualElement.getTransformPagePoint()),i=(e=s.layout.layoutBox,{x:s2(e.x,n.x),y:s2(e.y,n.y)});if(r){let e=r(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(i));this.hasMutatedConstraints=!!e,e&&(i=eq(e))}return i}startAnimation(e){let{drag:t,dragMomentum:r,dragElastic:a,dragTransition:s,dragSnapToOrigin:n,onDragTransitionEnd:i}=this.getProps(),o=this.constraints||{};return Promise.all(sq(i=>{if(!s8(i,t,this.currentDirection))return;let l=o&&o[i]||{};n&&(l={min:0,max:0});let c={type:"inertia",velocity:r?e[i]:0,bounceStiffness:a?200:1e6,bounceDamping:a?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...s,...l};return this.startAxisValueAnimation(i,c)})).then(i)}startAxisValueAnimation(e,t){let r=this.getAxisMotionValue(e);return ah(this.visualElement,e),r.start(sk(e,r,0,t,this.visualElement,!1))}stopAnimation(){sq(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){sq(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){let t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps();return r[t]||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){sq(t=>{let{drag:r}=this.getProps();if(!s8(t,r,this.currentDirection))return;let{projection:a}=this.visualElement,s=this.getAxisMotionValue(t);if(a&&a.layout){let{min:r,max:n}=a.layout.layoutBox[t];s.set(e[t]-eY(r,n,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!aa(t)||!r||!this.constraints)return;this.stopAnimation();let a={x:0,y:0};sq(e=>{let t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){var r,s;let n,i,o,l=t.get();a[e]=(r={min:l,max:l},s=this.constraints[e],n=.5,i=sV(r),(o=sV(s))>i?n=a8(s.min,s.max-i,r.min):i>o&&(n=a8(r.min,r.max-o,s.min)),e8(0,1,n))}});let{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),sq(t=>{if(!s8(t,e,null))return;let r=this.getAxisMotionValue(t),{min:s,max:n}=this.constraints[t];r.set(eY(s,n,a[t]))})}addListeners(){if(!this.visualElement.current)return;s3.set(this.visualElement,this);let e=sU(this.visualElement.current,"pointerdown",e=>{let{drag:t,dragListener:r=!0}=this.getProps();t&&r&&this.start(e)}),t=()=>{let{dragConstraints:e}=this.getProps();aa(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",t);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),tj.read(t);let s=sM(window,"resize",()=>this.scalePositionWithinConstraints()),n=r.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(sq(t=>{let r=this.getAxisMotionValue(t);r&&(this.originPoint[t]+=e[t].translate,r.set(r.get()+e[t].translate))}),this.visualElement.render())});return()=>{s(),e(),a(),n&&n()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:a=!1,dragConstraints:s=!1,dragElastic:n=.35,dragMomentum:i=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:a,dragConstraints:s,dragElastic:n,dragMomentum:i}}}function s8(e,t,r){return(!0===t||t===e)&&(null===r||r===e)}let s7=e=>(t,r)=>{e&&tj.postRender(()=>e(t,r))};var s9=U;let ne={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function nt(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let nr={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e)if(!ts.test(e))return e;else e=parseFloat(e);let r=nt(e,t.target.x),a=nt(e,t.target.y);return`${r}% ${a}%`}},na=!1;class ns extends s9.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:a}=this.props,{projection:s}=e;for(let e in ni)rL[e]=ni[e],eH(e)&&(rL[e].isCSSVariable=!0);s&&(t.group&&t.group.add(s),r&&r.register&&a&&r.register(s),na&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),ne.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:r,drag:a,isPresent:s}=this.props,{projection:n}=r;return n&&(n.isPresent=s,na=!0,a||e.layoutDependency!==t||void 0===t||e.isPresent!==s?n.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?n.promote():n.relegate()||tj.postRender(()=>{let e=n.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),rc.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:a}=e;na=!0,a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),r&&r.deregister&&r.deregister(a))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function nn(e){let[t,r]=function(e=!0){let t=(0,U.useContext)(r8);if(null===t)return[!0,null];let{isPresent:r,onExitComplete:a,register:s}=t,n=(0,U.useId)();(0,U.useEffect)(()=>{if(e)return s(n)},[e]);let i=(0,U.useCallback)(()=>e&&a&&a(n),[n,a,e]);return!r&&a?[!1,i]:[!0]}(),a=(0,s9.useContext)(rK);return(0,B.jsx)(ns,{...e,layoutGroup:a,switchLayoutGroup:(0,s9.useContext)(an),isPresent:t,safeToRemove:r})}let ni={borderRadius:{...nr,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:nr,borderTopRightRadius:nr,borderBottomLeftRadius:nr,borderBottomRightRadius:nr,boxShadow:{correct:(e,{treeScale:t,projectionDelta:r})=>{let a=tJ.parse(e);if(a.length>5)return e;let s=tJ.createTransformer(e),n=+("number"!=typeof a[0]),i=r.x.scale*t.x,o=r.y.scale*t.y;a[0+n]/=i,a[1+n]/=o;let l=eY(i,o,.5);return"number"==typeof a[2+n]&&(a[2+n]/=l),"number"==typeof a[3+n]&&(a[3+n]/=l),s(a)}}};function no(e){return"object"==typeof e&&null!==e}function nl(e){return no(e)&&"ownerSVGElement"in e}let nc=(e,t)=>e.depth-t.depth;class nd{constructor(){this.children=[],this.isDirty=!1}add(e){ra(this.children,e),this.isDirty=!0}remove(e){rs(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(nc),this.isDirty=!1,this.children.forEach(e)}}let nh=["TopLeft","TopRight","BottomLeft","BottomRight"],nu=nh.length,nm=e=>"string"==typeof e?parseFloat(e):e,np=e=>"number"==typeof e||ts.test(e);function nf(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let ng=nb(0,.5,a2),nx=nb(.5,.95,ty);function nb(e,t,r){return a=>a<e?0:a>t?1:r(a8(e,t,a))}function ny(e,t){e.min=t.min,e.max=t.max}function nv(e,t){ny(e.x,t.x),ny(e.y,t.y)}function nw(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function nN(e,t,r,a,s){return e-=t,e=a+1/r*(e-a),void 0!==s&&(e=a+1/s*(e-a)),e}function nj(e,t,[r,a,s],n,i){!function(e,t=0,r=1,a=.5,s,n=e,i=e){if(ta.test(t)&&(t=parseFloat(t),t=eY(i.min,i.max,t/100)-i.min),"number"!=typeof t)return;let o=eY(n.min,n.max,a);e===n&&(o-=t),e.min=nN(e.min,t,r,o,s),e.max=nN(e.max,t,r,o,s)}(e,t[r],t[a],t[s],t.scale,n,i)}let nk=["x","scaleX","originX"],nE=["y","scaleY","originY"];function nS(e,t,r,a){nj(e.x,t,nk,r?r.x:void 0,a?a.x:void 0),nj(e.y,t,nE,r?r.y:void 0,a?a.y:void 0)}function nT(e){return 0===e.translate&&1===e.scale}function nC(e){return nT(e.x)&&nT(e.y)}function nA(e,t){return e.min===t.min&&e.max===t.max}function nR(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function nO(e,t){return nR(e.x,t.x)&&nR(e.y,t.y)}function n_(e){return sV(e.x)/sV(e.y)}function nD(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class nP{constructor(){this.members=[]}add(e){ra(this.members,e),e.scheduleRender()}remove(e){if(rs(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t,r=this.members.findIndex(t=>e===t);if(0===r)return!1;for(let e=r;e>=0;e--){let r=this.members[e];if(!1!==r.isPresent){t=r;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:a}=e.options;!1===a&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}let nI=["","X","Y","Z"],nL=0;function nM(e,t,r,a){let{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),a&&(a[e]=0))}function nF({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:s}){return class{constructor(e={},r=t?.()){this.id=nL++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(nV),this.nodes.forEach(nY),this.nodes.forEach(nX),this.nodes.forEach(nz)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=r?r.root||r:this,this.path=r?[...r.path,r]:[],this.parent=r,this.depth=r?r.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new nd)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new rn),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let r=this.eventHandlers.get(e);r&&r.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;this.isSVG=nl(t)&&!(nl(t)&&"svg"===t.tagName),this.instance=t;let{layoutId:r,layout:a,visualElement:s}=this.options;if(s&&!s.current&&s.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||r)&&(this.isLayoutDirty=!0),e){let r,a=0,s=()=>this.root.updateBlockedByResize=!1;tj.read(()=>{a=window.innerWidth}),e(t,()=>{let e=window.innerWidth;if(e!==a){let t,n;a=e,this.root.updateBlockedByResize=!0,r&&r(),t=rr.now(),n=({timestamp:e})=>{let r=e-t;r>=250&&(tk(n),s(r-250))},tj.setup(n,!0),r=()=>tk(n),ne.hasAnimatedSinceResize&&(ne.hasAnimatedSinceResize=!1,this.nodes.forEach(nq))}})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&s&&(r||a)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:r,layout:a})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let n=this.options.transition||s.getDefaultTransition()||n1,{onLayoutAnimationStart:i,onLayoutAnimationComplete:o}=s.getProps(),l=!this.targetLayout||!nO(this.targetLayout,a),c=!t&&r;if(this.options.layoutRoot||this.resumeFrom||c||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);let t={...ac(n,"layout"),onPlay:i,onComplete:o};(s.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,c)}else t||nq(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=a})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),tk(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(nK),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&function e(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;let{visualElement:r}=t.options;if(!r)return;let a=r.props[as];if(window.MotionHasOptimisedAnimation(a,"transform")){let{layout:e,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",tj,!(e||r))}let{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&e(s)}(this),this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:r}=this.options;if(void 0===t&&!r)return;let a=this.getTransformTemplate();this.prevTransformTemplateValue=a?a(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(nW);return}if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(n$);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(nG),this.nodes.forEach(nB),this.nodes.forEach(nU)):this.nodes.forEach(n$),this.clearAllSnapshots();let e=rr.now();tE.delta=e8(0,1e3/60,e-tE.timestamp),tE.timestamp=e,tE.isProcessing=!0,tS.update.process(tE),tS.preRender.process(tE),tS.render.process(tE),tE.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,rc.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(nH),this.sharedNodes.forEach(nQ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,tj.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){tj.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||sV(this.snapshot.measuredBox.x)||sV(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++)this.path[e].updateScroll();let e=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=rf(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){let t=a(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!s)return;let e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!nC(this.projectionDelta),r=this.getTransformTemplate(),a=r?r(this.latestValues,""):void 0,n=a!==this.prevTransformTemplateValue;e&&this.instance&&(t||eQ(this.latestValues)||n)&&(s(this.instance,a),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let r=this.measurePageBox(),a=this.removeElementScroll(r);return e&&(a=this.removeTransform(a)),n4((t=a).x),n4(t.y),{animationId:this.root.animationId,measuredBox:r,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return rf();let t=e.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(n6))){let{scroll:e}=this.root;e&&(e2(t.x,e.offset.x),e2(t.y,e.offset.y))}return t}removeElementScroll(e){let t=rf();if(nv(t,e),this.scroll?.wasRoot)return t;for(let r=0;r<this.path.length;r++){let a=this.path[r],{scroll:s,options:n}=a;a!==this.root&&s&&n.layoutScroll&&(s.wasRoot&&nv(t,e),e2(t.x,s.offset.x),e2(t.y,s.offset.y))}return t}applyTransform(e,t=!1){let r=rf();nv(r,e);for(let e=0;e<this.path.length;e++){let a=this.path[e];!t&&a.options.layoutScroll&&a.scroll&&a!==a.root&&e4(r,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),eQ(a.latestValues)&&e4(r,a.latestValues)}return eQ(this.latestValues)&&e4(r,this.latestValues),r}removeTransform(e){let t=rf();nv(t,e);for(let e=0;e<this.path.length;e++){let r=this.path[e];if(!r.instance||!eQ(r.latestValues))continue;eK(r.latestValues)&&r.updateSnapshot();let a=rf();nv(a,r.measurePageBox()),nS(t,r.latestValues,r.snapshot?r.snapshot.layoutBox:void 0,a)}return eQ(this.latestValues)&&nS(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==tE.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){let t=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=t.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=t.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=t.isSharedProjectionDirty);let r=!!this.resumingFrom||this!==t;if(!(e||r&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;let{layout:a,layoutId:s}=this.options;if(!this.layout||!(a||s))return;this.resolvedRelativeTargetAt=tE.timestamp;let n=this.getClosestProjectingParent();if(n&&this.linkedParentVersion!==n.layoutVersion&&!n.options.layoutRoot&&this.removeRelativeTarget(),this.targetDelta||this.relativeTarget||(n&&n.layout?this.createRelativeTarget(n,this.layout.layoutBox,n.layout.layoutBox):this.removeRelativeTarget()),this.relativeTarget||this.targetDelta){if(this.target||(this.target=rf(),this.targetWithTransforms=rf()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target){var i,o,l;this.forceRelativeParentToResolveTarget(),i=this.target,o=this.relativeTarget,l=this.relativeParent.target,sW(i.x,o.x,l.x),sW(i.y,o.y,l.y)}else this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nv(this.target,this.layout.layoutBox),e1(this.target,this.targetDelta)):nv(this.target,this.layout.layoutBox);this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,n&&!!n.resumingFrom==!!this.resumingFrom&&!n.options.layoutScroll&&n.target&&1!==this.animationProgress?this.createRelativeTarget(n,this.target,n.target):this.relativeParent=this.relativeTarget=void 0)}}getClosestProjectingParent(){if(!(!this.parent||eK(this.parent.latestValues)||eJ(this.parent.latestValues)))if(this.parent.isProjecting())return this.parent;else return this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(e,t,r){this.relativeParent=e,this.linkedParentVersion=e.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rf(),this.relativeTargetOrigin=rf(),sG(this.relativeTargetOrigin,t,r),nv(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){let e=this.getLead(),t=!!this.resumingFrom||this!==e,r=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(r=!1),t&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===tE.timestamp&&(r=!1),r)return;let{layout:a,layoutId:s}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(a||s))return;nv(this.layoutCorrected,this.layout.layoutBox);let n=this.treeScale.x,i=this.treeScale.y;!function(e,t,r,a=!1){let s,n,i=r.length;if(i){t.x=t.y=1;for(let o=0;o<i;o++){n=(s=r[o]).projectionDelta;let{visualElement:i}=s.options;(!i||!i.props.style||"contents"!==i.props.style.display)&&(a&&s.options.layoutScroll&&s.scroll&&s!==s.root&&e4(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),n&&(t.x*=n.x.scale,t.y*=n.y.scale,e1(e,n)),a&&eQ(s.latestValues)&&e4(e,s.latestValues))}t.x<1.0000000000001&&t.x>.999999999999&&(t.x=1),t.y<1.0000000000001&&t.y>.999999999999&&(t.y=1)}}(this.layoutCorrected,this.treeScale,this.path,t),e.layout&&!e.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(e.target=e.layout.layoutBox,e.targetWithTransforms=rf());let{target:o}=e;if(!o){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}this.projectionDelta&&this.prevProjectionDelta?(nw(this.prevProjectionDelta.x,this.projectionDelta.x),nw(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),sH(this.projectionDelta,this.layoutCorrected,o,this.latestValues),this.treeScale.x===n&&this.treeScale.y===i&&nD(this.projectionDelta.x,this.prevProjectionDelta.x)&&nD(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",o))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.visualElement?.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=rm(),this.projectionDelta=rm(),this.projectionDeltaWithTransform=rm()}setAnimationOrigin(e,t=!1){let r,a=this.snapshot,s=a?a.latestValues:{},n={...this.latestValues},i=rm();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let o=rf(),l=(a?a.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,h=!!(l&&!d&&!0===this.options.crossfade&&!this.path.some(n0));this.animationProgress=0,this.mixTargetDelta=t=>{let a=t/1e3;if(nJ(i.x,e.x,a),nJ(i.y,e.y,a),this.setTargetDelta(i),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var c,u,m,p,f,g;sG(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),m=this.relativeTarget,p=this.relativeTargetOrigin,f=o,g=a,nZ(m.x,p.x,f.x,g),nZ(m.y,p.y,f.y,g),r&&(c=this.relativeTarget,u=r,nA(c.x,u.x)&&nA(c.y,u.y))&&(this.isProjectionDirty=!1),r||(r=rf()),nv(r,this.relativeTarget)}l&&(this.animationValues=n,function(e,t,r,a,s,n){s?(e.opacity=eY(0,r.opacity??1,ng(a)),e.opacityExit=eY(t.opacity??1,0,nx(a))):n&&(e.opacity=eY(t.opacity??1,r.opacity??1,a));for(let s=0;s<nu;s++){let n=`border${nh[s]}Radius`,i=nf(t,n),o=nf(r,n);(void 0!==i||void 0!==o)&&(i||(i=0),o||(o=0),0===i||0===o||np(i)===np(o)?(e[n]=Math.max(eY(nm(i),nm(o),a),0),(ta.test(o)||ta.test(i))&&(e[n]+="%")):e[n]=o)}(t.rotate||r.rotate)&&(e.rotate=eY(t.rotate||0,r.rotate||0,a))}(n,s,this.latestValues,a,h,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=a},this.mixTargetDelta(1e3*!!this.options.layoutRoot)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(tk(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=tj.update(()=>{var t,r,a;let s;ne.hasAnimatedSinceResize=!0,ag.layout++,this.motionValue||(this.motionValue=ro(0)),this.currentAnimation=(t=this.motionValue,r=[0,1e3],a={...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{ag.layout--},onComplete:()=>{ag.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}},(s=re(t)?t:ro(t)).start(sk("",s,r,a)),s.animation),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:r,layout:a,latestValues:s}=e;if(t&&r&&a){if(this!==e&&this.layout&&a&&n3(this.options.animationType,this.layout.layoutBox,a.layoutBox)){r=this.target||rf();let t=sV(this.layout.layoutBox.x);r.x.min=e.target.x.min,r.x.max=r.x.min+t;let a=sV(this.layout.layoutBox.y);r.y.min=e.target.y.min,r.y.max=r.y.min+a}nv(t,r),e4(t,s),sH(this.projectionDeltaWithTransform,this.layoutCorrected,t,s)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new nP),this.sharedNodes.get(e).add(t);let r=t.options.initialPromotionConfig;t.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){let{layoutId:e}=this.options;return e&&this.getStack()?.lead||this}getPrevLead(){let{layoutId:e}=this.options;return e?this.getStack()?.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:r}={}){let a=this.getStack();a&&a.promote(this,r),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:r}=e;if((r.z||r.rotate||r.rotateX||r.rotateY||r.rotateZ||r.skewX||r.skewY)&&(t=!0),!t)return;let a={};r.z&&nM("z",e,a,this.animationValues);for(let t=0;t<nI.length;t++)nM(`rotate${nI[t]}`,e,a,this.animationValues),nM(`skew${nI[t]}`,e,a,this.animationValues);for(let t in e.render(),a)e.setStaticValue(t,a[t]),this.animationValues&&(this.animationValues[t]=a[t]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible){e.visibility="hidden";return}let r=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=r7(t?.pointerEvents)||"",e.transform=r?r(this.latestValues,""):"none";return}let a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target){this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=r7(t?.pointerEvents)||""),this.hasProjected&&!eQ(this.latestValues)&&(e.transform=r?r({},""):"none",this.hasProjected=!1);return}e.visibility="";let s=a.animationValues||a.latestValues;this.applyTransformsToTarget();let n=function(e,t,r){let a="",s=e.x.translate/t.x,n=e.y.translate/t.y,i=r?.z||0;if((s||n||i)&&(a=`translate3d(${s}px, ${n}px, ${i}px) `),(1!==t.x||1!==t.y)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){let{transformPerspective:e,rotate:t,rotateX:s,rotateY:n,skewX:i,skewY:o}=r;e&&(a=`perspective(${e}px) ${a}`),t&&(a+=`rotate(${t}deg) `),s&&(a+=`rotateX(${s}deg) `),n&&(a+=`rotateY(${n}deg) `),i&&(a+=`skewX(${i}deg) `),o&&(a+=`skewY(${o}deg) `)}let o=e.x.scale*t.x,l=e.y.scale*t.y;return(1!==o||1!==l)&&(a+=`scale(${o}, ${l})`),a||"none"}(this.projectionDeltaWithTransform,this.treeScale,s);r&&(n=r(s,n)),e.transform=n;let{x:i,y:o}=this.projectionDelta;for(let t in e.transformOrigin=`${100*i.origin}% ${100*o.origin}% 0`,a.animationValues?e.opacity=a===this?s.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:s.opacityExit:e.opacity=a===this?void 0!==s.opacity?s.opacity:"":void 0!==s.opacityExit?s.opacityExit:0,rL){if(void 0===s[t])continue;let{correct:r,applyTo:i,isCSSVariable:o}=rL[t],l="none"===n?s[t]:r(s[t],a);if(i){let t=i.length;for(let r=0;r<t;r++)e[i[r]]=l}else o?this.options.visualElement.renderState.vars[t]=l:e[t]=l}this.options.layoutId&&(e.pointerEvents=a===this?r7(t?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>e.currentAnimation?.stop()),this.root.nodes.forEach(nW),this.root.sharedNodes.clear()}}}function nB(e){e.updateLayout()}function nU(e){let t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){let{layoutBox:r,measuredBox:a}=e.layout,{animationType:s}=e.options,n=t.source!==e.layout.source;"size"===s?sq(e=>{let a=n?t.measuredBox[e]:t.layoutBox[e],s=sV(a);a.min=r[e].min,a.max=a.min+s}):n3(s,t.layoutBox,r)&&sq(a=>{let s=n?t.measuredBox[a]:t.layoutBox[a],i=sV(r[a]);s.max=s.min+i,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[a].max=e.relativeTarget[a].min+i)});let i=rm();sH(i,r,t.layoutBox);let o=rm();n?sH(o,e.applyTransform(a,!0),t.measuredBox):sH(o,r,t.layoutBox);let l=!nC(i),c=!1;if(!e.resumeFrom){let a=e.getClosestProjectingParent();if(a&&!a.resumeFrom){let{snapshot:s,layout:n}=a;if(s&&n){let i=rf();sG(i,t.layoutBox,s.layoutBox);let o=rf();sG(o,r,n.layoutBox),nO(i,o)||(c=!0),a.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=i,e.relativeParent=a)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function nV(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function nz(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function nH(e){e.clearSnapshot()}function nW(e){e.clearMeasurements()}function n$(e){e.isLayoutDirty=!1}function nG(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function nq(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function nY(e){e.resolveTargetDelta()}function nX(e){e.calcProjection()}function nK(e){e.resetSkewAndRotation()}function nQ(e){e.removeLeadSnapshot()}function nJ(e,t,r){e.translate=eY(t.translate,0,r),e.scale=eY(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function nZ(e,t,r,a){e.min=eY(t.min,r.min,a),e.max=eY(t.max,r.max,a)}function n0(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let n1={duration:.45,ease:[.4,0,.1,1]},n2=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),n5=n2("applewebkit/")&&!n2("chrome/")?Math.round:ty;function n4(e){e.min=n5(e.min),e.max=n5(e.max)}function n3(e,t,r){return"position"===e||"preserve-aspect"===e&&!(.2>=Math.abs(n_(t)-n_(r)))}function n6(e){return e!==e.root&&e.scroll?.wasRoot}let n8=nF({attachResizeListener:(e,t)=>sM(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),n7={current:void 0},n9=nF({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!n7.current){let e=new n8({});e.mount(window),e.setOptions({layoutScroll:!0}),n7.current=e}return n7.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});function ie(e,t){let r=function(e,t,r){if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document,r=(void 0)??t.querySelectorAll(e);return r?Array.from(r):[]}return Array.from(e)}(e),a=new AbortController;return[r,{passive:!0,...t,signal:a.signal},()=>a.abort()]}function it(e){return!("touch"===e.pointerType||sL.x||sL.y)}function ir(e,t,r){let{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover","Start"===r);let s=a["onHover"+r];s&&tj.postRender(()=>s(t,sB(t)))}let ia=(e,t)=>!!t&&(e===t||ia(e,t.parentElement)),is=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),ii=new WeakSet;function io(e){return t=>{"Enter"===t.key&&e(t)}}function il(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function ic(e){return sF(e)&&!(sL.x||sL.y)}function id(e,t,r){let{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap","Start"===r);let s=a["onTap"+("End"===r?"":r)];s&&tj.postRender(()=>s(t,sB(t)))}let ih=new WeakMap,iu=new WeakMap,im=e=>{let t=ih.get(e.target);t&&t(e)},ip=e=>{e.forEach(im)},ig={some:0,all:1},ix=function(e,t){if("undefined"==typeof Proxy)return ao;let r=new Map,a=(r,a)=>ao(r,a,e,t);return new Proxy((e,t)=>a(e,t),{get:(s,n)=>"create"===n?a:(r.has(n)||r.set(n,ao(n,void 0,e,t)),r.get(n))})}({animation:{Feature:class extends sP{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:r})=>(function(e,t,r={}){let a;if(e.notify("AnimationStart",t),Array.isArray(t))a=Promise.all(t.map(t=>sT(e,t,r)));else if("string"==typeof t)a=sT(e,t,r);else{let s="function"==typeof t?al(e,t,r.custom):t;a=Promise.all(sE(e,s,r))}return a.then(()=>{e.notify("AnimationComplete",t)})})(e,t,r))),r=sD(),a=!0,s=t=>(r,a)=>{let s=al(e,a,"exit"===t?e.presenceContext?.custom:void 0);if(s){let{transition:e,transitionEnd:t,...a}=s;r={...r,...a,...t}}return r};function n(n){let{props:i}=e,o=function e(t){if(!t)return;if(!t.isControllingVariants){let r=t.parent&&e(t.parent)||{};return void 0!==t.props.initial&&(r.initial=t.props.initial),r}let r={};for(let e=0;e<sA;e++){let a=rj[e],s=t.props[a];(rw(s)||!1===s)&&(r[a]=s)}return r}(e.parent)||{},l=[],c=new Set,d={},h=1/0;for(let t=0;t<sO;t++){var u,m;let p=sR[t],f=r[p],g=void 0!==i[p]?i[p]:o[p],x=rw(g),b=p===n?f.isActive:null;!1===b&&(h=t);let y=g===o[p]&&g!==i[p]&&x;if(y&&a&&e.manuallyAnimateOnMount&&(y=!1),f.protectedKeys={...d},!f.isActive&&null===b||!g&&!f.prevProp||rv(g)||"boolean"==typeof g)continue;let v=(u=f.prevProp,"string"==typeof(m=g)?m!==u:!!Array.isArray(m)&&!sC(m,u)),w=v||p===n&&f.isActive&&!y&&x||t>h&&x,N=!1,j=Array.isArray(g)?g:[g],k=j.reduce(s(p),{});!1===b&&(k={});let{prevResolvedValues:E={}}=f,S={...E,...k},T=t=>{w=!0,c.has(t)&&(N=!0,c.delete(t)),f.needsAnimating[t]=!0;let r=e.getValue(t);r&&(r.liveStyle=!1)};for(let e in S){let t=k[e],r=E[e];if(!d.hasOwnProperty(e))(ad(t)&&ad(r)?sC(t,r):t===r)?void 0!==t&&c.has(e)?T(e):f.protectedKeys[e]=!0:null!=t?T(e):c.add(e)}f.prevProp=g,f.prevResolvedValues=k,f.isActive&&(d={...d,...k}),a&&e.blockInitialAnimation&&(w=!1);let C=y&&v,A=!C||N;w&&A&&l.push(...j.map(t=>{let r={type:p};if("string"==typeof t&&a&&!C&&e.manuallyAnimateOnMount&&e.parent){let{parent:a}=e,s=al(a,t);if(a.enteringChildren&&s){let{delayChildren:t}=s.transition||{};r.delay=sS(a.enteringChildren,e,t)}}return{animation:t,options:r}}))}if(c.size){let t={};if("boolean"!=typeof i.initial){let r=al(e,Array.isArray(i.initial)?i.initial[0]:i.initial);r&&r.transition&&(t.transition=r.transition)}c.forEach(r=>{let a=e.getBaseTarget(r),s=e.getValue(r);s&&(s.liveStyle=!0),t[r]=a??null}),l.push({animation:t})}let p=!!l.length;return a&&(!1===i.initial||i.initial===i.animate)&&!e.manuallyAnimateOnMount&&(p=!1),a=!1,p?t(l):Promise.resolve()}return{animateChanges:n,setActive:function(t,a){if(r[t].isActive===a)return Promise.resolve();e.variantChildren?.forEach(e=>e.animationState?.setActive(t,a)),r[t].isActive=a;let s=n(t);for(let e in r)r[e].protectedKeys={};return s},setAnimateFunction:function(r){t=r(e)},getState:()=>r,reset:()=>{r=sD()}}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();rv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}},exit:{Feature:class extends sP{constructor(){super(...arguments),this.id=sI++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;let a=this.node.animationState.setActive("exit",!e);t&&!e&&a.then(()=>{t(this.id)})}mount(){let{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}},inView:{Feature:class extends sP{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){var e;let t;this.unmount();let{viewport:r={}}=this.node.getProps(),{root:a,margin:s,amount:n="some",once:i}=r,o={root:a?a.current:void 0,rootMargin:s,threshold:"number"==typeof n?n:ig[n]},l=e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,i&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:r,onViewportLeave:a}=this.node.getProps(),s=t?r:a;s&&s(e)};return e=this.node.current,t=function({root:e,...t}){let r=e||document;iu.has(r)||iu.set(r,{});let a=iu.get(r),s=JSON.stringify(t);return a[s]||(a[s]=new IntersectionObserver(ip,{root:e,...t})),a[s]}(o),ih.set(e,l),t.observe(e),()=>{ih.delete(e),t.unobserve(e)}}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends sP{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){let[a,s,n]=ie(e,r),i=e=>{let a=e.currentTarget;if(!ic(e))return;ii.add(a);let n=t(a,e),i=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),ii.has(a)&&ii.delete(a),ic(e)&&"function"==typeof n&&n(e,{success:t})},o=e=>{i(e,a===window||a===document||r.useGlobalTarget||ia(a,e.target))},l=e=>{i(e,!1)};window.addEventListener("pointerup",o,s),window.addEventListener("pointercancel",l,s)};return a.forEach(e=>{(r.useGlobalTarget?window:e).addEventListener("pointerdown",i,s),no(e)&&"offsetHeight"in e&&(e.addEventListener("focus",e=>((e,t)=>{let r=e.currentTarget;if(!r)return;let a=io(()=>{if(ii.has(r))return;il(r,"down");let e=io(()=>{il(r,"up")});r.addEventListener("keyup",e,t),r.addEventListener("blur",()=>il(r,"cancel"),t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)})(e,s)),is.has(e.tagName)||-1!==e.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),n}(e,(e,t)=>(id(this.node,t,"Start"),(e,{success:t})=>id(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends sP{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ap(sM(this.node.current,"focus",()=>this.onFocus()),sM(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends sP{mount(){let{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){let[a,s,n]=ie(e,r),i=e=>{if(!it(e))return;let{target:r}=e,a=t(r,e);if("function"!=typeof a||!r)return;let n=e=>{it(e)&&(a(e),r.removeEventListener("pointerleave",n))};r.addEventListener("pointerleave",n,s)};return a.forEach(e=>{e.addEventListener("pointerenter",i,s)}),n}(e,(e,t)=>(ir(this.node,t,"Start"),e=>ir(this.node,e,"End"))))}unmount(){}}},pan:{Feature:class extends sP{constructor(){super(...arguments),this.removePointerDownListener=ty}onPointerDown(e){this.session=new sK(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:sY(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:a}=this.node.getProps();return{onSessionStart:s7(e),onStart:s7(t),onMove:r,onEnd:(e,t)=>{delete this.session,a&&tj.postRender(()=>a(e,t))}}}mount(){this.removePointerDownListener=sU(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends sP{constructor(e){super(e),this.removeGroupControls=ty,this.removeListeners=ty,this.controls=new s6(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ty}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:n9,MeasureLayout:nn},layout:{ProjectionNode:n9,MeasureLayout:nn}},(e,t)=>rX(e)?new rq(t):new rB(t,{allowProjection:e!==U.Fragment}));var ib=e.i(10504),iy=e.i(8152);function iv({onSuccess:e}){let{theme:t}=(0,z.useTheme)(),[r,a]=(0,U.useState)(null),[s,n]=(0,U.useState)("loading"),[i,o]=(0,U.useState)("Iniciando vinculación..."),[l,c]=(0,U.useState)(!1),d=(0,U.useRef)(null),h=(0,U.useRef)(!1),u=(0,U.useCallback)(()=>{h.current||(h.current=!0,d.current&&(clearInterval(d.current),d.current=null),ea.toast.success("✅ WhatsApp vinculado correctamente"),setTimeout(()=>e(),500))},[e]),m=(0,U.useCallback)(async()=>{try{let e=await er.api.whatsapp.status();e.data?.connected&&(console.log("[VincularQR] Estado conectado detectado por polling"),n("connected"),o("Vinculación exitosa"),u())}catch(e){}},[u]),p=(0,U.useCallback)(()=>{d.current&&clearInterval(d.current),console.log("[VincularQR] Iniciando polling de estado..."),m(),d.current=setInterval(()=>{m()},3e3)},[m]),f=(0,U.useCallback)(async()=>{try{console.log("[VincularQR] Solicitando QR..."),n("loading"),o("Generando código QR...");let e=await er.api.whatsapp.qr();if(e.data?.connected){console.log("[VincularQR] Ya está conectado"),u();return}e.data?.qr?(a(e.data.qr),n("scanning"),o("📱 Escanea este código QR con WhatsApp")):e.data?.initializing?o("⏳ Inicializando cliente de WhatsApp..."):o("⏳ Esperando código QR...")}catch(e){console.error("[VincularQR] Error obteniendo QR:",e),n("error"),o("Error al generar código QR"),ea.toast.error("No se pudo obtener el código QR")}},[u]),g=async()=>{try{c(!0),a(null),o("Generando nuevo código QR..."),await er.api.whatsapp.relink(),ea.toast.success("Solicitando nuevo código QR..."),setTimeout(()=>{l&&(c(!1),console.warn("[VincularQR] Timeout esperando nuevo QR"))},1e4)}catch(e){console.error("[VincularQR] Error en relink:",e),ea.toast.error("No se pudo refrescar el código QR"),c(!1)}};return(0,U.useEffect)(()=>{console.log("[VincularQR] Montando componente...");let e=(0,iy.connectSocket)(),t=e=>{console.log("[VincularQR] Socket: 'qr' recibido"),a(e),n("scanning"),o("📱 Escanea este código QR con WhatsApp")},s=()=>{console.log("[VincularQR] Socket: 'ready' recibido"),n("connected"),o("Vinculación exitosa"),u()},i=()=>{console.log("[VincularQR] Socket: 'authenticated' recibido"),n("connected"),o("Vinculación exitosa"),u()},l=()=>{console.log("[VincularQR] Socket: 'qr_refresh' o 'qr_expired' recibido"),a(null),o("♻️ Generando nuevo código QR..."),n("loading"),f()},c=()=>{console.log("[VincularQR] Socket: 'logout_success' recibido"),a(null),o("Generando nuevo código QR..."),setTimeout(()=>{f(),p()},1e3)},m=t=>{console.warn("[VincularQR] Socket desconectado:",t),"io server disconnect"===t&&(console.log("[VincularQR] Reconectando..."),e.connect())},g=e=>{console.log("[VincularQR] Socket reconectado después de",e,"intentos"),h.current||r||(console.log("[VincularQR] Refrescando QR después de reconexión"),f())},x=e=>{console.log("[VincularQR] Intento de reconexión:",e),o(`⏳ Reconectando (intento ${e})...`)},b=e=>{console.error("[VincularQR] Error de conexión socket:",e.message)};e.on("qr",t),e.on("ready",s),e.on("authenticated",i),e.on("qr_refresh",l),e.on("qr_expired",l),e.on("logout_success",c),e.on("disconnect",m),e.on("reconnect",g),e.on("reconnect_attempt",x),e.on("connect_error",b);let y=setInterval(()=>{e.connected||h.current||(console.warn("[VincularQR] Socket no conectado, intentando reconectar..."),e.connect())},5e3);return(async()=>{try{let e=await er.api.whatsapp.status();if(e.data?.connected){console.log("[VincularQR] Ya está conectado, navegando..."),u();return}f(),p()}catch(e){console.error("[VincularQR] Error en init:",e),f(),p()}})(),()=>{console.log("[VincularQR] Desmontando componente..."),clearInterval(y),d.current&&(clearInterval(d.current),d.current=null),e.off("qr",t),e.off("ready",s),e.off("authenticated",i),e.off("qr_refresh",l),e.off("qr_expired",l),e.off("logout_success",c),e.off("disconnect",m),e.off("reconnect",g),e.off("reconnect_attempt",x),e.off("connect_error",b)}},[]),(0,B.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] p-6",children:(0,B.jsxs)(ix.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:(0,V.cn)("w-full max-w-md rounded-2xl shadow-2xl p-8 flex flex-col items-center","dark"===t?"bg-gradient-to-br from-gray-900/90 to-gray-800/90 border border-white/10":"bg-gradient-to-br from-white to-gray-50 border border-purple-100"),children:[(0,B.jsxs)("div",{className:"text-center mb-6",children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-2xl font-bold mb-2","dark"===t?"text-white":"text-gray-800"),children:"🔗 Vincular WhatsApp"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===t?"text-gray-400":"text-gray-600"),children:i})]}),(0,B.jsx)("div",{className:"mb-6",children:"loading"===s||l?(0,B.jsxs)("div",{className:"flex flex-col items-center justify-center w-64 h-64",children:[(0,B.jsx)(eT,{className:(0,V.cn)("w-12 h-12 animate-spin","dark"===t?"text-gray-400":"text-gray-500")}),(0,B.jsx)("p",{className:(0,V.cn)("mt-4 text-sm","dark"===t?"text-gray-500":"text-gray-400"),children:"Cargando..."})]}):r?(0,B.jsx)(ix.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},className:"border-4 border-white shadow-xl p-3 bg-white rounded-xl",children:(0,B.jsx)(ib.default,{value:r,size:256})},r):"connected"===s?(0,B.jsxs)("div",{className:"flex flex-col items-center justify-center w-64 h-64",children:[(0,B.jsx)("div",{className:"text-6xl mb-4",children:"✅"}),(0,B.jsx)("p",{className:(0,V.cn)("text-lg font-semibold","dark"===t?"text-green-400":"text-green-600"),children:"Conectado"})]}):(0,B.jsxs)("div",{className:"flex flex-col items-center justify-center w-64 h-64",children:[(0,B.jsx)("div",{className:"text-6xl mb-4",children:"⏳"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===t?"text-gray-500":"text-gray-400"),children:"Esperando código QR..."})]})}),(0,B.jsx)("div",{className:"w-full flex flex-col gap-3",children:(0,B.jsxs)("button",{onClick:g,disabled:l||"connected"===s,className:(0,V.cn)("w-full px-4 py-3 rounded-lg font-semibold transition-all flex items-center justify-center gap-2",l||"connected"===s?"bg-gray-400 cursor-not-allowed text-gray-200":"dark"===t?"bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white shadow-lg":"bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white shadow-lg"),children:[(0,B.jsx)(J.RefreshCw,{className:(0,V.cn)("w-4 h-4",l&&"animate-spin")}),l?"Actualizando...":"♻️ Refrescar código QR"]})}),(0,B.jsxs)("div",{className:(0,V.cn)("mt-6 p-4 rounded-lg text-sm text-center","dark"===t?"bg-white/5 text-gray-400":"bg-purple-50 text-gray-600"),children:[(0,B.jsx)("p",{className:"font-semibold mb-1",children:"Cómo vincular:"}),(0,B.jsxs)("p",{children:["1. Abre WhatsApp en tu teléfono",(0,B.jsx)("br",{}),"2. Ve a ",(0,B.jsx)("strong",{children:"Dispositivos vinculados"}),(0,B.jsx)("br",{}),"3. Escanea este código QR"]})]})]})})}function iw({onDismiss:e,onReconnect:t}){let{theme:r}=(0,z.useTheme)();return(0,B.jsx)("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in-right",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-96 rounded-xl border-2 shadow-2xl p-5 animate-pulse-border","dark"===r?"bg-gradient-to-br from-red-900/90 to-red-800/90 border-red-500 backdrop-blur-md":"bg-gradient-to-br from-red-50 to-orange-50 border-red-400"),children:[(0,B.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2.5 rounded-lg animate-bounce","dark"===r?"bg-red-500/30":"bg-red-200"),children:(0,B.jsx)(ec,{className:(0,V.cn)("w-6 h-6","dark"===r?"text-red-300":"text-red-700")})}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-bold mb-1","dark"===r?"text-red-100":"text-red-900"),children:"⚠️ WhatsApp Desconectado"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===r?"text-red-200":"text-red-800"),children:"Se perdió la conexión con WhatsApp"})]}),(0,B.jsx)("button",{onClick:e,className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"hover:bg-red-700/50 text-red-300":"hover:bg-red-200 text-red-700"),title:"Cerrar notificación",children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-3 rounded-lg mb-4 text-sm","dark"===r?"bg-red-800/50 text-red-100 border border-red-600/50":"bg-white/80 text-red-900 border border-red-300"),children:[(0,B.jsx)("p",{className:"font-medium mb-2",children:"🛑 Tus campañas se han detenido"}),(0,B.jsx)("p",{className:"text-xs opacity-90",children:"Es necesario volver a vincular WhatsApp para reanudar el envío de mensajes. Las campañas en progreso permanecerán pausadas hasta que reconectes."})]}),(0,B.jsxs)("button",{onClick:t,className:(0,V.cn)("w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-semibold transition-all transform hover:scale-[1.02]","dark"===r?"bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 text-white shadow-lg":"bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-600 hover:to-green-600 text-white shadow-lg"),children:[(0,B.jsx)(J.RefreshCw,{className:"w-5 h-5"}),"Vincular WhatsApp Ahora"]}),(0,B.jsxs)("div",{className:"flex items-center justify-center gap-1 mt-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-2 h-2 rounded-full animate-ping","dark"===r?"bg-red-400":"bg-red-600")}),(0,B.jsx)("span",{className:(0,V.cn)("text-[10px] font-medium","dark"===r?"text-red-300":"text-red-700"),children:"Alerta activa - Requiere atención"})]})]})})}var iN=e.i(61351),ij=e.i(33121);let ik=(0,Y.default)("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function iE({count:e,onDismiss:t,onDownload:r}){let{theme:a}=(0,z.useTheme)();return(0,B.jsx)("div",{className:"fixed top-4 right-4 z-[100] animate-slide-in-right",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-96 rounded-xl border-2 shadow-2xl p-5","dark"===a?"bg-gradient-to-br from-yellow-900/90 to-orange-900/90 border-yellow-500 backdrop-blur-md":"bg-gradient-to-br from-yellow-50 to-orange-50 border-yellow-400"),children:[(0,B.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2.5 rounded-lg","dark"===a?"bg-yellow-500/30":"bg-yellow-200"),children:(0,B.jsx)(iN.AlertTriangle,{className:(0,V.cn)("w-6 h-6","dark"===a?"text-yellow-300":"text-yellow-700")})}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-bold mb-1","dark"===a?"text-yellow-100":"text-yellow-900"),children:"⚠️ Contactos Rechazados"}),(0,B.jsxs)("p",{className:(0,V.cn)("text-sm","dark"===a?"text-yellow-200":"text-yellow-800"),children:[e," contacto",1!==e?"s":""," no se ",1!==e?"pudieron":"pudo"," cargar"]})]}),(0,B.jsx)("button",{onClick:t,className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===a?"hover:bg-yellow-700/50 text-yellow-300":"hover:bg-yellow-200 text-yellow-700"),title:"Cerrar notificación",children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-3 rounded-lg mb-4 text-sm","dark"===a?"bg-yellow-800/50 text-yellow-100 border border-yellow-600/50":"bg-white/80 text-yellow-900 border border-yellow-300"),children:[(0,B.jsxs)("p",{className:"font-medium mb-2 flex items-center gap-2",children:[(0,B.jsx)(ik,{className:"w-4 h-4"}),"Motivos comunes:"]}),(0,B.jsxs)("ul",{className:"list-disc list-inside text-xs opacity-90 space-y-1",children:[(0,B.jsx)("li",{children:"Números de teléfono inválidos"}),(0,B.jsx)("li",{children:"Datos obligatorios faltantes"}),(0,B.jsx)("li",{children:"Duplicados en el archivo"})]})]}),(0,B.jsxs)("button",{onClick:r,className:(0,V.cn)("w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-semibold transition-all transform hover:scale-[1.02]","dark"===a?"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white shadow-lg":"bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white shadow-lg"),children:[(0,B.jsx)(ij.Download,{className:"w-5 h-5"}),"Descargar Reporte de Rechazos"]})]})})}function iS({data:e,onDismiss:t}){let{theme:r}=(0,z.useTheme)();return(0,B.jsx)("div",{className:"fixed bottom-4 right-4 z-[100] animate-slide-in-right",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-80 rounded-xl border shadow-2xl p-4","dark"===r?"bg-[#1a1333]/95 border-purple-500/30 backdrop-blur-md":"bg-white/95 border-purple-200"),children:[(0,B.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-1.5 rounded-lg","dark"===r?"bg-purple-500/20":"bg-purple-100"),children:(0,B.jsx)(et.MessageSquare,{className:(0,V.cn)("w-4 h-4","dark"===r?"text-purple-300":"text-purple-600")})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-sm font-semibold","dark"===r?"text-white":"text-gray-900"),children:"Auto-respuesta enviada"}),(0,B.jsx)("p",{className:(0,V.cn)("text-[10px]","dark"===r?"text-gray-400":"text-gray-500"),children:new Date(e.timestamp).toLocaleTimeString()})]})]}),(0,B.jsx)("button",{onClick:t,className:(0,V.cn)("p-1 rounded-md transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-4 h-4"})})]}),(0,B.jsxs)("div",{className:"space-y-2",children:[(0,B.jsxs)("div",{className:(0,V.cn)("text-xs p-2 rounded-lg","dark"===r?"bg-white/5":"bg-gray-50"),children:[(0,B.jsxs)("p",{className:(0,V.cn)("font-medium mb-1","dark"===r?"text-gray-300":"text-gray-700"),children:["Contacto: ",(0,B.jsx)("span",{className:"font-normal",children:e.contact?.nombre||e.contact?.telefono})]}),(0,B.jsxs)("p",{className:(0,V.cn)("font-medium","dark"===r?"text-gray-300":"text-gray-700"),children:["Keyword: ",(0,B.jsx)("span",{className:(0,V.cn)("font-normal px-1.5 py-0.5 rounded text-[10px]","dark"===r?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-600"),children:e.keyword})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("text-xs italic opacity-80 pl-2 border-l-2","dark"===r?"border-purple-500/50 text-gray-400":"border-purple-300 text-gray-600"),children:['"',e.response.length>50?e.response.substring(0,50)+"...":e.response,'"']})]})]})})}var iT=e.i(97220);function iC(e){return({running:"ejecutando",completed:"completado",failed:"fallido",paused:"pausado",pending:"ejecutando",resting:"descanso"})[e.toLowerCase()]||e}function iA(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),[r,a]=(0,U.useState)([]),[s,n]=(0,U.useState)([]),[i,o]=(0,U.useState)(!1),[l,c]=(0,U.useState)(""),[d,h]=(0,U.useState)(""),[u,m]=(0,U.useState)(""),[p,f]=(0,U.useState)("60"),[g,x]=(0,U.useState)("90"),[b,y]=(0,U.useState)("15"),[v,w]=(0,U.useState)("25"),[N,j]=(0,U.useState)(""),[k,E]=(0,U.useState)(new Date().toISOString().split("T")[0]),[S,T]=(0,U.useState)(!1),[C,A]=(0,U.useState)(!1),[R,O]=(0,U.useState)(null),[_,D]=(0,U.useState)([]),[P,I]=(0,U.useState)(null),[L,M]=(0,U.useState)(null),[F,W]=(0,U.useState)(!1),[G,Y]=(0,U.useState)(null),[X,K]=(0,U.useState)(null),[J,et]=(0,U.useState)(!0),[es,en]=(0,U.useState)([]),[ei,eo]=(0,U.useState)(!1),[ek,eE]=(0,U.useState)(!1),[eS,eT]=(0,U.useState)(!1),[eR,eO]=(0,U.useState)(!1),[e_,eD]=(0,U.useState)(0),[eP,eI]=(0,U.useState)(null),[eL,eM]=(0,U.useState)({mensajesHoy:0,usuariosActivos:0,contactosCargados:0});(0,U.useEffect)(()=>{let e=(0,iy.connectSocket)();return(async()=>{try{let e=await er.api.whatsapp.status();K(e.data?.connected||!1),et(!1),e.data?.connected||A(!0)}catch(e){console.error("[MensajeriaMasiva] Error checking WhatApp status:",e),K(!1),et(!1),A(!0)}})(),e.on("whatsapp:disconnected",e=>{console.log("[MensajeriaMasiva] WhatsApp disconnected:",e),K(!1),eT(!0),ea.toast.error("WhatsApp desconectado - Las campañas se han detenido")}),e.emit("jobs:subscribe"),e.on("jobs:update",e=>{console.log("[MensajeriaMasiva] Job update received:",e),a(t=>e.deleted||"cancelado"===e.status&&!t.find(t=>t._id===e._id)?t.filter(t=>t._id!==e._id):t.some(t=>t._id===e._id)?t.map(t=>t._id===e._id?{...t,...e}:t):[e,...t]),eF()}),e.on("auto_response:sent",e=>{console.log("[MensajeriaMasiva] Auto-response sent:",e),eI(e),setTimeout(()=>eI(null),5e3)}),e.on("job:progress",e=>{console.log("[MensajeriaMasiva] Job progress received:",e),a(t=>{let r=e._id||e.jobId;if(!r)return console.warn("[MensajeriaMasiva] Progress data missing job ID:",e),t;let a=t.findIndex(e=>e._id===r||e._id.toString()===r.toString());if(-1===a)return console.warn("[MensajeriaMasiva] Job not found in campaigns:",r),t;let s=[...t],n=s[a];console.log("[MensajeriaMasiva] Updating campaign:",n.name,"Progress:",e.stats);let i=n.stats?.sent||0,o=e.stats?.sent??i,l=o-i;return l>0&&(console.log("[MensajeriaMasiva] Updating global metrics. Delta:",l),eM(e=>({...e,mensajesHoy:e.mensajesHoy+l}))),s[a]={...n,status:e.status||n.status,sentCount:o,failedCount:e.stats?.failed??n.failedCount,pendingCount:e.stats?.pending??n.pendingCount,repliesCount:e.repliesCount??n.repliesCount,stats:{sent:o,failed:e.stats?.failed??n.stats?.failed??0,pending:e.stats?.pending??n.stats?.pending??0,total:n.stats?.total??0}},"pendiente"===e.status&&"pendiente"!==n.status&&(eT(!0),ea.toast.error("Campaña en estado Pendiente - Revisa la conexión de WhatsApp")),s})}),e.on("campaign:reply",e=>{console.log("[MensajeriaMasiva] Reply received:",e),a(t=>{let r=t.findIndex(t=>t._id===e.campaignId);if(-1===r)return t;let a=[...t],s=a[r];return a[r]={...s,repliesCount:(s.repliesCount||0)+1},a})}),eU(),eV(),eF(),()=>{e.off("whatsapp:disconnected"),e.off("jobs:update"),e.off("auto_response:sent"),e.off("job:progress"),e.off("campaign:reply"),e.emit("jobs:unsubscribe")}},[]);let eF=async()=>{try{let e=await er.api.metrics.dashboard();eM(e.data)}catch(e){console.error("Error fetching metrics:",e)}},eB=async e=>{let t=e.target.files?.[0];if(t)try{O(t);let e=await er.api.contacts.upload(t);if(e.data){let{contacts:t,resumen:r,rejectedFileId:a,headers:s}=e.data;if(D(t||[]),M(r),I(a),s&&s.length>0)console.log("[MensajeriaMasiva] Headers from backend:",s),en(s);else if(t&&t.length>0){let e=t[0],r=Object.keys(e.extraData||{});console.log("[MensajeriaMasiva] Headers from first contact:",r),en(r)}let n=r?.accepted||0,i=r?.rejected||0;i>0&&(eD(i),eO(!0)),ea.toast.success(`✅ ${n} afiliados cargados correctamente`)}}catch(e){console.error("Error uploading contacts:",e),ea.toast.error(e.response?.data?.message||"Error al cargar contactos"),O(null),D([]),M(null),I(null),en([])}},eU=async()=>{try{let e=await er.api.sendJobs.list();a(e.data||[])}catch(e){console.error("Error fetching campaigns:",e),ea.toast.error("Error al cargar campañas")}},eV=async()=>{try{let e=await er.api.templates.list();n(e.data||[])}catch(e){console.error("Error fetching templates:",e),ea.toast.error("Error al cargar plantillas")}},ez=(e,t="")=>{let r=document.querySelector("textarea[name='mensaje']");if(!r)return void console.warn("[insertAtCursor] Textarea not found");let a=r.selectionStart,s=r.selectionEnd,n=u.substring(a,s);m(u.substring(0,a)+e+n+t+u.substring(s)),setTimeout(()=>{r.focus();let s=a+e.length+n.length+t.length;r.selectionStart=s,r.selectionEnd=s},0)},eH=new Set(["telefono","phone","celular","telefono1","telefonocelular","movil"]),eW=es.filter(e=>e&&!eH.has(String(e).toLowerCase())),e$=async()=>{if(!u.trim())return void ea.toast.error("Escribe un mensaje para guardar como plantilla");let e=prompt("Nombre de la plantilla:");if(e)try{d?(await er.api.templates.update(d,{nombre:e,contenido:u}),ea.toast.success("Plantilla actualizada")):(await er.api.templates.create({nombre:e,contenido:u}),ea.toast.success("Plantilla guardada")),eV()}catch(e){console.error("Error saving template:",e),ea.toast.error(e.response?.data?.message||"Error al guardar plantilla")}},eG=async()=>{if(!d)return void ea.toast.error("Selecciona una plantilla para eliminar");if(confirm("¿Eliminar esta plantilla?"))try{await er.api.templates.delete(d),ea.toast.success("Plantilla eliminada"),h(""),m(""),eV()}catch(e){console.error("Error deleting template:",e),ea.toast.error(e.response?.data?.message||"Error al eliminar plantilla")}},eq=async()=>{if(!l.trim())return void ea.toast.error("Ingresa un nombre para la campaña");if(0===_.length)return void ea.toast.error("Debes cargar contactos primero");if(!u.trim()&&!d)return void ea.toast.error("Escribe un mensaje o selecciona una plantilla");try{o(!0),await er.api.sendJobs.start({name:l,templateId:d||void 0,message:d?void 0:u,contacts:_,delayMin:parseInt(p),delayMax:parseInt(g),batchSize:parseInt(b),batchDelay:60*parseInt(v),scheduledAt:N||void 0}),ea.toast.success("Campaña iniciada exitosamente"),c(""),h(""),m(""),D([]),O(null),j(""),eU()}catch(e){console.error("Error starting campaign:",e),ea.toast.error(e.response?.data?.message||"Error al iniciar campaña")}finally{o(!1)}},eY=async e=>{try{await er.api.sendJobs.pause(e),ea.toast.success("Campaña pausada"),eU()}catch(e){console.error("Error pausing campaign:",e),ea.toast.error(e.response?.data?.message||"Error al pausar campaña")}},eX=async e=>{try{await er.api.sendJobs.resume(e),ea.toast.success("Campaña reanudada"),eU()}catch(e){console.error("Error resuming campaign:",e),ea.toast.error(e.response?.data?.message||"Error al reanudar campaña")}},eK=async e=>{if(confirm("¿Cancelar esta campaña?"))try{await er.api.sendJobs.cancel(e),ea.toast.success("Campaña cancelada"),eU()}catch(e){console.error("Error canceling campaign:",e),ea.toast.error(e.response?.data?.message||"Error al cancelar campaña")}},eQ=async e=>{try{let t=await er.api.sendJobs.export(e),r=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=r,a.setAttribute("download",`campaign_${e}.xlsx`),document.body.appendChild(a),a.click(),a.remove(),ea.toast.success("Campaña exportada")}catch(e){console.error("Error exporting campaign:",e),ea.toast.error(e.response?.data?.message||"Error al exportar campaña")}},eJ=async()=>{if(P)try{let e=await er.api.contacts.downloadRejected(P),t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t,r.setAttribute("download",`afiliados_rechazados_${Date.now()}.txt`),document.body.appendChild(r),r.click(),r.remove(),ea.toast.success("Archivo de rechazados descargado")}catch(e){console.error("Error downloading rejected file:",e),ea.toast.error("Error al descargar archivo de rechazados")}},eZ=async()=>{if(confirm("¿Estás seguro de que deseas desconectar el dispositivo? Deberás vincular uno nuevo."))try{await er.api.whatsapp.logout(),ea.toast.success("Dispositivo desconectado exitosamente"),K(!1),A(!0)}catch(e){console.error("Error disconnecting device:",e),ea.toast.error(e.response?.data?.message||"Error al desconectar dispositivo")}},e0=r.filter(e=>!k||new Date(e.createdAt).toISOString().split("T")[0]===k);return J?(0,B.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)]",children:(0,B.jsxs)("div",{className:"text-center",children:[(0,B.jsx)("div",{className:(0,V.cn)("inline-block w-12 h-12 border-4 border-t-transparent rounded-full animate-spin mb-4","dark"===e?"border-white/20 border-t-white":"border-gray-300 border-t-purple-600")}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Verificando conexión de WhatsApp..."})]})}):!1===X?(0,B.jsx)(iv,{onSuccess:()=>{K(!0),ea.toast.success("WhatsApp vinculado correctamente"),eU()}}):(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-4 lg:space-y-6",children:[(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-2xl border shadow-sm transition-all duration-300 hover:shadow-lg relative overflow-hidden group","dark"===e?"bg-white/5 border-white/10":(0,V.cn)("border-gray-200/50",H.default.cardPrimaryLight)),style:{animationDelay:"0ms"},children:["dark"!==e&&(0,B.jsx)("div",{className:(0,V.cn)("absolute -top-10 -right-10 w-24 h-24 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity",H.default.glowPrimaryLight)}),(0,B.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-lg flex items-center justify-center w-10 h-10 lg:w-12 lg:h-12","dark"===e?"bg-blue-500/20 text-blue-400":(0,V.cn)("text-white",H.default.iconPrimaryLight)),children:(0,B.jsx)(ed.MessageCircle,{className:"w-5 h-5 lg:w-6 lg:h-6"})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Mensajes enviados hoy"}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl lg:text-3xl font-bold","dark"===e?"text-white":H.default.textPrimaryLight),children:eL.mensajesHoy})]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-2xl border shadow-sm transition-all duration-300 hover:shadow-lg relative overflow-hidden group","dark"===e?"bg-white/5 border-white/10":(0,V.cn)("border-gray-200/50",H.default.cardSecondaryLight)),style:{animationDelay:"100ms"},children:["dark"!==e&&(0,B.jsx)("div",{className:(0,V.cn)("absolute -top-10 -right-10 w-24 h-24 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity",H.default.glowSecondaryLight)}),(0,B.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-lg flex items-center justify-center w-10 h-10 lg:w-12 lg:h-12","dark"===e?"bg-emerald-500/20 text-emerald-400":(0,V.cn)("text-white",H.default.iconSecondaryLight)),children:(0,B.jsx)(q.Users,{className:"w-5 h-5 lg:w-6 lg:h-6"})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Usuarios activos"}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl lg:text-3xl font-bold","dark"===e?"text-white":H.default.textSecondaryLight),children:eL.usuariosActivos})]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-2xl border shadow-sm transition-all duration-300 hover:shadow-lg relative overflow-hidden group","dark"===e?"bg-white/5 border-white/10":(0,V.cn)("border-gray-200/50",H.default.cardAccentLight)),style:{animationDelay:"200ms"},children:["dark"!==e&&(0,B.jsx)("div",{className:(0,V.cn)("absolute -top-10 -right-10 w-24 h-24 rounded-full blur-3xl opacity-30 group-hover:opacity-50 transition-opacity",H.default.glowAccentLight)}),(0,B.jsxs)("div",{className:"flex items-center gap-3 relative z-10",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-lg flex items-center justify-center w-10 h-10 lg:w-12 lg:h-12","dark"===e?"bg-purple-500/20 text-purple-400":(0,V.cn)("text-white",H.default.iconAccentLight)),children:(0,B.jsx)(el.Upload,{className:"w-5 h-5 lg:w-6 lg:h-6"})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs font-medium mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Contactos cargados"}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl lg:text-3xl font-bold","dark"===e?"text-white":H.default.textAccentLight),children:eL.contactosCargados})]})]})]})]}),(0,B.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,B.jsxs)("label",{className:(0,V.cn)("flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all cursor-pointer","dark"===e?"bg-[#17C787] hover:bg-[#17C787]/80 text-white":"bg-emerald-500 hover:bg-emerald-600 text-white"),children:[(0,B.jsx)(el.Upload,{className:"w-3.5 h-3.5"}),(0,B.jsx)("span",{className:"hidden sm:inline",children:"Subir contactos (CSV/XLS)"}),(0,B.jsx)("span",{className:"sm:hidden",children:"Subir"}),(0,B.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:eB,className:"hidden"})]}),(0,B.jsxs)("button",{onClick:eZ,className:(0,V.cn)("flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#C8376B] hover:bg-[#C8376B]/80 text-white":"bg-rose-500 hover:bg-rose-600 text-white"),children:[(0,B.jsx)(ec,{className:"w-3.5 h-3.5"}),(0,B.jsx)("span",{className:"hidden sm:inline",children:"Desconectar dispositivo"}),(0,B.jsx)("span",{className:"sm:hidden",children:"Desconectar"})]}),(0,B.jsxs)("button",{onClick:()=>T(!0),className:(0,V.cn)("flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#1E88E5] hover:bg-[#1E88E5]/80 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:[(0,B.jsx)(ed.MessageCircle,{className:"w-3.5 h-3.5"}),(0,B.jsx)("span",{className:"hidden sm:inline",children:"Auto-respuestas"}),(0,B.jsx)("span",{className:"sm:hidden",children:"Auto"})]})]}),L&&(0,B.jsxs)("div",{className:"space-y-2",children:[L.accepted>0&&(0,B.jsxs)("div",{className:(0,V.cn)("p-3 rounded-lg border","dark"===e?"bg-emerald-500/10 border-emerald-500/30 text-emerald-400":"bg-emerald-50 border-emerald-200 text-emerald-700"),children:["✅ ",L.accepted," afiliados aceptados y listos para contactar desde ",R?.name]}),L.rejected>0&&P&&(0,B.jsxs)("div",{className:(0,V.cn)("p-3 rounded-lg border flex items-center justify-between","dark"===e?"bg-orange-500/10 border-orange-500/30 text-orange-400":"bg-orange-50 border-orange-200 text-orange-700"),children:[(0,B.jsxs)("span",{children:["⚠️ ",L.rejected," afiliados rechazados (duplicados o ya contactados)"]}),(0,B.jsxs)("button",{onClick:eJ,className:(0,V.cn)("flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-orange-500/20 hover:bg-orange-500/30 text-orange-300":"bg-orange-200 hover:bg-orange-300 text-orange-800"),children:[(0,B.jsx)(Z,{className:"w-3.5 h-3.5"}),"Descargar rechazados"]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:"Nombre de la campaña"}),(0,B.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Ingresa el nombre...",className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:"Plantilla (opcional)"}),(0,B.jsxs)("select",{value:d,onChange:e=>(e=>{if(h(e),e){let t=s.find(t=>t._id===e);t&&m(t.contenido)}})(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm border transition-all focus:ring-2","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 focus:border-purple-400 focus:ring-purple-200/50"),children:[(0,B.jsx)("option",{value:"",children:"-- Selecciona plantilla --"}),s.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("button",{onClick:e$,className:(0,V.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#17C787]/20 hover:bg-[#17C787]/30 text-[#17C787] border border-[#17C787]/30":"bg-emerald-100 hover:bg-emerald-200 text-emerald-700 border border-emerald-200"),children:[(0,B.jsx)(eh.Save,{className:"w-3.5 h-3.5"}),"Guardar"]}),(0,B.jsxs)("button",{onClick:eG,className:(0,V.cn)("flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-[#C8376B]/20 hover:bg-[#C8376B]/30 text-[#C8376B] border border-[#C8376B]/30":"bg-rose-100 hover:bg-rose-200 text-rose-700 border border-rose-200"),children:[(0,B.jsx)(eu.Trash2,{className:"w-3.5 h-3.5"}),"Eliminar"]})]})]}),(0,B.jsxs)("div",{className:"space-y-2",children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:"Mensaje"}),(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center gap-1 px-2 py-1.5 rounded-t-lg border-b relative","dark"===e?"bg-white/5 border-white/10":"bg-purple-50 border-purple-100"),children:[(0,B.jsx)("button",{type:"button",onClick:()=>ez("*","*"),title:"Negrita",className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-600"),children:(0,B.jsx)(ey,{className:"w-3.5 h-3.5"})}),(0,B.jsx)("button",{type:"button",onClick:()=>ez("_","_"),title:"Cursiva",className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-600"),children:(0,B.jsx)(ev,{className:"w-3.5 h-3.5"})}),(0,B.jsx)("button",{type:"button",onClick:()=>eo(!ei),title:"Emoji",className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-600"),children:(0,B.jsx)(ew,{className:"w-3.5 h-3.5"})}),ei&&(0,B.jsx)("div",{className:(0,V.cn)("absolute top-full left-0 mt-1 p-2 rounded-lg shadow-lg border grid grid-cols-10 gap-1 z-20","dark"===e?"bg-gray-800 border-white/10":"bg-white border-purple-200"),children:["😀","😃","😄","😉","😊","😍","🤩","😎","😁","😂","🙌","👍","💪","🎉","🎯","✨","📞","📲","📅","🕒","💬","✅","❌","⚠️","📍","📌","🔔","🚀","💡","🧾"].map(e=>(0,B.jsx)("button",{type:"button",onClick:()=>{ez(e),eo(!1)},className:(0,V.cn)("text-xl hover:bg-gray-100 dark:hover:bg-gray-700 rounded p-1"),children:e},e))}),(0,B.jsx)("div",{className:(0,V.cn)("w-px h-4 mx-1","dark"===e?"bg-white/10":"bg-purple-200")}),(0,B.jsx)("button",{type:"button",onClick:()=>eE(!0),title:"Spintax - Variaciones de texto",className:(0,V.cn)("px-2 py-1 rounded text-xs font-medium transition-colors","dark"===e?"hover:bg-white/10 text-purple-400":"hover:bg-purple-100 text-purple-600"),children:"Spintax"}),eW.length>0&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{className:(0,V.cn)("w-px h-4 mx-1","dark"===e?"bg-white/10":"bg-purple-200")}),eW.map(t=>(0,B.jsxs)("button",{type:"button",onClick:()=>ez(`[${t}]`),title:`Insertar campo din\xe1mico: ${t}`,className:(0,V.cn)("px-2 py-1 rounded text-xs font-medium transition-colors","dark"===e?"hover:bg-white/10 text-blue-400":"hover:bg-blue-100 text-blue-600"),children:["[",String(t).toUpperCase(),"]"]},t))]})]}),(0,B.jsx)("textarea",{name:"mensaje",value:u,onChange:e=>m(e.target.value),placeholder:"Escribe tu mensaje aquí... (se ignora si seleccionas plantilla)",rows:4,spellCheck:!0,lang:"es",className:(0,V.cn)("w-full px-3 py-2 rounded-b-lg text-sm border border-t-0 transition-all focus:ring-2 resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500 focus:border-purple-500/50 focus:ring-purple-500/20":"bg-white border-purple-200/50 text-gray-700 placeholder-gray-400 focus:border-purple-400 focus:ring-purple-200/50")}),(0,B.jsxs)("button",{onClick:()=>{if(!u.trim())return void ea.toast.error("Escribe un mensaje para previsualizar");if(!_||0===_.length)return void ea.toast.error("Carga un archivo para previsualizar con datos reales");try{let e=_[0],t=u;console.log("[Preview] First contact:",e),console.log("[Preview] First contact FULL:",JSON.stringify(e,null,2)),console.log("[Preview] Import headers:",es),console.log("[Preview] Original message:",u),es.forEach(r=>{let a=e[r]||e.extraData?.[r]||e[r.toLowerCase()]||e.extraData?.[r.toLowerCase()]||`[${r}]`;console.log(`[Preview] Replacing [${r}] with:`,a);let s=RegExp(`\\[${r}\\]`,"gi");t=t.replace(s,String(a))}),e.extraData&&Object.keys(e.extraData).forEach(r=>{let a=e.extraData[r],s=RegExp(`\\[${r}\\]`,"gi");t=t.replace(s,String(a))}),console.log("[Preview] After replacement:",t),t=t.replace(/{([^}]+)}/g,(e,t)=>t.split("|").map(e=>e.trim())[0]||e),Y({message:t,contactName:e.nombre||e.extraData?.nombre||"Ejemplo"}),W(!0)}catch(e){console.error("Error previewing message:",e),ea.toast.error("Error al generar vista previa")}},className:(0,V.cn)("w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all","dark"===e?"bg-gradient-to-r from-purple-600/50 to-blue-600/50 hover:from-purple-600/70 hover:to-blue-600/70 text-white border border-white/10":"bg-gradient-to-r from-purple-200 to-blue-200 hover:from-purple-300 hover:to-blue-300 text-purple-700 border border-purple-200"),children:[(0,B.jsx)(em.Eye,{className:"w-3.5 h-3.5"}),"Previsualizar"]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4 pt-4 border-t","dark"===e?"border-white/10":"border-purple-100"),children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)(ep.Clock,{className:"w-3 h-3"}),"Tiempo (seg)"]}),(0,B.jsxs)("div",{className:"flex gap-1",children:[(0,B.jsx)("input",{type:"number",value:p,onChange:e=>f(e.target.value),className:(0,V.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")}),(0,B.jsx)("input",{type:"number",value:g,onChange:e=>x(e.target.value),className:(0,V.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)(ef.Package,{className:"w-3 h-3"}),"Tamaño lote"]}),(0,B.jsx)("input",{type:"number",value:b,onChange:e=>y(e.target.value),className:(0,V.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)(eg,{className:"w-3 h-3"}),"Descanso (min)"]}),(0,B.jsx)("input",{type:"number",value:v,onChange:e=>w(e.target.value),className:(0,V.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("flex items-center gap-1.5 text-xs font-medium mb-1.5","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)(Q.Calendar,{className:"w-3 h-3"}),"Programar"]}),(0,B.jsx)("input",{type:"datetime-local",value:N,onChange:e=>j(e.target.value),className:(0,V.cn)("w-full px-2 py-1.5 rounded-lg text-xs border transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]})]}),(0,B.jsxs)("button",{onClick:eq,disabled:i,className:(0,V.cn)("w-full mt-4 flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm font-semibold transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed","dark"===e?"bg-gradient-to-r from-[#17C787] to-[#1E88E5] hover:from-[#17C787]/90 hover:to-[#1E88E5]/90 text-white shadow-lg shadow-[#17C787]/20":"bg-gradient-to-r from-emerald-500 to-blue-500 hover:from-emerald-600 hover:to-blue-600 text-white shadow-lg shadow-emerald-200/50"),children:[(0,B.jsx)(eN.Sparkles,{className:"w-4 h-4"}),i?"Iniciando...":"Iniciar envío"]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border backdrop-blur-sm overflow-hidden","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 p-4 border-b","dark"===e?"border-white/10":"border-purple-100"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-sm font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Campañas creadas"}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("span",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Fecha:"}),(0,B.jsx)("input",{type:"date",value:k,onChange:e=>E(e.target.value),className:(0,V.cn)("px-2 py-1 rounded text-xs border w-28","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-purple-200/50 text-gray-700")})]})]}),(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-xs",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:"dark"===e?"bg-white/5":"bg-purple-50",children:[(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Nombre"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Usuario/Equipo"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Estado"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Progreso"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Métricas"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Hora"}),(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-center font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Acciones"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===e?"divide-white/5":"divide-purple-100"),children:e0.map(t=>{let r={running:{bg:"dark"===e?"bg-blue-500/20":"bg-blue-100",text:"dark"===e?"text-blue-400":"text-blue-600"},pending:{bg:"dark"===e?"bg-yellow-500/20":"bg-yellow-100",text:"dark"===e?"text-yellow-400":"text-yellow-600"},failed:{bg:"dark"===e?"bg-red-500/20":"bg-red-100",text:"dark"===e?"text-red-400":"text-red-600"},completed:{bg:"dark"===e?"bg-green-500/20":"bg-green-100",text:"dark"===e?"text-green-400":"text-green-600"},completado:{bg:"dark"===e?"bg-green-500/20":"bg-green-100",text:"dark"===e?"text-green-400":"text-green-600"},paused:{bg:"dark"===e?"bg-orange-500/20":"bg-orange-100",text:"dark"===e?"text-orange-400":"text-orange-600"},pausado:{bg:"dark"===e?"bg-orange-500/20":"bg-orange-100",text:"dark"===e?"text-orange-400":"text-orange-600"},ejecutando:{bg:"dark"===e?"bg-blue-500/20":"bg-blue-100",text:"dark"===e?"text-blue-400":"text-blue-600"},fallido:{bg:"dark"===e?"bg-red-500/20":"bg-red-100",text:"dark"===e?"text-red-400":"text-red-600"},descanso:{bg:"dark"===e?"bg-blue-500/20":"bg-blue-100",text:"dark"===e?"text-blue-400":"text-blue-600"}}[iC(t.status).toLowerCase()]||{bg:"dark"===e?"bg-gray-500/20":"bg-gray-100",text:"dark"===e?"text-gray-400":"text-gray-600"},a=t.progress||0;return(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-purple-50/50"),children:[(0,B.jsx)("td",{className:"px-3 py-2.5",children:(0,B.jsx)("span",{className:(0,V.cn)("font-medium","dark"===e?"text-purple-400":"text-purple-600"),children:t.name})}),(0,B.jsx)("td",{className:"px-3 py-2.5",children:(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:"dark"===e?"text-white":"text-gray-700",children:t.createdBy?.nombre||"N/A"}),(0,B.jsx)("span",{className:(0,V.cn)("ml-2 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600"),children:t.createdBy?.numeroEquipo||"N/A"})]})}),(0,B.jsx)("td",{className:"px-3 py-2.5",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded-full text-[10px] font-medium",r.bg,r.text),children:iC(t.status)})}),(0,B.jsx)("td",{className:"px-3 py-2.5",children:(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:"flex-1 h-1.5 bg-gray-100 dark:bg-white/10 rounded-full overflow-hidden",children:(0,B.jsx)("div",{className:(0,V.cn)("h-full transition-all duration-500","completed"===t.status?"bg-[#17C787]":"failed"===t.status?"bg-[#C8376B]":"dark"===e?"bg-purple-500":"bg-purple-400"),style:{width:`${a}% `}})}),(0,B.jsxs)("span",{className:(0,V.cn)("text-[10px]","dark"===e?"text-gray-400":"text-gray-500"),children:[a,"%"]}),("resting"===t.status||"descanso"===t.status)&&t.restBreakUntil&&(0,B.jsx)(iR,{targetDate:t.restBreakUntil})]})}),(0,B.jsx)("td",{className:"px-3 py-2.5",children:(0,B.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-[#17C787]/20 text-[#17C787]":"bg-emerald-100 text-emerald-600"),children:["✓",t.stats?.sent||0]}),(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-[#C8376B]/20 text-[#C8376B]":"bg-rose-100 text-rose-600"),children:["✕",t.stats?.failed||0]}),(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-[#1E88E5]/20 text-[#1E88E5]":"bg-blue-100 text-blue-600"),children:["⏳",t.stats?.pending||0]}),(0,B.jsxs)("span",{className:(0,V.cn)("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded text-[10px]","dark"===e?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-600"),title:"Respuestas recibidas",children:["💬",t.repliesCount||0]})]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-2.5","dark"===e?"text-gray-400":"text-gray-600"),children:new Date(t.createdAt).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!0})}),(0,B.jsx)("td",{className:"px-3 py-2.5",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[!["paused","pausado","completado","completed","fallida","failed"].includes(t.status?.toLowerCase()||"")&&(0,B.jsx)("button",{onClick:()=>eY(t._id),className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#F4C04A]/20 text-[#F4C04A] hover:bg-[#F4C04A]/30":"bg-amber-100 text-amber-600 hover:bg-amber-200"),title:"Pausar campaña",children:(0,B.jsx)(ex,{className:"w-3 h-3"})}),("paused"===t.status||"pausado"===t.status)&&(0,B.jsx)("button",{onClick:()=>eX(t._id),className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#17C787]/20 text-[#17C787] hover:bg-[#17C787]/30":"bg-emerald-100 text-emerald-600 hover:bg-emerald-200"),title:"Reanudar campaña",children:(0,B.jsx)(eb,{className:"w-3 h-3"})}),(0,B.jsx)("button",{onClick:()=>eK(t._id),className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#C8376B]/20 text-[#C8376B] hover:bg-[#C8376B]/30":"bg-rose-100 text-rose-600 hover:bg-rose-200"),title:"Borrar campaña",children:(0,B.jsx)(eu.Trash2,{className:"w-3 h-3"})}),(0,B.jsx)("button",{onClick:()=>eQ(t._id),className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"bg-[#17C787]/20 text-[#17C787] hover:bg-[#17C787]/30":"bg-emerald-100 text-emerald-600 hover:bg-emerald-200"),title:"Descargar reporte",children:(0,B.jsx)(Z,{className:"w-3 h-3"})})]})})]},t._id)})})]})})]}),F&&G&&(0,B.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-md rounded-2xl border p-6 shadow-2xl pointer-events-auto","dark"===e?"bg-gradient-to-br from-gray-900 to-gray-800 border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-bold","dark"===e?"text-white":"text-gray-800"),children:"Vista Previa del Mensaje"}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:["Ejemplo con: ",G.contactName]})]}),(0,B.jsx)("button",{onClick:()=>W(!1),className:(0,V.cn)("p-2 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsx)("div",{className:"mb-6",children:(0,B.jsx)("div",{className:"flex justify-end",children:(0,B.jsxs)("div",{className:(0,V.cn)("max-w-[85%] rounded-lg p-3 shadow-md","dark"===e?"bg-green-900/50 text-green-100":"bg-green-100 text-gray-800"),children:[(0,B.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:G.message}),(0,B.jsxs)("div",{className:"flex items-center justify-end gap-1 mt-1",children:[(0,B.jsx)("span",{className:(0,V.cn)("text-[10px]","dark"===e?"text-green-300/70":"text-gray-500"),children:new Date().toLocaleTimeString("es",{hour:"2-digit",minute:"2-digit"})}),(0,B.jsx)(ej,{className:(0,V.cn)("w-3 h-3","dark"===e?"text-blue-400":"text-blue-500")})]})]})})}),(0,B.jsx)("button",{onClick:()=>W(!1),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg font-semibold transition-all","dark"===e?"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white":"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white"),children:"Cerrar"})]})}),C&&(0,B.jsx)(iv,{onSuccess:()=>{K(!0),A(!1),eU()}}),(0,B.jsx)(eC,{isOpen:S,onClose:()=>T(!1)}),(0,B.jsx)(eA,{isOpen:ek,onClose:()=>eE(!1),onInsert:e=>{ez(e),eE(!1)}}),eS&&(0,B.jsx)(iw,{onDismiss:()=>eT(!1),onReconnect:()=>{eT(!1),A(!0)}}),eR&&(0,B.jsx)(iE,{count:e_,onDismiss:()=>eO(!1),onDownload:eJ}),eP&&(0,B.jsx)(iS,{data:eP,onDismiss:()=>eI(null)})]})}function iR({targetDate:e}){let[t,r]=(0,U.useState)("");return(0,U.useEffect)(()=>{let t=setInterval(()=>{let a=new Date().getTime(),s=new Date(e).getTime()-a;if(s<=0)r("Reanudando..."),clearInterval(t);else{let e=Math.floor(s%36e5/6e4),t=Math.floor(s%6e4/1e3);r(`${e}m ${t}s`)}},1e3);return()=>clearInterval(t)},[e]),(0,B.jsxs)("span",{className:"text-[10px] font-mono bg-blue-500/20 text-blue-400 px-1.5 py-0.5 rounded animate-pulse",children:["⏳ ",t]})}var iO=e.i(35389),i_=e.i(33133),iD=e.i(29396),iP=e.i(74402);function iI({isOpen:e,onClose:t}){let{theme:r}=(0,z.useTheme)(),a=(0,iy.useSocket)(),[s,n]=(0,U.useState)("inbox"),[i,o]=(0,U.useState)(null),[l,c]=(0,U.useState)(!1),[d,h]=(0,U.useState)(void 0),[u,m]=(0,U.useState)([]),[p,f]=(0,U.useState)(!0),[g,x]=(0,U.useState)({page:1,pages:1,total:0}),[b,y]=(0,U.useState)(0),[v,w]=(0,U.useState)([]);(0,U.useEffect)(()=>{e&&(N(),j())},[e,s,g.page]),(0,U.useEffect)(()=>(a&&e&&(a.on("new_message",e=>{ea.toast.info(`Nuevo mensaje de ${e.from.nombre}: ${e.subject}`),j(),"inbox"===s&&N()}),a.on("message_read",()=>{"sent"===s&&N()})),()=>{a&&(a.off("new_message"),a.off("message_read"))}),[a,s,e]);let N=async()=>{f(!0);try{let e,t={page:g.page,limit:20};"inbox"===s?e=await er.api.internalMessages.getInbox(t):"sent"===s?e=await er.api.internalMessages.getSent(t):"starred"===s&&(e=await er.api.internalMessages.getStarred(t)),e&&(m(e.data.messages),x(t=>({...t,pages:e.data.pagination.pages,total:e.data.pagination.total})))}catch(e){console.error("Error loading messages:",e),ea.toast.error("Error al cargar mensajes")}finally{f(!1)}},j=async()=>{try{let e=await er.api.internalMessages.getUnreadCount();y(e.data.unreadCount)}catch(e){console.error("Error loading unread count:",e)}},k=async e=>{if("inbox"===s&&!e.read)try{await er.api.internalMessages.markAsRead(e._id,!0),y(e=>Math.max(0,e-1)),m(t=>t.map(t=>t._id===e._id?{...t,read:!0}:t)),e.read=!0}catch(e){console.error("Error marking as read:",e)}o(e)},E=async(e,t)=>{e.stopPropagation();try{await er.api.internalMessages.toggleStarred(t),m(e=>e.map(e=>e._id===t?{...e,starred:!e.starred}:e)),i?._id===t&&o(e=>e?{...e,starred:!e.starred}:null),"starred"===s&&N()}catch(e){console.error("Error toggling star:",e)}},S=async e=>{if(confirm(`\xbfEst\xe1 seguro de eliminar ${e.length} mensaje(s)?`))try{await Promise.all(e.map(e=>er.api.internalMessages.delete(e))),ea.toast.success("Mensajes eliminados"),w([]),i&&e.includes(i._id)&&o(null),N()}catch(e){console.error("Error deleting messages:",e),ea.toast.error("Error al eliminar mensajes")}},T=async()=>{if(confirm("¿Está seguro de eliminar TODOS los mensajes? Esta acción no se puede deshacer."))try{await er.api.internalMessages.deleteAll(),ea.toast.success("Todos los mensajes eliminados"),w([]),N()}catch(e){console.error("Error deleting all messages:",e),ea.toast.error("Error al eliminar todos los mensajes")}};return e?(0,B.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,B.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-fade-in",onClick:t}),(0,B.jsxs)("div",{className:(0,V.cn)("relative w-full max-w-6xl h-[85vh] overflow-hidden rounded-2xl border shadow-2xl animate-scale-in flex flex-col","dark"===r?"bg-gradient-to-br from-[#1a1333] to-[#0f0a1e] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2] border-purple-200/50"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-4 border-b flex-shrink-0","dark"===r?"border-white/10":"border-purple-100"),children:[(0,B.jsx)("div",{className:"flex items-center gap-2",children:(0,B.jsx)("h2",{className:(0,V.cn)("text-lg font-semibold","dark"===r?"text-white":"text-gray-700"),children:"Mensajería Interna"})}),(0,B.jsx)("button",{onClick:t,className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===r?"hover:bg-white/10 text-gray-400":"hover:bg-purple-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,B.jsx)(iO.MessagesSidebar,{currentView:s,onViewChange:e=>{n(e),o(null),x({...g,page:1})},onCompose:()=>{h(void 0),c(!0)},unreadCount:b}),(0,B.jsx)("div",{className:"flex-1 flex flex-col min-w-0 border-l border-opacity-10 dark:border-white/10 border-gray-200",children:i?(0,B.jsx)(iD.MessageDetail,{message:i,onBack:()=>o(null),onReply:()=>{i&&(h({to:[i.from._id],subject:`RE: ${i.subject}`,replyTo:i._id,content:`

--- En respuesta a ---
Fecha: ${new Date(i.createdAt).toLocaleString()}
De: ${i.from.nombre}
Asunto: ${i.subject}

${i.content}`}),c(!0))},onForward:()=>{i&&(h({subject:`FW: ${i.subject}`,content:`

--- Mensaje reenviado ---
Fecha: ${new Date(i.createdAt).toLocaleString()}
De: ${i.from.nombre}
Asunto: ${i.subject}

${i.content}`,isForward:!0}),c(!0))},onDelete:()=>S([i._id]),onToggleStar:()=>E({stopPropagation:()=>{}},i._id)}):(0,B.jsx)(i_.MessageList,{messages:u,loading:p,view:s,onSelectMessage:k,onToggleStar:E,onDelete:S,selectedIds:v,onToggleSelect:e=>{w(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},onToggleSelectAll:()=>{v.length===u.length?w([]):w(u.map(e=>e._id))},onDeleteAll:T,pagination:g,onPageChange:e=>x(t=>({...t,page:e}))})})]}),(0,B.jsx)(iP.ComposeModal,{isOpen:l,onClose:()=>c(!1),initialData:d,onSent:()=>{"sent"===s&&N()}})]})]}):null}var iL=e.i(61956);let iM=(0,Y.default)("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);var iF=e.i(21264);function iB(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)(null),[a,s]=(0,U.useState)(!0),[n,i]=(0,U.useState)(0),[o,l]=(0,U.useState)(0);(0,U.useEffect)(()=>{c()},[]);let c=async()=>{try{s(!0);let[e,t,a]=await Promise.all([er.api.affiliates.stats(),er.api.affiliates.getFresh(),er.api.affiliates.getReusableData()]);r(e.data),i(t.data.total||0),l(a.data.total||0)}catch(e){console.error("Error loading stats:",e),ea.toast.error("Error al cargar estadísticas")}finally{s(!1)}};if(a)return(0,B.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6 h-20","dark"===e?"bg-white/5 border-white/10":"bg-gray-100 border-gray-200")}),(0,B.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[1,2,3].map(t=>(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl h-32","dark"===e?"bg-white/5":"bg-gray-100")},t))})]});if(!t)return(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6 text-center","dark"===e?"bg-white/5 border-white/10 text-gray-400":"bg-gray-50 border-gray-200 text-gray-600"),children:"No hay estadísticas disponibles"});let d=t.total-n-o,h=t.total>0?(n/t.total*100).toFixed(1):"0.0",u=t.total>0?(o/t.total*100).toFixed(1):"0.0",m=t.total>0?(d/t.total*100).toFixed(1):"0.0",p=t.obrasSociales.slice(0,5);return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2","dark"===e?"text-white":"text-gray-700"),children:[(0,B.jsx)(iL.BarChart3,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Estadísticas de la Base"]})}),(0,B.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl p-5 transition-all duration-300 hover:scale-[1.02]","dark"===e?"bg-gradient-to-br from-blue-600 to-blue-700":"bg-gradient-to-br from-blue-500 to-blue-600"),children:[(0,B.jsx)("p",{className:"text-4xl lg:text-5xl font-bold text-white mb-2",children:t.total.toLocaleString()}),(0,B.jsxs)("p",{className:"text-sm text-blue-100 flex items-center gap-2",children:[(0,B.jsx)(q.Users,{className:"w-4 h-4"}),"Afiliados Totales"]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl p-5 transition-all duration-300 hover:scale-[1.02]","dark"===e?"bg-gradient-to-br from-emerald-600 to-emerald-700":"bg-gradient-to-br from-emerald-500 to-emerald-600"),children:[(0,B.jsx)("p",{className:"text-4xl lg:text-5xl font-bold text-white mb-2",children:n.toLocaleString()}),(0,B.jsxs)("p",{className:"text-sm text-emerald-100 flex items-center gap-2",children:[(0,B.jsx)(eN.Sparkles,{className:"w-4 h-4"}),"Disponibles (Sin usar)"]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl p-5 transition-all duration-300 hover:scale-[1.02]","dark"===e?"bg-gradient-to-br from-orange-500 to-orange-600":"bg-gradient-to-br from-orange-400 to-orange-500"),children:[(0,B.jsx)("p",{className:"text-4xl lg:text-5xl font-bold text-white mb-2",children:t.exported.toLocaleString()}),(0,B.jsxs)("p",{className:"text-sm text-orange-100 flex items-center gap-2",children:[(0,B.jsx)(iM,{className:"w-4 h-4"}),"Ya Exportados"]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-base font-semibold mb-4","dark"===e?"text-white":"text-gray-700"),children:"Estado de Uso"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsxs)("div",{className:(0,V.cn)("h-8 rounded-lg overflow-hidden flex","dark"===e?"bg-gray-700":"bg-gray-200"),children:[(0,B.jsx)("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 flex items-center justify-center text-xs font-medium text-white",style:{width:`${h}%`},children:Number(h)>5&&`${h}%`}),(0,B.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center text-xs font-medium text-white",style:{width:`${u}%`},children:Number(u)>5&&`${u}%`}),(0,B.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-400 to-orange-500 flex items-center justify-center text-xs font-medium text-white",style:{width:`${m}%`},children:Number(m)>5&&`${m}%`})]}),(0,B.jsxs)("div",{className:"flex justify-between mt-2 text-xs flex-wrap gap-2",children:[(0,B.jsxs)("div",{className:"flex items-center gap-1",children:[(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-white text-xs","dark"===e?"bg-emerald-600":"bg-emerald-500"),children:"Frescos"}),(0,B.jsxs)("span",{className:(0,V.cn)("flex items-center gap-1","dark"===e?"text-emerald-400":"text-emerald-600"),children:[(0,B.jsx)(eN.Sparkles,{className:"w-3 h-3"})," ",n.toLocaleString()]})]}),(0,B.jsxs)("div",{className:"flex items-center gap-1",children:[(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-white text-xs","dark"===e?"bg-purple-600":"bg-purple-500"),children:"Reutilizables"}),(0,B.jsxs)("span",{className:(0,V.cn)("flex items-center gap-1","dark"===e?"text-purple-400":"text-purple-600"),children:[(0,B.jsx)(iF.Recycle,{className:"w-3 h-3"})," ",o.toLocaleString()]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center gap-1","dark"===e?"text-orange-400":"text-orange-600"),children:[(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-white text-xs","dark"===e?"bg-orange-600":"bg-orange-500"),children:"Usados"}),(0,B.jsxs)("span",{className:"flex items-center gap-1",children:[(0,B.jsx)(iM,{className:"w-3 h-3"})," ",d.toLocaleString()]})]})]})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-base font-semibold mb-4","dark"===e?"text-white":"text-gray-700"),children:"Top Obras Sociales"}),(0,B.jsx)("div",{className:"space-y-3",children:p.length>0?p.map((t,r)=>(0,B.jsxs)("div",{className:(0,V.cn)("flex items-start justify-between gap-2 pb-3",r!==p.length-1&&("dark"===e?"border-b border-white/10":"border-b border-gray-100")),children:[(0,B.jsx)("p",{className:(0,V.cn)("text-sm flex-1","dark"===e?"text- gray-300":"text-gray-600"),children:t.name}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm font-semibold shrink-0","dark"===e?"text-blue-400":"text-blue-600"),children:t.count.toLocaleString()})]},r)):(0,B.jsx)("p",{className:(0,V.cn)("text-sm text-center","dark"===e?"text-gray-500":"text-gray-400"),children:"No hay datos disponibles"})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-base font-semibold mb-4","dark"===e?"text-white":"text-gray-700"),children:"Cargas Recientes"}),(0,B.jsx)("div",{className:"space-y-4",children:t.recentBatches.length>0?t.recentBatches.map((r,a)=>(0,B.jsxs)("div",{className:(0,V.cn)("flex items-start justify-between gap-2 pb-3",a!==t.recentBatches.length-1&&("dark"===e?"border-b border-white/10":"border-b border-gray-100")),children:[(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,B.jsxs)("p",{className:(0,V.cn)("text-sm font-medium truncate flex items-center gap-2","dark"===e?"text-gray-200":"text-gray-700"),children:[(0,B.jsx)(Z,{className:(0,V.cn)("w-4 h-4 shrink-0","dark"===e?"text-emerald-400":"text-emerald-500")}),r.sourceFile]}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs mt-1 flex items-center gap-1","dark"===e?"text-gray-500":"text-gray-400"),children:[(0,B.jsx)(ep.Clock,{className:"w-3 h-3"}),new Date(r.uploadDate).toLocaleString("es-AR")]})]}),(0,B.jsxs)("span",{className:(0,V.cn)("text-sm font-semibold shrink-0","dark"===e?"text-orange-400":"text-orange-500"),children:[r.count.toLocaleString()," registros"]})]},a)):(0,B.jsx)("p",{className:(0,V.cn)("text-sm text-center","dark"===e?"text-gray-500":"text-gray-400"),children:"No hay cargas recientes"})})]})]})]})}let iU=(0,Y.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),iV=(0,Y.default)("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);function iz(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!0),[n,i]=(0,U.useState)(null);(0,U.useEffect)(()=>{o()},[]);let o=async()=>{try{s(!0);let e=await er.api.affiliates.listExports();r(e.data.exports||[])}catch(e){console.error("Error fetching exports:",e),ea.toast.error("Error al cargar archivos exportados")}finally{s(!1)}},l=async e=>{try{i(e);let t=await er.api.affiliates.downloadExport(e),r=new Blob([t.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a),ea.toast.success("Archivo descargado correctamente")}catch(e){console.error("Error downloading file:",e),ea.toast.error("Error al descargar archivo")}finally{i(null)}};return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2","dark"===e?"text-white":"text-gray-700"),children:[(0,B.jsx)(ij.Download,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Archivos Exportados"]})}),a&&(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-8 text-center backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-sm"),children:(0,B.jsx)("p",{className:(0,V.cn)("dark"===e?"text-gray-400":"text-gray-500"),children:"Cargando archivos..."})}),!a&&0===t.length&&(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-8 text-center backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-sm"),children:(0,B.jsx)("p",{className:(0,V.cn)("dark"===e?"text-gray-400":"text-gray-500"),children:"No hay archivos exportados disponibles"})}),!a&&t.length>0&&(0,B.jsx)("div",{className:"space-y-3",children:t.map((t,r)=>{var a;return(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-4 backdrop-blur-sm transition-all duration-300 hover:scale-[1.01]","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10 hover:border-purple-500/30":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-sm hover:shadow-md hover:border-purple-300/50"),style:{animationDelay:`${50*r}ms`},children:(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-3",children:[(0,B.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,B.jsx)("h3",{className:(0,V.cn)("font-medium text-sm lg:text-base truncate mb-2","dark"===e?"text-white":"text-gray-700"),children:t.filename}),(0,B.jsxs)("div",{className:"flex flex-wrap items-center gap-3 lg:gap-4 text-xs",children:[(0,B.jsxs)("span",{className:(0,V.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,B.jsx)(iU,{className:"w-3.5 h-3.5"}),(0,B.jsx)("span",{className:(0,V.cn)("dark"===e?"text-purple-400":"text-purple-500"),children:t.supervisorName})]}),(0,B.jsxs)("span",{className:(0,V.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,B.jsx)(Q.Calendar,{className:"w-3.5 h-3.5"}),new Date(t.createdAt).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})]}),(0,B.jsxs)("span",{className:(0,V.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,B.jsx)(iV,{className:"w-3.5 h-3.5"}),(a=t.size)<1024?`${a} B`:a<1048576?`${(a/1024).toFixed(2)} KB`:`${(a/1048576).toFixed(2)} MB`]}),(0,B.jsxs)("span",{className:(0,V.cn)("flex items-center gap-1.5","dark"===e?"text-gray-400":"text-gray-500"),children:[(0,B.jsx)(q.Users,{className:"w-3.5 h-3.5"}),t.affiliateCount," afiliados"]})]})]}),(0,B.jsxs)("button",{onClick:()=>l(t.filename),disabled:n===t.filename,className:(0,V.cn)("flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 shrink-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100","dark"===e?"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white hover:from-cyan-500 hover:to-cyan-400":"bg-gradient-to-r from-cyan-500 to-cyan-400 text-white hover:from-cyan-400 hover:to-cyan-300"),children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),n===t.filename?"Descargando...":"Descargar"]})]})},t.filename)})})]})}var iH=e.i(37239),iW=e.i(47248);let i$=(0,Y.default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var iG=e.i(82726);let iq=(0,Y.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function iY({isOpen:e,onClose:t,availableObrasSociales:r,onAdd:a,triggerElement:s}){let{theme:n}=(0,z.useTheme)(),[i,o]=(0,U.useState)(""),[l,c]=(0,U.useState)(0),[d,h]=(0,U.useState)({top:0,left:0}),u=(0,U.useRef)(null);return((0,U.useEffect)(()=>{if(e&&s){let e=s.getBoundingClientRect(),t=window.scrollY||window.pageYOffset,r=window.scrollX||window.pageXOffset;h({top:e.bottom+t+8,left:e.left+r})}},[e,s]),(0,U.useEffect)(()=>{let r=e=>{"Escape"===e.key&&(console.log("🔍 [Modal Debug] Closing: Escape key"),t())};if(e)return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e,t]),e)?(0,B.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",onClick:e=>{e.target===e.currentTarget&&(console.log("🔍 [Modal Debug] Closing: Backdrop click"),t())},children:(0,B.jsxs)("div",{ref:u,onClick:e=>e.stopPropagation(),className:(0,V.cn)("w-full max-w-md rounded-2xl shadow-xl overflow-hidden transform transition-all animate-in zoom-in-95 duration-200","dark"===n?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("px-6 py-4 border-b flex items-center justify-between","dark"===n?"border-white/10":"border-gray-100"),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-lg font-semibold","dark"===n?"text-white":"text-gray-800"),children:"Agregar Obra Social"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===n?"text-gray-400":"text-gray-500"),children:"Nueva configuración de distribución"})]}),(0,B.jsx)("button",{onClick:t,className:(0,V.cn)("p-2 rounded-lg transition-colors","dark"===n?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"p-6 space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===n?"text-gray-300":"text-gray-700"),children:"Nombre de Obra Social"}),(0,B.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-purple-500/50","dark"===n?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"-- Seleccione una Obra Social --"}),r.map(e=>(0,B.jsx)("option",{value:e,className:"dark"===n?"bg-[#1a1333]":"",children:e},e))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===n?"text-gray-300":"text-gray-700"),children:"Cantidad de Afiliados"}),(0,B.jsx)("input",{type:"number",value:l,onChange:e=>c(Number(e.target.value)),min:"1",className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm outline-none focus:ring-2 focus:ring-purple-500/50","dark"===n?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("px-6 py-4 border-t flex justify-end gap-3","dark"===n?"border-white/10 bg-white/5":"border-gray-100 bg-gray-50"),children:[(0,B.jsx)("button",{onClick:t,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===n?"hover:bg-white/10 text-gray-300":"hover:bg-gray-200 text-gray-600"),children:"Cancelar"}),(0,B.jsx)("button",{onClick:()=>{i&&!(l<=0)&&(a(i,l),o(""),c(0),t())},disabled:!i||l<=0,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-all shadow-lg shadow-purple-500/20 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none","dark"===n?"bg-purple-600 text-white hover:bg-purple-500":"bg-purple-600 text-white hover:bg-purple-700"),children:"Agregar Obra Social"})]})]})}):null}function iX(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),[r,a]=(0,U.useState)(!0),[s,n]=(0,U.useState)(!1),[i,o]=(0,U.useState)("masivo"),[l,c]=(0,U.useState)(100),[d,h]=(0,U.useState)("09:00"),[u,m]=(0,U.useState)([]),[p,f]=(0,U.useState)([{id:"1",supervisorId:"",supervisorName:"",cantidad:50,obrasSociales:[]}]),[g,x]=(0,U.useState)(null),[b,y]=(0,U.useState)(!1),[v,w]=(0,U.useState)(null),[N,j]=(0,U.useState)([]),k=(0,U.useRef)({}),[E,S]=(0,U.useState)(50),[T,C]=(0,U.useState)(50),[A,R]=(0,U.useState)(!1),[O,_]=(0,U.useState)(!1),[D,P]=(0,U.useState)(null),I=t?.role?.toLowerCase()==="supervisor";(0,U.useEffect)(()=>{L()},[t]);let L=async()=>{try{if(a(!0),I){let e=await er.api.affiliates.getSupervisorStats();P(e.data)}else{let[e,t,r]=await Promise.all([er.api.users.getSupervisors(),er.api.affiliates.getExportConfig(),er.api.affiliates.getObrasSociales()]);if(m(e.data||[]),j(r.data?.obrasSociales||[]),t.data?.config){let e=t.data.config;if(x(e),o(e.sendType||"masivo"),h(e.scheduledTime||"09:00"),"masivo"===e.sendType)c(e.affiliatesPerFile||100),e.dataSourceMix&&(S(e.dataSourceMix.freshPercentage),C(e.dataSourceMix.reusablePercentage));else if("avanzado"===e.sendType&&e.supervisorConfigs){let t=e.supervisorConfigs.map(e=>({id:e._id||Date.now().toString(),supervisorId:e.supervisorId?._id||e.supervisorId,supervisorName:e.supervisorId?.nombre||"Sin nombre",cantidad:e.affiliatesPerFile||50,obrasSociales:e.obraSocialDistribution?.map(e=>({id:Date.now().toString()+Math.random(),nombre:e.obraSocial,cantidad:e.cantidad}))||[]}));f(t)}}}}catch(e){console.error("Error loading data:",e),ea.toast.error("Error al cargar datos")}finally{a(!1)}},M=e=>{e!==i&&(o(e),"masivo"===e?f([{id:"1",supervisorId:"",supervisorName:"",cantidad:50,obrasSociales:[]}]):c(100))},F=async e=>{try{_(!0),await er.api.affiliates.cancelExports(e),ea.toast.success("today"===e?"Envíos cancelados solo por hoy. Se reanudarán mañana automáticamente.":"Envíos cancelados indefinidamente. Guarda una nueva configuración para reanudar."),R(!1),L()}catch(e){console.error("Error cancelling exports:",e),ea.toast.error("Error al cancelar envíos")}finally{_(!1)}},H=async()=>{try{if(n(!0),"masivo"===i&&E+T!==100)return void ea.toast.error("La suma de porcentajes debe ser 100%");let e={sendType:i,scheduledTime:d};if("masivo"===i)e.affiliatesPerFile=l,e.dataSourceMix={enabled:!0,freshPercentage:E,reusablePercentage:T};else{if(p.some(e=>!e.supervisorId))return void ea.toast.error("Seleccione todos los supervisores");e.supervisorConfigs=p.map(e=>{let t={supervisorId:e.supervisorId,affiliatesPerFile:e.cantidad};return e.obrasSociales.length>0&&(t.obraSocialDistribution=e.obrasSociales.map(e=>({obraSocial:e.nombre,cantidad:e.cantidad}))),t})}await er.api.affiliates.saveExportConfig(e),ea.toast.success("Configuración guardada correctamente"),L()}catch(e){console.error("Error saving config:",e),ea.toast.error(e.response?.data?.error||"Error al guardar configuración")}finally{n(!1)}};return r?(0,B.jsx)("div",{className:"animate-fade-in-up flex items-center justify-center p-12",children:(0,B.jsx)("div",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Cargando configuración..."})}):I?(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-xl font-semibold flex items-center gap-2 mb-6","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)(iq,{className:(0,V.cn)("w-6 h-6","dark"===e?"text-purple-400":"text-purple-600")}),"Disponibilidad de Datos"]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{className:(0,V.cn)("p-6 rounded-2xl border transition-all duration-300","dark"===e?"bg-emerald-500/10 border-emerald-500/20 hover:bg-emerald-500/20":"bg-emerald-50 border-emerald-200 hover:bg-emerald-100"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,B.jsx)("span",{className:(0,V.cn)("text-sm font-medium","dark"===e?"text-emerald-300":"text-emerald-700"),children:"Datos Frescos"}),(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-lg","dark"===e?"bg-emerald-500/20":"bg-emerald-200"),children:(0,B.jsx)(q.Users,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-emerald-400":"text-emerald-600")})})]}),(0,B.jsx)("div",{className:(0,V.cn)("text-3xl font-bold","dark"===e?"text-white":"text-gray-900"),children:D?.freshCount||0}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-2","dark"===e?"text-gray-400":"text-gray-500"),children:"Disponibles para asignar"})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-6 rounded-2xl border transition-all duration-300","dark"===e?"bg-blue-500/10 border-blue-500/20 hover:bg-blue-500/20":"bg-blue-50 border-blue-200 hover:bg-blue-100"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,B.jsx)("span",{className:(0,V.cn)("text-sm font-medium","dark"===e?"text-blue-300":"text-blue-700"),children:"Datos Reutilizables"}),(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-lg","dark"===e?"bg-blue-500/20":"bg-blue-200"),children:(0,B.jsx)(iL.BarChart3,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-blue-400":"text-blue-600")})})]}),(0,B.jsx)("div",{className:(0,V.cn)("text-3xl font-bold","dark"===e?"text-white":"text-gray-900"),children:D?.reusableCount||0}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-2","dark"===e?"text-gray-400":"text-gray-500"),children:"Disponibles para re-asignar"})]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-semibold mb-4","dark"===e?"text-white":"text-gray-800"),children:"Detalle por Obra Social"}),D?.byObraSocial&&D.byObraSocial.length>0?(0,B.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:D.byObraSocial.map((t,r)=>(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-3 rounded-xl border","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-100"),children:[(0,B.jsx)("span",{className:(0,V.cn)("text-sm font-medium truncate flex-1","dark"===e?"text-gray-300":"text-gray-700"),children:t.obraSocial||"Sin especificar"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm font-bold px-2 py-1 rounded-lg ml-2","dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-100 text-purple-700"),children:t.count})]},r))}):(0,B.jsx)("div",{className:(0,V.cn)("text-center py-8 text-sm","dark"===e?"text-gray-500":"text-gray-400"),children:"No hay datos disponibles"})]})]}):(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2 mb-3","dark"===e?"text-white":"text-gray-700"),children:[(0,B.jsx)(iH.Settings,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Configuración de Envíos Programados"]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-lg p-3 text-sm","dark"===e?"bg-blue-500/10 border border-blue-500/20 text-blue-300":"bg-blue-50 border border-blue-200 text-blue-700"),children:["Los archivos ",(0,B.jsx)("strong",{children:"XLSX (Excel)"})," se generarán automáticamente cada día a la hora indicada. Cada"," ",(0,B.jsx)("strong",{className:(0,V.cn)("dark"===e?"text-purple-400":"text-purple-600"),children:"Supervisor"})," recibirá su archivo exclusivo vía mensajería interna."]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-3 block","dark"===e?"text-gray-300":"text-gray-600"),children:"Tipo de Envío"}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,B.jsxs)("button",{onClick:()=>M("masivo"),className:(0,V.cn)("p-4 rounded-xl border-2 transition-all duration-200 text-center relative","masivo"===i?"dark"===e?"border-purple-500 bg-purple-500/10":"border-purple-400 bg-purple-50":"dark"===e?"border-white/10 hover:border-white/20 opacity-50":"border-gray-200 hover:border-purple-200 opacity-50"),children:["masivo"!==i&&(0,B.jsx)("div",{className:"absolute top-2 right-2",children:(0,B.jsx)(i$,{className:(0,V.cn)("w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")})}),(0,B.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-1",children:[(0,B.jsx)(ef.Package,{className:(0,V.cn)("w-5 h-5","masivo"===i?"dark"===e?"text-orange-400":"text-orange-500":"dark"===e?"text-gray-400":"text-gray-500")}),(0,B.jsx)("span",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Masivo"})]}),(0,B.jsx)("span",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Misma cantidad para todos"})]}),(0,B.jsxs)("button",{onClick:()=>M("avanzado"),className:(0,V.cn)("p-4 rounded-xl border-2 transition-all duration-200 text-center relative","avanzado"===i?"dark"===e?"border-purple-500 bg-purple-500/10":"border-purple-400 bg-purple-50":"dark"===e?"border-white/10 hover:border-white/20 opacity-50":"border-gray-200 hover:border-purple-200 opacity-50"),children:["avanzado"!==i&&(0,B.jsx)("div",{className:"absolute top-2 right-2",children:(0,B.jsx)(i$,{className:(0,V.cn)("w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")})}),(0,B.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-1",children:[(0,B.jsx)(iH.Settings,{className:(0,V.cn)("w-5 h-5","avanzado"===i?"dark"===e?"text-orange-400":"text-orange-500":"dark"===e?"text-gray-400":"text-gray-500")}),(0,B.jsx)("span",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Avanzado"})]}),(0,B.jsx)("span",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Configurar por supervisor"})]})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:"masivo"===i?(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold flex items-center gap-2","dark"===e?"text-orange-400":"text-orange-500"),children:[(0,B.jsx)(ef.Package,{className:"w-4 h-4"}),"Configuración Masiva"]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm mb-2 block","dark"===e?"text-gray-400":"text-gray-600"),children:"Cantidad de afiliados por archivo"}),(0,B.jsx)("input",{type:"number",value:l,onChange:e=>c(Number(e.target.value)),className:(0,V.cn)("w-32 px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm mb-2 block font-medium","dark"===e?"text-gray-300":"text-gray-600"),children:"Proporción de Datos (Fresh/Reusable)"}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Frescos (%)"}),(0,B.jsx)("input",{type:"number",min:"0",max:"100",value:E,onChange:e=>{let t=Number(e.target.value);S(t),C(100-t)},className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Reutilizables (%)"}),(0,B.jsx)("input",{type:"number",min:"0",max:"100",value:T,onChange:e=>{let t=Number(e.target.value);C(t),S(100-t)},className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]})]}),E+T!==100&&(0,B.jsxs)("span",{className:(0,V.cn)("text-xs mt-1 flex items-center gap-1","dark"===e?"text-amber-400":"text-amber-600"),children:[(0,B.jsx)(iN.AlertTriangle,{className:"w-3 h-3"}),"La suma debe ser 100%"]})]})]}):(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold flex items-center gap-2","dark"===e?"text-orange-400":"text-orange-500"),children:[(0,B.jsx)(iH.Settings,{className:"w-4 h-4"}),"Configuración Avanzada"]}),(0,B.jsxs)("button",{type:"button",onClick:()=>{f([...p,{id:Date.now().toString(),supervisorId:"",supervisorName:"",cantidad:50,obrasSociales:[]}])},className:(0,V.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors","dark"===e?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-green-100 text-green-600 hover:bg-green-200"),children:[(0,B.jsx)(eE.Plus,{className:"w-4 h-4"}),"Agregar Supervisor"]})]}),(0,B.jsx)("div",{className:"space-y-3",children:p.map((t,r)=>{let a=t.obrasSociales.reduce((e,t)=>e+t.cantidad,0),s=t.cantidad-a;return(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl border p-4","dark"===e?"border-white/10 bg-white/5":"border-gray-200 bg-gray-50"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,B.jsxs)("span",{className:(0,V.cn)("font-medium text-sm","dark"===e?"text-white":"text-gray-700"),children:["Supervisor #",r+1]}),p.length>1&&(0,B.jsxs)("button",{type:"button",onClick:()=>{var e;return e=t.id,void(p.length>1&&f(p.filter(t=>t.id!==e)))},className:(0,V.cn)("flex items-center gap-1 px-2 py-1 rounded text-xs","dark"===e?"text-red-400 hover:bg-red-500/20":"text-red-500 hover:bg-red-50"),children:[(0,B.jsx)(eu.Trash2,{className:"w-3 h-3"}),"Eliminar"]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Seleccionar Supervisor"}),(0,B.jsxs)("select",{value:t.supervisorId,onChange:e=>{var r,a;let s;return r=t.id,a=e.target.value,s=u.find(e=>e._id===a),void f(p.map(e=>e.id===r?{...e,supervisorId:a,supervisorName:s?.nombre||""}:e))},className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700"),children:[(0,B.jsx)("option",{value:"",children:"-- Seleccione --"}),u.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Cantidad Total de Afiliados"}),(0,B.jsx)("input",{type:"number",value:t.cantidad,onChange:e=>{var r,a;return r=t.id,a=Number(e.target.value),void f(p.map(e=>e.id===r?{...e,cantidad:a}:e))},className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")}),s>0&&(0,B.jsxs)("span",{className:(0,V.cn)("text-xs mt-1 flex items-center gap-1","dark"===e?"text-amber-400":"text-amber-600"),children:[(0,B.jsx)(iN.AlertTriangle,{className:"w-3 h-3"}),"Faltan ",s," afiliados por distribuir"]})]})]}),(0,B.jsxs)("div",{className:"mt-3",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:"Distribución por Obra Social"}),(0,B.jsxs)("button",{type:"button",ref:e=>{e&&(k.current[t.id]=e)},onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log("🔍 [Modal Trigger] Button clicked for supervisor:",t.id),w(t.id),y(!0)},className:(0,V.cn)("flex items-center gap-1 text-xs px-2 py-1 rounded","dark"===e?"text-green-400 hover:bg-green-500/20":"text-green-600 hover:bg-green-100"),children:[(0,B.jsx)(eE.Plus,{className:"w-3 h-3"}),"Agregar Obra Social"]})]}),0===t.obrasSociales.length?(0,B.jsx)("div",{className:(0,V.cn)("rounded-lg border-2 border-dashed p-4 text-center text-xs","dark"===e?"border-white/10 text-gray-500":"border-gray-200 text-gray-400"),children:"Sin obras sociales configuradas"}):(0,B.jsx)("div",{className:"space-y-2",children:t.obrasSociales.map(r=>(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-2 rounded text-xs","dark"===e?"bg-white/5":"bg-white"),children:[(0,B.jsxs)("span",{className:(0,V.cn)("dark"===e?"text-white":"text-gray-700"),children:[r.nombre,": ",(0,B.jsx)("strong",{children:r.cantidad})," afiliados"]}),(0,B.jsx)("button",{onClick:()=>{var e,a;return e=t.id,a=r.id,void f(p.map(t=>t.id===e?{...t,obrasSociales:t.obrasSociales.filter(e=>e.id!==a)}:t))},className:(0,V.cn)("p-1 rounded hover:bg-red-500/20","dark"===e?"text-red-400":"text-red-500"),children:(0,B.jsx)(eu.Trash2,{className:"w-3 h-3"})})]},r.id))})]})]},t.id)})})]})}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-2 block","dark"===e?"text-gray-300":"text-gray-600"),children:"Hora de envío diario (HH:mm)"}),(0,B.jsx)("input",{type:"time",value:d,onChange:e=>h(e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-700")})]}),g&&(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-green-500/10 to-green-500/5 border-green-500/20":"bg-gradient-to-br from-green-50 to-green-50/50 border-green-200"),children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold flex items-center gap-2 mb-3","dark"===e?"text-green-400":"text-green-600"),children:[(0,B.jsx)(iW.CheckCircle,{className:"w-5 h-5"}),"Configuración Actual"]}),(0,B.jsxs)("ul",{className:(0,V.cn)("space-y-1 text-sm","dark"===e?"text-green-300":"text-green-700"),children:[(0,B.jsxs)("li",{children:["• Tipo: ",(0,B.jsx)("strong",{children:"masivo"===g.sendType?"Masivo":"Avanzado"})]}),(0,B.jsxs)("li",{children:["• ","masivo"===g.sendType?"Configuración masiva para todos los supervisores":`${g.supervisorConfigs?.length||0} supervisor(es) configurado(s)`]}),(0,B.jsxs)("li",{children:["• Envío diario a las ",g.scheduledTime]}),g.lastExecutedAt&&(0,B.jsxs)("li",{children:["• Última ejecución: ",new Date(g.lastExecutedAt).toLocaleString("es-AR")]})]})]}),(0,B.jsxs)("button",{onClick:H,disabled:s,className:(0,V.cn)("flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed","dark"===e?"bg-gradient-to-r from-blue-600 to-blue-500 text-white hover:from-blue-500 hover:to-blue-400":"bg-gradient-to-r from-blue-500 to-blue-400 text-white hover:from-blue-400 hover:to-blue-300"),children:[(0,B.jsx)(iW.CheckCircle,{className:"w-5 h-5"}),s?"Guardando...":"Guardar Configuración"]}),g&&(0,B.jsxs)("button",{onClick:()=>R(!0),disabled:O,className:(0,V.cn)("flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-200 hover:scale-105 disabled:opacity-50","dark"===e?"bg-red-500/20 text-red-400 hover:bg-red-500/30 border border-red-500/30":"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200"),children:[(0,B.jsx)(iG.XCircle,{className:"w-5 h-5"}),"Cancelar Envíos"]}),A&&(0,B.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>R(!1),children:(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl p-6 max-w-md w-full mx-4","dark"===e?"bg-gray-800 border border-white/10":"bg-white"),onClick:e=>e.stopPropagation(),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-bold mb-4","dark"===e?"text-white":"text-gray-900"),children:"Cancelar Envíos Programados"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mb-6","dark"===e?"text-gray-400":"text-gray-600"),children:"Selecciona cómo deseas cancelar los envíos:"}),(0,B.jsxs)("div",{className:"space-y-3",children:[(0,B.jsxs)("button",{onClick:()=>F("today"),disabled:O,className:(0,V.cn)("w-full p-4 rounded-xl border-2 transition-all text-left","dark"===e?"border-white/10 hover:border-yellow-500/50 hover:bg-yellow-500/10":"border-gray-200 hover:border-yellow-400 hover:bg-yellow-50"),children:[(0,B.jsx)("p",{className:(0,V.cn)("font-medium mb-1","dark"===e?"text-white":"text-gray-900"),children:"Solo por hoy"}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:"Se reanudará mañana automáticamente"})]}),(0,B.jsxs)("button",{onClick:()=>F("indefinite"),disabled:O,className:(0,V.cn)("w-full p-4 rounded-xl border-2 transition-all text-left","dark"===e?"border-red-500/30 hover:border-red-500/50 hover:bg-red-500/10":"border-red-200 hover:border-red-400 hover:bg-red-50"),children:[(0,B.jsx)("p",{className:(0,V.cn)("font-medium mb-1","dark"===e?"text-red-400":"text-red-600"),children:"Indefinidamente"}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:"Hasta que guardes una nueva configuración"})]})]}),(0,B.jsx)("button",{onClick:()=>R(!1),disabled:O,className:(0,V.cn)("mt-4 w-full py-2 rounded-lg font-medium","dark"===e?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-800"),children:"Cerrar"})]})}),b&&v&&(0,B.jsx)(iY,{isOpen:b,onClose:()=>y(!1),onAdd:(e,t)=>{f(p.map(r=>r.id===v?{...r,obrasSociales:[...r.obrasSociales,{id:Date.now().toString(),nombre:e,cantidad:t}]}:r)),y(!1),ea.toast.success("Obra social agregada")},availableObrasSociales:N,triggerElement:k.current[v]})]})}var iK=e.i(53609);function iQ(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!0),[n,i]=(0,U.useState)(""),[o,l]=(0,U.useState)(""),[c,d]=(0,U.useState)(1),[h,u]=(0,U.useState)(1),m=async()=>{try{s(!0);let e=await er.api.affiliates.list({page:c,limit:50,search:n,obraSocial:o});r(e.data.affiliates||[]),u(e.data.totalPages||1)}catch(e){console.error("Error loading affiliates:",e),ea.toast.error("Error al cargar afiliados")}finally{s(!1)}};(0,U.useEffect)(()=>{m()},[c,n,o]);let p=async e=>{if(confirm("¿Está seguro de eliminar este afiliado?"))try{await er.api.affiliates.delete(e),ea.toast.success("Afiliado eliminado"),m()}catch(e){ea.toast.error("Error al eliminar afiliado")}};return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-end gap-4",children:[(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2 mb-4","dark"===e?"text-white":"text-gray-700"),children:[(0,B.jsx)(iK.Search,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Buscar y Filtrar Afiliados"]}),(0,B.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3",children:(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs mb-1 block","dark"===e?"text-gray-400":"text-gray-500"),children:"Búsqueda por Nombre, CUIL o Teléfono"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)(iK.Search,{className:(0,V.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,B.jsx)("input",{type:"text",placeholder:"Buscar...",value:n,onChange:e=>i(e.target.value),className:(0,V.cn)("w-full pl-9 pr-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500":"bg-white border-gray-200 text-gray-700 placeholder:text-gray-400")})]})]})})]}),(0,B.jsxs)("button",{onClick:m,disabled:a,className:(0,V.cn)("flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 shrink-0 disabled:opacity-50","dark"===e?"bg-gradient-to-r from-cyan-600 to-cyan-500 text-white":"bg-gradient-to-r from-cyan-500 to-cyan-400 text-white"),children:[(0,B.jsx)(J.RefreshCw,{className:(0,V.cn)("w-4 h-4",a&&"animate-spin")}),"Recargar Datos"]})]})}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl p-4 text-sm","dark"===e?"bg-blue-500/10 text-blue-300":"bg-blue-50 text-blue-700"),children:["Mostrando ",t.length," afiliados"]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border backdrop-blur-sm overflow-hidden","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-sm",children:[(0,B.jsx)("thead",{children:(0,B.jsx)("tr",{className:(0,V.cn)("dark"===e?"bg-white/5 border-b border-white/10":"bg-purple-50/50 border-b border-purple-100"),children:["Nombre","CUIL","Obra Social","Teléfono","Localidad","Cargado","Acciones"].map(t=>(0,B.jsx)("th",{className:(0,V.cn)("px-4 py-3 text-left font-semibold whitespace-nowrap","dark"===e?"text-gray-300":"text-gray-600"),children:t},t))})}),(0,B.jsx)("tbody",{children:a?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:7,className:"px-4 py-8 text-center",children:(0,B.jsx)("div",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Cargando..."})})}):0===t.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:7,className:"px-4 py-8 text-center",children:(0,B.jsx)("div",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"No se encontraron afiliados"})})}):t.map(t=>(0,B.jsxs)("tr",{className:(0,V.cn)("border-b transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-purple-50 hover:bg-purple-50/50"),children:[(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 font-medium","dark"===e?"text-white":"text-gray-700"),children:t.nombre}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3","dark"===e?"text-gray-300":"text-gray-600"),children:t.cuil}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 max-w-xs truncate","dark"===e?"text-gray-400":"text-gray-500"),children:t.obraSocial}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3","dark"===e?"text-gray-300":"text-gray-600"),children:t.telefono1}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3","dark"===e?"text-gray-300":"text-gray-600"),children:t.localidad}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3","dark"===e?"text-gray-400":"text-gray-500"),children:new Date(t.uploadDate).toLocaleDateString("es-AR")}),(0,B.jsx)("td",{className:"px-4 py-3",children:(0,B.jsx)("button",{onClick:()=>p(t._id),className:(0,V.cn)("p-1.5 rounded transition-colors","dark"===e?"text-red-400 hover:bg-red-500/20":"text-red-600 hover:bg-red-100"),children:(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"})})})]},t._id))})]})})})]})}function iJ(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)(!1),[a,s]=(0,U.useState)(null),[n,i]=(0,U.useState)(!1),[o,l]=(0,U.useState)(null),c=(0,U.useRef)(null),d=async e=>{if(e.stopPropagation(),a)try{i(!0),l(null);let e=await er.api.affiliates.upload(a);console.log("🔍 [Upload Debug] Response data:",e.data);let t=e.data.imported||e.data.processed||0,r=e.data.duplicates||0,n=e.data.duplicatesReport;console.log("🔍 [Upload Debug] Extracted report URL:",n);let o={success:!0,message:`Archivo procesado: ${t} afiliados cargados${r>0?`, ${r} rechazados`:""}.`,stats:{...e.data,duplicatesReportUrl:n}};console.log("🔍 [Upload Debug] Setting result state:",o),l(o),ea.toast.success(`${t} afiliados cargados exitosamente`),s(null)}catch(t){console.error("Error procesando archivo:",t);let e=t.response?.data?.message||t.message||"Error al procesar el archivo";l({success:!1,message:e}),ea.toast.error(e)}finally{i(!1)}};return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-4",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-white to-[#FAF7F2]/80 border-purple-200/30 shadow-lg shadow-purple-100/30"),children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold flex items-center gap-2 mb-4","dark"===e?"text-white":"text-gray-700"),children:[(0,B.jsx)(el.Upload,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),"Cargar Archivo de Afiliados"]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl p-4 space-y-2","dark"===e?"bg-blue-500/10 border border-blue-500/20":"bg-blue-50 border border-blue-200"),children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold text-sm flex items-center gap-2","dark"===e?"text-blue-300":"text-blue-700"),children:[(0,B.jsx)(ek,{className:"w-4 h-4"}),"Requisitos del archivo:"]}),(0,B.jsxs)("ul",{className:(0,V.cn)("text-sm space-y-1 ml-6","dark"===e?"text-blue-200":"text-blue-600"),children:[(0,B.jsxs)("li",{children:[(0,B.jsx)("strong",{children:"Formato:"})," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===e?"text-cyan-400":"text-cyan-600"),children:".xlsx"})," o"," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===e?"text-cyan-400":"text-cyan-600"),children:".xls"})]}),(0,B.jsxs)("li",{children:[(0,B.jsx)("strong",{children:"Campos obligatorios:"})," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===e?"text-purple-400":"text-purple-600"),children:"Nombre, CUIL, Obra Social, Localidad, Teléfono_1"})]}),(0,B.jsxs)("li",{children:[(0,B.jsx)("strong",{children:"Campos opcionales:"})," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===e?"text-gray-400":"text-gray-600"),children:"Teléfono_2, Teléfono_3, Edad, Código de obra social"})]}),(0,B.jsxs)("li",{children:[(0,B.jsx)("strong",{children:"Tolerancia de headers:"})," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===e?"text-gray-400":"text-gray-600"),children:'Acepta variantes (ej: "nombre", "Name", "NOMBRE")'})]})]})]})]}),(0,B.jsxs)("div",{onDragOver:e=>{e.preventDefault(),r(!0)},onDragLeave:()=>{r(!1)},onDrop:e=>{e.preventDefault(),r(!1);let t=e.dataTransfer.files[0];t&&(t.name.endsWith(".xlsx")||t.name.endsWith(".xls"))&&s(t)},onClick:()=>c.current?.click(),className:(0,V.cn)("rounded-2xl border-2 border-dashed p-8 lg:p-12 text-center cursor-pointer transition-all duration-300",t?"dark"===e?"border-purple-500 bg-purple-500/10":"border-purple-400 bg-purple-50":"dark"===e?"border-white/20 bg-white/5 hover:border-purple-500/50 hover:bg-purple-500/5":"border-gray-300 bg-white hover:border-purple-300 hover:bg-purple-50/50"),children:[(0,B.jsx)("input",{ref:c,type:"file",accept:".xlsx,.xls",onChange:e=>{let t=e.target.files?.[0];t&&(s(t),l(null))},className:"hidden"}),a?(0,B.jsxs)("div",{className:"space-y-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-16 h-16 mx-auto rounded-xl flex items-center justify-center","dark"===e?"bg-green-500/20":"bg-green-100"),children:(0,B.jsx)(iW.CheckCircle,{className:(0,V.cn)("w-8 h-8","dark"===e?"text-green-400":"text-green-500")})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:a.name}),(0,B.jsxs)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:[(a.size/1024).toFixed(2)," KB"]})]}),(0,B.jsx)("button",{onClick:d,disabled:n,className:(0,V.cn)("px-6 py-2 rounded-lg font-medium text-sm transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed","dark"===e?"bg-gradient-to-r from-green-600 to-green-500 text-white":"bg-gradient-to-r from-green-500 to-green-400 text-white"),children:n?"Procesando...":"Procesar Archivo"})]}):(0,B.jsxs)("div",{className:"space-y-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-16 h-16 mx-auto rounded-xl flex items-center justify-center","dark"===e?"bg-white/10":"bg-gray-100"),children:(0,B.jsx)(Z,{className:(0,V.cn)("w-8 h-8","dark"===e?"text-purple-400":"text-purple-500")})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-700"),children:"Click aquí para seleccionar archivo"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"O arrastra y suelta tu archivo .xlsx"})]})]})]}),o&&(0,B.jsx)("div",{className:"mt-4",children:(0,B.jsx)("div",{className:(0,V.cn)("p-4 rounded-xl text-sm border shadow-sm transition-all duration-300 animate-in fade-in slide-in-from-top-2",o.success?"dark"===e?"bg-green-500/10 text-green-300 border-green-500/20":"bg-green-50 text-green-700 border-green-200":"dark"===e?"bg-red-500/10 text-red-300 border-red-500/20":"bg-red-50 text-red-700 border-red-200"),children:(0,B.jsxs)("div",{className:"flex items-start gap-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("p-2 rounded-full shrink-0",o.success?"dark"===e?"bg-green-500/20":"bg-green-100":"dark"===e?"bg-red-500/20":"bg-red-100"),children:o.success?(0,B.jsx)(iW.CheckCircle,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-green-400":"text-green-600")}):(0,B.jsx)(ek,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-red-400":"text-red-600")})}),(0,B.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,B.jsx)("p",{className:"font-medium pt-1",children:o.message}),o.stats?.duplicatesReportUrl&&(0,B.jsxs)("button",{onClick:async()=>{try{let e=await er.api.client.get(o.stats.duplicatesReportUrl,{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t;let a=o.stats.duplicatesReportUrl.split("/").pop()||"reporte_rechazos.xlsx";r.setAttribute("download",a),document.body.appendChild(r),r.click(),r.parentNode?.removeChild(r),window.URL.revokeObjectURL(t)}catch(e){console.error("Error downloading report:",e),ea.toast.error("Error al descargar el reporte")}},className:(0,V.cn)("inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 cursor-pointer","dark"===e?"bg-yellow-500/10 text-yellow-300 border border-yellow-500/20 hover:bg-yellow-500/20":"bg-yellow-50 text-yellow-700 border border-yellow-200 hover:bg-yellow-100"),children:[(0,B.jsx)(Z,{className:"w-4 h-4"}),"Descargar Reporte de Rechazos"]})]})]})})})]})}var iZ=e.i(56667);let i0=(0,Y.default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var i1=e.i(34684);let i2=(0,Y.default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var i5=e.i(66487),i4={};i4.version="0.18.5";var i3=1200,i6=1252,i8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],i7={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},i9=function(e){-1!=i8.indexOf(e)&&(i6=i7[0]=e)},oe=function(e){i3=e,i9(e)};function ot(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var or=function(e){return String.fromCharCode(e)},oa=function(e){return String.fromCharCode(e)},os="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function on(e){for(var t="",r=0,a=0,s=0,n=0,i=0,o=0,l=0,c=0;c<e.length;)n=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(a=e.charCodeAt(c++))>>4,o=(15&a)<<2|(s=e.charCodeAt(c++))>>6,l=63&s,isNaN(a)?o=l=64:isNaN(s)&&(l=64),t+=os.charAt(n)+os.charAt(i)+os.charAt(o)+os.charAt(l);return t}function oi(e){var t="",r=0,a=0,s=0,n=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)t+=String.fromCharCode((s=os.indexOf(e.charAt(l++)))<<2|(n=os.indexOf(e.charAt(l++)))>>4),r=(15&n)<<4|(i=os.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(r)),a=(3&i)<<6|(o=os.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var oo=void 0!==i5.Buffer&&void 0!==th.default&&void 0!==th.default.versions&&!!th.default.versions.node,ol=function(){if(void 0!==i5.Buffer){var e=!i5.Buffer.from;if(!e)try{i5.Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new i5.Buffer(e,t):new i5.Buffer(e)}:i5.Buffer.from.bind(i5.Buffer)}return function(){}}();function oc(e){return oo?i5.Buffer.alloc?i5.Buffer.alloc(e):new i5.Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):Array(e)}function od(e){return oo?i5.Buffer.allocUnsafe?i5.Buffer.allocUnsafe(e):new i5.Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):Array(e)}var oh=function(e){return oo?ol(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function ou(e){if("undefined"==typeof ArrayBuffer)return oh(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=255&e.charCodeAt(a);return t}function om(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}var op=oo?function(e){return i5.Buffer.concat(e.map(function(e){return i5.Buffer.isBuffer(e)?e:ol(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else if("string"==typeof e[t])throw"wtf";else a.set(new Uint8Array(e[t]),r);return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))},of=/\u0000/g,og=/[\u0001-\u0006]/g;function ox(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ob(e,t){var r=""+e;return r.length>=t?r:ld("0",t-r.length)+r}function oy(e,t){var r=""+e;return r.length>=t?r:ld(" ",t-r.length)+r}function ov(e,t){var r=""+e;return r.length>=t?r:r+ld(" ",t-r.length)}function ow(e,t){var r,a;return e>0x100000000||e<-0x100000000?(r=""+Math.round(e)).length>=t?r:ld("0",t-r.length)+r:(a=""+Math.round(e)).length>=t?a:ld("0",t-a.length)+a}function oN(e,t){return t=t||0,e.length>=7+t&&(32|e.charCodeAt(t))==103&&(32|e.charCodeAt(t+1))==101&&(32|e.charCodeAt(t+2))==110&&(32|e.charCodeAt(t+3))==101&&(32|e.charCodeAt(t+4))==114&&(32|e.charCodeAt(t+5))==97&&(32|e.charCodeAt(t+6))==108}var oj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ok=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],oE={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},oS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function oC(e,t,r){for(var a=e<0?-1:1,s=e*a,n=0,i=1,o=0,l=1,c=0,d=0,h=Math.floor(s);c<t&&(o=(h=Math.floor(s))*i+n,d=h*c+l,!(s-h<5e-8));)s=1/(s-h),n=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=n):(d=c,o=i)),!r)return[0,a*o,d];var u=Math.floor(a*o/d);return[u,a*o-u*d,d]}function oA(e,t,r){if(e>2958465||e<0)return null;var a=0|e,s=Math.floor(86400*(e-a)),n=0,i=[],o={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(1e-6>Math.abs(o.u)&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,86400==++s&&(o.T=s=0,++a,++o.D)),60===a)i=r?[1317,10,29]:[1900,2,29],n=3;else if(0===a)i=r?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var l,c,d,h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),i=[h.getFullYear(),h.getMonth()+1,h.getDate()],n=h.getDay(),a<60&&(n=(n+6)%7),r&&(l=h,c=i,c[0]-=581,d=l.getDay(),l<60&&(d=(d+6)%7),n=d)}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,o.M=(s=Math.floor(s/60))%60,o.H=s=Math.floor(s/60),o.q=n,o}var oR=new Date(1899,11,31,0,0,0),oO=oR.getTime(),o_=new Date(1900,2,1,0,0,0);function oD(e,t){var r=e.getTime();return t?r-=1262304e5:e>=o_&&(r+=864e5),(r-(oO+(e.getTimezoneOffset()-oR.getTimezoneOffset())*6e4))/864e5}function oP(e){return -1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function oI(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":var r,a,s,n,i,o,l;return(0|e)===e?e.toString(10):((l=Math.floor(Math.log(Math.abs(r=e))*Math.LOG10E))>=-4&&l<=-1?o=r.toPrecision(10+l):9>=Math.abs(l)?(a=r<0?12:11,o=(s=oP(r.toFixed(12))).length<=a||(s=r.toPrecision(10)).length<=a?s:r.toExponential(5)):o=10===l?r.toFixed(10).substr(0,12):(n=oP(r.toFixed(11))).length>(r<0?12:11)||"0"===n||"-0"===n?r.toPrecision(6):n,oP(-1==(i=o.toUpperCase()).indexOf("E")?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")));case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return oK(14,oD(e,t&&t.date1904),t)}throw Error("unsupported value in General format: "+e)}function oL(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var oM=/%/g,oF=/# (\?+)( ?)\/( ?)(\d+)/,oB=/^#*0*\.([0#]+)/,oU=/\).*[0#]/,oV=/\(###\) ###\\?-####/;function oz(e){for(var t,r="",a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function oH(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function oW(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function o$(e,t,r){return(0|r)===r?function e(t,r,a){if(40===t.charCodeAt(0)&&!r.match(oU)){var s,n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?e("n",n,a):"("+e("n",n,-a)+")"}if(44===r.charCodeAt(r.length-1)){for(var i=r,o=i.length-1;44===i.charCodeAt(o-1);)--o;return o$(t,i.substr(0,o),a/Math.pow(10,3*(i.length-o)))}if(-1!==r.indexOf("%"))return c=(l=r).replace(oM,""),d=l.length-c.length,o$(t,c,a*Math.pow(10,2*d))+ld("%",d);if(-1!==r.indexOf("E"))return function e(t,r){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var n=t.indexOf(".");-1===n&&(n=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),!(a=(r/Math.pow(10,i)).toPrecision(s+1+(n+i)%n)).match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(n+i)%n)+"."+a.substr(i)+"E"})}else a=r.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(r,a);if(36===r.charCodeAt(0))return"$"+e(t,r.substr(" "==r.charAt(1)?2:1),a);var l,c,d,h,u,m,p,f=Math.abs(a),g=a<0?"-":"";if(r.match(/^00+$/))return g+ob(f,r.length);if(r.match(/^[#?]+$/))return h=""+a,0===a&&(h=""),h.length>r.length?h:oz(r.substr(0,r.length-h.length))+h;if(u=r.match(oF))return g+(0===f?"":""+f)+ld(" ",(s=u)[1].length+2+s[4].length);if(r.match(/^#+0+$/))return g+ob(f,r.length-r.indexOf("0"));if(u=r.match(oB))return h=(h=(""+a).replace(/^([^\.]+)$/,"$1."+oz(u[1])).replace(/\.$/,"."+oz(u[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+ld("0",oz(u[1]).length-t.length)}),-1!==r.indexOf("0.")?h:h.replace(/^0\./,".");if(u=(r=r.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return g+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".");if(u=r.match(/^#{1,3},##0(\.?)$/))return g+oL(""+f);if(u=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+e(t,r,-a):oL(""+a)+"."+ld("0",u[1].length);if(u=r.match(/^#,#*,#0/))return e(t,r.replace(/^#,#*,/,""),a);if(u=r.match(/^([0#]+)(\\?-([0#]+))+$/))return h=ox(e(t,r.replace(/[\\-]/g,""),a)),m=0,ox(ox(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return m<h.length?h.charAt(m++):"0"===e?"0":""}));if(r.match(oV))return"("+(h=e(t,"##########",a)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var x="";if(u=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return p=oC(f,Math.pow(10,m=Math.min(u[4].length,7))-1,!1),h=""+g," "==(x=o$("n",u[1],p[1])).charAt(x.length-1)&&(x=x.substr(0,x.length-1)+"0"),h+=x+u[2]+"/"+u[3],(x=ov(p[2],m)).length<u[4].length&&(x=oz(u[4].substr(u[4].length-x.length))+x),h+=x;if(u=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g+((p=oC(f,Math.pow(10,m=Math.min(Math.max(u[1].length,u[4].length),7))-1,!0))[0]||(p[1]?"":"0"))+" "+(p[1]?oy(p[1],m)+u[2]+"/"+u[3]+ov(p[2],m):ld(" ",2*m+1+u[2].length+u[3].length));if(u=r.match(/^[#0?]+$/))return(h=""+a,r.length<=h.length)?h:oz(r.substr(0,r.length-h.length))+h;if(u=r.match(/^([#0]+)\.([#0]+)$/)){m=(h=""+a.toFixed(Math.min(u[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");var b=r.indexOf(".")-m,y=r.length-h.length-b;return oz(r.substr(0,b)+h+r.substr(r.length-y))}if(u=r.match(/^00,000\.([#0]*0)$/))return a<0?"-"+e(t,r,-a):oL(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?ob(0,3-e.length):"")+e})+"."+ob(0,u[1].length);switch(r){case"###,###":case"##,###":case"#,###":var v=oL(""+f);return"0"!==v?g+v:"";default:if(r.match(/\.[0#?]*$/))return e(t,r.slice(0,r.lastIndexOf(".")),a)+oz(r.slice(r.lastIndexOf(".")))}throw Error("unsupported format |"+r+"|")}(e,t,r):function e(t,r,a){if(40===t.charCodeAt(0)&&!r.match(oU)){var s,n,i,o,l,c,d=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?e("n",d,a):"("+e("n",d,-a)+")"}if(44===r.charCodeAt(r.length-1)){for(var h=r,u=h.length-1;44===h.charCodeAt(u-1);)--u;return o$(t,h.substr(0,u),a/Math.pow(10,3*(h.length-u)))}if(-1!==r.indexOf("%"))return p=(m=r).replace(oM,""),f=m.length-p.length,o$(t,p,a*Math.pow(10,2*f))+ld("%",f);if(-1!==r.indexOf("E"))return function e(t,r){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+e(t,-r);var n=t.indexOf(".");-1===n&&(n=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),-1===(a=(r/Math.pow(10,i)).toPrecision(s+1+(n+i)%n)).indexOf("e")){var o=Math.floor(Math.log(r)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(o-a.length+i):a+="E+"+(o-i);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,n)+"."+a.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,a){return t+r+a.substr(0,(n+i)%n)+"."+a.substr(i)+"E"})}else a=r.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(r,a);if(36===r.charCodeAt(0))return"$"+e(t,r.substr(" "==r.charAt(1)?2:1),a);var m,p,f,g,x,b,y,v=Math.abs(a),w=a<0?"-":"";if(r.match(/^00+$/))return w+ow(v,r.length);if(r.match(/^[#?]+$/))return"0"===(g=ow(a,0))&&(g=""),g.length>r.length?g:oz(r.substr(0,r.length-g.length))+g;if(x=r.match(oF))return o=Math.floor((i=Math.round(v*(n=parseInt((s=x)[4],10))))/n),l=i-o*n,w+(0===o?"":""+o)+" "+(0===l?ld(" ",s[1].length+1+s[4].length):oy(l,s[1].length)+s[2]+"/"+s[3]+ob(n,s[4].length));if(r.match(/^#+0+$/))return w+ow(v,r.length-r.indexOf("0"));if(x=r.match(oB))return g=oH(a,x[1].length).replace(/^([^\.]+)$/,"$1."+oz(x[1])).replace(/\.$/,"."+oz(x[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+ld("0",oz(x[1]).length-t.length)}),-1!==r.indexOf("0.")?g:g.replace(/^0\./,".");if(x=(r=r.replace(/^#+([0.])/,"$1")).match(/^(0*)\.(#*)$/))return w+oH(v,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=r.match(/^#{1,3},##0(\.?)$/))return w+oL(ow(v,0));if(x=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+e(t,r,-a):oL(""+(Math.floor(a)+ +((c=x[1].length)<(""+Math.round((a-Math.floor(a))*Math.pow(10,c))).length)))+"."+ob(oW(a,x[1].length),x[1].length);if(x=r.match(/^#,#*,#0/))return e(t,r.replace(/^#,#*,/,""),a);if(x=r.match(/^([0#]+)(\\?-([0#]+))+$/))return g=ox(e(t,r.replace(/[\\-]/g,""),a)),b=0,ox(ox(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return b<g.length?g.charAt(b++):"0"===e?"0":""}));if(r.match(oV))return"("+(g=e(t,"##########",a)).substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var N="";if(x=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return y=oC(v,Math.pow(10,b=Math.min(x[4].length,7))-1,!1),g=""+w," "==(N=o$("n",x[1],y[1])).charAt(N.length-1)&&(N=N.substr(0,N.length-1)+"0"),g+=N+x[2]+"/"+x[3],(N=ov(y[2],b)).length<x[4].length&&(N=oz(x[4].substr(x[4].length-N.length))+N),g+=N;if(x=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return w+((y=oC(v,Math.pow(10,b=Math.min(Math.max(x[1].length,x[4].length),7))-1,!0))[0]||(y[1]?"":"0"))+" "+(y[1]?oy(y[1],b)+x[2]+"/"+x[3]+ov(y[2],b):ld(" ",2*b+1+x[2].length+x[3].length));if(x=r.match(/^[#0?]+$/))return(g=ow(a,0),r.length<=g.length)?g:oz(r.substr(0,r.length-g.length))+g;if(x=r.match(/^([#0?]+)\.([#0]+)$/)){b=(g=""+a.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1")).indexOf(".");var j=r.indexOf(".")-b,k=r.length-g.length-j;return oz(r.substr(0,j)+g+r.substr(r.length-k))}if(x=r.match(/^00,000\.([#0]*0)$/))return b=oW(a,x[1].length),a<0?"-"+e(t,r,-a):oL(a<0x7fffffff&&a>-0x80000000?""+(a>=0?0|a:a-1|0):""+Math.floor(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?ob(0,3-e.length):"")+e})+"."+ob(b,x[1].length);switch(r){case"###,##0.00":return e(t,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var E=oL(ow(v,0));return"0"!==E?w+E:"";case"###,###.00":return e(t,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return e(t,"#,##0.00",a).replace(/^0\./,".")}throw Error("unsupported format |"+r+"|")}(e,t,r)}var oG=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function oq(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":oN(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase()||"AM/PM"===e.substr(t,5).toUpperCase()||"上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=r;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(oG))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(" "==e.charAt(t)||"*"==e.charAt(t))&&++t;break;case"(":case")":case" ":default:++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);}return!1}var oY=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function oX(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function oK(e,t,r){null==r&&(r={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(a=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:oE)[e])&&(a=r.table&&r.table[oS[e]]||oE[oS[e]]),null==a&&(a=oT[e]||"General")}if(oN(a,0))return oI(t,r);t instanceof Date&&(t=oD(t,r.date1904));var s=function(e,t){var r=function(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),!0===r)throw Error("Format |"+e+"| unterminated string ");return t}(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var n=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[a,n];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(oY),o=r[1].match(oY);return oX(t,i)?[a,r[0]]:oX(t,o)?[a,r[1]]:[a,r[null!=i&&null!=o?2:1]]}return[a,n]}(a,t);if(oN(s[1]))return oI(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,a){for(var s,n,i,o=[],l="",c=0,d="",h="t",u="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!oN(e,c))throw Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var m=e.charAt(++c),p="("===m||")"===m?m:"t";o[o.length]={t:p,v:m},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==s&&null==(s=oA(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||null==s&&null==(s=oA(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===h.toLowerCase()&&(d="M"),"h"===d&&(d=u),o[o.length]={t:d,v:l},h=d;break;case"A":case"a":case"上":var f={t:d,v:d};if(null==s&&(s=oA(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=s&&(f.v=s.H>=12?"P":"A"),f.t="T",u="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=s&&(f.v=s.H>=12?"PM":"AM"),f.t="T",c+=5,u="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=s&&(f.v=s.H>=12?"下午":"上午"),f.t="T",c+=5,u="h"):(f.t="t",++c),null==s&&"T"===f.t)return"";o[o.length]=f,h=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(oG)){if(null==s&&null==(s=oA(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",oq(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=s){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},h=d;break;case"*":++c,(" "==e.charAt(c)||"*"==e.charAt(c))&&++c;break;case"(":case")":o[o.length]={t:1===a?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d))throw Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,x=0,b=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=u,h="h",x<1&&(x=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&o[c].v.match(/[Hh]/)&&(x=1),x<2&&o[c].v.match(/[Mm]/)&&(x=2),x<3&&o[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M),s.M>=60&&(s.M=0,++s.H);break;case 2:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M)}var y,v="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=function(e,t,r,a){var s,n="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:s=l%100,c=2;break;default:s=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:s=r.m,c=t.length;break;case 3:return ok[r.m-1][1];case 5:return ok[r.m-1][0];default:return ok[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:s=r.d,c=t.length;break;case 3:return oj[r.q][0];default:return oj[r.q][1]}break;case 104:switch(t.length){case 1:case 2:s=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:s=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:s=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;if(0===r.u&&("s"==t||"ss"==t))return ob(r.S,t.length);if((i=Math.round((o=a>=2?3===a?1e3:100:1===a?10:1)*(r.S+r.u)))>=60*o&&(i=0),"s"===t)return 0===i?"0":""+i/o;if(n=ob(i,2+a),"ss"===t)return n.substr(0,2);return"."+n.substr(2,t.length-1);case 90:switch(t){case"[h]":case"[hh]":s=24*r.D+r.H;break;case"[m]":case"[mm]":s=(24*r.D+r.H)*60+r.M;break;case"[s]":case"[ss]":s=((24*r.D+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:s=l,c=1}return c>0?ob(s,c):""}(o[c].t.charCodeAt(0),o[c].v,s,b),o[c].t="t";break;case"n":case"?":for(y=c+1;null!=o[y]&&("?"===(d=o[y].t)||"D"===d||(" "===d||"t"===d)&&null!=o[y+1]&&("?"===o[y+1].t||"t"===o[y+1].t&&"/"===o[y+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[y].v||" "===o[y].v&&null!=o[y+1]&&"?"==o[y+1].t));)o[c].v+=o[y].v,o[y]={v:"",t:";"},++y;v+=o[c].v,c=y-1;break;case"G":o[c].t="t",o[c].v=oI(t,r)}var w,N,j="";if(v.length>0){40==v.charCodeAt(0)?(w=t<0&&45===v.charCodeAt(0)?-t:t,N=o$("n",v,w)):(N=o$("n",v,w=t<0&&a>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(N=N.substr(1),o[0].v="-"+o[0].v)),y=N.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var E=o.length;if(k===o.length&&-1===N.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(y>=o[c].v.length-1?(y-=o[c].v.length,o[c].v=N.substr(y+1,o[c].v.length)):y<0?o[c].v="":(o[c].v=N.substr(0,y+1),y=-1),o[c].t="t",E=c);y>=0&&E<o.length&&(o[E].v=N.substr(0,y+1)+o[E].v)}else if(k!==o.length&&-1===N.indexOf("E")){for(y=N.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(n=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,j=o[c].v.substr(n+1);n>=0;--n)y>=0&&("0"===o[c].v.charAt(n)||"#"===o[c].v.charAt(n))&&(j=N.charAt(y--)+j);o[c].v=j,o[c].t="t",E=c}for(y>=0&&E<o.length&&(o[E].v=N.substr(0,y+1)+o[E].v),y=N.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(n=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,j=o[c].v.substr(0,n);n<o[c].v.length;++n)y<N.length&&(j+=N.charAt(y++));o[c].v=j,o[c].t="t",E=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=a>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=o$(o[c].t,o[c].v,w),o[c].t="t");var S="";for(c=0;c!==o.length;++c)null!=o[c]&&(S+=o[c].v);return S}(s[1],t,r,s[0])}function oQ(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r){if(void 0==oE[r]){t<0&&(t=r);continue}if(oE[r]==e){t=r;break}}t<0&&(t=391)}return oE[t]=e,t}function oJ(e){for(var t=0;392!=t;++t)void 0!==e[t]&&oQ(e[t],t)}function oZ(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',oE=e}var o0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,o1=((i={}).version="1.2.0",c=(l=function(e){var t=0,r=0,a=0,s="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(a=0;256!=a;++a)s[a]=e[a];for(a=0;256!=a;++a)for(r=e[a],t=256+a;t<4096;t+=256)r=s[t]=r>>>8^e[255&r];var n=[];for(a=1;16!=a;++a)n[a-1]="undefined"!=typeof Int32Array?s.subarray(256*a,256*a+256):s.slice(256*a,256*a+256);return n}(o=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}()))[0],d=l[1],h=l[2],u=l[3],m=l[4],p=l[5],f=l[6],g=l[7],x=l[8],b=l[9],y=l[10],v=l[11],w=l[12],N=l[13],j=l[14],i.table=o,i.bstr=function(e,t){for(var r=-1^t,a=0,s=e.length;a<s;)r=r>>>8^o[(r^e.charCodeAt(a++))&255];return~r},i.buf=function(e,t){for(var r=-1^t,a=e.length-15,s=0;s<a;)r=j[e[s++]^255&r]^N[e[s++]^r>>8&255]^w[e[s++]^r>>16&255]^v[e[s++]^r>>>24]^y[e[s++]]^b[e[s++]]^x[e[s++]]^g[e[s++]]^f[e[s++]]^p[e[s++]]^m[e[s++]]^u[e[s++]]^h[e[s++]]^d[e[s++]]^c[e[s++]]^o[e[s++]];for(a+=15;s<a;)r=r>>>8^o[(r^e[s++])&255];return~r},i.str=function(e,t){for(var r=-1^t,a=0,s=e.length,n=0,i=0;a<s;)(n=e.charCodeAt(a++))<128?r=r>>>8^o[(r^n)&255]:n<2048?r=(r=r>>>8^o[(r^(192|n>>6&31))&255])>>>8^o[(r^(128|63&n))&255]:n>=55296&&n<57344?(n=(1023&n)+64,i=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^o[(r^(240|n>>8&7))&255])>>>8^o[(r^(128|n>>2&63))&255])>>>8^o[(r^(128|i>>6&15|(3&n)<<4))&255])>>>8^o[(r^(128|63&i))&255]):r=(r=(r=r>>>8^o[(r^(224|n>>12&15))&255])>>>8^o[(r^(128|n>>6&63))&255])>>>8^o[(r^(128|63&n))&255];return~r},i),o2=function(){var e,t,r={};function a(e){if("/"==e.charAt(e.length-1))return -1===e.slice(0,-1).indexOf("/")?e:a(e.slice(0,-1));var t=e.lastIndexOf("/");return -1===t?e:e.slice(0,t+1)}function s(e){if("/"==e.charAt(e.length-1))return s(e.slice(0,-1));var t=e.lastIndexOf("/");return -1===t?e:e.slice(t+1)}function n(e){cx(e,0);for(var t={},r=0;e.l<=e.length-4;){var a=e.read_shift(2),s=e.read_shift(2),n=e.l+s,i={};21589===a&&(1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),s>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime))),e.l=n,t[a]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return Q(e,t);if((32|e[0])==109&&(32|e[1])==105)return function(e,t){if("mime-version:"!=b(e.slice(0,13)).toLowerCase())throw Error("Unsupported MAD header");var r=t&&t.root||"",a=(oo&&i5.Buffer.isBuffer(e)?e.toString("binary"):b(e)).split("\r\n"),s=0,n="";for(s=0;s<a.length;++s)if((n=a[s],/^Content-Location:/i.test(n))&&(n=n.slice(n.indexOf("file")),r||(r=n.slice(0,n.lastIndexOf("/")+1)),n.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),n.slice(0,r.length)!=r););var i=(a[1]||"").match(/boundary="(.*?)"/);if(!i)throw Error("MAD cannot find boundary");var o="--"+(i[1]||""),l={FileIndex:[],FullPaths:[]};c(l);var d,h=0;for(s=0;s<a.length;++s){var u=a[s];(u===o||u===o+"--")&&(h++&&function(e,t,r){for(var a,s="",n="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":s=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":n=c[2].trim()}}switch(++o,n.toLowerCase()){case"base64":a=oh(oi(t.slice(o).join("")));break;case"quoted-printable":a=function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r];r<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++r];t.push(a)}for(var s=0;s<t.length;++s)t[s]=t[s].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return oh(t.join("\r\n"))}(t.slice(o));break;default:throw Error("Unsupported Content-Transfer-Encoding "+n)}var d=Z(e,s.slice(r.length),a,{unsafe:!0});i&&(d.ctype=i)}(l,a.slice(d,s),r),d=s)}return l}(e,t);if(e.length<512)throw Error("CFB file size "+e.length+" < 512");var r=3,a=512,s=0,n=0,i=0,o=0,d=0,h=[],f=e.slice(0,512);cx(f,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(p,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(f);switch(r=g[0]){case 3:a=512;break;case 4:a=4096;break;case 0:if(0==g[1])return Q(e,t);default:throw Error("Major Version: Expected 3 or 4 saw "+r)}512!==a&&cx(f=e.slice(0,a),28);var x=e.slice(0,a),y=f,v=r,w=9;switch(y.l+=2,w=y.read_shift(2)){case 9:if(3!=v)throw Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(4!=v)throw Error("Sector Shift: Expected 12 saw "+w);break;default:throw Error("Sector Shift: Expected 9 or 12 saw "+w)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ");var N=f.read_shift(4,"i");if(3===r&&0!==N)throw Error("# Directory Sectors: Expected 0 saw "+N);f.l+=4,i=f.read_shift(4,"i"),f.l+=4,f.chk("00100000","Mini Stream Cutoff Size: "),o=f.read_shift(4,"i"),s=f.read_shift(4,"i"),d=f.read_shift(4,"i"),n=f.read_shift(4,"i");for(var j=-1,k=0;k<109&&!((j=f.read_shift(4,"i"))<0);++k)h[k]=j;var E=function(e,t){for(var r=Math.ceil(e.length/t)-1,a=[],s=1;s<r;++s)a[s-1]=e.slice(s*t,(s+1)*t);return a[r-1]=e.slice(r*t),a}(e,a);!function e(t,r,a,s,n){var i=m;if(t===m){if(0!==r)throw Error("DIFAT chain shorter than expected")}else if(-1!==t){var o=a[t],l=(s>>>2)-1;if(!o)return;for(var c=0;c<l&&(i=cd(o,4*c))!==m;++c)n.push(i);e(cd(o,s-4),r-1,a,s,n)}}(d,n,E,a,h);var S=function(e,t,r,a){var s=e.length,n=[],i=[],o=[],l=[],c=a-1,d=0,h=0,u=0,m=0;for(d=0;d<s;++d)if(o=[],(u=d+t)>=s&&(u-=s),!i[u]){l=[];var p=[];for(h=u;h>=0;){p[h]=!0,i[h]=!0,o[o.length]=h,l.push(e[h]);var f=r[Math.floor(4*h/a)];if(a<4+(m=4*h&c))throw Error("FAT boundary crossed: "+h+" 4 "+a);if(!e[f]||p[h=cd(e[f],m)])break}n[u]={nodes:o,data:lK([l])}}return n}(E,i,h,a);S[i].name="!Directory",s>0&&o!==m&&(S[o].name="!MiniFAT"),S[h[0]].name="!FAT",S.fat_addrs=h,S.ssz=a;var T=[],C=[],A=[];(function(e,t,r,a,s,n,i,o){for(var c,d=0,h=2*!!a.length,p=t[e].data,f=0,g=0;f<p.length;f+=128){var x=p.slice(f,f+128);cx(x,64),g=x.read_shift(2),c=lJ(x,0,g-h),a.push(c);var b={name:c,type:x.read_shift(1),color:x.read_shift(1),L:x.read_shift(4,"i"),R:x.read_shift(4,"i"),C:x.read_shift(4,"i"),clsid:x.read_shift(16),state:x.read_shift(4,"i"),start:0,size:0};0!==x.read_shift(2)+x.read_shift(2)+x.read_shift(2)+x.read_shift(2)&&(b.ct=l(x,x.l-8)),0!==x.read_shift(2)+x.read_shift(2)+x.read_shift(2)+x.read_shift(2)&&(b.mt=l(x,x.l-8)),b.start=x.read_shift(4,"i"),b.size=x.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=m,b.name=""),5===b.type?(d=b.start,s>0&&d!==m&&(t[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=function(e,t,r,a,s){var n=[],i=[];s||(s=[]);var o=a-1,l=0,c=0;for(l=t;l>=0;){s[l]=!0,n[n.length]=l,i.push(e[l]);var d=r[Math.floor(4*l/a)];if(a<4+(c=4*l&o))throw Error("FAT boundary crossed: "+l+" 4 "+a);if(!e[d])break;l=cd(e[d],c)}return{nodes:n,data:lK([i])}}(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==m&&b.start!==m&&t[d]&&(b.content=function(e,t,r){for(var a=e.start,s=e.size,n=[],i=a;r&&s>0&&i>=0;)n.push(t.slice(i*u,i*u+u)),s-=u,i=cd(r,4*i);return 0===n.length?cy(0):op(n).slice(0,e.size)}(b,t[d].data,(t[o]||{}).data))),b.content&&cx(b.content,0),n[c]=b,i.push(b)}})(i,S,E,T,s,{},C,o),function(e,t,r){for(var a=0,s=0,n=0,i=0,o=0,l=r.length,c=[],d=[];a<l;++a)c[a]=d[a]=a,t[a]=r[a];for(;o<d.length;++o)s=e[a=d[o]].L,n=e[a].R,i=e[a].C,c[a]===a&&(-1!==s&&c[s]!==s&&(c[a]=c[s]),-1!==n&&c[n]!==n&&(c[a]=c[n])),-1!==i&&(c[i]=a),-1!==s&&a!=c[a]&&(c[s]=c[a],d.lastIndexOf(s)<o&&d.push(s)),-1!==n&&a!=c[a]&&(c[n]=c[a],d.lastIndexOf(n)<o&&d.push(n));for(a=1;a<l;++a)c[a]===a&&(-1!==n&&c[n]!==n?c[a]=c[n]:-1!==s&&c[s]!==s&&(c[a]=c[s]));for(a=1;a<l;++a)if(0!==e[a].type){if((o=a)!=c[o])do o=c[o],t[a]=t[o]+"/"+t[a];while(0!==o&&-1!==c[o]&&o!=c[o])c[a]=-1}for(t[0]+="/",a=1;a<l;++a)2!==e[a].type&&(t[a]+="/")}(C,A,T),T.shift();var R={FileIndex:C,FullPaths:A};return t&&t.raw&&(R.raw={header:x,sectors:E}),R}function l(e,t){return new Date((cc(e,t+4)/1e7*0x100000000+cc(e,t)/1e7-0x2b6109100)*1e3)}function c(e,t){var r=t||{},a=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(!o2.find(e,"/"+t)){var r=cy(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}}(e)}function d(e,t){c(e);for(var r=!1,n=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:n?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:n=!0,isNaN(o.R*o.L*o.C)&&(r=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(r=!0);break;default:r=!0}}if(r||t){var l=new Date(1987,1,19),d=0,h=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)h[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var m=a(u[i][0]);(n=h[m])||(u.push([m,{name:s(m).replace("/",""),type:1,clsid:g,ct:l,mt:l,content:null}]),h[m]=!0)}for(u.sort(function(e,t){return function(e,t){for(var r=e.split("/"),a=t.split("/"),s=0,n=0,i=Math.min(r.length,a.length);s<i;++s){if(n=r[s].length-a[s].length)return n;if(r[s]!=a[s])return r[s]<a[s]?-1:1}return r.length-a.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var p=e.FileIndex[i],f=e.FullPaths[i];if(p.name=s(f).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||g,0===i)p.C=u.length>1?1:-1,p.size=0,p.type=5;else if("/"==f.slice(-1)){for(d=i+1;d<u.length&&a(e.FullPaths[d])!=f;++d);for(p.C=d>=u.length?-1:d,d=i+1;d<u.length&&a(e.FullPaths[d])!=a(f);++d);p.R=d>=u.length?-1:d,p.type=1}else a(e.FullPaths[i+1]||"")==a(f)&&(p.R=i+1),p.type=2}}}function h(e,r){var a=r||{};if("mad"==a.fileType)return function(e,t){for(var r=t||{},a=r.boundary||"SheetJS",s=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(a="------="+a).slice(2)+'"',"","",""],n=e.FullPaths[0],i=n,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(n.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=oo&&i5.Buffer.isBuffer(c)?c.toString("binary"):b(c),h=0,u=Math.min(1024,d.length),m=0,p=0;p<=u;++p)(m=d.charCodeAt(p))>=32&&m<128&&++h;var f=h>=4*u/5;s.push(a),s.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),s.push("Content-Transfer-Encoding: "+(f?"quoted-printable":"base64")),s.push("Content-Type: "+function(e,t){if(e.ctype)return e.ctype;var r=e.name||"",a=r.match(/\.([^\.]+)$/);return a&&J[a[1]]||t&&(a=(r=t).match(/[\.\\]([^\.\\])+$/))&&J[a[1]]?J[a[1]]:"application/octet-stream"}(o,i)),s.push(""),s.push(f?function(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/mg,"=20").replace(/\t$/mg,"=09")).charAt(0)&&(t="=0D"+t.slice(1)),t=t.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,"\n=0A").replace(/([^\r\n])\n/mg,"$1=0A");for(var r=[],a=t.split("\r\n"),s=0;s<a.length;++s){var n=a[s];if(0==n.length){r.push("");continue}for(var i=0;i<n.length;){var o=76,l=n.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=n.slice(i,i+o),(i+=o)<n.length&&(l+="="),r.push(l)}}return r.join("\r\n")}(d):function(e){for(var t=on(e),r=[],a=0;a<t.length;a+=76)r.push(t.slice(a,a+76));return r.join("\r\n")+"\r\n"}(d))}return s.push(a+"--\r\n"),s.join("\r\n")}(e,a);if(d(e),"zip"===a.fileType)return function(e,r){var a=[],s=[],n=cy(1),i=8*!!(r||{}).compression,o=0,l=0,c=0,d=0,h=e.FullPaths[0],u=h,m=e.FileIndex[0],p=[],f=0;for(o=1;o<e.FullPaths.length;++o)if(u=e.FullPaths[o].slice(h.length),(m=e.FileIndex[o]).size&&m.content&&"\x01Sh33tJ5"!=u){var g,x=c,b=cy(u.length);for(l=0;l<u.length;++l)b.write_shift(1,127&u.charCodeAt(l));b=b.slice(0,b.l),p[d]=o1.buf(m.content,0);var y=m.content;8==i&&(g=y,y=t?t.deflateRawSync(g):z(g)),(n=cy(30)).write_shift(4,0x4034b50),n.write_shift(2,20),n.write_shift(2,0),n.write_shift(2,i),m.mt?function(e,t){"string"==typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var a=t.getFullYear()-1980;a=(a=a<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,a)}(n,m.mt):n.write_shift(4,0),n.write_shift(-4,(0,p[d])),n.write_shift(4,(0,y.length)),n.write_shift(4,(0,m.content.length)),n.write_shift(2,b.length),n.write_shift(2,0),c+=n.length,a.push(n),c+=b.length,a.push(b),c+=y.length,a.push(y),(n=cy(46)).write_shift(4,0x2014b50),n.write_shift(2,0),n.write_shift(2,20),n.write_shift(2,0),n.write_shift(2,i),n.write_shift(4,0),n.write_shift(-4,p[d]),n.write_shift(4,y.length),n.write_shift(4,m.content.length),n.write_shift(2,b.length),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n.write_shift(4,x),f+=n.l,s.push(n),f+=b.length,s.push(b),++d}return(n=cy(22)).write_shift(4,0x6054b50),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,d),n.write_shift(2,d),n.write_shift(4,f),n.write_shift(4,c),n.write_shift(2,0),op([op(a),op(s),n])}(e,a);var s=function(e){for(var t=0,r=0,a=0;a<e.FileIndex.length;++a){var s=e.FileIndex[a];if(s.content){var n=s.content.length;n>0&&(n<4096?t+=n+63>>6:r+=n+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+7>>3,l=t+127>>7,c=o+r+i+l,d=c+127>>7,h=d<=109?0:Math.ceil((d-109)/127);c+d+h+127>>7>d;)h=++d<=109?0:Math.ceil((d-109)/127);var u=[1,h,d,l,i,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),n=cy(s[7]<<9),i=0,o=0;for(i=0;i<8;++i)n.write_shift(1,f[i]);for(i=0;i<8;++i)n.write_shift(2,0);for(n.write_shift(2,62),n.write_shift(2,3),n.write_shift(2,65534),n.write_shift(2,9),n.write_shift(2,6),i=0;i<3;++i)n.write_shift(2,0);for(n.write_shift(4,0),n.write_shift(4,s[2]),n.write_shift(4,s[0]+s[1]+s[2]+s[3]-1),n.write_shift(4,0),n.write_shift(4,4096),n.write_shift(4,s[3]?s[0]+s[1]+s[2]-1:m),n.write_shift(4,s[3]),n.write_shift(-4,s[1]?s[0]-1:m),n.write_shift(4,s[1]),i=0;i<109;++i)n.write_shift(-4,i<s[2]?s[1]+i:-1);if(s[1])for(o=0;o<s[1];++o){for(;i<236+127*o;++i)n.write_shift(-4,i<s[2]?s[1]+i:-1);n.write_shift(-4,o===s[1]-1?m:o+1)}var l=function(e){for(o+=e;i<o-1;++i)n.write_shift(-4,i+1);e&&(++i,n.write_shift(-4,m))};for(o=(i=0)+s[1];i<o;++i)n.write_shift(-4,x.DIFSECT);for(o+=s[2];i<o;++i)n.write_shift(-4,x.FATSECT);l(s[3]),l(s[4]);for(var c=0,h=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((h=u.content.length)<4096||(u.start=o,l(h+511>>9)));for(l(s[6]+7>>3);511&n.l;)n.write_shift(-4,x.ENDOFCHAIN);for(c=0,o=i=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(h=u.content.length)&&!(h>=4096)&&(u.start=o,l(h+63>>6));for(;511&n.l;)n.write_shift(-4,x.ENDOFCHAIN);for(i=0;i<s[4]<<2;++i){var p=e.FullPaths[i];if(!p||0===p.length){for(c=0;c<17;++c)n.write_shift(4,0);for(c=0;c<3;++c)n.write_shift(4,-1);for(c=0;c<12;++c)n.write_shift(4,0);continue}u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:m);var g=0===i&&a.root||u.name;if(h=2*(g.length+1),n.write_shift(64,g,"utf16le"),n.write_shift(2,h),n.write_shift(1,u.type),n.write_shift(1,u.color),n.write_shift(-4,u.L),n.write_shift(-4,u.R),n.write_shift(-4,u.C),u.clsid)n.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)n.write_shift(4,0);n.write_shift(4,u.state||0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,u.start),n.write_shift(4,u.size),n.write_shift(4,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(n.l=u.start+1<<9,oo&&i5.Buffer.isBuffer(u.content))u.content.copy(n,n.l,0,u.size),n.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)n.write_shift(1,u.content[c]);for(;511&c;++c)n.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(oo&&i5.Buffer.isBuffer(u.content))u.content.copy(n,n.l,0,u.size),n.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)n.write_shift(1,u.content[c]);for(;63&c;++c)n.write_shift(1,0)}if(oo)n.l=n.length;else for(;n.l<n.length;)n.write_shift(1,0);return n}r.version="1.2.1";var u=64,m=-2,p="d0cf11e0a1b11ae1",f=[208,207,17,224,161,177,26,225],g="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:-2,FREESECT:-1,HEADER_SIGNATURE:p,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:g,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function b(e){for(var t=Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}for(var y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],N="undefined"!=typeof Uint8Array,j=N?new Uint8Array(256):[],k=0;k<256;++k)j[k]=function(e){var t=(e<<1|e<<11)&139536|(e<<5|e<<15)&558144;return(t>>16|t>>8|t)&255}(k);function E(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=5?0:e[a+1]<<8))>>>r&7}function S(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=3?0:e[a+1]<<8))>>>r&31}function T(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=1?0:e[a+1]<<8))>>>r&127}function C(e,t,r){var a=7&t,s=t>>>3,n=(1<<r)-1,i=e[s]>>>a;return r<8-a||(i|=e[s+1]<<8-a,r<16-a||(i|=e[s+2]<<16-a,r<24-a))?i&n:(i|=e[s+3]<<24-a)&n}function A(e,t,r){var a=7&t,s=t>>>3;return a<=5?e[s]|=(7&r)<<a:(e[s]|=r<<a&255,e[s+1]=(7&r)>>8-a),t+3}function R(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=r,t+8}function O(e,t,r){var a=t>>>3;return r<<=7&t,e[a]|=255&r,r>>>=8,e[a+1]=255&r,e[a+2]=r>>>8,t+16}function _(e,t){var r=e.length,a=2*r>t?2*r:t+5,s=0;if(r>=t)return e;if(oo){var n=od(a);if(e.copy)e.copy(n);else for(;s<e.length;++s)n[s]=e[s];return n}if(N){var i=new Uint8Array(a);if(i.set)i.set(e);else for(;s<r;++s)i[s]=e[s];return i}return e.length=a,e}function D(e){for(var t=Array(e),r=0;r<e;++r)t[r]=0;return t}function P(e,t,r){var a=1,s=0,n=0,i=0,o=0,l=e.length,c=N?new Uint16Array(32):D(32);for(n=0;n<32;++n)c[n]=0;for(n=l;n<r;++n)e[n]=0;l=e.length;var d=N?new Uint16Array(l):D(l);for(n=0;n<l;++n)c[s=e[n]]++,a<s&&(a=s),d[n]=0;for(n=1,c[0]=0;n<=a;++n)c[n+16]=o=o+c[n-1]<<1;for(n=0;n<l;++n)0!=(o=e[n])&&(d[n]=c[o+16]++);var h=0;for(n=0;n<l;++n)if(0!=(h=e[n]))for(o=function(e,t){var r=j[255&e];return t<=8?r>>>8-t:(r=r<<8|j[e>>8&255],t<=16)?r>>>16-t:(r=r<<8|j[e>>16&255])>>>24-t}(d[n],a)>>a-h,i=(1<<a+4-h)-1;i>=0;--i)t[o|i<<h]=15&h|n<<4;return a}var I=N?new Uint16Array(512):D(512),L=N?new Uint16Array(32):D(32);if(!N){for(var M=0;M<512;++M)I[M]=0;for(M=0;M<32;++M)L[M]=0}for(var F=[],B=0;B<32;B++)F.push(5);P(F,L,32);var U=[];for(B=0;B<=143;B++)U.push(8);for(;B<=255;B++)U.push(9);for(;B<=279;B++)U.push(7);for(;B<=287;B++)U.push(8);P(U,I,288);var V=function(){for(var e=N?new Uint8Array(32768):[],t=0,r=0;t<w.length-1;++t)for(;r<w[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var a=N?new Uint8Array(259):[];for(t=0,r=0;t<v.length-1;++t)for(;r<v[t+1];++r)a[r]=t;return function(t,r){if(t.length<8){for(var s=0;s<t.length;){var n=Math.min(65535,t.length-s),i=s+n==t.length;for(r.write_shift(1,+i),r.write_shift(2,n),r.write_shift(2,65535&~n);n-- >0;)r[r.l++]=t[s++]}return r.l}return function(t,r){for(var s=0,n=0,i=N?new Uint16Array(32768):[];n<t.length;){var o=Math.min(65535,t.length-n);if(o<10){for(7&(s=A(r,s,+(n+o==t.length)))&&(s+=8-(7&s)),r.l=s/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[n++];s=8*r.l;continue}s=A(r,s,+(n+o==t.length)+2);for(var l=0;o-- >0;){var c,d,h=t[n],u=-1,m=0;if((u=i[l=(l<<5^h)&32767])&&((u|=-32768&n)>n&&(u-=32768),u<n))for(;t[u+m]==t[n+m]&&m<250;)++m;if(m>2){(h=a[m])<=22?s=R(r,s,j[h+1]>>1)-1:(R(r,s,3),R(r,s+=5,j[h-23]>>5),s+=3);var p=h<8?0:h-4>>2;p>0&&(O(r,s,m-v[h]),s+=p),s=R(r,s,j[h=e[n-u]]>>3)-3;var f=h<4?0:h-2>>1;f>0&&(O(r,s,n-u-w[h]),s+=f);for(var g=0;g<m;++g)i[l]=32767&n,l=(l<<5^t[n])&32767,++n;o-=m-1}else h<=143?h+=48:(d=(1&(d=1))<<(7&(c=s)),r[c>>>3]|=d,s=c+1),s=R(r,s,j[h]),i[l]=32767&n,++n}s=R(r,s,0)-1}return r.l=(s+7)/8|0,r.l}(t,r)}}();function z(e){var t=cy(50+Math.floor(1.1*e.length)),r=V(e,t);return t.slice(0,r)}var H=N?new Uint16Array(32768):D(32768),W=N?new Uint16Array(32768):D(32768),G=N?new Uint16Array(128):D(128),q=1,Y=1;function X(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[oc(t),2];for(var r=0,a=0,s=od(t||262144),n=0,i=s.length>>>0,o=0,l=0;(1&a)==0;){if(a=E(e,r),r+=3,a>>>1==0){7&r&&(r+=8-(7&r));var c=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,c>0)for(!t&&i<n+c&&(i=(s=_(s,n+c)).length);c-- >0;)s[n++]=e[r>>>3],r+=8;continue}for(a>>1==1?(o=9,l=5):(r=function(e,t){var r,a,s,n=S(e,t)+257,i=S(e,t+=5)+1;t+=5;var o=(a=7&(r=t),((e[s=r>>>3]|(a<=4?0:e[s+1]<<8))>>>a&15)+4);t+=4;for(var l=0,c=N?new Uint8Array(19):D(19),d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=1,u=N?new Uint8Array(8):D(8),m=N?new Uint8Array(8):D(8),p=c.length,f=0;f<o;++f)c[y[f]]=l=E(e,t),h<l&&(h=l),u[l]++,t+=3;var g=0;for(f=1,u[0]=0;f<=h;++f)m[f]=g=g+u[f-1]<<1;for(f=0;f<p;++f)0!=(g=c[f])&&(d[f]=m[g]++);var x=0;for(f=0;f<p;++f)if(0!=(x=c[f])){g=j[d[f]]>>8-x;for(var b=(1<<7-x)-1;b>=0;--b)G[g|b<<x]=7&x|f<<3}var v=[];for(h=1;v.length<n+i;)switch(g=G[T(e,t)],t+=7&g,g>>>=3){case 16:for(l=3+function(e,t){var r=7&t,a=t>>>3;return(e[a]|(r<=6?0:e[a+1]<<8))>>>r&3}(e,t),t+=2,g=v[v.length-1];l-- >0;)v.push(g);break;case 17:for(l=3+E(e,t),t+=3;l-- >0;)v.push(0);break;case 18:for(l=11+T(e,t),t+=7;l-- >0;)v.push(0);break;default:v.push(g),h<g&&(h=g)}var w=v.slice(0,n),k=v.slice(n);for(f=n;f<286;++f)w[f]=0;for(f=i;f<30;++f)k[f]=0;return q=P(w,H,286),Y=P(k,W,30),t}(e,r),o=q,l=Y);;){!t&&i<n+32767&&(i=(s=_(s,n+32767)).length);var d=C(e,r,o),h=a>>>1==1?I[d]:H[d];if(r+=15&h,((h>>>=4)>>>8&255)==0)s[n++]=h;else if(256==h)break;else{var u=(h-=257)<8?0:h-4>>2;u>5&&(u=0);var m=n+v[h];u>0&&(m+=C(e,r,u),r+=u),d=C(e,r,l),r+=15&(h=a>>>1==1?L[d]:W[d]);var p=(h>>>=4)<4?0:h-2>>1,f=w[h];for(p>0&&(f+=C(e,r,p),r+=p),!t&&i<m&&(i=(s=_(s,m+100)).length);n<m;)s[n]=s[n-f],++n}}}return t?[s,r+7>>>3]:[s.slice(0,n),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function K(e,t){if(e)"undefined"!=typeof console&&console.error(t);else throw Error(t)}function Q(e,r){cx(e,0);var a={FileIndex:[],FullPaths:[]};c(a,{root:r.root});for(var s=e.length-4;(80!=e[s]||75!=e[s+1]||5!=e[s+2]||6!=e[s+3])&&s>=0;)--s;e.l=s+4,e.l+=4;var i=e.read_shift(2);e.l+=6;var o=e.read_shift(4);for(s=0,e.l=o;s<i;++s){e.l+=20;var l=e.read_shift(4),d=e.read_shift(4),h=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2);e.l+=8;var p=e.read_shift(4),f=n(e.slice(e.l+h,e.l+h+u));e.l+=h+u+m;var g=e.l;e.l=p+4,function(e,r,a,s,i){e.l+=2;var o,l,c,d,h,u,m,p=e.read_shift(2),f=e.read_shift(2),g=(o=65535&e.read_shift(2),l=65535&e.read_shift(2),c=new Date,d=31&l,h=15&(l>>>=5),l>>>=4,c.setMilliseconds(0),c.setFullYear(l+1980),c.setMonth(h-1),c.setDate(d),u=31&o,m=63&(o>>>=5),o>>>=6,c.setHours(o),c.setMinutes(m),c.setSeconds(u<<1),c);if(8257&p)throw Error("Unsupported ZIP encryption");for(var x=e.read_shift(4),b=e.read_shift(4),y=e.read_shift(4),v=e.read_shift(2),w=e.read_shift(2),N="",j=0;j<v;++j)N+=String.fromCharCode(e[e.l++]);if(w){var k=n(e.slice(e.l,e.l+w));(k[21589]||{}).mt&&(g=k[21589].mt),((i||{})[21589]||{}).mt&&(g=i[21589].mt)}e.l+=w;var E=e.slice(e.l,e.l+b);switch(f){case 8:E=function(e,r){if(!t)return X(e,r);var a=new t.InflateRaw,s=a._processChunk(e.slice(e.l),a._finishFlushFlag);return e.l+=a.bytesRead,s}(e,y);break;case 0:break;default:throw Error("Unsupported ZIP Compression method "+f)}var S=!1;8&p&&(0x8074b50==e.read_shift(4)&&(e.read_shift(4),S=!0),b=e.read_shift(4),y=e.read_shift(4)),b!=r&&K(S,"Bad compressed size: "+r+" != "+b),y!=a&&K(S,"Bad uncompressed size: "+a+" != "+y),Z(s,N,E,{unsafe:!0,mt:g})}(e,l,d,a,f),e.l=g}return a}var J={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Z(e,t,r,a){var n=a&&a.unsafe;n||c(e);var i=!n&&o2.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:s(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),n||o2.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return r.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),a=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),s=!1;47===t.charCodeAt(0)?(s=!0,t=r[0].slice(0,-1)+t):s=-1!==t.indexOf("/");var n=t.toUpperCase(),i=!0===s?r.indexOf(n):a.indexOf(n);if(-1!==i)return e.FileIndex[i];var o=!n.match(og);for(n=n.replace(of,""),o&&(n=n.replace(og,"!")),i=0;i<r.length;++i)if((o?r[i].replace(og,"!"):r[i]).replace(of,"")==n||(o?a[i].replace(og,"!"):a[i]).replace(of,"")==n)return e.FileIndex[i];return null},r.read=function(t,r){var a=r&&r.type;switch(!a&&oo&&i5.Buffer.isBuffer(t)&&(a="buffer"),a||"base64"){case"file":return i(),o(e.readFileSync(t),r);case"base64":return o(oh(oi(t)),r);case"binary":return o(oh(t),r)}return o(t,r)},r.parse=o,r.write=function(t,r){var a=h(t,r);switch(r&&r.type||"buffer"){case"file":i(),e.writeFileSync(r.filename,a);break;case"binary":return"string"==typeof a?a:b(a);case"base64":return on("string"==typeof a?a:b(a));case"buffer":if(oo)return i5.Buffer.isBuffer(a)?a:ol(a);case"array":return"string"==typeof a?oh(a):a}return a},r.writeFile=function(t,r,a){i();var s=h(t,a);e.writeFileSync(r,s)},r.utils={cfb_new:function(e){var t={};return c(t,e),t},cfb_add:Z,cfb_del:function(e,t){c(e);var r=o2.find(e,t);if(r){for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==r)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0}return!1},cfb_mov:function(e,t,r){c(e);var a=o2.find(e,t);if(a){for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==a)return e.FileIndex[n].name=s(r),e.FullPaths[n]=r,!0}return!1},cfb_gc:function(e){d(e,!0)},ReadShift:ch,CheckField:cg,prep_blob:cx,bconcat:op,use_zlib:function(e){try{var r=new e.InflateRaw;if(r._processChunk(new Uint8Array([3,0]),r._finishFlushFlag),r.bytesRead)t=e;else throw Error("zlib does not expose bytesRead")}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:z,_inflateRaw:X,consts:x},r}();function o5(e,t,r){if(void 0!==a&&a.writeFileSync)return r?a.writeFileSync(e,t,r):a.writeFileSync(e,t);if("undefined"!=typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ou(t);break;default:throw Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s="utf8"==r?lP(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(s,e);if("undefined"!=typeof Blob){var n=new Blob([function(e){if("string"==typeof e)return ou(e);if(Array.isArray(e)){if("undefined"==typeof Uint8Array)throw Error("Unsupported");return new Uint8Array(e)}return e}(s)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!=typeof saveAs)return saveAs(n,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=om(t)),l.write(t),l.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw Error("cannot save file "+e)}function o4(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function o3(e,t){for(var r=[],a=o4(e),s=0;s!==a.length;++s)null==r[e[a[s]][t]]&&(r[e[a[s]][t]]=a[s]);return r}function o6(e){for(var t=[],r=o4(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function o8(e){for(var t=[],r=o4(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}var o7=new Date(1899,11,30,0,0,0);function o9(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(o7.getTime()+(e.getTimezoneOffset()-o7.getTimezoneOffset())*6e4))/864e5}var le=new Date,lt=o7.getTime()+(le.getTimezoneOffset()-o7.getTimezoneOffset())*6e4,lr=le.getTimezoneOffset();function la(e){var t=new Date;return t.setTime(24*e*36e5+lt),t.getTimezoneOffset()!==lr&&t.setTime(t.getTime()+(t.getTimezoneOffset()-lr)*6e4),t}var ls=new Date("2017-02-19T19:06:09.000Z"),ln=isNaN(ls.getFullYear())?new Date("2/19/17"):ls,li=2017==ln.getFullYear();function lo(e,t){var r=new Date(e);if(li)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==ln.getFullYear()&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function ll(e,t){if(oo&&i5.Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return lP(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return lP(ot(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return lP(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return lP(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"",ˆ:"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return r[e]||e})}catch(e){}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function lc(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=lc(e[r]));return t}function ld(e,t){for(var r="";r.length<t;)r+=e;return r}function lh(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(a))&&isNaN(t=Number(a=a.replace(/[(](.*)[)]/,function(e,t){return r=-r,t})))?t:t/r}var lu=["january","february","march","april","may","june","july","august","september","october","november","december"];function lm(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==lu.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||n>1)&&101!=a?t:e.match(/[^-0-9:,\/\\]/)?r:t}function lp(e,t,r){if(e.FullPaths){if("string"==typeof r){var a;return a=oo?ol(r):function(e){for(var t=[],r=0,a=e.length+250,s=oc(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|63&i;else if(i>=55296&&i<57344){i=(1023&i)+64;var o=1023&e.charCodeAt(++n);s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(3&i)<<4,s[r++]=128|63&o}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|63&i;r>a&&(t.push(s.slice(0,r)),r=0,s=oc(65535),a=65530)}return t.push(s.slice(0,r)),op(t)}(r),o2.utils.cfb_add(e,t,a)}o2.utils.cfb_add(e,t,r)}else e.file(t,r)}function lf(){return o2.utils.cfb_new()}var lg='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',lx=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,lb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ly=lg.match(lb)?lb:/<[^>]*>/g;function lv(e,t,r){for(var a={},s=0,n=0;s!==e.length&&32!==(n=e.charCodeAt(s))&&10!==n&&13!==n;++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var i=e.match(lx),o=0,l="",c=0,d="",h="",u=1;if(i)for(c=0;c!=i.length;++c){for(n=0,h=i[c];n!=h.length&&61!==h.charCodeAt(n);++n);for(d=h.slice(0,n).trim();32==h.charCodeAt(n+1);)++n;for(o=0,u=+(34==(s=h.charCodeAt(n+1))||39==s),l=h.slice(n+1+u,h.length-u);o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=l,r||(a[d.toLowerCase()]=l);else{var m=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(a[m]&&"ext"==d.slice(o-3,o))continue;a[m]=l,r||(a[m.toLowerCase()]=l)}}return a}var lw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lN=o6(lw),lj=(k=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,E=/_x([\da-fA-F]{4})_/ig,function e(t){var r=t+"",a=r.indexOf("<![CDATA[");if(-1==a)return r.replace(k,function(e,t){return lw[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(E,function(e,t){return String.fromCharCode(parseInt(t,16))});var s=r.indexOf("]]>");return e(r.slice(0,a))+r.slice(a+9,s)+e(r.slice(s+3))}),lk=/[&<>'"]/g,lE=/[\u0000-\u0008\u000b-\u001f]/g;function lS(e){return(e+"").replace(lk,function(e){return lN[e]}).replace(lE,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lT(e){return lS(e).replace(/ /g,"_x0020_")}var lC=/[\u0000-\u001f]/g;function lA(e){for(var t="",r=0,a=0,s=0,n=0,i=0,o=0;r<e.length;){if((a=e.charCodeAt(r++))<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){t+=String.fromCharCode((31&a)<<6|63&s);continue}if(n=e.charCodeAt(r++),a<240){t+=String.fromCharCode((15&a)<<12|(63&s)<<6|63&n);continue}t+=String.fromCharCode(55296+((o=((7&a)<<18|(63&s)<<12|(63&n)<<6|63&e.charCodeAt(r++))-65536)>>>10&1023)),t+=String.fromCharCode(56320+(1023&o))}return t}function lR(e){var t,r,a,s=oc(2*e.length),n=1,i=0,o=0;for(r=0;r<e.length;r+=n)n=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=(31&a)*64+(63&e.charCodeAt(r+1)),n=2):a<240?(t=(15&a)*4096+(63&e.charCodeAt(r+1))*64+(63&e.charCodeAt(r+2)),n=3):(n=4,o=55296+((t=(7&a)*262144+(63&e.charCodeAt(r+1))*4096+(63&e.charCodeAt(r+2))*64+(63&e.charCodeAt(r+3))-65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(s[i++]=255&o,s[i++]=o>>>8,o=0),s[i++]=t%256,s[i++]=t>>>8;return s.slice(0,i).toString("ucs2")}function lO(e){return ol(e,"binary").toString("utf8")}var l_="foo bar bazâð£",lD=oo&&(lO(l_)==lA(l_)&&lO||lR(l_)==lA(l_)&&lR)||lA,lP=oo?function(e){return ol(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,t.push(String.fromCharCode(240+((s=e.charCodeAt(r++)-56320+(a<<10))>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(63&s)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)))}return t.join("")},lI=(S={},function(e,t){var r=e+"|"+(t||"");return S[r]?S[r]:S[r]=RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",t||"")}),lL=(T=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[RegExp("&"+e[0]+";","ig"),e[1]]}),function(e){for(var t=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<T.length;++r)t=t.replace(T[r][0],T[r][1]);return t}),lM=/(^\s|\s$|\n)/;function lF(e,t){return"<"+e+(t.match(lM)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function lB(e){return o4(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function lU(e,t,r){return"<"+e+(null!=r?lB(r):"")+(null!=t?(t.match(lM)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function lV(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}var lz="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",lH="http://schemas.openxmlformats.org/officeDocument/2006/relationships",lW="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",l$="http://www.w3.org/2001/XMLSchema-instance",lG="urn:schemas-microsoft-com:office:office",lq="urn:schemas-microsoft-com:office:excel",lY="urn:schemas-microsoft-com:office:spreadsheet",lX=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var a=0,s=e[0][r].length;a<s;a+=10240)t.push.apply(t,e[0][r].slice(a,a+10240));return t},lK=oo?function(e){return e[0].length>0&&i5.Buffer.isBuffer(e[0][0])?i5.Buffer.concat(e[0].map(function(e){return i5.Buffer.isBuffer(e)?e:ol(e)})):lX(e)}:lX,lQ=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(co(e,s)));return a.join("").replace(of,"")},lJ=oo?function(e,t,r){return i5.Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(of,""):lQ(e,t,r)}:lQ,lZ=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},l0=oo?function(e,t,r){return i5.Buffer.isBuffer(e)?e.toString("hex",t,t+r):lZ(e,t,r)}:lZ,l1=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(ci(e,s)));return a.join("")},l2=oo?function(e,t,r){return i5.Buffer.isBuffer(e)?e.toString("utf8",t,r):l1(e,t,r)}:l1,l5=function(e,t){var r=cc(e,t);return r>0?l2(e,t+4,t+4+r-1):""},l4=l5,l3=function(e,t){var r=cc(e,t);return r>0?l2(e,t+4,t+4+r-1):""},l6=l3,l8=function(e,t){var r=2*cc(e,t);return r>0?l2(e,t+4,t+4+r-1):""},l7=l8,l9=function(e,t){var r=cc(e,t);return r>0?lJ(e,t+4,t+4+r):""},ce=l9,ct=function(e,t){var r=cc(e,t);return r>0?l2(e,t+4,t+4+r):""},cr=ct,ca=function(e,t){for(var r=1-2*(e[t+7]>>>7),a=((127&e[t+7])<<4)+(e[t+6]>>>4&15),s=15&e[t+6],n=5;n>=0;--n)s=256*s+e[t+n];return 2047==a?0==s?1/0*r:NaN:(0==a?a=-1022:(a-=1023,s+=0x10000000000000),r*Math.pow(2,a-52)*s)},cs=ca,cn=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};oo&&(l4=function(e,t){if(!i5.Buffer.isBuffer(e))return l5(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},l6=function(e,t){if(!i5.Buffer.isBuffer(e))return l3(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},l7=function(e,t){if(!i5.Buffer.isBuffer(e))return l8(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},ce=function(e,t){if(!i5.Buffer.isBuffer(e))return l9(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},cr=function(e,t){if(!i5.Buffer.isBuffer(e))return ct(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},cs=function(e,t){return i5.Buffer.isBuffer(e)?e.readDoubleLE(t):ca(e,t)},cn=function(e){return i5.Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array}),void 0!==M&&(lJ=function(e,t,r){return M.utils.decode(1200,e.slice(t,r)).replace(of,"")},l2=function(e,t,r){return M.utils.decode(65001,e.slice(t,r))},l4=function(e,t){var r=cc(e,t);return r>0?M.utils.decode(i6,e.slice(t+4,t+4+r-1)):""},l6=function(e,t){var r=cc(e,t);return r>0?M.utils.decode(i3,e.slice(t+4,t+4+r-1)):""},l7=function(e,t){var r=2*cc(e,t);return r>0?M.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},ce=function(e,t){var r=cc(e,t);return r>0?M.utils.decode(1200,e.slice(t+4,t+4+r)):""},cr=function(e,t){var r=cc(e,t);return r>0?M.utils.decode(65001,e.slice(t+4,t+4+r)):""});var ci=function(e,t){return e[t]},co=function(e,t){return 256*e[t+1]+e[t]},cl=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-((65535-r+1)*1)},cc=function(e,t){return 0x1000000*e[t+3]+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},cd=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]};function ch(e,t){var r,a,s,n,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,oo&&i5.Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(co(this,o)),o+=2;e*=2;break;case"utf8":l=l2(this,this.l,this.l+e);break;case"utf16le":e*=2,l=lJ(this,this.l,this.l+e);break;case"wstr":if(void 0===M)return ch.call(this,e,"dbcs");l=M.utils.decode(i3,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=l4(this,this.l),e=4+cc(this,this.l);break;case"lpstr-cp":l=l6(this,this.l),e=4+cc(this,this.l);break;case"lpwstr":l=l7(this,this.l),e=4+2*cc(this,this.l);break;case"lpp4":e=4+cc(this,this.l),l=ce(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+cc(this,this.l),l=cr(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(s=ci(this,this.l+e++));)c.push(or(s));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(s=co(this,this.l+e));)c.push(or(s)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(i=0,l="",o=this.l;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=ci(this,o),this.l=o+1,n=ch.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(or(co(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if(void 0!==M){l=M.utils.decode(i3,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(i=0,l="",o=this.l;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=ci(this,o),this.l=o+1,n=ch.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(or(ci(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=ci(this,this.l),this.l++,r;case 2:return r=("i"===t?cl:co)(this,this.l),this.l+=2,r;case 4:case -4:if("i"===t||(128&this[this.l+3])==0)return r=(e>0?cd:function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]})(this,this.l),this.l+=4,r;return a=cc(this,this.l),this.l+=4,a;case 8:case -8:if("f"===t)return a=8==e?cs(this,this.l):cs([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:l=l0(this,this.l,e)}}return this.l+=e,l}var cu=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},cm=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},cp=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function cf(e,t,r){var a=0,s=0;if("dbcs"===r){for(s=0;s!=t.length;++s)cp(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if("sbcs"===r){if(void 0!==M&&874==i6)for(s=0;s!=t.length;++s){var n=M.utils.encode(i6,t.charAt(s));this[this.l+s]=n[0]}else for(s=0,t=t.replace(/[^\x00-\x7F]/g,"_");s!=t.length;++s)this[this.l+s]=255&t.charCodeAt(s);a=t.length}else if("hex"===r){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if("utf16le"===r){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=255&t;break;case 2:a=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:a=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:a=4,cu(this,t,this.l);break;case 8:if(a=8,"f"===r){!function(e,t,r){var a=(t<0||1/t==-1/0)<<7,s=0,n=0,i=a?-t:t;isFinite(i)?0==i?s=n=0:(s=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<0x10000000000000)?s=-1022:(n-=0x10000000000000,s+=1023)):(s=2047,n=26985*!!isNaN(t));for(var o=0;o<=5;++o,n/=256)e[r+o]=255&n;e[r+6]=(15&s)<<4|15&n,e[r+7]=s>>4|a}(this,t,this.l);break}case 16:break;case -4:a=4,cm(this,t,this.l)}return this.l+=a,this}function cg(e,t){var r=l0(this,this.l,e.length>>1);if(r!==e)throw Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function cx(e,t){e.l=t,e.read_shift=ch,e.chk=cg,e.write_shift=cf}function cb(e,t){e.l+=t}function cy(e){var t=oc(e);return cx(t,0),t}function cv(){var e=[],t=oo?256:2048,r=function(e){var t=cy(e);return cx(t,0),t},a=r(t),s=function(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},n=function(e){return a&&e<a.length-a.l?a:(s(),a=r(Math.max(e+1,t)))};return{next:n,push:function(e){s(),null==(a=e).l&&(a.l=a.length),n(t)},end:function(){return s(),op(e)},_bufs:e}}function cw(e,t,r,a){var s,n=+t;if(!isNaN(n)){a||(a=hY[n].p||(r||[]).length||0),s=1+ +(n>=128)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var i=e.next(s);n<=127?i.write_shift(1,n):(i.write_shift(1,(127&n)+128),i.write_shift(1,n>>7));for(var o=0;4!=o;++o)if(a>=128)i.write_shift(1,(127&a)+128),a>>=7;else{i.write_shift(1,a);break}a>0&&cn(r)&&e.push(r)}}function cN(e,t,r){var a=lc(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function cj(e,t,r){var a=lc(e);return a.s=cN(a.s,t.s,r),a.e=cN(a.e,t.s,r),a}function ck(e,t){if(e.cRel&&e.c<0)for(e=lc(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=lc(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=cO(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=r.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),r}function cE(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?ck(e.s,t.biff)+":"+ck(e.e,t.biff):(e.s.rRel?"":"$")+cT(e.s.r)+":"+(e.e.rRel?"":"$")+cT(e.e.r):(e.s.cRel?"":"$")+cA(e.s.c)+":"+(e.e.cRel?"":"$")+cA(e.e.c)}function cS(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function cT(e){return""+(e+1)}function cC(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function cA(e){if(e<0)throw Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function cR(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function cO(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function c_(e){var t=e.indexOf(":");return -1==t?{s:cR(e),e:cR(e)}:{s:cR(e.slice(0,t)),e:cR(e.slice(t+1))}}function cD(e,t){return void 0===t||"number"==typeof t?cD(e.s,e.e):("string"!=typeof e&&(e=cO(e)),"string"!=typeof t&&(t=cO(t)),e==t?e:e+":"+t)}function cP(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,n=e.length;for(r=0;a<n&&!((s=e.charCodeAt(a)-64)<1)&&!(s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<n&&!((s=e.charCodeAt(a)-48)<0)&&!(s>9);++a)r=10*r+s;if(t.s.r=--r,a===n||10!=s)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=n&&!((s=e.charCodeAt(a)-64)<1)&&!(s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=n&&!((s=e.charCodeAt(a)-48)<0)&&!(s>9);++a)r=10*r+s;return t.e.r=--r,t}function cI(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=oK(e.z,r?o9(t):t)}catch(e){}try{return e.w=oK((e.XF||{}).numFmtId||14*!!r,r?o9(t):t)}catch(e){return""+t}}function cL(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t)?c3[e.v]||e.v:void 0==t?cI(e,e.v):cI(e,t)}function cM(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function cF(e,t){return function(e,t,r){var a=r||{},s=(0,a.dense),n=s?[]:{},i=0,o=0;if(n&&null!=a.origin){if("number"==typeof a.origin)i=a.origin;else{var l="string"==typeof a.origin?cR(a.origin):a.origin;i=l.r,o=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=cP(n["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=t[h].length;++u)if(void 0!==t[h][u]){var m={v:t[h][u]},p=i+h,f=o+u;if(c.s.r>p&&(c.s.r=p),c.s.c>f&&(c.s.c=f),c.e.r<p&&(c.e.r=p),c.e.c<f&&(c.e.c=f),!t[h][u]||"object"!=typeof t[h][u]||Array.isArray(t[h][u])||t[h][u]instanceof Date)if(Array.isArray(m.v)&&(m.f=t[h][u][1],m.v=m.v[0]),null===m.v)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else{if(!a.sheetStubs)continue;m.t="z"}else"number"==typeof m.v?m.t="n":"boolean"==typeof m.v?m.t="b":m.v instanceof Date?(m.z=a.dateNF||oE[14],a.cellDates?(m.t="d",m.w=oK(m.z,o9(m.v))):(m.t="n",m.v=o9(m.v),m.w=oK(m.z,m.v))):m.t="s";else m=t[h][u];if(s)n[p]||(n[p]=[]),n[p][f]&&n[p][f].z&&(m.z=n[p][f].z),n[p][f]=m;else{var g=cO({c:f,r:p});n[g]&&n[g].z&&(m.z=n[g].z),n[g]=m}}}return c.s.c<1e7&&(n["!ref"]=cD(c)),n}(null,e,t)}function cB(e,t){return t||(t=cy(4)),t.write_shift(4,e),t}function cU(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function cV(e,t){var r=!1;return null==t&&(r=!0,t=cy(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cz(e,t){var r=e.l,a=e.read_shift(1),s=cU(e),n=[],i={t:s,h:s};if((1&a)!=0){for(var o=e.read_shift(4),l=0;l!=o;++l)n.push({ich:e.read_shift(2),ifnt:e.read_shift(2)});i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function cH(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function cW(e,t){return null==t&&(t=cy(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function c$(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function cG(e,t){return null==t&&(t=cy(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function cq(e){var t=e.read_shift(4);return 0===t||0xffffffff===t?"":e.read_shift(t,"dbcs")}function cY(e,t){var r=!1;return null==t&&(r=!0,t=cy(127)),t.write_shift(4,e.length>0?e.length:0xffffffff),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function cX(e){var t=e.slice(e.l,e.l+4),r=1&t[0],a=2&t[0];e.l+=4;var s=0===a?cs([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):cd(t,0)>>2;return r?s/100:s}function cK(e,t){null==t&&(t=cy(4));var r=0,a=0,s=100*e;if(e==(0|e)&&e>=-0x20000000&&e<0x20000000?a=1:s==(0|s)&&s>=-0x20000000&&s<0x20000000&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw Error("unsupported RkNumber "+e)}function cQ(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var cJ=function(e,t){return t||(t=cy(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function cZ(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function c0(e,t){return(t||cy(8)).write_shift(8,e,"f")}function c1(e,t){if(t||(t=cy(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var a=e.rgb||"FFFFFF";"number"==typeof a&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var c2={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},0x80000000:{n:"Locale",t:19},0x80000003:{n:"Behavior",t:19},0x72627262:{}},c5={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},0x80000000:{n:"Locale",t:19},0x80000003:{n:"Behavior",t:19},0x72627262:{}},c4=lc([0,0xffffff,0xff0000,65280,255,0xffff00,0xff00ff,65535,0,0xffffff,0xff0000,65280,255,0xffff00,0xff00ff,65535,8388608,32768,128,8421376,8388736,32896,0xc0c0c0,8421504,0x9999ff,0x993366,0xffffcc,0xccffff,6684774,0xff8080,26316,0xccccff,128,0xff00ff,0xffff00,65535,8388736,8388608,32896,255,52479,0xccffff,0xccffcc,0xffff99,0x99ccff,0xff99cc,0xcc99ff,0xffcc99,3368703,3394764,0x99cc00,0xffcc00,0xff9900,0xff6600,6710937,9868950,13158,3381606,13056,3355392,0x993300,0x993366,3355545,3355443,0xffffff,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(e){return[e>>16&255,e>>8&255,255&e]})),c3={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},c6={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},c8={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function c7(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function c9(e,t){var r,a=function(e){for(var t=[],r=o4(e),a=0;a!==r.length;++a)null==t[e[r[a]]]&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}(c6),s=[];s[s.length]=lg,s[s.length]=lU("Types",null,{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":l$}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return lU("Default",null,{Extension:e[0],ContentType:e[1]})}));var n=function(a){e[a]&&e[a].length>0&&(r=e[a][0],s[s.length]=lU("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:c8[a][t.bookType]||c8[a].xlsx}))},i=function(r){(e[r]||[]).forEach(function(e){s[s.length]=lU("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:c8[r][t.bookType]||c8[r].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){s[s.length]=lU("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:a[t][0]})})};return n("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var de="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",dt="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",dr="http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",da="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",ds="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",dn="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",di="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",dl="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",dc="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",dd="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",dh="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",du="http://schemas.microsoft.com/office/2006/relationships/vbaProject";function dm(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function dp(e){var t=[lg,lU("Relationships",null,{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"})];return o4(e["!id"]).forEach(function(r){t[t.length]=lU("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function df(e,t,r,a,s,n){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,n?s.TargetMode=n:[dt,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath","http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing"].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function dg(e,t,r){return'  <rdf:Description rdf:about="'+e+'">\n'+('    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#")+t+'"/>\n  </rdf:Description>\n'}function dx(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+i4.version+"</meta:generator></office:meta></office:document-meta>"}var db=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function dy(e,t,r,a,s){null==s[e]&&null!=t&&""!==t&&(s[e]=t,t=lS(t),a[a.length]=r?lU(e,t,r):lF(e,t))}function dv(e,t){var r=t||{},a=[lg,lU("cp:coreProperties",null,{"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":l$})],s={};if(!e&&!r.Props)return a.join("");e&&(null!=e.CreatedDate&&dy("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:lV(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),null!=e.ModifiedDate&&dy("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:lV(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var n=0;n!=db.length;++n){var i=db[n],o=r.Props&&null!=r.Props[i[1]]?r.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&dy(i[0],o,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var dw=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],dN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dj(e){var t=[];return e||(e={}),e.Application="SheetJS",t[t.length]=lg,t[t.length]=lU("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":lW}),dw.forEach(function(r){var a;if(void 0!==e[r[1]]){switch(r[2]){case"string":a=lS(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=lU(r[0],a))}}),t[t.length]=lU("HeadingPairs",lU("vt:vector",lU("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+lU("vt:variant",lU("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=lU("TitlesOfParts",lU("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+lS(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function dk(e){var t=[lg,lU("Properties",null,{xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties","xmlns:vt":lW})];if(!e)return t.join("");var r=1;return o4(e).forEach(function(a){++r,t[t.length]=lU("property",function(e,t){switch(typeof e){case"string":var r=lU("vt:lpwstr",lS(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return lU((0|e)==e?"vt:i4":"vt:r8",lS(String(e)));case"boolean":return lU("vt:bool",e?"true":"false")}if(e instanceof Date)return lU("vt:filetime",lV(e));throw Error("Unable to serialize "+e)}(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:lS(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function dS(e,t){var r,a,s,n,i,o=cy(4),l=cy(4);switch(o.write_shift(4,80==e?31:e),e){case 3:l.write_shift(-4,t);break;case 5:(l=cy(8)).write_shift(8,t,"f");break;case 11:l.write_shift(4,+!!t);break;case 64:a=(r=("string"==typeof t?new Date(Date.parse(t)):t).getTime()/1e3+0x2b6109100)%0x100000000,s=(r-a)/0x100000000*1e7,(n=(a*=1e7)/0x100000000|0)>0&&(a%=0x100000000,s+=n),(i=cy(8)).write_shift(4,a),i.write_shift(4,s),l=i;break;case 31:case 80:for((l=cy(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),l.write_shift(0,t,"dbcs");l.l!=l.length;)l.write_shift(1,0);break;default:throw Error("TypedPropertyValue unrecognized type "+e+" "+t)}return op([o,l])}var dT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dC(e,t,r){var a=cy(8),s=[],n=[],i=8,o=0,l=cy(8),c=cy(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),n.push(l),s.push(c),i+=8+l.length,!t){(c=cy(8)).write_shift(4,0),s.unshift(c);var d=[cy(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for((l=cy(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=op(d),n.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]]||dT.indexOf(e[o][0])>-1||dN.indexOf(e[o][0])>-1)&&null!=e[o][1]){var u=e[o][1],m=0;if(t){var p=r[m=+t[e[o][0]]];if("version"==p.p&&"string"==typeof u){var f=u.split(".");u=(f[0]<<16)+(+f[1]||0)}l=dS(p.t,u)}else{var g=function(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return -1}(u);-1==g&&(g=31,u=String(u)),l=dS(g,u)}n.push(l),(c=cy(8)).write_shift(4,t?m:2+o),s.push(c),i+=8+l.length}var x=8*(n.length+1);for(o=0;o<n.length;++o)s[o].write_shift(4,x),x+=n[o].length;return a.write_shift(4,i),a.write_shift(4,n.length),op([a].concat(s).concat(n))}function dA(e,t,r,a,s,n){var i=cy(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,0x32363237),i.write_shift(16,o2.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=dC(e,r,a);if(o.push(l),s){var c=dC(s,null,null);i.write_shift(16,n,"hex"),i.write_shift(4,68+l.length),o.push(c)}return op(o)}function dR(e,t){return t||(t=cy(2)),t.write_shift(2,+!!e),t}function dO(e){return e.read_shift(2,"u")}function d_(e,t){return t||(t=cy(2)),t.write_shift(2,e),t}function dD(e,t,r){return r||(r=cy(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,+("e"==t)),r}function dP(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",n=i3;r&&r.biff>=8&&(i3=1200),r&&8!=r.biff?12==r.biff&&(s="wstr"):e.read_shift(1)&&(s="dbcs-cont"),r.biff>=2&&r.biff<=5&&(s="cpstr");var i=a?e.read_shift(a,s):"";return i3=n,i}function dI(e,t,r){return r||(r=cy(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function dL(e,t){t||(t=cy(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function dM(e,t,r,a){return a||(a=cy(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function dF(e,t){return t||(t=cy(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function dB(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;default:throw Error("unsupported BIFF version")}var n=cy(s);return n.write_shift(2,a),n.write_shift(2,t),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function dU(e,t,r,a){var s=r&&5==r.biff;a||(a=cy(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var n=0;return e.numFmtId>0&&s&&(n|=1024),a.write_shift(4,n),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}var dV=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=o6({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var a=r||{};a.dateNF||(a.dateNF="yyyymmdd");var s=cF(function(t,r){var a=[],s=oc(1);switch(r.type){case"base64":s=oh(oi(t));break;case"binary":s=oh(t);break;case"buffer":case"array":s=t}cx(s,0);var n=s.read_shift(1),i=!!(136&n),o=!1,l=!1;switch(n){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw Error("DBF Unsupported Version: "+n.toString(16))}var c=0,d=521;2==n&&(c=s.read_shift(2)),s.l+=3,2!=n&&(c=s.read_shift(4)),c>1048576&&(c=1e6),2!=n&&(d=s.read_shift(2));var h=s.read_shift(2),u=r.codepage||1252;2!=n&&(s.l+=16,s.read_shift(1),0!==s[s.l]&&(u=e[s[s.l]]),s.l+=1,s.l+=2),l&&(s.l+=36);for(var m=[],p={},f=Math.min(s.length,2==n?521:d-10-264*!!o),g=l?32:11;s.l<f&&13!=s[s.l];)switch((p={}).name=M.utils.decode(u,s.slice(s.l,s.l+g)).replace(/[\u0000\r\n].*$/g,""),s.l+=g,p.type=String.fromCharCode(s.read_shift(1)),2!=n&&!l&&(p.offset=s.read_shift(4)),p.len=s.read_shift(1),2==n&&(p.offset=s.read_shift(2)),p.dec=s.read_shift(1),p.name.length&&m.push(p),2!=n&&(s.l+=l?13:14),p.type){case"B":(!o||8!=p.len)&&r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw Error("Unknown Field Type: "+p.type)}if(13!==s[s.l]&&(s.l=d-1),13!==s.read_shift(1))throw Error("DBF Terminator not found "+s.l+" "+s[s.l]);s.l=d;var x=0,b=0;for(b=0,a[0]=[];b!=m.length;++b)a[0][b]=m[b].name;for(;c-- >0;){if(42===s[s.l]){s.l+=h;continue}for(++s.l,a[++x]=[],b=0,b=0;b!=m.length;++b){var y=s.slice(s.l,s.l+m[b].len);s.l+=m[b].len,cx(y,0);var v=M.utils.decode(u,y);switch(m[b].type){case"C":v.trim().length&&(a[x][b]=v.replace(/\s+$/,""));break;case"D":8===v.length?a[x][b]=new Date(+v.slice(0,4),v.slice(4,6)-1,+v.slice(6,8)):a[x][b]=v;break;case"F":a[x][b]=parseFloat(v.trim());break;case"+":case"I":a[x][b]=l?0x80000000^y.read_shift(-4,"i"):y.read_shift(4,"i");break;case"L":switch(v.trim().toUpperCase()){case"Y":case"T":a[x][b]=!0;break;case"N":case"F":a[x][b]=!1;break;case"":case"?":break;default:throw Error("DBF Unrecognized L:|"+v+"|")}break;case"M":if(!i)throw Error("DBF Unexpected MEMO for type "+n.toString(16));a[x][b]="##MEMO##"+(l?parseInt(v.trim(),10):y.read_shift(4));break;case"N":(v=v.replace(/\u0000/g,"").trim())&&"."!=v&&(a[x][b]=+v||0);break;case"@":a[x][b]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":a[x][b]=new Date((y.read_shift(4)-2440588)*864e5+y.read_shift(4));break;case"Y":a[x][b]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*0x100000000;break;case"O":a[x][b]=-y.read_shift(-8,"f");break;case"B":if(o&&8==m[b].len){a[x][b]=y.read_shift(8,"f");break}case"G":case"P":y.l+=m[b].len;break;case"0":if("_NullFlags"===m[b].name)break;default:throw Error("DBF Unsupported data type "+m[b].type)}}}if(2!=n&&s.l<s.length&&26!=s[s.l++])throw Error("DBF EOF Marker missing "+(s.l-1)+" of "+s.length+" "+s[s.l-1].toString(16));return r&&r.sheetRows&&(a=a.slice(0,r.sheetRows)),r.DBF=m,a}(t,a),a);return s["!cols"]=a.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete a.DBF,s}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return cM(r(e,t),t)}catch(e){if(t&&t.WTF)throw e}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var s=r||{};if(+s.codepage>=0&&oe(+s.codepage),"string"==s.type)throw Error("Cannot write DBF to JS string");var n=cv(),i=ud(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,h=0,u=0,m=1;for(d=0;d<o.length;++d){if(((c[d]||{}).DBF||{}).name){o[d]=c[d].DBF.name,++u;continue}if(null!=o[d]){if(++u,"number"==typeof o[d]&&(o[d]=o[d].toString(10)),"string"!=typeof o[d])throw Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d){for(h=0;h<1024;++h)if(-1==o.indexOf(o[d]+"_"+h)){o[d]+="_"+h;break}}}}var p=cP(e["!ref"]),f=[],g=[],x=[];for(d=0;d<=p.e.c-p.s.c;++d){var b="",y="",v=0,w=[];for(h=0;h<l.length;++h)null!=l[h][d]&&w.push(l[h][d]);if(0==w.length||null==o[d]){f[d]="?";continue}for(h=0;h<w.length;++h){switch(typeof w[h]){case"number":y="B";break;case"string":default:y="C";break;case"boolean":y="L";break;case"object":y=w[h]instanceof Date?"D":"C"}v=Math.max(v,String(w[h]).length),b=b&&b!=y?"C":y}v>250&&(v=250),"C"==(y=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>v&&(v=c[d].DBF.len),"B"==b&&"N"==y&&(b="N",x[d]=c[d].DBF.dec,v=c[d].DBF.len),g[d]="C"==b||"N"==y?v:a[b]||0,m+=g[d],f[d]=b}var N=n.next(32);for(N.write_shift(4,0x13021130),N.write_shift(4,l.length),N.write_shift(2,296+32*u),N.write_shift(2,m),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+t[i6]||3)<<8),d=0,h=0;d<o.length;++d)if(null!=o[d]){var j=n.next(32),k=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,k,"sbcs"),j.write_shift(1,"?"==f[d]?"C":f[d],"sbcs"),j.write_shift(4,h),j.write_shift(1,g[d]||a[f[d]]||0),j.write_shift(1,x[d]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),h+=g[d]||a[f[d]]||0}var E=n.next(264);for(E.write_shift(4,13),d=0;d<65;++d)E.write_shift(4,0);for(d=0;d<l.length;++d){var S=n.next(m);for(S.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(f[h]){case"L":S.write_shift(1,null==l[d][h]?63:l[d][h]?84:70);break;case"B":S.write_shift(8,l[d][h]||0,"f");break;case"N":var T="0";for("number"==typeof l[d][h]&&(T=l[d][h].toFixed(x[h]||0)),u=0;u<g[h]-T.length;++u)S.write_shift(1,32);S.write_shift(1,T,"sbcs");break;case"D":l[d][h]?(S.write_shift(4,("0000"+l[d][h].getFullYear()).slice(-4),"sbcs"),S.write_shift(2,("00"+(l[d][h].getMonth()+1)).slice(-2),"sbcs"),S.write_shift(2,("00"+l[d][h].getDate()).slice(-2),"sbcs")):S.write_shift(8,"00000000","sbcs");break;case"C":var C=String(null!=l[d][h]?l[d][h]:"").slice(0,g[h]);for(S.write_shift(1,C,"sbcs"),u=0;u<g[h]-C.length;++u)S.write_shift(1,32)}}return n.next(1).write_shift(1,26),n.end()}}}(),dz=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=RegExp("\x1bN("+o4(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var a=e[r];return"number"==typeof a?oa(a):a},a=function(e,t,r){var a=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==a?e:oa(a)};function s(e,s){var n,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,h=[],u=[],m=null,p={},f=[],g=[],x=[],b=0;for(+s.codepage>=0&&oe(+s.codepage);c!==i.length;++c){b=0;var y,v=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),w=v.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),N=w[0];if(v.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&u.push(v.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,k=!1,E=!1,S=!1,T=-1,C=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,k||(l=0),n=h.length;n<=o;++n)h[n]=[];break;case"K":'"'===(y=w[d].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(lh(y))?isNaN(lm(y).getDate())||(y=lo(y)):(y=lh(y),null!==m&&oq(m)&&(y=la(y))),void 0!==M&&"string"==typeof y&&"string"!=(s||{}).type&&(s||{}).codepage&&(y=M.utils.decode(s.codepage,y)),j=!0;break;case"E":S=!0;var A=hl(w[d].slice(1),{r:o,c:l});h[o][l]=[h[o][l],A];break;case"S":E=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":T=parseInt(w[d].slice(1))-1;break;case"C":C=parseInt(w[d].slice(1))-1;break;default:if(s&&s.WTF)throw Error("SYLK bad record "+v)}if(j&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=y:h[o][l]=y,m=null),E){if(S)throw Error("SYLK shared formula cannot have own formula");var R=T>-1&&h[T][C];if(!R||!R[1])throw Error("SYLK shared formula cannot find base");h[o][l][1]=function(e,t){return e.replace(hc,function(e,r,a,s,n,i){return r+("$"==a?a+s:cA(cC(s)+t.c))+("$"==n?n+i:cT(cS(i)+t.r))})}(R[1],{r:o-T,c:l-C})}break;case"F":var O=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++O;break;case"Y":for(o=parseInt(w[d].slice(1))-1,n=h.length;n<=o;++n)h[n]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":m=u[parseInt(w[d].slice(1))];break;case"W":for(n=parseInt((x=w[d].slice(1).split(" "))[0],10);n<=parseInt(x[1],10);++n)b=parseInt(x[2],10),g[n-1]=0===b?{hidden:!0}:{wch:b},d3(g[n-1]);break;case"C":g[l=parseInt(w[d].slice(1))-1]||(g[l]={});break;case"R":f[o=parseInt(w[d].slice(1))-1]||(f[o]={}),b>0?(f[o].hpt=b,f[o].hpx=96*b/96):0===b&&(f[o].hidden=!0);break;default:if(s&&s.WTF)throw Error("SYLK bad record "+v)}O<1&&(m=null);break;default:if(s&&s.WTF)throw Error("SYLK bad record "+v)}}return f.length>0&&(p["!rows"]=f),g.length>0&&(p["!cols"]=g),s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),[h,p]}function n(e,t){var r=function(e,t){switch(t.type){case"base64":return s(oi(e),t);case"binary":return s(e,t);case"buffer":return s(oo&&i5.Buffer.isBuffer(e)?e.toString("binary"):om(e),t);case"array":return s(ll(e),t)}throw Error("Unrecognized type "+t.type)}(e,t),a=r[0],n=r[1],i=cF(a,t);return o4(n).forEach(function(e){i[e]=n[e]}),i}return e["|"]=254,{to_workbook:function(e,t){return cM(n(e,t),t)},to_sheet:n,from_sheet:function(e,t){var r,a=["ID;PWXL;N;E"],s=[],n=cP(e["!ref"]),i=Array.isArray(e);a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=d2(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=d5(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&a.push(r)}),e["!rows"]&&e["!rows"].forEach(function(e,t){var r="F;";e.hidden?r+="M0;":e.hpt?r+="M"+20*e.hpt+";":e.hpx&&(r+="M"+20*d6(e.hpx)+";"),r.length>2&&a.push(r+"R"+(t+1))}),a.push("B;Y"+(n.e.r-n.s.r+1)+";X"+(n.e.c-n.s.c+1)+";D"+[n.s.c,n.s.r,n.e.c,n.e.r].join(" "));for(var o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=cO({r:o,c:l});(r=i?(e[o]||[])[l]:e[c])&&(null!=r.v||r.f&&!r.F)&&s.push(function(e,t,r,a){var s="C;Y"+(r+1)+";X"+(a+1)+";K";switch(e.t){case"n":s+=e.v||0,e.f&&!e.F&&(s+=";E"+hd(e.f,{r:r,c:a}));break;case"b":s+=e.v?"TRUE":"FALSE";break;case"e":s+=e.w||e.v;break;case"d":s+='"'+(e.w||e.v)+'"';break;case"s":s+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return s}(r,0,o,l,t))}return a.join("\r\n")+"\r\n"+s.join("\r\n")+"\r\nE\r\n"}}}(),dH=function(){var e,t;function r(e,t){for(var r=e.split("\n"),a=-1,s=-1,n=0,i=[];n!==r.length;++n){if("BOT"===r[n].trim()){i[++a]=[],s=0;continue}if(!(a<0)){for(var o=r[n].trim().split(","),l=o[0],c=o[1],d=r[++n]||"";1&(d.match(/["]/g)||[]).length&&n<r.length-1;)d+="\n"+r[++n];switch(d=d.trim(),+l){case -1:if("BOT"===d){i[++a]=[],s=0;continue}if("EOD"!==d)throw Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[a][s]=!0:"FALSE"===d?i[a][s]=!1:isNaN(lh(c))?isNaN(lm(c).getDate())?i[a][s]=c:i[a][s]=lo(c):i[a][s]=lh(c),++s;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[a][s++]=""!==d?d:null}if("EOD"===d)break}}return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function a(e,t){return cF(function(e,t){switch(t.type){case"base64":return r(oi(e),t);case"binary":return r(e,t);case"buffer":return r(oo&&i5.Buffer.isBuffer(e)?e.toString("binary"):om(e),t);case"array":return r(ll(e),t)}throw Error("Unrecognized type "+t.type)}(e,t),t)}return{to_workbook:function(e,t){return cM(a(e,t),t)},to_sheet:a,from_sheet:(e=function(e,t,r,a,s){e.push(t),e.push(r+","+a),e.push('"'+s.replace(/"/g,'""')+'"')},t=function(e,t,r,a){e.push(t+","+r),e.push(1==t?'"'+a.replace(/"/g,'""')+'"':a)},function(r){var a,s=[],n=cP(r["!ref"]),i=Array.isArray(r);e(s,"TABLE",0,1,"sheetjs"),e(s,"VECTORS",0,n.e.r-n.s.r+1,""),e(s,"TUPLES",0,n.e.c-n.s.c+1,""),e(s,"DATA",0,0,"");for(var o=n.s.r;o<=n.e.r;++o){t(s,-1,0,"BOT");for(var l=n.s.c;l<=n.e.c;++l){var c=cO({r:o,c:l});if(!(a=i?(r[o]||[])[l]:r[c])){t(s,1,0,"");continue}switch(a.t){case"n":var d=a.w;d||null==a.v||(d=a.v),null==d?!a.f||a.F?t(s,1,0,""):t(s,1,0,"="+a.f):t(s,0,d,"V");break;case"b":t(s,0,+!!a.v,a.v?"TRUE":"FALSE");break;case"s":t(s,1,0,isNaN(a.v)?a.v:'="'+a.v+'"');break;case"d":a.w||(a.w=oK(a.z||oE[14],o9(lo(a.v)))),t(s,0,a.w,"V");break;default:t(s,1,0,"")}}}return t(s,-1,0,"EOD"),s.join("\r\n")})}}(),dW=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return cF(function(e,t){for(var r=e.split("\n"),a=-1,s=-1,n=0,i=[];n!==r.length;++n){var o=r[n].trim().split(":");if("cell"===o[0]){var l=cR(o[1]);if(i.length<=l.r)for(a=i.length;a<=l.r;++a)i[a]||(i[a]=[]);switch(a=l.r,s=l.c,o[2]){case"t":i[a][s]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":i[a][s]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?i[a][s]=!!+o[4]:i[a][s]=+o[4],"vtf"==o[2]&&(i[a][s]=[i[a][s],c])}}}return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}(e,t),t)}var r="--SocialCalcSpreadsheetControlSave\nContent-type: text/plain; charset=UTF-8\n";return{to_workbook:function(e,r){return cM(t(e,r),r)},to_sheet:t,from_sheet:function(t){return["socialcalc:version:1.5\nMIME-Version: 1.0\nContent-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave",r,"# SocialCalc Spreadsheet Control Save\npart:sheet",r,function(t){if(!t||!t["!ref"])return"";for(var r,a=[],s=[],n="",i=c_(t["!ref"]),o=Array.isArray(t),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(n=cO({r:l,c:c}),(r=o?(t[l]||[])[c]:t[n])&&null!=r.v&&"z"!==r.t){switch(s=["cell",n,"t"],r.t){case"s":case"str":s.push(e(r.v));break;case"n":r.f?(s[2]="vtf",s[3]="n",s[4]=r.v,s[5]=e(r.f)):(s[2]="v",s[3]=r.v);break;case"b":s[2]="vt"+(r.f?"f":"c"),s[3]="nl",s[4]=r.v?"1":"0",s[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=o9(lo(r.v));s[2]="vtc",s[3]="nd",s[4]=""+d,s[5]=r.w||oK(r.z||oE[14],d);break;case"e":continue}a.push(s.join(":"))}return a.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}(t),"--SocialCalcSpreadsheetControlSave--"].join("\n")}}}(),d$=function(){function e(e,t,r,a,s){s.raw?t[r][a]=e:""===e||("TRUE"===e?t[r][a]=!0:"FALSE"===e?t[r][a]=!1:isNaN(lh(e))?isNaN(lm(e).getDate())?t[r][a]=e:t[r][a]=lo(e):t[r][a]=lh(e))}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(e){for(var a={},s=!1,n=0,i=0;n<e.length;++n)34==(i=e.charCodeAt(n))?s=!s:!s&&i in t&&(a[i]=(a[i]||0)+1);for(n in i=[],a)Object.prototype.hasOwnProperty.call(a,n)&&i.push([a[n],n]);if(!i.length)for(n in a=r)Object.prototype.hasOwnProperty.call(a,n)&&i.push([a[n],n]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function s(t,r){var s,n="",i="string"==r.type?[0,0,0,0]:function(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=oi(e.slice(0,12));break;case"binary":r=e;break;default:throw Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}(t,r);switch(r.type){case"base64":n=oi(t);break;case"binary":case"string":n=t;break;case"buffer":n=65001==r.codepage?t.toString("utf8"):r.codepage&&void 0!==M?M.utils.decode(r.codepage,t):oo&&i5.Buffer.isBuffer(t)?t.toString("binary"):om(t);break;case"array":n=ll(t);break;default:throw Error("Unrecognized type "+r.type)}return(239==i[0]&&187==i[1]&&191==i[2]?n=lD(n.slice(3)):"string"!=r.type&&"buffer"!=r.type&&65001==r.codepage?n=lD(n):"binary"==r.type&&void 0!==M&&r.codepage&&(n=M.utils.decode(r.codepage,M.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19))?dW.to_sheet("string"==r.type?n:lD(n),r):(s=n,!(r&&r.PRN)||r.FS||"sep="==s.slice(0,4)||s.indexOf("	")>=0||s.indexOf(",")>=0||s.indexOf(";")>=0?function(e,t){var r,s=t||{},n="",i=s.dense?[]:{},o={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=a(e.slice(0,1024)):n=s&&s.FS?s.FS:a(e.slice(0,1024));var l=0,c=0,d=0,h=0,u=0,m=n.charCodeAt(0),p=!1,f=0,g=e.charCodeAt(0);e=e.replace(/\r\n/mg,"\n");var x=null!=s.dateNF?RegExp("^"+("number"==typeof(r=s.dateNF)?oE[r]:r).replace(o0,"(\\d+)")+"$"):null;function b(){var t=e.slice(h,u),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(s.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(d=lh(t)))if(!isNaN(lm(t).getDate())||x&&t.match(x)){r.z=s.dateNF||oE[14];var a,n,p,b,y,v,w,N,j,k,E=0;x&&t.match(x)&&(a=s.dateNF,n=t.match(x)||[],p=-1,b=-1,y=-1,v=-1,w=-1,N=-1,(a.match(o0)||[]).forEach(function(e,t){var r=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":p=r;break;case"d":y=r;break;case"h":v=r;break;case"s":N=r;break;case"m":v>=0?w=r:b=r}}),N>=0&&-1==w&&b>=0&&(w=b,b=-1),7==(j=(""+(p>=0?p:new Date().getFullYear())).slice(-4)+"-"+("00"+(b>=1?b:1)).slice(-2)+"-"+("00"+(y>=1?y:1)).slice(-2)).length&&(j="0"+j),8==j.length&&(j="20"+j),k=("00"+(v>=0?v:0)).slice(-2)+":"+("00"+(w>=0?w:0)).slice(-2)+":"+("00"+(N>=0?N:0)).slice(-2),t=-1==v&&-1==w&&-1==N?j:-1==p&&-1==b&&-1==y?k:j+"T"+k,E=1),s.cellDates?(r.t="d",r.v=lo(t,E)):(r.t="n",r.v=o9(lo(t,E))),!1!==s.cellText&&(r.w=oK(r.z,r.v instanceof Date?o9(r.v):r.v)),s.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==s.cellText&&(r.w=t),r.v=d;if("z"==r.t||(s.dense?(i[l]||(i[l]=[]),i[l][c]=r):i[cO({c:c,r:l})]=r),h=u+1,g=e.charCodeAt(h),o.e.c<c&&(o.e.c=c),o.e.r<l&&(o.e.r=l),f==m)++c;else if(c=0,++l,s.sheetRows&&s.sheetRows<=l)return!0}e:for(;u<e.length;++u)switch(f=e.charCodeAt(u)){case 34:34===g&&(p=!p);break;case m:case 10:case 13:if(!p&&b())break e}return u-h>0&&b(),i["!ref"]=cD(o),i}(s,r):cF(function(t,r){var a=r||{},s=[];if(!t||0===t.length)return s;for(var n=t.split(/[\r\n]/),i=n.length-1;i>=0&&0===n[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=n[c].indexOf(" "))?l=n[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){s[c]=[];var d=0;for(e(n[c].slice(0,o).trim(),s,c,d,a),d=1;d<=(n[c].length-o)/10+1;++d)e(n[c].slice(o+(d-1)*10,o+10*d).trim(),s,c,d,a)}return a.sheetRows&&(s=s.slice(0,a.sheetRows)),s}(s,r),r))}return{to_workbook:function(e,t){return cM(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,r=[],a=cP(e["!ref"]),s=Array.isArray(e),n=a.s.r;n<=a.e.r;++n){for(var i=[],o=a.s.c;o<=a.e.c;++o){var l=cO({r:n,c:o});if(!(t=s?(e[n]||[])[o]:e[l])||null==t.v){i.push("          ");continue}for(var c=(t.w||(cL(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}r.push(i.join(""))}return r.join("\n")}}}(),dG=function(){function e(e,t,r){if(e){cx(e,e.l||0);for(var a=r.Enum||h;e.l<e.length;){var s=e.read_shift(2),n=a[s]||a[65535],i=e.read_shift(2),o=e.l+i,l=n.f&&n.f(e,i,r);if(e.l=o,t(l,n,s))return}}}function t(t,r){if(!t)return t;var a=r||{},s=a.dense?[]:{},n="Sheet1",i="",o=0,l={},c=[],d=[],m={s:{r:0,c:0},e:{r:0,c:0}},p=a.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw Error("Unsupported Works 3 for Mac file");if(2==t[2])a.Enum=h,e(t,function(e,t,r){switch(r){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:m=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&(112&e[2])==112&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||oE[14],a.cellDates&&(e[1].t="d",e[1].v=la(e[1].v))),a.qpro&&e[3]>o&&(s["!ref"]=cD(m),l[n]=s,c.push(n),s=a.dense?[]:{},m={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],n=i||"Sheet"+(o+1),i="");var d=a.dense?(s[e[0].r]||[])[e[0].c]:s[cO(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}a.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[cO(e[0])]=e[1]}},a);else if(26==t[2]||14==t[2])a.Enum=u,14==t[2]&&(a.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:n=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(s["!ref"]=cD(m),l[n]=s,c.push(n),s=a.dense?[]:{},m={s:{r:0,c:0},e:{r:0,c:0}},n="Sheet"+((o=e[3])+1)),p>0&&e[0].r>=p)break;a.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[cO(e[0])]=e[1],m.e.c<e[0].c&&(m.e.c=e[0].c),m.e.r<e[0].r&&(m.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(n=e[1])}},a);else throw Error("Unrecognized LOTUS BOF "+t[2]);if(s["!ref"]=cD(m),l[i||n]=s,c.push(i||n),!d.length)return{SheetNames:c,Sheets:l};for(var f={},g=[],x=0;x<d.length;++x)l[c[x]]?(g.push(d[x]||c[x]),f[d[x]]=l[d[x]]||l[c[x]]):(g.push(d[x]),f[d[x]]={"!ref":"A1"});return{SheetNames:g,Sheets:f}}function r(e,t,r){var a=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(a[0].c=e.read_shift(1),a[3]=e.read_shift(1),a[0].r=e.read_shift(2),e.l+=2):(a[2]=e.read_shift(1),a[0].c=e.read_shift(2),a[0].r=e.read_shift(2)),a}function a(e,t,a){var s=e.l+t,n=r(e,t,a);if(n[1].t="s",20768==a.vers){e.l++;var i=e.read_shift(1);return n[1].v=e.read_shift(i,"utf8"),n}return a.qpro&&e.l++,n[1].v=e.read_shift(s-e.l,"cstr"),n}function s(e,t,r){var a=32768&t;return t&=-32769,t=(a?e:0)+(t>=8192?t-16384:t),(a?"":"$")+(r?cA(t):cT(t))}var n={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},i=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function o(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function l(e,t){var r=o(e,t),a=e.read_shift(4),s=e.read_shift(4),n=e.read_shift(2);if(65535==n)return 0===a&&0xc0000000===s?(r[1].t="e",r[1].v=15):0===a&&0xd0000000===s?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&n;return n=(32767&n)-16446,r[1].v=(1-2*i)*(s*Math.pow(2,n+32)+a*Math.pow(2,n)),r}function c(e,t){var r=o(e,t),a=e.read_shift(8,"f");return r[1].v=a,r}function d(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}var h={0:{n:"BOF",f:dO},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var a={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(a.s.c=e.read_shift(1),e.l++,a.s.r=e.read_shift(2),a.e.c=e.read_shift(1),e.l++,a.e.r=e.read_shift(2)):(a.s.c=e.read_shift(2),a.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),a.e.c=e.read_shift(2),a.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==a.s.c&&(a.s.c=a.e.c=a.s.r=a.e.r=0)),a}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,a){var s=r(e,t,a);return s[1].v=e.read_shift(2,"i"),s}},14:{n:"NUMBER",f:function(e,t,a){var s=r(e,t,a);return s[1].v=e.read_shift(8,"f"),s}},15:{n:"LABEL",f:a},16:{n:"FORMULA",f:function(e,t,a){var o=e.l+t,l=r(e,t,a);if(l[1].v=e.read_shift(8,"f"),a.qpro)e.l=o;else{var c=e.read_shift(2);(function(e,t){cx(e,0);for(var r=[],a=0,o="",l="",c="",d="";e.l<e.length;){var h=e[e.l++];switch(h){case 0:r.push(e.read_shift(8,"f"));break;case 1:l=s(t[0].c,e.read_shift(2),!0),o=s(t[0].r,e.read_shift(2),!1),r.push(l+o);break;case 2:var u=s(t[0].c,e.read_shift(2),!0),m=s(t[0].r,e.read_shift(2),!1);l=s(t[0].c,e.read_shift(2),!0),o=s(t[0].r,e.read_shift(2),!1),r.push(u+m+":"+l+o);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);r.push('"'+p.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),c=r.pop(),r.push(["AND","OR"][h-20]+"("+c+","+d+")");break;default:if(h<32&&i[h])d=r.pop(),c=r.pop(),r.push(c+i[h]+d);else if(n[h]){if(69==(a=n[h][1])&&(a=e[e.l++]),a>r.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+r.join("|")+"|");var f=r.slice(-a);r.length-=a,r.push(n[h][0]+"("+f.join(",")+")")}else if(h<=7)return console.error("WK1 invalid opcode "+h.toString(16));else if(h<=24)return console.error("WK1 unsupported op "+h.toString(16));else if(h<=30)return console.error("WK1 invalid opcode "+h.toString(16));else if(h<=115)return console.error("WK1 unsupported function opcode "+h.toString(16));else return console.error("WK1 unrecognized opcode "+h.toString(16))}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")})(e.slice(e.l,e.l+c),l),e.l+=c}return l}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:a},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:d},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var a="";a.length<r;)a+=String.fromCharCode(e[e.l++]);return a}},65535:{n:""}},u={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=o(e,t);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:l},24:{n:"NUMBER18",f:function(e,t){var r=o(e,t);r[1].v=e.read_shift(2);var a=r[1].v>>1;if(1&r[1].v)switch(7&a){case 0:a=(a>>3)*5e3;break;case 1:a=(a>>3)*500;break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64}return r[1].v=a,r}},25:{n:"FORMULA19",f:function(e,t){var r=l(e,14);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},a=e.l+t;e.l<a;){var s=e.read_shift(2);if(14e3==s){for(r[s]=[0,""],r[s][0]=e.read_shift(2);e[e.l];)r[s][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=o(e,t),a=e.read_shift(4);return r[1].v=a>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:c},40:{n:"FORMULA28",f:function(e,t){var r=c(e,14);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:d},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var a=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[a,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r,a,s,n,i=t||{};if(+i.codepage>=0&&oe(+i.codepage),"string"==i.type)throw Error("Cannot write WK1 to JS string");var o=cv(),l=cP(e["!ref"]),c=Array.isArray(e),d=[];hX(o,0,(r=1030,(a=cy(2)).write_shift(2,1030),a)),hX(o,6,(s=l,(n=cy(8)).write_shift(2,s.s.c),n.write_shift(2,s.s.r),n.write_shift(2,s.e.c),n.write_shift(2,s.e.r),n));for(var h=Math.min(l.e.r,8191),u=l.s.r;u<=h;++u)for(var m=cT(u),p=l.s.c;p<=l.e.c;++p){u===l.s.r&&(d[p]=cA(p));var f=d[p]+m,g=c?(e[u]||[])[p]:e[f];g&&"z"!=g.t&&("n"==g.t?(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?hX(o,13,function(e,t,r){var a=cy(7);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(2,r,"i"),a}(u,p,g.v)):hX(o,14,function(e,t,r){var a=cy(13);return a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(8,r,"f"),a}(u,p,g.v)):hX(o,15,function(e,t,r){var a=cy(7+r.length);a.write_shift(1,255),a.write_shift(2,t),a.write_shift(2,e),a.write_shift(1,39);for(var s=0;s<a.length;++s){var n=r.charCodeAt(s);a.write_shift(1,n>=128?95:n)}return a.write_shift(1,0),a}(u,p,cL(g).slice(0,239))))}return hX(o,1),o.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&oe(+r.codepage),"string"==r.type)throw Error("Cannot write WK3 to JS string");var a=cv();hX(a,0,function(e){var t=cy(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,a=0,s=0,n=0;n<e.SheetNames.length;++n){var i=e.SheetNames[n],o=e.Sheets[i];if(o&&o["!ref"]){++s;var l=c_(o["!ref"]);r<l.e.r&&(r=l.e.r),a<l.e.c&&(a=l.e.c)}}return r>8191&&(r=8191),t.write_shift(2,r),t.write_shift(1,s),t.write_shift(1,a),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var s=0,n=0;s<e.SheetNames.length;++s)(e.Sheets[e.SheetNames[s]]||{})["!ref"]&&hX(a,27,function(e,t){var r=cy(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var a=0;a<e.length;++a){var s=e.charCodeAt(a);r[r.l++]=s>127?95:s}return r[r.l++]=0,r}(e.SheetNames[s],n++));var i=0;for(s=0;s<e.SheetNames.length;++s){var o=e.Sheets[e.SheetNames[s]];if(o&&o["!ref"]){for(var l=cP(o["!ref"]),c=Array.isArray(o),d=[],h=Math.min(l.e.r,8191),u=l.s.r;u<=h;++u)for(var m=cT(u),p=l.s.c;p<=l.e.c;++p){u===l.s.r&&(d[p]=cA(p));var f=d[p]+m,g=c?(o[u]||[])[p]:o[f];g&&"z"!=g.t&&("n"==g.t?hX(a,23,function(e,t,r,a){var s=cy(14);if(s.write_shift(2,e),s.write_shift(1,r),s.write_shift(1,t),0==a)return s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,65535),s;var n=0,i=0,o=0,l=0;return a<0&&(n=1,a=-a),i=0|Math.log2(a),a/=Math.pow(2,i-31),(0x80000000&(l=a>>>0))==0&&(a/=2,++i,l=a>>>0),a-=l,l|=0x80000000,l>>>=0,a*=0x100000000,o=a>>>0,s.write_shift(4,o),s.write_shift(4,l),i+=16383+32768*!!n,s.write_shift(2,i),s}(u,p,i,g.v)):hX(a,22,function(e,t,r,a){var s=cy(6+a.length);s.write_shift(2,e),s.write_shift(1,r),s.write_shift(1,t),s.write_shift(1,39);for(var n=0;n<a.length;++n){var i=a.charCodeAt(n);s.write_shift(1,i>=128?95:i)}return s.write_shift(1,0),s}(u,p,i,cL(g).slice(0,239))))}++i}}return hX(a,1),a.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(oh(oi(e)),r);case"binary":return t(oh(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}(),dq=/^\s|\s$|[\t\n\r]/;function dY(e,t){if(!t.bookSST)return"";var r=[lg];r[r.length]=lU("sst",null,{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(null!=e[a]){var s=e[a],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(dq)&&(n+=' xml:space="preserve"'),n+=">"+lS(s.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var dX=function(e,t){var r=!1;return null==t&&(r=!0,t=cy(15+4*e.t.length)),t.write_shift(1,0),cV(e.t,t),r?t.slice(0,t.l):t};function dK(e){if(void 0!==M)return M.utils.encode(i6,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function dQ(e){var t,r,a=0,s=dK(e),n=s.length+1;for(r=1,(t=oc(n))[0]=s.length;r!=n;++r)t[r]=s[r-1];for(r=n-1;r>=0;--r)a=((16384&a)!=0|a<<1&32767)^t[r];return 52811^a}var dJ=(C=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],A=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],R=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],O=function(e,t){var r;return((r=e^t)/2|128*r)&255},_=function(e){for(var t=A[e.length-1],r=104,a=e.length-1;a>=0;--a)for(var s=e[a],n=0;7!=n;++n)64&s&&(t^=R[r]),s*=2,--r;return t},function(e){for(var t,r,a,s=dK(e),n=_(s),i=s.length,o=oc(16),l=0;16!=l;++l)o[l]=0;for((1&i)==1&&(t=n>>8,o[i]=O(C[0],t),--i,t=255&n,r=s[s.length-1],o[i]=O(r,t));i>0;)--i,t=n>>8,o[i]=O(s[i],t),--i,t=255&n,o[i]=O(s[i],t);for(i=15,a=15-s.length;a>0;)t=n>>8,o[i]=O(C[a],t),--i,--a,t=255&n,o[i]=O(s[i],t),--i,--a;return o}),dZ=function(){function e(e,r){switch(r.type){case"base64":return t(oi(e),r);case"binary":return t(e,r);case"buffer":return t(oo&&i5.Buffer.isBuffer(e)?e.toString("binary"):om(e),r);case"array":return t(ll(e),r)}throw Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},a=e.match(/\\trowd.*?\\row\b/g);if(!a.length)throw Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var a,n=/\\\w+\b/g,i=0,o=-1;a=n.exec(e);){if("\\cell"===a[0]){var l=e.slice(i,n.lastIndex-a[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[cO({r:t,c:o})]=c}}i=n.lastIndex}o>s.e.c&&(s.e.c=o)}),r["!ref"]=cD(s),r}return{to_workbook:function(t,r){return cM(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],a=cP(e["!ref"]),s=Array.isArray(e),n=a.s.r;n<=a.e.r;++n){r.push("\\trowd\\trautofit1");for(var i=a.s.c;i<=a.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=a.s.c;i<=a.e.c;++i){var o=cO({r:n,c:i});(t=s?(e[n]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(cL(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function d0(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var d1=6;function d2(e){return Math.floor((e+Math.round(128/d1)/256)*d1)}function d5(e){return Math.floor((e-5)/d1*100+.5)/100}function d4(e){return Math.round((e*d1+5)/d1*256)/256}function d3(e){e.width?(e.wpx=d2(e.width),e.wch=d5(e.wpx),e.MDW=d1):e.wpx?(e.wch=d5(e.wpx),e.width=d4(e.wch),e.MDW=d1):"number"==typeof e.wch&&(e.width=d4(e.wch),e.wpx=d2(e.width),e.MDW=d1),e.customWidth&&delete e.customWidth}function d6(e){return 96*e/96}function d8(e,t){var r,a,s,n,i,o=[lg,lU("styleSheet",null,{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:vt":lW})];return e.SSF&&null!=(r=e.SSF,a=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=r[t]&&(a[a.length]=lU("numFmt",null,{numFmtId:t,formatCode:lS(r[t])}))}),i=1===a.length?"":(a[a.length]="</numFmts>",a[0]=lU("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join("")))&&(o[o.length]=i),o[o.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',o[o.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',o[o.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',o[o.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',s=t.cellXfs,(n=[])[n.length]=lU("cellXfs",null),s.forEach(function(e){n[n.length]=lU("xf",null,e)}),n[n.length]="</cellXfs>",(i=2===n.length?"":(n[0]=lU("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join("")))&&(o[o.length]=i),o[o.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',o[o.length]='<dxfs count="0"/>',o[o.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',o.length>2&&(o[o.length]="</styleSheet>",o[1]=o[1].replace("/>",">")),o.join("")}var d7=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function d9(e,t){t||(t=cy(84)),F||(F=o6(d7));var r=F[e.patternType];null==r&&(r=40),t.write_shift(4,r);var a=0;if(40!=r)for(c1({auto:1},t),c1({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function he(e,t,r){return r||(r=cy(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ht(e,t){return t||(t=cy(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}function hr(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[lg];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function ha(){var e=[lg];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var hs=1024;function hn(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[lU("xml",null,{"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":lG,"xmlns:x":lq,"xmlns:mv":"http://macVmlSchemaUri"}).replace(/\/>/,">"),lU("o:shapelayout",lU("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),lU("v:shapetype",[lU("v:stroke",null,{joinstyle:"miter"}),lU("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];hs<1e3*e;)hs+=1e3;return t.forEach(function(e){var t=cR(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var a="gradient"==r.type?lU("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,n=lU("v:fill",a,r);++hs,s=s.concat(["<v:shape"+lB({id:"_x0000_s"+hs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",n,lU("v:shadow",null,{on:"t",obscured:"t"}),lU("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lF("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),lF("x:AutoFill","False"),lF("x:Row",String(t.r)),lF("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function hi(e){var t=[lg,lU("comments",null,{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"})],r=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var a=lS(e.a);-1==r.indexOf(a)&&(r.push(a),t.push("<author>"+a+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var a=0,s=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?a=r.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(a=r.indexOf(lS(e.a))),s.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(lF("t",lS(s[0]||"")));else{for(var n="Comment:\n    "+s[0]+"\n",i=1;i<s.length;++i)n+="Reply:\n    "+s[i]+"\n";t.push(lF("t",lS(n)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}var ho=["xlsb","xlsm","xlam","biff8","xla"],hl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,a,s){var n=!1,i=!1;0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1)),0==s.length?n=!0:"["==s.charAt(0)&&(n=!0,s=s.slice(1,-1));var o=a.length>0?0|parseInt(a,10):0,l=s.length>0?0|parseInt(s,10):0;return n?l+=t.c:--l,i?o+=t.r:--o,r+(n?"":"$")+cA(l)+(i?"":"$")+cT(o)}return function(a,s){return t=s,a.replace(e,r)}}(),hc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hd=function(e,t){return e.replace(hc,function(e,r,a,s,n,i){var o=cC(s)-(a?0:t.c),l=cS(i)-(n?0:t.r);return r+"R"+(0==l?"":n?l+1:"["+l+"]")+"C"+(0==o?"":a?o+1:"["+o+"]")})};function hh(e){e.l+=1}function hu(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function hm(e,t,r){var a=2;if(r)if(r.biff>=2&&r.biff<=5)return hp(e,t,r);else 12==r.biff&&(a=4);var s=e.read_shift(a),n=e.read_shift(a),i=hu(e,2),o=hu(e,2);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function hp(e){var t=hu(e,2),r=hu(e,2),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function hf(e,t,r){if(r&&r.biff>=2&&r.biff<=5){var a,s,n;return s=hu(a=e,2),n=a.read_shift(1),{r:s[0],c:n,cRel:s[1],rRel:s[2]}}var i=e.read_shift(r&&12==r.biff?4:2),o=hu(e,2);return{r:i,c:o[0],cRel:o[1],rRel:o[2]}}function hg(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function hx(e){return[e.read_shift(1),e.read_shift(1)]}function hb(e,t,r){var a;return e.l+=2,[{r:e.read_shift(2),c:255&(a=e.read_shift(2)),fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}]}function hy(e){return e.l+=6,[]}function hv(e){return e.l+=2,[dO(e),1&e.read_shift(2)]}var hw=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],hN={1:{n:"PtgExp",f:function(e,t,r){return(e.l++,r&&12==r.biff)?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:cb},3:{n:"PtgAdd",f:hh},4:{n:"PtgSub",f:hh},5:{n:"PtgMul",f:hh},6:{n:"PtgDiv",f:hh},7:{n:"PtgPower",f:hh},8:{n:"PtgConcat",f:hh},9:{n:"PtgLt",f:hh},10:{n:"PtgLe",f:hh},11:{n:"PtgEq",f:hh},12:{n:"PtgGe",f:hh},13:{n:"PtgGt",f:hh},14:{n:"PtgNe",f:hh},15:{n:"PtgIsect",f:hh},16:{n:"PtgUnion",f:hh},17:{n:"PtgRange",f:hh},18:{n:"PtgUplus",f:hh},19:{n:"PtgUminus",f:hh},20:{n:"PtgPercent",f:hh},21:{n:"PtgParen",f:hh},22:{n:"PtgMissArg",f:hh},23:{n:"PtgStr",f:function(e,t,r){return e.l++,dP(e,t-1,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,c3[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,cZ(e,8)}},32:{n:"PtgArray",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[a]}},33:{n:"PtgFunc",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[hD[s],h_[s],a]}},34:{n:"PtgFuncVar",f:function(e,t,r){var a,s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[88==s?-1:0,e.read_shift(1)]:[(a=e)[a.l+1]>>7,32767&a.read_shift(2)];return[n,(0===i[0]?h_:hO)[i[1]]]}},35:{n:"PtgName",f:function(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,n]}},36:{n:"PtgRef",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,hf(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,hm(e,r.biff>=2&&r.biff<=5?6:8,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[a,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:cb},40:{n:"PtgMemNoMem",f:cb},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[a]}},43:{n:"PtgAreaErr",f:function(e,t,r){var a=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}},44:{n:"PtgRefN",f:function(e,t,r){var a=(96&e[e.l])>>5;return e.l+=1,[a,function(e,t,r){var a,s,n,i,o,l=r&&r.biff?r.biff:8;if(l>=2&&l<=5){return s=(a=e).read_shift(2),n=a.read_shift(1),i=(32768&s)>>15,o=(16384&s)>>14,s&=16383,1==i&&s>=8192&&(s-=16384),1==o&&n>=128&&(n-=256),{r:s,c:n,cRel:o,rRel:i}}var c=e.read_shift(l>=12?4:2),d=e.read_shift(2),h=(16384&d)>>14,u=(32768&d)>>15;if(d&=16383,1==u)for(;c>524287;)c-=1048576;if(1==h)for(;d>8191;)d-=16384;return{r:c,c:d,cRel:h,rRel:u}}(e,0,r)]}},45:{n:"PtgAreaN",f:function(e,t,r){return[(96&e[e.l++])>>5,function(e,t,r){if(r.biff<8)return hp(e,t,r);var a=e.read_shift(12==r.biff?4:2),s=e.read_shift(12==r.biff?4:2),n=hu(e,2),i=hu(e,2);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}(e,t-1,r)]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){var a,s,n,i;return 5==r.biff?(s=(a=e).read_shift(1)>>>5&3,n=a.read_shift(2,"i"),a.l+=8,i=a.read_shift(2),a.l+=12,[s,n,i]):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var a=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[a,s,hf(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return[a,s,hm(e,n,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6}return e.l+=n,[a,s]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var a=(96&e[e.l++])>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return e.l+=n,[a,s]}},255:{}},hj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hk={1:{n:"PtgElfLel",f:hv},2:{n:"PtgElfRw",f:hb},3:{n:"PtgElfCol",f:hb},6:{n:"PtgElfRwV",f:hb},7:{n:"PtgElfColV",f:hb},10:{n:"PtgElfRadical",f:hb},11:{n:"PtgElfRadicalS",f:hy},13:{n:"PtgElfColS",f:hy},15:{n:"PtgElfColSV",f:hy},16:{n:"PtgElfRadicalLel",f:hv},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),i=hw[r>>2&31];return{ixti:t,coltype:3&r,rt:i,idx:a,c:s,C:n}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},hE={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[a]}},2:{n:"PtgAttrIf",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var a=e.read_shift(r&&2==r.biff?1:2),s=[],n=0;n<=a;++n)s.push(e.read_shift(r&&2==r.biff?1:2));return s}},8:{n:"PtgAttrGoto",f:function(e,t,r){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:hg},33:{n:"PtgAttrBaxcel",f:hg},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),hx(e,2)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),hx(e,2)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}},hS={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:if(null!=r.SID)return e.SheetNames[r.SID];return"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(";;");default:if(!e[a[0]][0][3])return"SH33TJSERR2";return s=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]}}function hC(e,t,r){var a=hT(e,t,r);return"#REF"==a?a:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(a,r)}function hA(e,t,r,a,s){var n,i,o,l,c=s&&s.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},h=[],u=0,m=0,p="";if(!e[0]||!e[0][0])return"";for(var f=-1,g="",x=0,b=e[0].length;x<b;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(n=h.pop(),i=h.pop(),f>=0){switch(e[0][f][1][0]){case 0:g=ld(" ",e[0][f][1][1]);break;case 1:g=ld("\r",e[0][f][1][1]);break;default:if(g="",s.WTF)throw Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}i+=g,f=-1}h.push(i+hS[y[0]]+n);break;case"PtgIsect":n=h.pop(),i=h.pop(),h.push(i+" "+n);break;case"PtgUnion":n=h.pop(),i=h.pop(),h.push(i+","+n);break;case"PtgRange":n=h.pop(),i=h.pop(),h.push(i+":"+n);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=cN(y[1][1],d,s),h.push(ck(o,c));break;case"PtgRefN":o=r?cN(y[1][1],r,s):y[1][1],h.push(ck(o,c));break;case"PtgRef3d":u=y[1][1],o=cN(y[1][2],d,s),p=hC(a,u,s),h.push(p+"!"+ck(o,c));break;case"PtgFunc":case"PtgFuncVar":var v=y[1][0],w=y[1][1];v||(v=0);var N=0==(v&=127)?[]:h.slice(-v);h.length-=v,"User"===w&&(w=N.shift()),h.push(w+"("+N.join(",")+")");break;case"PtgBool":h.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(y[1]);break;case"PtgNum":h.push(String(y[1]));break;case"PtgStr":h.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=cj(y[1][1],r?{s:r}:d,s),h.push(cE(l,s));break;case"PtgArea":l=cj(y[1][1],d,s),h.push(cE(l,s));break;case"PtgArea3d":u=y[1][1],l=y[1][2],p=hC(a,u,s),h.push(p+"!"+cE(l,s));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":m=y[1][2];var j=(a.names||[])[m-1]||(a[0]||[])[m],k=j?j.Name:"SH33TJSNAME"+String(m);k&&"_xlfn."==k.slice(0,6)&&!s.xlfn&&(k=k.slice(6)),h.push(k);break;case"PtgNameX":var E,S=y[1][1];if(m=y[1][2],s.biff<=5)S<0&&(S=-S),a[S]&&(E=a[S][m]);else{var T="";if(14849==((a[S]||[])[0]||[])[0]||(1025==((a[S]||[])[0]||[])[0]?a[S][m]&&a[S][m].itab>0&&(T=a.SheetNames[a[S][m].itab-1]+"!"):T=a.SheetNames[m-1]+"!"),a[S]&&a[S][m])T+=a[S][m].Name;else if(a[0]&&a[0][m])T+=a[0][m].Name;else{var C=(hT(a,S,s)||"").split(";;");C[m-1]?T=C[m-1]:T+="SH33TJSERRX"}h.push(T);break}E||(E={Name:"SH33TJSERRY"}),h.push(E.Name);break;case"PtgParen":var A="(",R=")";if(f>=0){switch(g="",e[0][f][1][0]){case 2:A=ld(" ",e[0][f][1][1])+A;break;case 3:A=ld("\r",e[0][f][1][1])+A;break;case 4:R=ld(" ",e[0][f][1][1])+R;break;case 5:R=ld("\r",e[0][f][1][1])+R;break;default:if(s.WTF)throw Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}h.push(A+h.pop()+R);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var O={c:r.c,r:r.r};if(a.sharedf[cO(o)]){var _=a.sharedf[cO(o)];h.push(hA(_,d,O,a,s))}else{var D=!1;for(n=0;n!=a.arrayf.length;++n)if((i=a.arrayf[n],!(o.c<i[0].s.c)&&!(o.c>i[0].e.c))&&!(o.r<i[0].s.r)&&!(o.r>i[0].e.r)){h.push(hA(i[1],d,O,a,s)),D=!0;break}D||h.push(y[1])}break;case"PtgArray":h.push("{"+function(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],n=0;n<a.length;++n){var i=a[n];i?2===i[0]?s.push('"'+i[1].replace(/"/g,'""')+'"'):s.push(i[1]):s.push("")}t.push(s.join(","))}return t.join(";")}(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=x;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw Error("Unsupported ELFs");default:throw Error("Unrecognized Formula Token: "+String(y))}var P=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(3!=s.biff&&f>=0&&-1==P.indexOf(e[0][x][0])){y=e[0][f];var I=!0;switch(y[1][0]){case 4:I=!1;case 0:g=ld(" ",y[1][1]);break;case 5:I=!1;case 1:g=ld("\r",y[1][1]);break;default:if(g="",s.WTF)throw Error("Unexpected PtgAttrSpaceType "+y[1][0])}h.push((I?g:"")+h.pop()+(I?"":g)),f=-1}}if(h.length>1&&s.WTF)throw Error("bad formula stack");return h[0]}function hR(e,t,r){var a=e.read_shift(4),s=function(e,t,r){for(var a,s,n,i=e.l+t,o=[];i!=e.l;)(t=i-e.l,s=hN[n=e[e.l]]||hN[hj[n]],(24===n||25===n)&&(s=(24===n?hk:hE)[e[e.l+1]]),s&&s.f)?o.push([s.n,s.f(e,t,r)]):(a=t,e.l+=a);return o}(e,a,r),n=e.read_shift(4),i=n>0?function(e,t,r,a){if(a.biff<8)return s=t,void(e.l+=s);for(var s,n,i=e.l+t,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=function(e,t,r){var a=0,s=0;12==r.biff?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,0==--s&&(s=256));for(var n=0,i=[];n!=a&&(i[n]=[]);++n)for(var o=0;o!=s;++o)i[n][o]=function(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=1===e.read_shift(1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=c3[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=cZ(e,8);break;case 2:r[1]=function(e,t,r){if(r.biff>5){var a,s,n;return a=e,s=r,0===(n=a.read_shift(s&&2==s.biff?1:2))?(a.l++,""):function(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}(a,n,s)}var i=e.read_shift(1);return 0===i?(e.l++,""):e.read_shift(i,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}(e,0,{biff:t>0&&t<8?2:t});break;default:throw Error("Bad SerAr: "+r[0])}return r}(e,r.biff);return i}(e,0,a),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=function(e,t,r){for(var a=e.read_shift(12==r.biff?4:2),s=[],n=0;n!=a;++n)s.push((12==r.biff?cQ:function(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}})(e,8));return s}(e,r[l][1],a),o.push(r[l][2]);break;case"PtgExp":a&&12==a.biff&&(r[l][1][1]=e.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return 0!=(t=i-e.l)&&o.push((n=t,void(e.l+=n))),o}(e,n,s,r):null;return[s,i]}var hO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},h_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},hD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},hP="undefined"!=typeof Map;function hI(e,t,r){var a=0,s=e.length;if(r){if(hP?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var n=hP?r.get(t):r[t];a<n.length;++a)if(e[n[a]].t===t)return e.Count++,n[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t:t},e.Count++,e.Unique++,r&&(hP?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function hL(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(d1=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?a=d5(t.wpx):null!=t.wch&&(a=t.wch),a>-1?(r.width=d4(a),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function hM(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function hF(e,t,r){var a=r.revssf[null!=t.z?t.z:"General"],s=60,n=e.length;if(null==a&&r.ssf){for(;s<392;++s)if(null==r.ssf[s]){oQ(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=n;++s)if(e[s].numFmtId===a)return s;return e[n]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}var hB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hU=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function hV(e,t,r,a){var s,n=[lg,lU("worksheet",null,{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":lH})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];null==c&&(c={});var d=c["!ref"]||"A1",h=cP(d);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=cD(h)}a||(a={}),c["!comments"]=[];var u=[];!function(e,t,r,a,s){var n=!1,i={},o=null;if("xlsx"!==a.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(e){}n=!0,i.codeName=lP(lS(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+lU("outlinePr",null,c)}(n||o)&&(s[s.length]=lU("sheetPr",o,i))}(c,r,e,t,n),n[n.length]=lU("dimension",null,{ref:d}),n[n.length]=(m={workbookViewId:"0"},(((r||{}).Workbook||{}).Views||[])[0]&&(m.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),lU("sheetViews",lU("sheetView",null,m),{})),t.sheetFormat&&(n[n.length]=lU("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=c["!cols"]&&c["!cols"].length>0&&(n[n.length]=function(e,t){for(var r,a=["<cols>"],s=0;s!=t.length;++s)(r=t[s])&&(a[a.length]=lU("col",null,hL(s,r)));return a[a.length]="</cols>",a.join("")}(0,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],null!=c["!ref"]&&(l=function(e,t,r,a){var s,n,i=[],o=[],l=cP(e["!ref"]),c="",d="",h=[],u=0,m=0,p=e["!rows"],f=Array.isArray(e),g={r:d},x=-1;for(m=l.s.c;m<=l.e.c;++m)h[m]=cA(m);for(u=l.s.r;u<=l.e.r;++u){for(o=[],d=cT(u),m=l.s.c;m<=l.e.c;++m){s=h[m]+d;var b=f?(e[u]||[])[m]:e[s];void 0!==b&&null!=(c=function(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!=typeof e.f||"z"===e.t&&!e.f)return"";var s="",n=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=c3[e.v];break;case"d":a&&a.cellDates?s=lo(e.v,-1).toISOString():((e=lc(e)).t="n",s=""+(e.v=o9(lo(e.v)))),void 0===e.z&&(e.z=oE[14]);break;default:s=e.v}var o=lF("v",lS(s)),l={r:t},c=hF(a.cellXfs,e,a);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=lF("v",""+hI(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str"}if(e.t!=n&&(e.t=n,e.v=i),"string"==typeof e.f&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=lU("f",lS(e.f),d)+(null!=e.v?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),lU("c",o,l)}(b,s,e,t,r,a))&&o.push(c)}(o.length>0||p&&p[u])&&(g={r:d},p&&p[u]&&((n=p[u]).hidden&&(g.hidden=1),x=-1,n.hpx?x=d6(n.hpx):n.hpt&&(x=n.hpt),x>-1&&(g.ht=x,g.customHeight=1),n.level&&(g.outlineLevel=n.level)),i[i.length]=lU("row",o.join(""),g))}if(p)for(;u<p.length;++u)p&&p[u]&&(g={r:u+1},(n=p[u]).hidden&&(g.hidden=1),x=-1,n.hpx?x=d6(n.hpx):n.hpt&&(x=n.hpt),x>-1&&(g.ht=x,g.customHeight=1),n.level&&(g.outlineLevel=n.level),i[i.length]=lU("row","",g));return i.join("")}(c,t,e,r,a)).length>0&&(n[n.length]=l),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=(p=c["!protect"],f={sheet:1},hB.forEach(function(e){null!=p[e]&&p[e]&&(f[e]="1")}),hU.forEach(function(e){null==p[e]||p[e]||(f[e]="0")}),p.password&&(f.password=dQ(p.password).toString(16).toUpperCase()),lU("sheetProtection",null,f))),null!=c["!autofilter"]&&(n[n.length]=function(e,t,r,a){var s="string"==typeof e.ref?e.ref:cD(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,i=c_(s);i.s.r==i.e.r&&(i.e.r=c_(t["!ref"]).e.r,s=cD(i));for(var o=0;o<n.length;++o){var l=n[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return o==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),lU("autoFilter",null,{ref:s})}(c["!autofilter"],c,r,e)),null!=c["!merges"]&&c["!merges"].length>0&&(n[n.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+cD(e[r])+'"/>';return t+"</mergeCells>"}(c["!merges"]));var m,p,f,g,x=-1,b=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(e){e[1].Target&&(g={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(b=df(a,-1,lS(e[1].Target).replace(/#.*$/,""),dt),g["r:id"]="rId"+b),(x=e[1].Target.indexOf("#"))>-1&&(g.location=lS(e[1].Target.slice(x+1))),e[1].Tooltip&&(g.tooltip=lS(e[1].Tooltip)),n[n.length]=lU("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete c["!links"],null!=c["!margins"]&&(n[n.length]=(hM(s=c["!margins"]),lU("pageMargins",null,s))),(!t||t.ignoreEC||void 0==t.ignoreEC)&&(n[n.length]=lF("ignoredErrors",lU("ignoredError",null,{numberStoredAsText:1,sqref:d}))),u.length>0&&(b=df(a,-1,"../drawings/drawing"+(e+1)+".xml","http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"),n[n.length]=lU("drawing",null,{"r:id":"rId"+b}),c["!drawing"]=u),c["!comments"].length>0&&(b=df(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",dr),n[n.length]=lU("legacyDrawing",null,{"r:id":"rId"+b}),c["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}var hz=["left","right","top","bottom","header","footer"],hH=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],hW="][*?/\\".split("");function h$(e,t){if(e.length>31){if(t)return!1;throw Error("Sheet names cannot exceed 31 chars")}var r=!0;return hW.forEach(function(a){if(-1!=e.indexOf(a)){if(!t)throw Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function hG(e){var t=[lg];t[t.length]=lU("workbook",null,{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":lH});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(hH.forEach(function(t){null==e.Workbook.WBProps[t[0]]||e.Workbook.WBProps[t[0]]!=t[1]&&(a[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=lU("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],n=0;if(s&&s[0]&&s[0].Hidden){for(n=0,t[t.length]="<bookViews>";n!=e.SheetNames.length&&s[n]&&s[n].Hidden;++n);n==e.SheetNames.length&&(n=0),t[t.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',t[t.length]="</bookViews>"}for(n=0,t[t.length]="<sheets>";n!=e.SheetNames.length;++n){var i={name:lS(e.SheetNames[n].slice(0,31))};if(i.sheetId=""+(n+1),i["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=lU("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=lU("definedName",lS(e.Ref),r))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function hq(e){return lU("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+hd(e.Ref,{r:0,c:0})})}var hY={0:{f:function(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,7&n&&(r.level=7&n),16&n&&(r.hidden=!0),32&n&&(r.hpt=s/20),r}},1:{f:function(e){return[cH(e)]}},2:{f:function(e){return[cH(e),cX(e),"n"]}},3:{f:function(e){return[cH(e),e.read_shift(1),"e"]}},4:{f:function(e){return[cH(e),e.read_shift(1),"b"]}},5:{f:function(e){return[cH(e),cZ(e),"n"]}},6:{f:function(e){return[cH(e),cU(e),"str"]}},7:{f:function(e){return[cH(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var a=e.l+t,s=cH(e);s.r=r["!row"];var n=[s,cU(e),"str"];if(r.cellFormula){e.l+=2;var i=hR(e,a-e.l,r);n[3]=hA(i,null,s,r.supbooks,r)}else e.l=a;return n}},9:{f:function(e,t,r){var a=e.l+t,s=cH(e);s.r=r["!row"];var n=[s,cZ(e),"n"];if(r.cellFormula){e.l+=2;var i=hR(e,a-e.l,r);n[3]=hA(i,null,s,r.supbooks,r)}else e.l=a;return n}},10:{f:function(e,t,r){var a=e.l+t,s=cH(e);s.r=r["!row"];var n=[s,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=hR(e,a-e.l,r);n[3]=hA(i,null,s,r.supbooks,r)}else e.l=a;return n}},11:{f:function(e,t,r){var a=e.l+t,s=cH(e);s.r=r["!row"];var n=[s,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=hR(e,a-e.l,r);n[3]=hA(i,null,s,r.supbooks,r)}else e.l=a;return n}},12:{f:function(e){return[c$(e)]}},13:{f:function(e){return[c$(e),cX(e),"n"]}},14:{f:function(e){return[c$(e),e.read_shift(1),"e"]}},15:{f:function(e){return[c$(e),e.read_shift(1),"b"]}},16:{f:function(e){return[c$(e),cZ(e),"n"]}},17:{f:function(e){return[c$(e),cU(e),"str"]}},18:{f:function(e){return[c$(e),e.read_shift(4),"s"]}},19:{f:cz},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=cU(e),i=hR(e,0,r),o=cq(e);e.l=a;var l={Name:n,Ptg:i};return s<0xfffffff&&(l.Sheet=s),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var a,s={};s.sz=e.read_shift(2)/20;var n=(a=e.read_shift(1),e.l++,{fBold:1&a,fItalic:2&a,fUnderline:4&a,fStrikeout:8&a,fOutline:16&a,fShadow:32&a,fCondense:64&a,fExtend:128&a});switch(n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1),700===e.read_shift(2)&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(s.underline=i);var o=e.read_shift(1);o>0&&(s.family=o);var l=e.read_shift(1);switch(l>0&&(s.charset=l),e.l++,s.color=function(e){var t={},r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(2,"i"),n=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r>>>1){case 0:t.auto=1;break;case 1:t.index=a;var l=c4[a];l&&(t.rgb=d0(l));break;case 2:t.rgb=d0([n,i,o]);break;case 3:t.theme=a}return 0!=s&&(t.tint=s>0?s/32767:s/32768),t}(e,8),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor"}return s.name=cU(e,t-21),s}},44:{f:function(e,t){return[e.read_shift(2),cU(e,t-2)]}},45:{f:cb},46:{f:cb},47:{f:function(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:function(e,t,r){if(!r.cellStyles)return void(e.l+=t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2);2==a&&(e.l+=2);var c={s:s,e:n,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}},62:{f:function(e){return[cH(e),cz(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=cO(r);var a=e.read_shift(1);return 2&a&&(t.l="1"),8&a&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cb,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},a=e[e.l];return++e.l,r.above=!(64&a),r.left=!(128&a),e.l+=18,r.name=cU(e,t-19),r}},148:{f:cQ,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?cU(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(65536&a),r.backupFile=!!(64&a),r.checkCompatibility=!!(4096&a),r.date1904=!!(1&a),r.filterPrivacy=!!(8&a),r.hidePivotFieldList=!!(1024&a),r.promptedSolutions=!!(16&a),r.publishItems=!!(2048&a),r.refreshAllConnections=!!(262144&a),r.saveExternalLinkValues=!!(128&a),r.showBorderUnselectedTables=!!(4&a),r.showInkAnnotation=!!(32&a),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(32768&a),r.updateLinks=["userSet","never","always"][a>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=cq(e,t-8),r.name=cU(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:cQ},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cQ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:cU(e,t-8)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cq},357:{},358:{},359:{},360:{T:1},361:{},362:{f:function(e,t,r){if(r.biff<8){var a,s,n,i;return a=e,s=t,n=r,3==a[a.l+1]&&a[a.l]++,3==(i=dP(a,s,n)).charCodeAt(0)?i.slice(1):i}for(var o=[],l=e.l+t,c=e.read_shift(r.biff>8?4:2);0!=c--;)o.push(function(e,t,r){var a=r.biff>8?4:2;return[e.read_shift(a),e.read_shift(a,"i"),e.read_shift(a,"i")]}(e,r.biff,r));if(e.l!=l)throw Error("Bad ExternSheet: "+e.l+" != "+l);return o}},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var a=e.l+t,s=cQ(e,16),n=e.read_shift(1),i=[s];if(i[2]=n,r.cellFormula){var o=hR(e,a-e.l,r);i[1]=o}else e.l=a;return i}},427:{f:function(e,t,r){var a=e.l+t,s=[cQ(e,16)];if(r.cellFormula){var n=hR(e,a-e.l,r);s[1]=n,e.l=a}else e.l=a;return s}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return hz.forEach(function(r){t[r]=cZ(e,8)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,a=cQ(e,16),s=cq(e),n=cU(e),i=cU(e),o=cU(e);e.l=r;var l={rfx:a,relId:s,loc:n,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cq},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cU},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=cQ(e,16);return t.rfx=r.s,t.ref=cO(r.s),e.l+=16,t}},636:{T:-1},637:{f:cz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:cU(e,t-10)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function hX(e,t,r,a){if(!isNaN(t)){var s=a||(r||[]).length||0,n=e.next(4);n.write_shift(2,t),n.write_shift(2,s),s>0&&cn(r)&&e.push(r)}}function hK(e,t,r){return e||(e=cy(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function hQ(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];a&&a["!ref"]&&c_(a["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var s=t||{};switch(s.biff||2){case 8:case 5:var n=t||{},i=[];e&&!e.SSF&&(e.SSF=lc(oE)),e&&e.SSF&&(oZ(),oJ(e.SSF),n.revssf=o8(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,un(n),n.cellXfs=[],hF(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)i[i.length]=function(e,t,r){var a,s,n,i,o,l,c,d,h,u=cv(),m=r.SheetNames[e],p=r.Sheets[m]||{},f=(r||{}).Workbook||{},g=(f.Sheets||[])[e]||{},x=Array.isArray(p),b=8==t.biff,y="",v=[],w=cP(p["!ref"]||"A1"),N=b?65536:16384;if(w.e.c>255||w.e.r>=N){if(t.WTF)throw Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,N-1)}hX(u,2057,dB(r,16,t)),hX(u,13,d_(1)),hX(u,12,d_(100)),hX(u,15,dR(!0)),hX(u,17,dR(!1)),hX(u,16,c0(.001)),hX(u,95,dR(!0)),hX(u,42,dR(!1)),hX(u,43,dR(!1)),hX(u,130,d_(1)),hX(u,128,(a=[0,0],(s=cy(8)).write_shift(4,0),s.write_shift(2,a[0]?a[0]+1:0),s.write_shift(2,a[1]?a[1]+1:0),s)),hX(u,131,dR(!1)),hX(u,132,dR(!1)),b&&function(e,t){if(t){var r=0;t.forEach(function(t,a){var s,n,i;++r<=256&&t&&hX(e,125,(s=hL(a,t),(n=cy(12)).write_shift(2,a),n.write_shift(2,a),n.write_shift(2,256*s.width),n.write_shift(2,0),i=0,s.hidden&&(i|=1),n.write_shift(1,i),i=s.level||0,n.write_shift(1,i),n.write_shift(2,0),n))})}}(u,p["!cols"]),hX(u,512,((i=cy(2*(n=8!=t.biff&&t.biff?2:4)+6)).write_shift(n,w.s.r),i.write_shift(n,w.e.r+1),i.write_shift(2,w.s.c),i.write_shift(2,w.e.c+1),i.write_shift(2,0),i)),b&&(p["!links"]=[]);for(var j=w.s.r;j<=w.e.r;++j){y=cT(j);for(var k=w.s.c;k<=w.e.c;++k){j===w.s.r&&(v[k]=cA(k)),h=v[k]+y;var E=x?(p[j]||[])[k]:p[h];E&&(!function(e,t,r,a,s){var n=16+hF(s.cellXfs,t,s);if(null==t.v&&!t.bf)return hX(e,513,dM(r,a,n));if(t.bf)hX(e,6,function(e,t,r,a,s){var n=dM(t,r,s),i=function(e){if(null==e){var t=cy(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return"number"==typeof e?c0(e):c0(0)}(e.v),o=cy(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=cy(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return op([n,i,o,l])}(t,r,a,0,n));else switch(t.t){case"d":case"n":var i,o="d"==t.t?o9(lo(t.v)):t.v;hX(e,515,(dM(r,a,n,i=cy(14)),c0(o,i),i));break;case"b":case"e":hX(e,517,(l=t.v,c=t.t,dM(r,a,n,d=cy(8)),dD(l,c,d),d));break;case"s":case"str":if(s.bookSST){var l,c,d,h,u,m,p,f=hI(s.Strings,t.v,s.revStrings);hX(e,253,(dM(r,a,n,p=cy(10)),p.write_shift(4,f),p))}else hX(e,516,(h=(t.v||"").slice(0,255),dM(r,a,n,m=cy(8+ +(u=!s||8==s.biff)+(1+u)*h.length)),m.write_shift(2,h.length),u&&m.write_shift(1,1),m.write_shift((1+u)*h.length,h,u?"utf16le":"sbcs"),m));break;default:hX(e,513,dM(r,a,n))}}(u,E,j,k,t),b&&E.l&&p["!links"].push([h,E.l]))}}var S=g.CodeName||g.name||m;return b&&hX(u,574,(o=(f.Views||[])[0],l=cy(18),c=1718,o&&o.RTL&&(c|=64),l.write_shift(2,c),l.write_shift(4,0),l.write_shift(4,64),l.write_shift(4,0),l.write_shift(4,0),l)),b&&(p["!merges"]||[]).length&&hX(u,229,function(e){var t=cy(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)dF(e[r],t);return t}(p["!merges"])),b&&function(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];hX(e,440,function(e){var t=cy(24),r=cR(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return op([t,function(e){var t=cy(512),r=0,a=e.Target;"file://"==a.slice(0,7)&&(a=a.slice(7));var s=a.indexOf("#"),n=s>-1?31:23;switch(a.charAt(0)){case"#":n=28;break;case".":n&=-3}t.write_shift(4,2),t.write_shift(4,n);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(28==n)dL(a=a.slice(1),t);else if(2&n){for(r=0,i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" ");r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),8&n&&dL(s>-1?a.slice(s+1):"",t)}else{for(r=0,i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" ");r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;"../"==a.slice(3*l,3*l+3)||"..\\"==a.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,a.length-3*l+1),r=0;r<a.length-3*l;++r)t.write_shift(1,255&a.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}(e[1])])}(a)),a[1].Tooltip&&hX(e,2048,function(e){var t=e[1].Tooltip,r=cy(10+2*(t.length+1));r.write_shift(2,2048);var a=cR(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}(a))}delete t["!links"]}(u,p),hX(u,442,dI(S,t)),b&&((d=cy(19)).write_shift(4,2151),d.write_shift(4,0),d.write_shift(4,0),d.write_shift(2,3),d.write_shift(1,1),d.write_shift(4,0),hX(u,2151,d),(d=cy(39)).write_shift(4,2152),d.write_shift(4,0),d.write_shift(4,0),d.write_shift(2,3),d.write_shift(1,0),d.write_shift(4,0),d.write_shift(2,1),d.write_shift(4,4),d.write_shift(2,0),dF(cP(p["!ref"]||"A1"),d),d.write_shift(4,4),hX(u,2152,d)),hX(u,10),u.end()}(o,n,e);return i.unshift(function(e,t,r){var a,s,n,i,o,l,c,d=cv(),h=(e||{}).Workbook||{},u=h.Sheets||[],m=h.WBProps||{},p=8==r.biff,f=5==r.biff;hX(d,2057,dB(e,5,r)),"xla"==r.bookType&&hX(d,135),hX(d,225,p?d_(1200):null),hX(d,193,function(e,t){t||(t=cy(2));for(var r=0;r<2;++r)t.write_shift(1,0);return t}(0)),f&&hX(d,191),f&&hX(d,192),hX(d,226),hX(d,92,function(e,t){var r=!t||8==t.biff,a=cy(r?112:54);for(a.write_shift(8==t.biff?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,0x33336853),a.write_shift(4,5458548|0x20000000*!r);a.l<a.length;)a.write_shift(1,32*!r);return a}(0,r)),hX(d,66,d_(p?1200:1252)),p&&hX(d,353,d_(0)),p&&hX(d,448),hX(d,317,function(e){for(var t=cy(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),p&&e.vbaraw&&hX(d,211),p&&e.vbaraw&&hX(d,442,dI(m.CodeName||"ThisWorkbook",r)),hX(d,156,d_(17)),hX(d,25,dR(!1)),hX(d,18,dR(!1)),hX(d,19,d_(0)),p&&hX(d,431,dR(!1)),p&&hX(d,444,d_(0)),hX(d,61,((a=cy(18)).write_shift(2,0),a.write_shift(2,0),a.write_shift(2,29280),a.write_shift(2,17600),a.write_shift(2,56),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,1),a.write_shift(2,500),a)),hX(d,64,dR(!1)),hX(d,141,d_(0)),hX(d,34,dR("true"==(e.Workbook&&e.Workbook.WBProps?!function(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}(e.Workbook.WBProps.date1904)?"false":"true":"false"))),hX(d,14,dR(!0)),p&&hX(d,439,dR(!1)),hX(d,218,d_(0)),hX(d,49,(n=(s={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(o=cy((i=r&&5==r.biff)?15+n.length:16+2*n.length)).write_shift(2,20*(s.sz||12)),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,n.length),i||o.write_shift(1,1),o.write_shift((i?1:2)*n.length,n,i?"sbcs":"utf16le"),o)),l=e.SSF,l&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var t=e[0];t<=e[1];++t)null!=l[t]&&hX(d,1054,function(e,t,r,a){var s=r&&5==r.biff;a||(a=cy(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var n=a.length>a.l?a.slice(0,a.l):a;return null==n.l&&(n.l=n.length),n}(t,l[t],r))});for(var g=0;g<16;++g)hX(d,224,dU({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(e){hX(d,224,dU(e,0,r))}),p&&hX(d,352,dR(!1));var x=d.end(),b=cv();p&&hX(b,140,(c||(c=cy(4)),c.write_shift(2,1),c.write_shift(2,1),c)),p&&r.Strings&&function(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return hX(e,252,r,s);if(!isNaN(252)){for(var n=r.parts||[],i=0,o=0,l=0;l+(n[i]||8224)<=8224;)l+=n[i]||8224,i++;var c=e.next(4);for(c.write_shift(2,252),c.write_shift(2,l),e.push(r.slice(o,o+l)),o+=l;o<s;){for((c=e.next(4)).write_shift(2,60),l=0;l+(n[i]||8224)<=8224;)l+=n[i]||8224,i++;c.write_shift(2,l),e.push(r.slice(o,o+l)),o+=l}}}(b,0,function(e,t){var r=cy(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=function(e){var t=e.t||"",r=cy(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=cy(2*t.length);return a.write_shift(2*t.length,t,"utf16le"),op([r,a])}(e[s],t);var n=op([r].concat(a));return n.parts=[r.length].concat(a.map(function(e){return e.length})),n}(r.Strings,r)),hX(b,10);var y=b.end(),v=cv(),w=0,N=0;for(N=0;N<e.SheetNames.length;++N)w+=(p?12:11)+(p?2:1)*e.SheetNames[N].length;var j=x.length+w+y.length;for(N=0;N<e.SheetNames.length;++N)hX(v,133,function(e,t){var r=!t||t.biff>=8?2:1,a=cy(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}({pos:j,hs:(u[N]||{}).Hidden||0,dt:0,name:e.SheetNames[N]},r)),j+=t[N].length;var k=v.end();if(w!=k.length)throw Error("BS8 "+w+" != "+k.length);var E=[];return x.length&&E.push(x),k.length&&E.push(k),y.length&&E.push(y),op(E)}(e,i,n)),op(i);case 4:case 3:case 2:for(var l=t||{},c=cv(),d=0,h=0;h<e.SheetNames.length;++h)e.SheetNames[h]==l.sheet&&(d=h);if(0==d&&l.sheet&&e.SheetNames[0]!=l.sheet)throw Error("Sheet not found: "+l.sheet);return hX(c,4==l.biff?1033:3==l.biff?521:9,dB(e,16,l)),!function(e,t,r,a){var s,n=Array.isArray(t),i=cP(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=cD(i)}for(var c=i.s.r;c<=i.e.r;++c){o=cT(c);for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(l[d]=cA(d)),s=l[d]+o;var h=n?(t[c]||[])[d]:t[s];h&&function(e,t,r,a){if(null!=t.v)switch(t.t){case"d":case"n":var s,n,i,o,l,c,d,h="d"==t.t?o9(lo(t.v)):t.v;h==(0|h)&&h>=0&&h<65536?hX(e,2,(hK(c=cy(9),r,a),c.write_shift(2,h),c)):hX(e,3,(hK(d=cy(15),r,a),d.write_shift(8,h,"f"),d));return;case"b":case"e":hX(e,5,(s=t.v,n=t.t,hK(i=cy(9),r,a),dD(s,n||"b",i),i));return;case"s":case"str":hX(e,4,(hK(l=cy(8+2*(o=(t.v||"").slice(0,255)).length),r,a),l.write_shift(1,o.length),l.write_shift(o.length,o,"sbcs"),l.l<l.length?l.slice(0,l.l):l));return}hX(e,1,hK(null,r,a))}(e,h,c,d,a)}}}(c,e.Sheets[e.SheetNames[d]],0,l,e),hX(c,10),c.end()}throw Error("invalid type "+s.bookType+" for BIFF")}var hJ=(D="<office:document-styles "+lB({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+'><office:master-styles><style:master-page style:name="mp1" style:page-layout-name="mp1"><style:header/><style:header-left style:display="false"/><style:footer/><style:footer-left style:display="false"/></style:master-page></office:master-styles></office:document-styles>',function(){return lg+D}),hZ=(P="          <table:table-cell />\n",I=function(e,t,r){var a=[];a.push('      <table:table table:name="'+lS(t.SheetNames[r])+'" table:style-name="ta1">\n');var s=0,n=0,i=c_(e["!ref"]||"A1"),o=e["!merges"]||[],l=0,c=Array.isArray(e);if(e["!cols"])for(n=0;n<=i.e.c;++n)a.push("        <table:table-column"+(e["!cols"][n]?' table:style-name="co'+e["!cols"][n].ods+'"':"")+"></table:table-column>\n");var d="",h=e["!rows"]||[];for(s=0;s<i.s.r;++s)d=h[s]?' table:style-name="ro'+h[s].ods+'"':"",a.push("        <table:table-row"+d+"></table:table-row>\n");for(;s<=i.e.r;++s){for(d=h[s]?' table:style-name="ro'+h[s].ods+'"':"",a.push("        <table:table-row"+d+">\n"),n=0;n<i.s.c;++n)a.push(P);for(;n<=i.e.c;++n){var u=!1,m={},p="";for(l=0;l!=o.length;++l)if(!(o[l].s.c>n)&&!(o[l].s.r>s)&&!(o[l].e.c<n)&&!(o[l].e.r<s)){(o[l].s.c!=n||o[l].s.r!=s)&&(u=!0),m["table:number-columns-spanned"]=o[l].e.c-o[l].s.c+1,m["table:number-rows-spanned"]=o[l].e.r-o[l].s.r+1;break}if(u){a.push("          <table:covered-table-cell/>\n");continue}var f=cO({r:s,c:n}),g=c?(e[s]||[])[n]:e[f];if(g&&g.f&&(m["table:formula"]=lS(("of:="+g.f.replace(hc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),g.F&&g.F.slice(0,f.length)==f)){var x=c_(g.F);m["table:number-matrix-columns-spanned"]=x.e.c-x.s.c+1,m["table:number-matrix-rows-spanned"]=x.e.r-x.s.r+1}if(!g){a.push(P);continue}switch(g.t){case"b":p=g.v?"TRUE":"FALSE",m["office:value-type"]="boolean",m["office:boolean-value"]=g.v?"true":"false";break;case"n":p=g.w||String(g.v||0),m["office:value-type"]="float",m["office:value"]=g.v||0;break;case"s":case"str":p=null==g.v?"":g.v,m["office:value-type"]="string";break;case"d":p=g.w||lo(g.v).toISOString(),m["office:value-type"]="date",m["office:date-value"]=lo(g.v).toISOString(),m["table:style-name"]="ce1";break;default:a.push(P);continue}var b=lS(p).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(g.l&&g.l.Target){var y=g.l.Target;"#"==(y="#"==y.charAt(0)?"#"+y.slice(1).replace(/\./,"!"):y).charAt(0)||y.match(/^\w+:/)||(y="../"+y),b=lU("text:a",b,{"xlink:href":y.replace(/&/g,"&amp;")})}a.push("          "+lU("table:table-cell",lU("text:p",b,{}),m)+"\n")}a.push("        </table:table-row>\n")}return a.push("      </table:table>\n"),a.join("")},L=function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"]){for(var a=0;a<t["!cols"].length;++a)if(t["!cols"][a]){var s=t["!cols"][a];if(null==s.width&&null==s.wpx&&null==s.wch)continue;d3(s),s.ods=r;var n=t["!cols"][a].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+n+'"/>\n'),e.push("  </style:style>\n"),++r}}});var a=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"]){for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=a;var s=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+a+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+s+'"/>\n'),e.push("  </style:style>\n"),++a}}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")},function(e,t){var r=[lg],a=lB({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=lB({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+a+s+">\n"),r.push(dx().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),L(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var n=0;n!=e.SheetNames.length;++n)r.push(I(e.Sheets[e.SheetNames[n]],e,n,t));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")});function h0(e,t){if("fods"==t.bookType)return hZ(e,t);var r=lf(),a="",s=[],n=[];return lp(r,a="mimetype","application/vnd.oasis.opendocument.spreadsheet"),lp(r,a="content.xml",hZ(e,t)),s.push([a,"text/xml"]),n.push([a,"ContentFile"]),lp(r,a="styles.xml",hJ(e,t)),s.push([a,"text/xml"]),n.push([a,"StylesFile"]),lp(r,a="meta.xml",lg+dx()),s.push([a,"text/xml"]),n.push([a,"MetadataFile"]),lp(r,a="manifest.rdf",function(e){var t=[lg];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(dg(e[r][0],e[r][1])),t.push('  <rdf:Description rdf:about="">\n    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e[r][0]+'"/>\n  </rdf:Description>\n');return t.push(dg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(n)),s.push([a,"application/rdf+xml"]),lp(r,a="META-INF/manifest.xml",function(e){var t=[lg];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(s)),r}function h1(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function h2(e){var t=new Uint8Array(e.reduce(function(e,t){return e+t.length},0)),r=0;return e.forEach(function(e){t.set(e,r),r+=e.length}),t}function h5(e,t){var r=t?t[0]:0,a=127&e[r];t:if(e[r++]>=128&&(a|=(127&e[r])<<7,e[r++]<128||(a|=(127&e[r])<<14,e[r++]<128)||(a|=(127&e[r])<<21,e[r++]<128)||(a+=(127&e[r])*0x10000000,++r,e[r++]<128)||(a+=(127&e[r])*0x800000000,++r,e[r++]<128)||(a+=(127&e[r])*0x40000000000,++r,e[r++]<128)))break t;return t&&(t[0]=r),a}function h4(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;r:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=0xfffffff)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=0x7ffffffff)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=0x3ffffffffff))break r;t[r-1]|=128,t[r]=e/0x1000000>>>21&127,++r}return t.slice(0,r)}function h3(e){var t=0,r=127&e[0];t:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128||(r|=(127&e[t])<<14,e[t++]<128)||(r|=(127&e[t])<<21,e[t++]<128))break t;r|=(127&e[t])<<28}return r}function h6(e){for(var t=[],r=[0];r[0]<e.length;){var a,s=r[0],n=h5(e,r),i=7&n,o=0;if(0==(n=Math.floor(n/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0]);break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=h5(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var c={data:a,type:i};null==t[n]?t[n]=[c]:t[n].push(c)}return t}function h8(e){var t=[];return e.forEach(function(e,r){e.forEach(function(e){e.data&&(t.push(h4(8*r+e.type)),2==e.type&&t.push(h4(e.data.length)),t.push(e.data))})}),h2(t)}function h7(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=h5(e,a),n=h6(e.slice(a[0],a[0]+s));a[0]+=s;var i={id:h3(n[1][0].data),messages:[]};n[2].forEach(function(t){var r=h6(t.data),s=h3(r[3][0].data);i.messages.push({meta:r,data:e.slice(a[0],a[0]+s)}),a[0]+=s}),(null==(t=n[3])?void 0:t[0])&&(i.merge=h3(n[3][0].data)>>>0>0),r.push(i)}return r}function h9(e){var t=[];return e.forEach(function(e){var r=[];r[1]=[{data:h4(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:h4(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(e){a.push(e.data),e.meta[3]=[{type:0,data:h4(e.data.length)}],r[2].push({data:h8(e.meta),type:2})});var s=h8(r);t.push(h4(s.length)),t.push(s),a.forEach(function(e){return t.push(e)})}),h2(t)}function ue(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(function(e,t){if(0!=e)throw Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=h5(t,r),s=[];r[0]<t.length;){var n=3&t[r[0]];if(0==n){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}var l=0,c=0;if(1==n?(c=(t[r[0]]>>2&7)+4,l=(224&t[r[0]++])<<3|t[r[0]++]):(c=(t[r[0]++]>>2)+1,2==n?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[h2(s)],0==l)throw Error("Invalid offset 0");if(l>s[0].length)throw Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}var d=h2(s);if(d.length!=a)throw Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw Error("data is not a valid framed stream!");return h2(t)}function ut(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,0xfffffff),s=new Uint8Array(4);t.push(s);var n=h4(a),i=n.length;t.push(n),a<=60?(i++,t.push(new Uint8Array([a-1<<2]))):a<=256?(i+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(i+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=0x1000000?(i+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=0x100000000&&(i+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),i+=a,s[0]=0,s[1]=255&i,s[2]=i>>8&255,s[3]=i>>16&255,r+=a}return h2(t)}function ur(e,t){var r=new Uint8Array(32),a=h1(r),s=12,n=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var a=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(127&a)<<1;for(var n=0;s>=1;++n,s/=256)e[t+n]=255&s;e[t+15]|=r>=0?0:128}(r,s,e.v),n|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,+!!e.v,!0),n|=2,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,n,!0),r.slice(0,s)}function ua(e,t){var r=new Uint8Array(32),a=h1(r),s=12,n=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),n|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,+!!e.v,!0),n|=32,s+=8;break;case"s":if(-1==t.indexOf(e.v))throw Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,n,!0),r.slice(0,s)}function us(e){return h5(h6(e)[1][0].data)}function un(e){var t;(t=[["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]],function(e){for(var r=0;r!=t.length;++r){var a=t[r];void 0===e[a[0]]&&(e[a[0]]=a[1]),"n"===a[2]&&(e[a[0]]=Number(e[a[0]]))}})(e)}function ui(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return o5(t.file,o2.write(e,{type:oo?"buffer":""}));case"string":throw Error("'string' output type invalid for '"+t.bookType+"' files");default:throw Error("Unrecognized type "+t.type)}return o2.write(e,t)}function uo(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return on(lP(a));case"binary":return lP(a);case"string":return e;case"file":return o5(t.file,a,"utf8");case"buffer":if(oo)return ol(a,"utf8");if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(a);return uo(a,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw Error("Unrecognized type "+t.type)}function ul(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return"base64"==t.type?on(r):"string"==t.type?lD(r):r;case"file":return o5(t.file,e);case"buffer":return e;default:throw Error("Unrecognized type "+t.type)}}function uc(e,t,r){var a=r||{};a.type="file",a.file=t;if(!a.bookType){var s=a.file.slice(a.file.lastIndexOf(".")).toLowerCase();s.match(/^\.[a-z]+$/)&&(a.bookType=s.slice(1)),a.bookType=({xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"})[a.bookType]||a.bookType}return function e(t,r){oe(1200),i9(1252),function(e){if(!e||!e.SheetNames||!e.Sheets)throw Error("Invalid Workbook");if(!e.SheetNames.length)throw Error("Workbook is empty");var t,r,a=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=!!e.vbaraw,t.forEach(function(e,s){h$(e);for(var n=0;n<s;++n)if(e==t[n])throw Error("Duplicate Sheet Name: "+e);if(r){var i=a&&a[s]&&a[s].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw Error("Bad Code Name: Worksheet"+i)}});for(var s=0;s<e.SheetNames.length;++s)!function(e,t,r){if(e&&e["!ref"]){var a=cP(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw Error("Bad range ("+r+"): "+e["!ref"])}}(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}(t);var a,s,n=lc(r||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var i=e(t,n);return n.type="array",ou(i)}var o=0;if(n.sheet&&(o="number"==typeof n.sheet?n.sheet:t.SheetNames.indexOf(n.sheet),!t.SheetNames[o]))throw Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return uo(function(e,t){t||(t={}),e.SSF||(e.SSF=lc(oE)),e.SSF&&(oZ(),oJ(e.SSF),t.revssf=o8(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],hF(t.cellXfs,{},{revssf:{General:0}}));var r,a,s,n,i,o,l,c,d,h,u=[];u.push((r=t,a=[],e.Props&&a.push((s=e.Props,n=[],o4(dE).map(function(e){for(var t=0;t<db.length;++t)if(db[t][1]==e)return db[t];for(t=0;t<dw.length;++t)if(dw[t][1]==e)return dw[t];throw e}).forEach(function(e){if(null!=s[e[1]]){var t=r&&r.Props&&null!=r.Props[e[1]]?r.Props[e[1]]:s[e[1]];"date"===e[2]&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof t?t=String(t):!0===t||!1===t?t=t?"1":"0":t instanceof Date&&(t=new Date(t).toISOString().replace(/\.\d*Z/,"")),n.push(lF(dE[e[1]]||e[1],t))}}),lU("DocumentProperties",n.join(""),{xmlns:lG}))),e.Custprops&&a.push((i=e.Props,o=e.Custprops,l=["Worksheets","SheetNames"],c="CustomDocumentProperties",d=[],i&&o4(i).forEach(function(e){if(Object.prototype.hasOwnProperty.call(i,e)){for(var t=0;t<db.length;++t)if(e==db[t][1])return;for(t=0;t<dw.length;++t)if(e==dw[t][1])return;for(t=0;t<l.length;++t)if(e==l[t])return;var r=i[e],a="string";"number"==typeof r?(a="float",r=String(r)):!0===r||!1===r?(a="boolean",r=r?"1":"0"):r=String(r),d.push(lU(lT(e),r,{"dt:dt":a}))}}),o&&o4(o).forEach(function(e){if(Object.prototype.hasOwnProperty.call(o,e)&&!(i&&Object.prototype.hasOwnProperty.call(i,e))){var t=o[e],r="string";"number"==typeof t?(r="float",t=String(t)):!0===t||!1===t?(r="boolean",t=t?"1":"0"):t instanceof Date?(r="dateTime.tz",t=t.toISOString()):t=String(t),d.push(lU(lT(e),t,{"dt:dt":r}))}}),"<"+c+' xmlns="'+lG+'">'+d.join("")+"</"+c+">")),a.join(""))),u.push(""),u.push(""),u.push("");for(var m=0;m<e.SheetNames.length;++m)u.push(lU("Worksheet",function(e,t,r){var a=[],s=r.SheetNames[e],n=r.Sheets[s],i=n?function(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,n=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||n.push(hq(o)))}return n.join("")}(n,0,e,r):"";return i.length>0&&a.push("<Names>"+i+"</Names>"),(i=n?function(e,t,r,a){if(!e["!ref"])return"";var s=cP(e["!ref"]),n=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(e,t){d3(e);var r=!!e.width,a=hL(t,e),s={"ss:Index":t+1};r&&(s["ss:Width"]=d2(a.width)),e.hidden&&(s["ss:Hidden"]="1"),o.push(lU("Column",null,s))});for(var l=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var d=[function(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=96*t.hpt/96),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}(c,(e["!rows"]||[])[c])],h=s.s.c;h<=s.e.c;++h){var u=!1;for(i=0;i!=n.length;++i)if(!(n[i].s.c>h)&&!(n[i].s.r>c)&&!(n[i].e.c<h)&&!(n[i].e.r<c)){(n[i].s.c!=h||n[i].s.r!=c)&&(u=!0);break}if(!u){var m={r:c,c:h},p=cO(m),f=l?(e[c]||[])[h]:e[p];d.push(function(e,t,r,a,s,n,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+lS(hd(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=cR(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=lS(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=lS(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],d=0;d!=c.length;++d)c[d].s.c==i.c&&c[d].s.r==i.r&&(c[d].e.c>c[d].s.c&&(o["ss:MergeAcross"]=c[d].e.c-c[d].s.c),c[d].e.r>c[d].s.r&&(o["ss:MergeDown"]=c[d].e.r-c[d].s.r));var h="",u="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":h="Number",u=String(e.v);break;case"b":h="Boolean",u=e.v?"1":"0";break;case"e":h="Error",u=c3[e.v];break;case"d":h="DateTime",u=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||oE[14]);break;case"s":h="String",u=((e.v||"")+"").replace(lk,function(e){return lN[e]}).replace(lC,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var m=hF(a.cellXfs,e,a);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=i.c+1;var p=null!=e.v?u:"",f="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(f+=e.c.map(function(e){var t=lU("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return lU("Comment",t,{"ss:Author":e.a})}).join("")),lU("Cell",f,o)}(f,p,e,t,0,0,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}(n,t,0,0):"").length>0&&a.push("<Table>"+i+"</Table>"),a.push(function(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(lU("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(lU("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(lU("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(lU("Visible",1==a.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&(!a.Workbook.Sheets[n]||a.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return(((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(lF("ProtectContents","True")),e["!protect"].objects&&s.push(lF("ProtectObjects","True")),e["!protect"].scenarios&&s.push(lF("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||s.push(lF("EnableSelection","UnlockedCells")):s.push(lF("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&s.push("<"+t[1]+"/>")})),0==s.length)?"":lU("WorksheetOptions",s.join(""),{xmlns:lq})}(n,0,e,r)),a.join("")}(m,t,e),{"ss:Name":lS(e.SheetNames[m])}));return u[2]=(h=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],t.cellXfs.forEach(function(e,t){var r=[];r.push(lU("NumberFormat",null,{"ss:Format":lS(oE[e.numFmtId])})),h.push(lU("Style",r.join(""),{"ss:ID":"s"+(21+t)}))}),lU("Styles",h.join(""))),u[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];null==s.Sheet&&(s.Name.match(/^_xlfn\./)||r.push(hq(s)))}return lU("Names",r.join(""))}(e,t),lg+lU("Workbook",u.join(""),{xmlns:lY,"xmlns:o":lG,"xmlns:x":lq,"xmlns:ss":lY,"xmlns:dt":"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882","xmlns:html":"http://www.w3.org/TR/REC-html40"})}(t,n),n);case"slk":case"sylk":return uo(dz.from_sheet(t.Sheets[t.SheetNames[o]],n),n);case"htm":case"html":return uo(function(e,t){var r=t||{},a=null!=r.header?r.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',s=null!=r.footer?r.footer:"</body></html>",n=[a],i=c_(e["!ref"]);r.dense=Array.isArray(e),n.push("<table"+(r&&r.id?' id="'+r.id+'"':"")+">");for(var o=i.s.r;o<=i.e.r;++o)n.push(function(e,t,r,a){for(var s=e["!merges"]||[],n=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r)&&!(s[c].s.c>i)&&!(s[c].e.r<r)&&!(s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var d=cO({r:r,c:i}),h=a.dense?(e[r]||[])[i]:e[d],u=h&&null!=h.v&&(h.h||((h.w||(cL(h),h.w)||"")+"").replace(lk,function(e){return lN[e]}).replace(/\n/g,"<br/>").replace(lC,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),a.editable?u='<span contenteditable="true">'+u+"</span>":h&&(m["data-t"]=h&&h.t||"z",null!=h.v&&(m["data-v"]=h.v),null!=h.z&&(m["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),m.id=(a.id||"sjs")+"-"+d,n.push(lU("td",u,m))}}return"<tr>"+n.join("")+"</tr>"}(e,i,o,r));return n.push("</table>"+s),n.join("")}(t.Sheets[t.SheetNames[o]],n),n);case"txt":var l=function(e,t){t||(t={}),t.FS="	",t.RS="\n";var r=uu(e,t);if(void 0===M||"string"==t.type)return r;var a=M.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}(t.Sheets[t.SheetNames[o]],n);switch(n.type){case"base64":return on(l);case"binary":case"string":return l;case"file":return o5(n.file,l,"binary");case"buffer":if(oo)return ol(l,"binary");return l.split("").map(function(e){return e.charCodeAt(0)})}throw Error("Unrecognized type "+n.type);case"csv":return uo(uu(t.Sheets[t.SheetNames[o]],n),n,"\uFEFF");case"dif":return uo(dH.from_sheet(t.Sheets[t.SheetNames[o]],n),n);case"dbf":return ul(dV.from_sheet(t.Sheets[t.SheetNames[o]],n),n);case"prn":return uo(d$.from_sheet(t.Sheets[t.SheetNames[o]],n),n);case"rtf":return uo(dZ.from_sheet(t.Sheets[t.SheetNames[o]],n),n);case"eth":return uo(dW.from_sheet(t.Sheets[t.SheetNames[o]],n),n);case"fods":return uo(h0(t,n),n);case"wk1":return ul(dG.sheet_to_wk1(t.Sheets[t.SheetNames[o]],n),n);case"wk3":return ul(dG.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),ul(hQ(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),ui(function(e,t){var r,a=t||{},s=o2.utils.cfb_new({root:"R"}),n="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":n="/Workbook",a.biff=8;break;case"biff5":n="/Book",a.biff=5;break;default:throw Error("invalid type "+a.bookType+" for XLS CFB")}return o2.utils.cfb_add(s,n,hQ(e,a)),8==a.biff&&(e.Props||e.Custprops)&&function(e,t){var r,a=[],s=[],n=[],i=0,o=o3(c2,"n"),l=o3(c5,"n");if(e.Props)for(i=0,r=o4(e.Props);i<r.length;++i)(Object.prototype.hasOwnProperty.call(o,r[i])?a:Object.prototype.hasOwnProperty.call(l,r[i])?s:n).push([r[i],e.Props[r[i]]]);if(e.Custprops)for(i=0,r=o4(e.Custprops);i<r.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},r[i])||(Object.prototype.hasOwnProperty.call(o,r[i])?a:Object.prototype.hasOwnProperty.call(l,r[i])?s:n).push([r[i],e.Custprops[r[i]]]);var c=[];for(i=0;i<n.length;++i)dT.indexOf(n[i][0])>-1||dN.indexOf(n[i][0])>-1||null!=n[i][1]&&c.push(n[i]);s.length&&o2.utils.cfb_add(t,"/\x05SummaryInformation",dA(s,"e0859ff2f94f6810ab9108002b27b3d9",l,c5)),(a.length||c.length)&&o2.utils.cfb_add(t,"/\x05DocumentSummaryInformation",dA(a,"02d5cdd59c2e1b10939708002b2cf9ae",o,c2,c.length?c:null,"05d5cdd59c2e1b10939708002b2cf9ae"))}(e,s),8==a.biff&&e.vbaraw&&(r=o2.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})).FullPaths.forEach(function(e,t){if(0!=t){var a=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&o2.utils.cfb_add(s,a,r.FileIndex[t].content)}}),s}(t,a=n||{}),a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r={},a=oo?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw Error("Unrecognized type "+t.type)}var s=e.FullPaths?o2.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!=typeof Deno&&"string"==typeof s){if("binary"==t.type||"base64"==t.type)return s;s=new Uint8Array(ou(s))}return t.password&&"undefined"!=typeof encrypt_agile?ui(encrypt_agile(s,t.password),t):"file"===t.type?o5(t.file,s):"string"==t.type?lD(s):s}("ods"==(s=lc(n||{})).bookType?h0(t,s):"numbers"==s.bookType?function(e,t){if(!t||!t.numbers)throw Error("Must pass a `numbers` option -- check the README");var r,a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=c_(a["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(cD(s)));var i=ud(a,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&o.push(e)})});var l={},c=[],d=o2.read(t.numbers,{type:"base64"});d.FileIndex.map(function(e,t){return[e,d.FullPaths[t]]}).forEach(function(e){var t=e[0],r=e[1];2!=t.type||t.name.match(/\.iwa/)&&h7(ue(t.content)).forEach(function(e){c.push(e.id),l[e.id]={deps:[],location:r,type:h3(e.messages[0].meta[1][0].data)}})}),c.sort(function(e,t){return e-t});var h=c.filter(function(e){return e>1}).map(function(e){return[e,h4(e)]});d.FileIndex.map(function(e,t){return[e,d.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&h7(ue(t.content)).forEach(function(e){e.messages.forEach(function(t){h.forEach(function(t){e.messages.some(function(e){return 11006!=h3(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}(e.data,t[1])})&&l[t[0]].deps.push(e.id)})})})});for(var u=o2.find(d,l[1].location),m=h7(ue(u.content)),p=0;p<m.length;++p){var f=m[p];1==f.id&&(r=f)}var g=us(h6(r.messages[0].data)[1][0].data);for(p=0,m=h7(ue((u=o2.find(d,l[g].location)).content));p<m.length;++p)(f=m[p]).id==g&&(r=f);for(p=0,g=us(h6(r.messages[0].data)[2][0].data),m=h7(ue((u=o2.find(d,l[g].location)).content));p<m.length;++p)(f=m[p]).id==g&&(r=f);for(p=0,g=us(h6(r.messages[0].data)[2][0].data),m=h7(ue((u=o2.find(d,l[g].location)).content));p<m.length;++p)(f=m[p]).id==g&&(r=f);var x=h6(r.messages[0].data);x[6][0].data=h4(s.e.r+1),x[7][0].data=h4(s.e.c+1);for(var b=us(x[46][0].data),y=o2.find(d,l[b].location),v=h7(ue(y.content)),w=0;w<v.length&&v[w].id!=b;++w);if(v[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var N=h6(v[w].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var j=0;j<=s.e.c;++j){var k=[];k[1]=k[2]=[{type:0,data:h4(j+420690)}],N[1].push({type:2,data:h8(k)}),N[2].push({type:0,data:h4(j)}),N[3].push({type:0,data:h4(j)})}N[4]=[],N[5]=[],N[6]=[];for(var E=0;E<=s.e.r;++E)(k=[])[1]=k[2]=[{type:0,data:h4(E+726270)}],N[4].push({type:2,data:h8(k)}),N[5].push({type:0,data:h4(E)}),N[6].push({type:0,data:h4(E)});v[w].messages[0].data=h8(N),y.content=ut(h9(v)),y.size=y.content.length,delete x[46];var S=h6(x[4][0].data);S[7][0].data=h4(s.e.r+1);var T=us(h6(S[1][0].data)[2][0].data);if((v=h7(ue((y=o2.find(d,l[T].location)).content)))[0].id!=T)throw"Bad HeaderStorageBucket";var C=h6(v[0].messages[0].data);for(E=0;E<i.length;++E){var A=h6(C[2][0].data);A[1][0].data=h4(E),A[4][0].data=h4(i[E].length),C[2][E]={type:C[2][0].type,data:h8(A)}}v[0].messages[0].data=h8(C),y.content=ut(h9(v)),y.size=y.content.length;var R=us(S[2][0].data);if((v=h7(ue((y=o2.find(d,l[R].location)).content)))[0].id!=R)throw"Bad HeaderStorageBucket";for(j=0,C=h6(v[0].messages[0].data);j<=s.e.c;++j)(A=h6(C[2][0].data))[1][0].data=h4(j),A[4][0].data=h4(s.e.r+1),C[2][j]={type:C[2][0].type,data:h8(A)};v[0].messages[0].data=h8(C),y.content=ut(h9(v)),y.size=y.content.length;var O=us(S[4][0].data);!function(){for(var e,t=o2.find(d,l[O].location),r=h7(ue(t.content)),a=0;a<r.length;++a){var s=r[a];s.id==O&&(e=s)}var n=h6(e.messages[0].data);n[3]=[];var i=[];o.forEach(function(e,t){i[1]=[{type:0,data:h4(t)}],i[2]=[{type:0,data:h4(1)}],i[3]=[{type:2,data:"undefined"!=typeof TextEncoder?new TextEncoder().encode(e):oh(lP(e))}],n[3].push({type:2,data:h8(i)})}),e.messages[0].data=h8(n),t.content=ut(h9(r)),t.size=t.content.length}();var _=h6(S[3][0].data),D=_[1][0];delete _[2];var P=h6(D.data),I=us(P[2][0].data);!function(){for(var e,t=o2.find(d,l[I].location),r=h7(ue(t.content)),a=0;a<r.length;++a){var n=r[a];n.id==I&&(e=n)}var c=h6(e.messages[0].data);delete c[6],delete _[7];var h=new Uint8Array(c[5][0].data);c[5]=[];for(var u=0,m=0;m<=s.e.r;++m){var p=h6(h);u+=function(e,t,r){if(!(null==(a=e[6])?void 0:a[0])||!(null==(s=e[7])?void 0:s[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(n=e[8])?void 0:n[0])?void 0:i.data)&&h3(e[8][0].data)>0)throw"Math only works with normal offsets";for(var a,s,n,i,o,l,c=0,d=h1(e[7][0].data),h=0,u=[],m=h1(e[4][0].data),p=0,f=[],g=0;g<t.length;++g){if(null==t[g]){d.setUint16(2*g,65535,!0),m.setUint16(2*g,65535);continue}switch(d.setUint16(2*g,h,!0),m.setUint16(2*g,p,!0),typeof t[g]){case"string":o=ur({t:"s",v:t[g]},r),l=ua({t:"s",v:t[g]},r);break;case"number":o=ur({t:"n",v:t[g]},r),l=ua({t:"n",v:t[g]},r);break;case"boolean":o=ur({t:"b",v:t[g]},r),l=ua({t:"b",v:t[g]},r);break;default:throw Error("Unsupported value "+t[g])}u.push(o),h+=o.length,f.push(l),p+=l.length,++c}for(e[2][0].data=h4(c);g<e[7][0].data.length/2;++g)d.setUint16(2*g,65535,!0),m.setUint16(2*g,65535,!0);return e[6][0].data=h2(u),e[3][0].data=h2(f),c}(p,i[m],o),p[1][0].data=h4(m),c[5].push({data:h8(p),type:2})}c[1]=[{type:0,data:h4(s.e.c+1)}],c[2]=[{type:0,data:h4(s.e.r+1)}],c[3]=[{type:0,data:h4(u)}],c[4]=[{type:0,data:h4(s.e.r+1)}],e.messages[0].data=h8(c),t.content=ut(h9(r)),t.size=t.content.length}(),D.data=h8(P),S[3][0].data=h8(_),x[4][0].data=h8(S),r.messages[0].data=h8(x);var L=ut(h9(m));return u.content=L,u.size=u.content.length,d}(t,s):"xlsb"==s.bookType?function(e,t){hs=1024,e&&!e.SSF&&(e.SSF=lc(oE)),e&&e.SSF&&(oZ(),oJ(e.SSF),t.revssf=o8(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hP?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r,a,s,n,i,o,l,c="xlsb"==t.bookType?"bin":"xml",d=ho.indexOf(t.bookType)>-1,h=c7();un(t=t||{});var u=lf(),m="",p=0;if(t.cellXfs=[],hF(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),lp(u,m="docProps/core.xml",dv(e.Props,t)),h.coreprops.push(m),df(t.rels,2,m,ds),m="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var f=[],g=0;g<e.SheetNames.length;++g)2!=(e.Workbook.Sheets[g]||{}).Hidden&&f.push(e.SheetNames[g]);e.Props.SheetNames=f}else e.Props.SheetNames=e.SheetNames;for(e.Props.Worksheets=e.Props.SheetNames.length,lp(u,m,dj(e.Props,t)),h.extprops.push(m),df(t.rels,3,m,dn),e.Custprops!==e.Props&&o4(e.Custprops||{}).length>0&&(lp(u,m="docProps/custom.xml",dk(e.Custprops,t)),h.custprops.push(m),df(t.rels,4,m,di)),p=1;p<=e.SheetNames.length;++p){var x={"!id":{}},b=e.Sheets[e.SheetNames[p-1]];if((b||{})["!type"],lp(u,m="xl/worksheets/sheet"+p+"."+c,(y=p-1,v=m,w=t,(".bin"===v.slice(-4)?function(e,t,r,a){var s,n,i,o,l,c,d,h,u,m=cv(),p=r.SheetNames[e],f=r.Sheets[p]||{},g=p;try{r&&r.Workbook&&(g=r.Workbook.Sheets[e].CodeName||g)}catch(e){}var x=cP(f["!ref"]||"A1");if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575)}f["!links"]=[],f["!comments"]=[],cw(m,129),(r.vbaraw||f["!outline"])&&cw(m,147,function(e,t,r){null==r&&(r=cy(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return c1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),cV(e,r),r.slice(0,r.l)}(g,f["!outline"])),cw(m,148,cJ(x)),s=r.Workbook,cw(m,133),cw(m,137,(null==n&&(n=cy(30)),i=924,(((s||{}).Views||[])[0]||{}).RTL&&(i|=32),n.write_shift(2,i),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n)),cw(m,138),cw(m,134),f&&f["!cols"]&&(cw(m,390),f["!cols"].forEach(function(e,t){var r,a,s;e&&cw(m,60,(null==r&&(r=cy(18)),a=hL(t,e),r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,256*(a.width||10)),r.write_shift(4,0),s=0,e.hidden&&(s|=1),"number"==typeof a.width&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r))}),cw(m,391)),function(e,t,r,a){var s,n=cP(t["!ref"]||"A1"),i="",o=[];cw(e,145);var l=Array.isArray(t),c=n.e.r;t["!rows"]&&(c=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=c;++d){i=cT(d),function(e,t,r,a){var s=function(e,t,r){var a=cy(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var n=320;s.hpx?n=20*d6(s.hpx):s.hpt&&(n=20*s.hpt),a.write_shift(2,n),a.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),a.write_shift(1,i),a.write_shift(1,0);var o=0,l=a.l;a.l+=4;for(var c={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10)&&!(t.e.c<d<<10)){for(var h=-1,u=-1,m=d<<10;m<d+1<<10;++m)c.c=m,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[cO(c)])&&(h<0&&(h=m),u=m);h<0||(++o,a.write_shift(4,h),a.write_shift(4,u))}var p=a.l;return a.l=l,a.write_shift(4,o),a.l=p,a.length>a.l?a.slice(0,a.l):a}(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&cw(e,0,s)}(e,t,n,d);var h=!1;if(d<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){d===n.s.r&&(o[u]=cA(u)),s=o[u]+i;var m=l?(t[d]||[])[u]:t[s];if(!m){h=!1;continue}h=function(e,t,r,a,s,n,i){if(void 0===t.v)return!1;var o,l,c,d,h,u,m,p,f,g,x,b,y,v,w,N,j,k,E,S,T,C,A,R,O="";switch(t.t){case"b":O=t.v?"1":"0";break;case"d":(t=lc(t)).z=t.z||oE[14],t.v=o9(lo(t.v)),t.t="n";break;case"n":case"e":O=""+t.v;break;default:O=t.v}var _={r:r,c:a};switch(_.s=hF(s.cellXfs,t,s),t.l&&n["!links"].push([cO(_),t.l]),t.c&&n["!comments"].push([cO(_),t.c]),t.t){case"s":case"str":return s.bookSST?(O=hI(s.Strings,t.v,s.revStrings),_.t="s",_.v=O,i)?cw(e,18,(null==o&&(o=cy(8)),cG(_,o),o.write_shift(4,_.v),o)):cw(e,7,(null==l&&(l=cy(12)),cW(_,l),l.write_shift(4,_.v),l)):(_.t="str",i)?cw(e,17,(c=t,null==d&&(d=cy(8+4*c.v.length)),cG(_,d),cV(c.v,d),d.length>d.l?d.slice(0,d.l):d)):cw(e,6,(h=t,null==u&&(u=cy(12+4*h.v.length)),cW(_,u),cV(h.v,u),u.length>u.l?u.slice(0,u.l):u)),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?cw(e,13,(m=t,null==p&&(p=cy(8)),cG(_,p),cK(m.v,p),p)):cw(e,2,(f=t,null==g&&(g=cy(12)),cW(_,g),cK(f.v,g),g)):i?cw(e,16,(x=t,null==b&&(b=cy(12)),cG(_,b),c0(x.v,b),b)):cw(e,5,(y=t,null==v&&(v=cy(16)),cW(_,v),c0(y.v,v),v)),!0;case"b":return(_.t="b",i)?cw(e,15,(w=t,null==N&&(N=cy(5)),cG(_,N),N.write_shift(1,+!!w.v),N)):cw(e,4,(j=t,null==k&&(k=cy(9)),cW(_,k),k.write_shift(1,+!!j.v),k)),!0;case"e":return(_.t="e",i)?cw(e,14,(E=t,null==S&&(S=cy(8)),cG(_,S),S.write_shift(1,E.v),S.write_shift(2,0),S.write_shift(1,0),S)):cw(e,3,(T=t,null==C&&(C=cy(9)),cW(_,C),C.write_shift(1,T.v),C)),!0}return i?cw(e,12,(null==A&&(A=cy(4)),cG(_,A))):cw(e,1,(null==R&&(R=cy(8)),cW(_,R))),!0}(e,m,d,u,a,t,h)}}cw(e,146)}(m,f,0,t,r);f["!protect"]&&cw(m,535,(o=f["!protect"],null==l&&(l=cy(66)),l.write_shift(2,o.password?dQ(o.password):0),l.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?l.write_shift(4,+(null!=o[e[0]]&&!o[e[0]])):l.write_shift(4,null!=o[e[0]]&&o[e[0]]?0:1)}),l)),!function(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],n="string"==typeof s.ref?s.ref:cD(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=c_(n);o.s.r==o.e.r&&(o.e.r=c_(t["!ref"]).e.r,n=cD(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+n;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),cw(e,161,cJ(cP(n))),cw(e,162)}}(m,f,r,e);f&&f["!merges"]&&(cw(m,177,(c=f["!merges"].length,null==d&&(d=cy(4)),d.write_shift(4,c),d)),f["!merges"].forEach(function(e){cw(m,176,cJ(e))}),cw(m,178)),f["!links"].forEach(function(e){if(e[1].Target){var t,r,s=df(a,-1,e[1].Target.replace(/#.*$/,""),dt);cw(m,494,(t=cy(50+4*(e[1].Target.length+(e[1].Tooltip||"").length)),cJ({s:cR(e[0]),e:cR(e[0])},t),cY("rId"+s,t),cV((-1==(r=e[1].Target.indexOf("#"))?"":e[1].Target.slice(r+1))||"",t),cV(e[1].Tooltip||"",t),cV("",t),t.slice(0,t.l)))}}),delete f["!links"],f["!margins"]&&cw(m,476,(h=f["!margins"],null==u&&(u=cy(48)),hM(h),hz.forEach(function(e){c0(h[e],u)}),u)),(!t||t.ignoreEC||void 0==t.ignoreEC)&&function(e,t){if(t&&t["!ref"]){var r,a;cw(e,648),cw(e,649,(r=cP(t["!ref"]),(a=cy(24)).write_shift(4,4),a.write_shift(4,1),cJ(r,a),a)),cw(e,650)}}(m,f);if(f["!comments"].length>0){var b=df(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",dr);cw(m,551,cY("rId"+b)),f["!legacy"]=b}return cw(m,130),m.end()}:hV)(y,w,e,x))),h.sheets.push(m),df(t.wbrels,-1,"worksheets/sheet"+p+"."+c,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),b){var y,v,w,N,j,k=b["!comments"],E=!1,S="";k&&k.length>0&&(lp(u,S="xl/comments"+p+"."+c,(N=S,j=t,(".bin"===N.slice(-4)?function(e){var t=cv(),r=[];return cw(t,628),cw(t,630),e.forEach(function(e){e[1].forEach(function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),cw(t,632,cV(e.a.slice(0,54))))})}),cw(t,631),cw(t,633),e.forEach(function(e){e[1].forEach(function(a){var s,n,i,o,l,c;a.iauthor=r.indexOf(a.a),cw(t,635,(s=[{s:cR(e[0]),e:cR(e[0])},a],null==n&&(n=cy(36)),n.write_shift(4,s[1].iauthor),cJ(s[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n)),a.t&&a.t.length>0&&cw(t,637,(o=!1,null==i&&(o=!0,i=cy(23+4*a.t.length)),i.write_shift(1,1),cV(a.t,i),i.write_shift(4,1),l={ich:0,ifnt:0},(c=i)||(c=cy(4)),c.write_shift(2,l.ich||0),c.write_shift(2,l.ifnt||0),o?i.slice(0,i.l):i)),cw(t,636),delete a.iauthor})}),cw(t,634),cw(t,629),t.end()}:hi)(k,j))),h.comments.push(S),df(x,-1,"../comments"+p+"."+c,da),E=!0),b["!legacy"]&&E&&lp(u,"xl/drawings/vmlDrawing"+p+".vml",hn(p,b["!comments"])),delete b["!comments"],delete b["!legacy"]}x["!id"].rId1&&lp(u,dm(m),dp(x))}return null!=t.Strings&&t.Strings.length>0&&(lp(u,m="xl/sharedStrings."+c,(r=t.Strings,a=m,s=t,(".bin"===a.slice(-4)?function(e){var t,r=cv();cw(r,159,(t||(t=cy(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t));for(var a=0;a<e.length;++a)cw(r,19,dX(e[a]));return cw(r,160),r.end()}:dY)(r,s))),h.strs.push(m),df(t.wbrels,-1,"sharedStrings."+c,dl)),lp(u,m="xl/workbook."+c,(n=m,i=t,(".bin"===n.slice(-4)?function(e,t){var r=cv();cw(r,131),cw(r,128,function(e,t){t||(t=cy(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return cV("SheetJS",t),cV(i4.version,t),cV(i4.version,t),cV("7262",t),t.length>t.l?t.slice(0,t.l):t}()),cw(r,153,(s=e.Workbook&&e.Workbook.WBProps||null,n||(n=cy(72)),i=0,s&&s.filterPrivacy&&(i|=8),n.write_shift(4,i),n.write_shift(4,0),cV(s&&s.CodeName||"ThisWorkbook",n),n.slice(0,n.l))),function(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r,a,s=t.Workbook.Sheets,n=0,i=-1,o=-1;n<s.length;++n)s[n]&&(s[n].Hidden||-1!=i)?1==s[n].Hidden&&-1==o&&(o=n):i=n;o>i||(cw(e,135),cw(e,158,(r=i,a||(a=cy(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,r),a.write_shift(4,r),a.write_shift(1,120),a.length>a.l?a.slice(0,a.l):a)),cw(e,136))}}(r,e,t);cw(r,143);for(var a=0;a!=e.SheetNames.length;++a){var s,n,i,o={Hidden:e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[a]&&e.Workbook.Sheets[a].Hidden||0,iTabID:a+1,strRelID:"rId"+(a+1),name:e.SheetNames[a]},l=void 0;cw(r,156,(l||(l=cy(127)),l.write_shift(4,o.Hidden),l.write_shift(4,o.iTabID),cY(o.strRelID,l),cV(o.name.slice(0,31),l),l.length>l.l?l.slice(0,l.l):l))}return cw(r,144),cw(r,132),r.end()}:hG)(e,i))),h.workbooks.push(m),df(t.rels,1,m,de),lp(u,m="xl/theme/theme1.xml",hr(e.Themes,t)),h.themes.push(m),df(t.wbrels,-1,"theme/theme1.xml",dd),lp(u,m="xl/styles."+c,(o=m,l=t,(".bin"===o.slice(-4)?function(e,t){var r,a,s,n,i,o,l,c,d,h,u,m=cv();return cw(m,278),!function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var a=e[0];a<=e[1];++a)null!=t[a]&&++r}),0!=r&&(cw(e,615,cB(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&cw(e,44,function(e,t,r){r||(r=cy(6+4*t.length)),r.write_shift(2,e),cV(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),a}(a,t[a]))}),cw(e,616))}}(m,e.SSF),cw(m,611,cB(1)),cw(m,43,(r={sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"},a||(a=cy(153)),a.write_shift(2,20*r.sz),(s=a)||(s=cy(2)),n=2*!!r.italic|8*!!r.strike|16*!!r.outline|32*!!r.shadow|64*!!r.condense|128*!!r.extend,s.write_shift(1,n),s.write_shift(1,0),a.write_shift(2,r.bold?700:400),i=0,"superscript"==r.vertAlign?i=1:"subscript"==r.vertAlign&&(i=2),a.write_shift(2,i),a.write_shift(1,r.underline||0),a.write_shift(1,r.family||0),a.write_shift(1,r.charset||0),a.write_shift(1,0),c1(r.color,a),o=0,"major"==r.scheme&&(o=1),"minor"==r.scheme&&(o=2),a.write_shift(1,o),cV(r.name,a),a.length>a.l?a.slice(0,a.l):a)),cw(m,612),cw(m,603,cB(2)),cw(m,45,d9({patternType:"none"})),cw(m,45,d9({patternType:"gray125"})),cw(m,604),cw(m,613,cB(1)),cw(m,46,(l||(l=cy(51)),l.write_shift(1,0),ht(null,l),ht(null,l),ht(null,l),ht(null,l),ht(null,l),l.length>l.l?l.slice(0,l.l):l)),cw(m,614),cw(m,626,cB(1)),cw(m,47,he({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),cw(m,627),cw(m,617,cB((c=t.cellXfs).length)),c.forEach(function(e){cw(m,47,he(e,0))}),cw(m,618),cw(m,619,cB(1)),cw(m,48,(d={xfId:0,builtinId:0,name:"Normal"},h||(h=cy(52)),h.write_shift(4,d.xfId),h.write_shift(2,1),h.write_shift(1,+d.builtinId),h.write_shift(1,0),cY(d.name||"",h),h.length>h.l?h.slice(0,h.l):h)),cw(m,620),cw(m,505,cB(0)),cw(m,506),cw(m,508,((u=cy(2052)).write_shift(4,0),cY("TableStyleMedium9",u),cY("PivotStyleMedium4",u),u.length>u.l?u.slice(0,u.l):u)),cw(m,509),cw(m,279),m.end()}:d8)(e,l))),h.styles.push(m),df(t.wbrels,-1,"styles."+c,dc),e.vbaraw&&d&&(lp(u,m="xl/vbaProject.bin",e.vbaraw),h.vba.push(m),df(t.wbrels,-1,"vbaProject.bin",du)),lp(u,m="xl/metadata."+c,(".bin"===m.slice(-4)?function(){var e,t,r,a,s=cv();return cw(s,332),cw(s,334,cB(1)),cw(s,335,((t=cy(12+2*(e={name:"XLDAPR",version:12e4,flags:0xd06ac0b0}).name.length)).write_shift(4,e.flags),t.write_shift(4,e.version),cV(e.name,t),t.slice(0,t.l))),cw(s,336),cw(s,339,((r=cy(20)).write_shift(4,1),cV("XLDAPR",r),r.slice(0,r.l))),cw(s,52),cw(s,35,cB(514)),cw(s,4096,cB(0)),cw(s,4097,d_(1)),cw(s,36),cw(s,53),cw(s,340),cw(s,337,((a=cy(8)).write_shift(4,1),a.write_shift(4,1),a)),cw(s,51,function(e){var t=cy(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),cw(s,338),cw(s,333),s.end()}:ha)()),h.metadata.push(m),df(t.wbrels,-1,"metadata."+c,dh),lp(u,"[Content_Types].xml",c9(h,t)),lp(u,"_rels/.rels",dp(t.rels)),lp(u,"xl/_rels/workbook."+c+".rels",dp(t.wbrels)),delete t.revssf,delete t.ssf,u}(t,s):function(e,t){hs=1024,e&&!e.SSF&&(e.SSF=lc(oE)),e&&e.SSF&&(oZ(),oJ(e.SSF),t.revssf=o8(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hP?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r,a=ho.indexOf(t.bookType)>-1,s=c7();un(t=t||{});var n=lf(),i="",o=0;if(t.cellXfs=[],hF(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),lp(n,i="docProps/core.xml",dv(e.Props,t)),s.coreprops.push(i),df(t.rels,2,i,ds),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,lp(n,i,dj(e.Props,t)),s.extprops.push(i),df(t.rels,3,i,dn),e.Custprops!==e.Props&&o4(e.Custprops||{}).length>0&&(lp(n,i="docProps/custom.xml",dk(e.Custprops,t)),s.custprops.push(i),df(t.rels,4,i,di));var d=["SheetJ5"];for(o=1,t.tcid=0;o<=e.SheetNames.length;++o){var h={"!id":{}},u=e.Sheets[e.SheetNames[o-1]];if((u||{})["!type"],lp(n,i="xl/worksheets/sheet"+o+".xml",hV(o-1,t,e,h)),s.sheets.push(i),df(t.wbrels,-1,"worksheets/sheet"+o+".xml","http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet"),u){var m=u["!comments"],p=!1,f="";if(m&&m.length>0){var g=!1;m.forEach(function(e){e[1].forEach(function(e){!0==e.T&&(g=!0)})}),g&&(lp(n,f="xl/threadedComments/threadedComment"+o+".xml",function(e,t,r){var a=[lg,lU("ThreadedComments",null,{xmlns:lz}).replace(/[\/]>/,">")];return e.forEach(function(e){var s="";(e[1]||[]).forEach(function(n,i){if(!n.T)return void delete n.ID;n.a&&-1==t.indexOf(n.a)&&t.push(n.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==i?s=o.id:o.parentId=s,n.ID=o.id,n.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(n.a)).slice(-12)+"}"),a.push(lU("threadedComment",lF("text",n.t||""),o))})}),a.push("</ThreadedComments>"),a.join("")}(m,d,t)),s.threadedcomments.push(f),df(h,-1,"../threadedComments/threadedComment"+o+".xml","http://schemas.microsoft.com/office/2017/10/relationships/threadedComment")),lp(n,f="xl/comments"+o+".xml",hi(m,t)),s.comments.push(f),df(h,-1,"../comments"+o+".xml",da),p=!0}u["!legacy"]&&p&&lp(n,"xl/drawings/vmlDrawing"+o+".vml",hn(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}h["!id"].rId1&&lp(n,dm(i),dp(h))}return null!=t.Strings&&t.Strings.length>0&&(lp(n,i="xl/sharedStrings.xml",dY(t.Strings,t)),s.strs.push(i),df(t.wbrels,-1,"sharedStrings.xml",dl)),lp(n,i="xl/workbook.xml",hG(e,t)),s.workbooks.push(i),df(t.rels,1,i,de),lp(n,i="xl/theme/theme1.xml",hr(e.Themes,t)),s.themes.push(i),df(t.wbrels,-1,"theme/theme1.xml",dd),lp(n,i="xl/styles.xml",d8(e,t)),s.styles.push(i),df(t.wbrels,-1,"styles.xml",dc),e.vbaraw&&a&&(lp(n,i="xl/vbaProject.bin",e.vbaraw),s.vba.push(i),df(t.wbrels,-1,"vbaProject.bin",du)),lp(n,i="xl/metadata.xml",ha()),s.metadata.push(i),df(t.wbrels,-1,"metadata.xml",dh),d.length>1&&(lp(n,i="xl/persons/person.xml",(r=[lg,lU("personList",null,{xmlns:lz,"xmlns:x":"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}).replace(/[\/]>/,">")],d.forEach(function(e,t){r.push(lU("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+t).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join(""))),s.people.push(i),df(t.wbrels,-1,"persons/person.xml","http://schemas.microsoft.com/office/2017/10/relationships/person")),lp(n,"[Content_Types].xml",c9(s,t)),lp(n,"_rels/.rels",dp(t.rels)),lp(n,"xl/_rels/workbook.xml.rels",dp(t.wbrels)),delete t.revssf,delete t.ssf,n}(t,s),s);default:throw Error("Unrecognized bookType |"+n.bookType+"|")}}(e,a)}function ud(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},a=0,s=1,n=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?a=1:"A"===c.header?a=2:Array.isArray(c.header)?a=3:null==c.header&&(a=0),typeof d){case"string":l=cP(d);break;case"number":(l=cP(e["!ref"])).s.r=d;break;default:l=d}a>0&&(s=0);var h=cT(l.s.r),u=[],m=[],p=0,f=0,g=Array.isArray(e),x=l.s.r,b=0,y={};g&&!e[x]&&(e[x]=[]);var v=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(v[b]||{}).hidden)switch(u[b]=cA(b),r=g?e[x][b]:e[u[b]+h],a){case 1:n[b]=b-l.s.c;break;case 2:n[b]=u[b];break;case 3:n[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=cL(r,null,c),f=y[i]||0){do o=i+"_"+f++;while(y[o])y[i]=f,y[o]=1}else y[i]=1;n[b]=o}for(x=l.s.r+s;x<=l.e.r;++x)if(!(w[x]||{}).hidden){var N=function(e,t,r,a,s,n,i,o){var l=cT(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,u=1===s?[]:{};if(1!==s)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:r,enumerable:!1})}catch(e){u.__rowNum__=r}else u.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var p=i?e[r][m]:e[a[m]+l];if(void 0===p||void 0===p.t){if(void 0===c)continue;null!=n[m]&&(u[n[m]]=c);continue}var f=p.v;switch(p.t){case"z":if(null==f)break;continue;case"e":f=0==f?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw Error("unrecognized type "+p.t)}if(null!=n[m]){if(null==f)if("e"==p.t&&null===f)u[n[m]]=null;else if(void 0!==c)u[n[m]]=c;else{if(!d||null!==f)continue;u[n[m]]=null}else u[n[m]]=d&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?f:cL(p,f,o);null!=f&&(h=!1)}}return{row:u,isempty:h}}(e,l,x,u,a,n,g,c);(!1===N.isempty||(1===a?!1!==c.blankrows:c.blankrows))&&(m[p++]=N.row)}return m.length=p,m}var uh=/"/g;function uu(e,t){var r=[],a=null==t?{}:t;if(null==e||null==e["!ref"])return"";var s=cP(e["!ref"]),n=void 0!==a.FS?a.FS:",",i=n.charCodeAt(0),o=void 0!==a.RS?a.RS:"\n",l=o.charCodeAt(0),c=RegExp(("|"==n?"\\|":n)+"+$"),d="",h=[];a.dense=Array.isArray(e);for(var u=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(u[p]||{}).hidden||(h[p]=cA(p));for(var f=0,g=s.s.r;g<=s.e.r;++g)!(m[g]||{}).hidden&&null!=(d=function(e,t,r,a,s,n,i,o){for(var l=!0,c=[],d="",h=cT(r),u=t.s.c;u<=t.e.c;++u)if(a[u]){var m=o.dense?(e[r]||[])[u]:e[a[u]+h];if(null==m)d="";else if(null!=m.v){l=!1,d=""+(o.rawNumbers&&"n"==m.t?m.v:cL(m,null,o));for(var p=0,f=0;p!==d.length;++p)if((f=d.charCodeAt(p))===s||f===n||34===f||o.forceQuotes){d='"'+d.replace(uh,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==m.f||m.F?d="":(l=!1,(d="="+m.f).indexOf(",")>=0&&(d='"'+d.replace(uh,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}(e,s,g,h,i,l,n,a))&&(a.strip&&(d=d.replace(c,"")),(d||!1!==a.blankrows)&&r.push((f++?o:"")+d));return delete a.dense,r.join("")}var um=function(e,t){return function(e,t,r){var a,s=r||{},n=+!s.skipHeader,i={},o=0,l=0;if(i&&null!=s.origin)if("number"==typeof s.origin)o=s.origin;else{var c="string"==typeof s.origin?cR(s.origin):s.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+n}};if(i["!ref"]){var h=cP(i["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),-1==o&&(o=h.e.r+1,d.e.r=o+t.length-1+n)}else -1==o&&(o=0,d.e.r=t.length-1+n);var u=s.header||[],m=0;t.forEach(function(e,t){o4(e).forEach(function(r){-1==(m=u.indexOf(r))&&(u[m=u.length]=r);var c=e[r],d="z",h="",p=cO({c:l+m,r:o+t+n});a=function e(t,r,a){if("string"==typeof r){if(Array.isArray(t)){var s=cR(r);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return"number"!=typeof r?e(t,cO(r)):e(t,cO({r:r,c:a||0}))}(i,p),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",s.cellDates||(d="n",c=o9(c)),h=s.dateNF||oE[14]):null===c&&s.nullError&&(d="e",c=0),a?(a.t=d,a.v=c,delete a.w,delete a.R,h&&(a.z=h)):i[p]=a={t:d,v:c},h&&(a.z=h)):i[p]=c})}),d.e.c=Math.max(d.e.c,l+u.length-1);var p=cT(o);if(n)for(m=0;m<u.length;++m)i[cA(m+l)+p]={t:"s",v:u[m]};return i["!ref"]=cD(d),i}(null,e,t)},up=function(){return{SheetNames:[],Sheets:{}}},uf=function(e,t,r,a){var s=1;if(!r)for(;s<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+s);++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var i=n&&n[1]||r;for(++s;s<=65535&&-1!=e.SheetNames.indexOf(r=i+s);++s);}if(h$(r),e.SheetNames.indexOf(r)>=0)throw Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r};i4.version;let ug=e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`},ux=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-";function ub(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),[r,a]=(0,U.useState)([]),[s,n]=(0,U.useState)(!1),[i,o]=(0,U.useState)(!0),[l,c]=(0,U.useState)({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),[d,h]=(0,U.useState)(!1),[u,m]=(0,U.useState)(!1),[p,f]=(0,U.useState)([]),[g,x]=(0,U.useState)([]),[b,y]=(0,U.useState)(!1),[v,w]=(0,U.useState)(!1),[N,j]=(0,U.useState)([]),[k,E]=(0,U.useState)([]),[S,T]=(0,U.useState)(!1),C=(0,U.useRef)(null),A=(0,U.useRef)(null);(0,U.useEffect)(()=>{console.log("BaseAfiliadosExitosas: Component mounted"),R(),O()},[]),(0,U.useEffect)(()=>{let e=e=>{C.current&&!C.current.contains(e.target)&&h(!1),A.current&&!A.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let R=async()=>{console.log("BaseAfiliadosExitosas: fetchFilterOptions started");try{let e=await er.api.users.list(),t=Array.isArray(e.data)?e.data:[];console.log("BaseAfiliadosExitosas: users loaded",t.length);let r=t.filter(e=>!1!==e.active&&("asesor"===e.role||"Asesor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));f(r);let a=t.filter(e=>!1!==e.active&&("supervisor"===e.role||"Supervisor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));x(a)}catch(e){console.error("Error loading filter options:",e)}},O=async()=>{console.log("BaseAfiliadosExitosas: fetchAudits started");try{n(!0);let e={estado:"QR hecho",ignoreDate:"true"};l.asesor&&(e.asesor=l.asesor),l.supervisor&&(e.supervisor=l.supervisor),l.cuil&&(e.cuil=l.cuil),l.dateFrom&&l.dateTo&&(e.dateFrom=l.dateFrom,e.dateTo=l.dateTo,e.dateField="fechaCreacionQR",delete e.ignoreDate),console.log("BaseAfiliadosExitosas: fetching with params",e);let{data:t}=await er.api.audits.list(e);console.log("BaseAfiliadosExitosas: audits loaded",Array.isArray(t)?t.length:0);let r=(Array.isArray(t)?t:[]).sort((e,t)=>{let r=new Date(e.fechaCreacionQR||e.scheduledAt).getTime();return new Date(t.fechaCreacionQR||t.scheduledAt).getTime()-r});a(r)}catch(e){console.error(e),ea.toast.error("Error al cargar afiliaciones")}finally{n(!1)}},_=(e,t)=>{c(r=>({...r,[e]:t}))},D=async()=>{y(!0),T(!0);try{let{data:e}=await er.api.audits.getSupervisorStats();j(e)}catch(e){console.error(e),ea.toast.error("Error al cargar estadísticas")}finally{T(!1)}},P={binimed:r.filter(e=>e.obraSocialVendida?.toLowerCase().trim()==="binimed").length,meplife:r.filter(e=>e.obraSocialVendida?.toLowerCase().trim().includes("meplife")).length,turf:r.filter(e=>e.obraSocialVendida?.toLowerCase().trim()==="turf").length};return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)("span",{className:"p-2 rounded-lg bg-green-500/20 text-green-500",children:(0,B.jsx)(iL.BarChart3,{className:"w-6 h-6"})}),"Afiliaciones Exitosas"]}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:'Listado histórico de ventas con estado "QR hecho"'})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("button",{onClick:D,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-purple-500/20 text-purple-300 hover:bg-purple-500/30":"bg-purple-100 text-purple-700 hover:bg-purple-200"),children:[(0,B.jsx)(iL.BarChart3,{className:"w-4 h-4"}),"Historial de ventas por Supervisor"]}),(0,B.jsxs)("button",{onClick:()=>{if(!r.length)return void ea.toast.info("No hay datos para exportar");let e=um(r.map(e=>({"Fecha de carga":ug(e.createdAt),"Fecha de QR":ug(e.fechaCreacionQR||e.scheduledAt),"Nombre del afiliado":e.nombre,CUIL:e.cuil||"-",Teléfono:e.telefono||"-","Obra social vendida":e.obraSocialVendida||"-",Asesor:e.asesor?.nombre||"-",Supervisor:ux(e)}))),t=up();uf(t,e,"Afiliaciones Exitosas"),uc(t,`afiliaciones_exitosas_${new Date().toISOString().slice(0,10)}.xlsx`)},className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),"Exportar"]})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 transition-all duration-300","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)(i0,{className:(0,V.cn)("w-4 h-4","dark"===e?"text-purple-400":"text-purple-600")}),(0,B.jsx)("h3",{className:(0,V.cn)("font-medium","dark"===e?"text-gray-200":"text-gray-700"),children:"Filtros"})]}),(0,B.jsx)("button",{onClick:()=>o(!i),className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-gray-100"),children:i?(0,B.jsx)(i2,{className:"w-4 h-4"}):(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})})]}),i&&(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,B.jsxs)("div",{className:"relative",ref:C,children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Asesor"}),(0,B.jsxs)("div",{onClick:()=>h(!d),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,B.jsx)("span",{className:"truncate",children:l.asesor||"Todos los asesores"}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),d&&(0,B.jsxs)("div",{className:(0,V.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,B.jsx)("div",{onClick:()=>{_("asesor",""),h(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los asesores"}),p.map(t=>(0,B.jsx)("div",{onClick:()=>{_("asesor",t.nombre),h(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",l.asesor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,B.jsxs)("div",{className:"relative",ref:A,children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Supervisor"}),(0,B.jsxs)("div",{onClick:()=>m(!u),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,B.jsx)("span",{className:"truncate",children:l.supervisor||"Todos los supervisores"}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),u&&(0,B.jsxs)("div",{className:(0,V.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,B.jsx)("div",{onClick:()=>{_("supervisor",""),m(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los supervisores"}),g.map(t=>(0,B.jsx)("div",{onClick:()=>{_("supervisor",t.nombre),m(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",l.supervisor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"CUIL"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)("input",{type:"text",value:l.cuil,onChange:e=>_("cuil",e.target.value),placeholder:"Buscar por CUIL...",className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border pl-9 transition-all outline-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-purple-300")}),(0,B.jsx)(iK.Search,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Desde (Fecha QR)"}),(0,B.jsx)("input",{type:"date",value:l.dateFrom,onChange:e=>_("dateFrom",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Hasta (Fecha QR)"}),(0,B.jsx)("input",{type:"date",value:l.dateTo,onChange:e=>_("dateTo",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]})]})]}),(0,B.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,B.jsx)("button",{onClick:()=>{c({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),O()},className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-colors","dark"===e?"text-gray-400 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:"Limpiar filtros"}),(0,B.jsx)("button",{onClick:O,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium text-white shadow-lg shadow-purple-500/20 transition-all hover:scale-105 active:scale-95","bg-gradient-to-r from-purple-600 to-blue-600"),children:"Aplicar filtros"})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-2xl border flex items-center justify-between","dark"===e?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-100"),children:[(0,B.jsx)("span",{className:(0,V.cn)("font-medium","dark"===e?"text-blue-300":"text-blue-700"),children:"Binimed"}),(0,B.jsx)("span",{className:(0,V.cn)("text-2xl font-bold","dark"===e?"text-blue-200":"text-blue-800"),children:P.binimed})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-2xl border flex items-center justify-between","dark"===e?"bg-green-500/10 border-green-500/20":"bg-green-100 border-green-200"),children:[(0,B.jsx)("span",{className:(0,V.cn)("font-medium","dark"===e?"text-green-300":"text-green-700"),children:"Meplife"}),(0,B.jsx)("span",{className:(0,V.cn)("text-2xl font-bold","dark"===e?"text-green-400":"text-green-800"),children:P.meplife})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-2xl border flex items-center justify-between","dark"===e?"bg-purple-500/10 border-purple-500/20":"bg-purple-50 border-purple-200"),children:[(0,B.jsx)("span",{className:(0,V.cn)("font-medium","dark"===e?"text-purple-300":"text-purple-700"),children:"TURF"}),(0,B.jsx)("span",{className:(0,V.cn)("text-2xl font-bold","dark"===e?"text-purple-200":"text-purple-800"),children:P.turf})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:(0,V.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,B.jsx)("th",{className:"px-6 py-4",children:"Fecha de carga"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Fecha de QR"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Afiliado"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"CUIL"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Teléfono"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Obra Social"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Asesor"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Supervisor"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:s?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-5 h-5 animate-spin text-purple-500"}),(0,B.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===r.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron afiliaciones exitosas"})}):r.map(t=>{var r,a;let s,n;return(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:ug(t.createdAt)}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-green-500",children:ug(t.fechaCreacionQR||t.scheduledAt)}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap font-medium",children:t.nombre.toUpperCase()}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.cuil||"-"}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.telefono||"-"}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded-md text-xs font-medium",(r=t.obraSocialVendida,"binimed"===(s=r?.toLowerCase()?.trim())?"dark"===e?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"meplife"===s||"meplife "===s?"dark"===e?"bg-green-500/20 text-green-400":"bg-green-200 text-green-800":"turf"===s?"dark"===e?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800":"dark"===e?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700")),children:t.obraSocialVendida||"-"})}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.asesor?.nombre||"-"}),(0,B.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded-md text-xs font-medium",(a=ux(t),(n=a.toLowerCase()).includes("nahuel")&&n.includes("sanchez")||n.includes("nahia")&&n.includes("avellaneda")||n.includes("santiago")&&n.includes("goldsztein")||n.includes("facundo")&&n.includes("tevez")?"dark"===e?"bg-red-900 text-red-200":"bg-red-100 text-red-800":n.includes("abigail")&&n.includes("vera")?"dark"===e?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800":n.includes("mateo")&&n.includes("viera")?"dark"===e?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800":n.includes("belen")&&n.includes("salaverry")?"dark"===e?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800":n.includes("analia")&&n.includes("suarez")?"dark"===e?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800":n.includes("erika")&&n.includes("cardozo")?"dark"===e?"bg-green-900 text-green-200":"bg-green-100 text-green-800":n.includes("aryel")&&n.includes("puiggros")?"dark"===e?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800":n.includes("joaquin")&&n.includes("valdez")||n.includes("joquin")&&n.includes("valdez")?"dark"===e?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800":n.includes("luciano")&&n.includes("carugno")?"dark"===e?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800":n.includes("alejandro")&&n.includes("mejail")?"dark"===e?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800":n.includes("gaston")&&n.includes("sarmiento")?"dark"===e?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800":"dark"===e?"bg-gray-800 text-gray-300":"bg-gray-100 text-gray-800")),children:ux(t)})})]},t._id)})})]})})}),b&&(0,iZ.createPortal)((0,B.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[(0,B.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>y(!1)}),(0,B.jsxs)("div",{className:(0,V.cn)("relative w-full max-w-lg rounded-2xl p-6 shadow-2xl animate-fade-in-up max-h-[80vh] overflow-y-auto","dark"===e?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,B.jsx)("button",{onClick:()=>y(!1),className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 transition-colors",children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})}),(0,B.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[(0,B.jsx)(iL.BarChart3,{className:"w-6 h-6 text-purple-500"}),"Historial de ventas por Supervisor"]}),S?(0,B.jsx)("div",{className:"flex justify-center py-8",children:(0,B.jsx)(J.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,B.jsx)("div",{className:"space-y-3",children:N.map((e,t)=>(0,B.jsxs)("div",{className:"flex items-center gap-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",0===t?"bg-yellow-500 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-400 text-white":"bg-gray-200 dark:bg-white/10 text-gray-600 dark:text-gray-400"),children:t+1}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,B.jsx)("span",{className:"font-medium",children:e.nombre}),(0,B.jsx)("span",{className:"font-bold",children:e.count})]}),(0,B.jsx)("div",{className:"h-2 rounded-full bg-gray-100 dark:bg-white/5 overflow-hidden",children:(0,B.jsx)("div",{className:"h-full bg-purple-500 rounded-full",style:{width:`${e.count/N[0].count*100}%`}})})]})]},t))})]})]}),document.body),v&&(0,iZ.createPortal)((0,B.jsxs)("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[(0,B.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>w(!1)}),(0,B.jsxs)("div",{className:(0,V.cn)("relative w-full max-w-lg rounded-2xl p-6 shadow-2xl animate-fade-in-up max-h-[80vh] overflow-y-auto","dark"===e?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,B.jsx)("button",{onClick:()=>w(!1),className:"absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 transition-colors",children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})}),(0,B.jsxs)("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[(0,B.jsx)(iL.BarChart3,{className:"w-6 h-6 text-blue-500"}),"Top Obras Sociales (Histórico)"]}),S?(0,B.jsx)("div",{className:"flex justify-center py-8",children:(0,B.jsx)(J.RefreshCw,{className:"w-8 h-8 animate-spin text-blue-500"})}):(0,B.jsx)("div",{className:"space-y-3",children:k.map((e,t)=>(0,B.jsxs)("div",{className:"flex items-center gap-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",0===t?"bg-yellow-500 text-white":1===t?"bg-gray-400 text-white":2===t?"bg-orange-400 text-white":"bg-gray-200 dark:bg-white/10 text-gray-600 dark:text-gray-400"),children:t+1}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,B.jsx)("span",{className:"font-medium",children:e.nombre}),(0,B.jsx)("span",{className:"font-bold",children:e.count})]}),(0,B.jsx)("div",{className:"h-2 rounded-full bg-gray-100 dark:bg-white/5 overflow-hidden",children:(0,B.jsx)("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${e.count/k[0].count*100}%`}})})]})]},t))})]})]}),document.body)]})}var uy=e.i(18096);let uv=(0,Y.default)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),uw=(0,Y.default)("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),uN=[{label:"Total Palabras",value:3,icon:uy.Shield,color:"blue"},{label:"Activas",value:3,icon:uv,color:"green"},{label:"Detecciones",value:0,icon:iN.AlertTriangle,color:"orange"},{label:"Sin Resolver",value:0,icon:iG.XCircle,color:"red"}],uj=[{id:1,palabra:"misma obra social",severidad:"alta",fecha:"5/11/2025"},{id:2,palabra:"sindicato",severidad:"alta",fecha:"4/11/2025"},{id:3,palabra:"superintendencia",severidad:"alta",fecha:"4/11/2025"}],uk=["Legal","Competencia","Inapropiado","Otra"];function uE(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)(""),[a,s]=(0,U.useState)("Todas las categorías"),[n,i]=(0,U.useState)(!0);return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,B.jsx)("div",{className:"flex items-start justify-between",children:(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-10 h-10 rounded-xl flex items-center justify-center","dark"===e?"bg-red-500/20":"bg-red-100"),children:(0,B.jsx)(uy.Shield,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-red-400":"text-red-500")})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-xl font-bold","dark"===e?"text-white":"text-gray-800"),children:"Lista de Palabras"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Gestiona la lista de palabras prohibidas"})]})]})}),(0,B.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:uN.map((t,r)=>{let a=t.icon;return(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-4 transition-all duration-300","dark"===e?"bg-white/5 border-white/10 hover:border-white/20":"bg-white border-gray-200 hover:border-purple-200 shadow-sm"),children:(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl font-bold mt-1",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color)),children:t.value})]}),(0,B.jsx)(a,{className:(0,V.cn)("w-6 h-6",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color))})]})},r)})}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-lg"),children:(0,B.jsxs)("div",{className:"space-y-4 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3",children:[(0,B.jsxs)("div",{className:"flex-1 relative",children:[(0,B.jsx)(iK.Search,{className:(0,V.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,B.jsx)("input",{type:"text",placeholder:"Buscar palabra...",value:t,onChange:e=>r(e.target.value),className:(0,V.cn)("w-full pl-10 pr-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-800 placeholder:text-gray-400 focus:border-purple-300")})]}),(0,B.jsxs)("select",{value:a,onChange:e=>s(e.target.value),className:(0,V.cn)("px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-gray-50 border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{children:"Todas las categorías"}),uk.map(e=>(0,B.jsx)("option",{children:e},e))]}),(0,B.jsxs)("label",{className:(0,V.cn)("flex items-center gap-2 px-4 py-2 rounded-lg border cursor-pointer transition-all",n?"dark"===e?"bg-green-500/20 border-green-500/30 text-green-400":"bg-green-50 border-green-200 text-green-600":"dark"===e?"bg-white/5 border-white/10 text-gray-400":"bg-gray-50 border-gray-200 text-gray-600"),children:[(0,B.jsx)("input",{type:"checkbox",checked:n,onChange:e=>i(e.target.checked),className:"sr-only"}),(0,B.jsx)(uv,{className:"w-4 h-4"}),(0,B.jsx)("span",{className:"text-sm font-medium",children:"Activas"})]})]}),(0,B.jsx)("div",{className:"space-y-2",children:uj.map(t=>(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-4 rounded-xl border transition-all hover:scale-[1.01]","dark"===e?"bg-white/5 border-white/10 hover:border-purple-500/30":"bg-gray-50 border-gray-200 hover:border-purple-200"),children:[(0,B.jsxs)("div",{className:"flex items-center gap-4",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-10 h-10 rounded-lg flex items-center justify-center","dark"===e?"bg-purple-500/20":"bg-purple-100"),children:(0,B.jsx)(uw,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")})}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("span",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:t.palabra}),(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-xs font-medium border",(t=>{switch(t.toLowerCase()){case"alta":return"dark"===e?"bg-red-500/20 text-red-400 border-red-500/30":"bg-red-100 text-red-600 border-red-200";case"media":return"dark"===e?"bg-yellow-500/20 text-yellow-400 border-yellow-500/30":"bg-yellow-100 text-yellow-600 border-yellow-200";case"baja":return"dark"===e?"bg-green-500/20 text-green-400 border-green-500/30":"bg-green-100 text-green-600 border-green-200";default:return"dark"===e?"bg-gray-500/20 text-gray-400 border-gray-500/30":"bg-gray-100 text-gray-600 border-gray-200"}})(t.severidad)),children:t.severidad})]}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs mt-0.5","text-gray-500"),children:["Agregada por el ",t.fecha]})]})]}),(0,B.jsx)("button",{className:(0,V.cn)("p-2 rounded-lg transition-all hover:scale-110","dark"===e?"text-red-400 hover:bg-red-500/20":"text-red-500 hover:bg-red-50"),children:(0,B.jsx)(eu.Trash2,{className:"w-5 h-5"})})]},t.id))})]})})]})}let uS=(0,Y.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),uT=[{label:"Total Palabras",value:3,icon:uy.Shield,color:"blue"},{label:"Activas",value:3,icon:uv,color:"green"},{label:"Detecciones",value:0,icon:iN.AlertTriangle,color:"orange"},{label:"Sin Resolver",value:0,icon:iG.XCircle,color:"red"}];function uC(){let{theme:e}=(0,z.useTheme)();return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,B.jsx)("div",{className:"flex items-start justify-between",children:(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-10 h-10 rounded-xl flex items-center justify-center","dark"===e?"bg-orange-500/20":"bg-orange-100"),children:(0,B.jsx)(iN.AlertTriangle,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-orange-400":"text-orange-500")})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-xl font-bold","dark"===e?"text-white":"text-gray-800"),children:"Detecciones"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Revisa las alertas de detección de palabras prohibidas"})]})]})}),(0,B.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:uT.map((t,r)=>{let a=t.icon;return(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-4 transition-all duration-300","dark"===e?"bg-white/5 border-white/10 hover:border-white/20":"bg-white border-gray-200 hover:border-purple-200 shadow-sm"),children:(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl font-bold mt-1",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color)),children:t.value})]}),(0,B.jsx)(a,{className:(0,V.cn)("w-6 h-6",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color))})]})},r)})}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-lg"),children:(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl py-16 animate-fade-in-up","dark"===e?"bg-gradient-to-br from-white/5 to-purple-500/5":"bg-gradient-to-br from-gray-50 to-purple-50/30"),children:(0,B.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-16 h-16 rounded-full flex items-center justify-center mb-4 border-2","dark"===e?"bg-green-500/10 border-green-500/30":"bg-green-50 border-green-200"),children:(0,B.jsx)(uS,{className:(0,V.cn)("w-8 h-8","dark"===e?"text-green-400":"text-green-500")})}),(0,B.jsx)("p",{className:(0,V.cn)("text-base","dark"===e?"text-gray-400":"text-gray-500"),children:"No hay detecciones registradas"})]})})})]})}let uA=[{label:"Total Palabras",value:3,icon:uy.Shield,color:"blue"},{label:"Activas",value:3,icon:uv,color:"green"},{label:"Detecciones",value:0,icon:iN.AlertTriangle,color:"orange"},{label:"Sin Resolver",value:0,icon:iG.XCircle,color:"red"}],uR=["Legal","Competencia","Inapropiado","Otra"],uO=["Alta","Media","Baja"];function u_(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)(""),[a,s]=(0,U.useState)("Otra"),[n,i]=(0,U.useState)("Media"),[o,l]=(0,U.useState)("");return(0,B.jsxs)("div",{className:"animate-fade-in-up space-y-6",children:[(0,B.jsx)("div",{className:"flex items-start justify-between",children:(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-10 h-10 rounded-xl flex items-center justify-center","dark"===e?"bg-purple-500/20":"bg-purple-100"),children:(0,B.jsx)(eE.Plus,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-xl font-bold","dark"===e?"text-white":"text-gray-800"),children:"Agregar Palabra"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Añade una nueva palabra prohibida a la lista"})]})]})}),(0,B.jsx)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:uA.map((t,r)=>{let a=t.icon;return(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-4 transition-all duration-300","dark"===e?"bg-white/5 border-white/10 hover:border-white/20":"bg-white border-gray-200 hover:border-purple-200 shadow-sm"),children:(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl font-bold mt-1",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color)),children:t.value})]}),(0,B.jsx)(a,{className:(0,V.cn)("w-6 h-6",(t=>{switch(t){case"blue":return"dark"===e?"text-blue-400":"text-blue-500";case"green":return"dark"===e?"text-green-400":"text-green-500";case"orange":return"dark"===e?"text-orange-400":"text-orange-500";case"red":return"dark"===e?"text-red-400":"text-red-500";default:return"dark"===e?"text-gray-400":"text-gray-500"}})(t.color))})]})},r)})}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-lg"),children:(0,B.jsx)("div",{className:"flex justify-center animate-fade-in-up",children:(0,B.jsxs)("div",{className:"w-full max-w-md space-y-5",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:["Palabra Prohibida ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsx)("input",{type:"text",placeholder:"Ej: competidor, ilegal, etc.",value:t,onChange:e=>r(e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-800 placeholder:text-gray-400 focus:border-purple-300")})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:"Categoría"}),(0,B.jsx)("select",{value:a,onChange:e=>s(e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-gray-50 border-gray-200 text-gray-800"),children:uR.map(e=>(0,B.jsx)("option",{children:e},e))})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:"Severidad"}),(0,B.jsx)("select",{value:n,onChange:e=>i(e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all","dark"===e?"bg-white/5 border-white/10 text-white":"bg-gray-50 border-gray-200 text-gray-800"),children:uO.map(e=>(0,B.jsx)("option",{children:e},e))})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-2","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas (Opcional)"}),(0,B.jsx)("textarea",{placeholder:"Motivo o contexto de la prohibición...",value:o,onChange:e=>l(e.target.value),rows:4,className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm transition-all resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-800 placeholder:text-gray-400 focus:border-purple-300")})]}),(0,B.jsxs)("button",{onClick:()=>{console.log({nuevaPalabra:t,nuevaCategoria:a,nuevaSeveridad:n,notas:o})},className:(0,V.cn)("w-full flex items-center justify-center gap-2 py-3 rounded-lg font-medium text-white transition-all hover:scale-[1.02] active:scale-[0.98]","dark"===e?"bg-gradient-to-r from-teal-600 to-cyan-600 hover:shadow-lg hover:shadow-teal-500/20":"bg-gradient-to-r from-teal-500 to-cyan-500 hover:shadow-lg hover:shadow-teal-300/30"),children:[(0,B.jsx)(eE.Plus,{className:"w-5 h-5"}),"Agregar Palabra"]})]})})})]})}let uD=["Mensaje enviado","En videollamada","Rechazada","Falta documentación","Falta clave","Reprogramada","Reprogramada (falta confirmar hora)","Completa","No atendió","Tiene dudas","Falta clave y documentación","No le llegan los mensajes","Cortó","Autovinculación","Caída","Rehacer vídeo","Pendiente","QR hecho","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrón","En revisión","Remuneración no válida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vídeo","Rechazada","Falta documentación","Falta clave","Falta clave y documentación"],uP=["OSDE","OSDEPYM","IOMA","OSSEG","OSDE 210","OSFATUN","OSDE GBA","OSECAC (126205)","OSPRERA","OMINT","OSSEGUR","OSPR","OSUTHGRA (108803)","OSBLYCA","UOM","OSPM","OSPECON (105408)","Elevar (114307)","OSCHOCA (105804)","OSPEP (113908)","OSPROTURA","OSPSIP (119708)","OSEIV (122401)","OSPIF (108100)","OSIPA (114208)","OSPESESGYPE (107206)","OSTCARA (126007)","OSPIT (121002)","OSMP (111209)","OSPECA (103709)","OSPIQYP (118705)","OSBLYCA (102904)","VIASANO (2501)","OSPCYD (103402)","OSUOMRA (112103)","OSAMOC (3405)","OSPAGA (101000)","OSPF (107404)","OSPIP (116006)","OSPIC","OSG (109202)","OSPERYH (106500)","OSPCRA (104009)"],uI=["Binimed","Meplife","TURF"],uL=["Alta","Cambio"];function uM({isOpen:t,onClose:r,audit:a,onSave:s}){let n,i,{theme:o}=(0,z.useTheme)(),{user:l}=(0,iT.useAuth)(),c=(e=>{if(!e)return{fecha:"",hora:""};let t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return{fecha:`${r}-${a}-${s}`,hora:`${n}:${i}`}})(a.scheduledAt),d=l?.role?.toLowerCase(),h="gerencia"===d,u="administrativo"===d,m=["auditor","supervisor"].includes(d||""),p=u?["Pendiente","QR hecho","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrón","En revisión","Remuneración no válida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vídeo","Rechazada","Falta documentación","Falta clave","Falta clave y documentación"]:m?["Mensaje enviado","En videollamada","Rechazada","Falta documentación","Falta clave","Reprogramada","Reprogramada (falta confirmar hora)","Completa","No atendió","Tiene dudas","Falta clave y documentación","No le llegan los mensajes","Cortó","Autovinculación","Caída","Rehacer vídeo"]:h?uD:[],[f,g]=(0,U.useState)({nombre:a.nombre||"",cuil:a.cuil||"",telefono:a.telefono||"",obraSocialAnterior:a.obraSocialAnterior||"",obraSocialVendida:a.obraSocialVendida||"",status:a.status||"",tipoVenta:a.tipoVenta||"Alta",asesor:a.asesor?._id||"",grupo:a.groupId?.nombre||a.groupId?.name||a.grupo||"",numeroEquipo:a.asesor?.numeroEquipo||a.numeroEquipo||"",auditor:a.auditor?._id||"",administrador:a.administrador?._id||"",fecha:c.fecha,hora:c.hora,datosExtra:a.datosExtra||"",isRecuperada:a.isRecuperada||!1,fechaCreacionQR:a.fechaCreacionQR?a.fechaCreacionQR.split("T")[0]:"",supervisor:a.supervisorSnapshot?._id||""}),[x,b]=(0,U.useState)(!1),[y,v]=(0,U.useState)(!1),[w,N]=(0,U.useState)("details"),[j,k]=(0,U.useState)([]),[E,S]=(0,U.useState)([]),[T,C]=(0,U.useState)([]),[A,R]=(0,U.useState)([]),[O,_]=(0,U.useState)([]),[D,P]=(0,U.useState)([]);(0,U.useEffect)(()=>{t&&(g({nombre:a.nombre||"",cuil:a.cuil||"",telefono:a.telefono||"",obraSocialAnterior:a.obraSocialAnterior||"",obraSocialVendida:a.obraSocialVendida||"",status:a.status||"",tipoVenta:a.tipoVenta||"Alta",asesor:a.asesor?._id||"",grupo:a.groupId?.nombre||a.groupId?.name||a.grupo||"",numeroEquipo:a.asesor?.numeroEquipo||a.numeroEquipo||"",auditor:a.auditor?._id||"",administrador:a.administrador?._id||"",fecha:c.fecha,hora:c.hora,datosExtra:a.datosExtra||"",isRecuperada:a.isRecuperada||!1,fechaCreacionQR:a.fechaCreacionQR?a.fechaCreacionQR.split("T")[0]:"",supervisor:a.supervisorSnapshot?._id||""}),I())},[t,a]),(0,U.useEffect)(()=>{f.fecha&&M(f.fecha)},[f.fecha]);let I=async()=>{try{let e=(await er.api.users.list("includeAllAuditors=true")).data||[];console.log("AuditEditModal: Users fetched:",e.length,e),k(e.filter(e=>!1!==e.active));let t=e.filter(e=>["auditor","supervisor","gerencia"].includes(e.role?.toLowerCase())&&!1!==e.active);console.log("AuditEditModal: Filtered auditores:",t.length,t),C(t),R(e.filter(e=>"supervisor"===e.role&&!1!==e.active)),_(e.filter(e=>"administrativo"===e.role&&!1!==e.active));let r=Array.from(new Set(e.filter(e=>e.numeroEquipo).map(e=>e.numeroEquipo))).map(e=>({_id:e,nombre:e,name:e}));S(r)}catch(e){console.error("Error fetching filter options:",e),k([]),C([]),_([]),S([])}},L=(0,U.useMemo)(()=>{if(!f.numeroEquipo&&!f.grupo)return j;let e=f.numeroEquipo||f.grupo;return j.filter(t=>t.numeroEquipo===e)},[j,f.numeroEquipo,f.grupo]),M=async e=>{try{let{data:t}=await er.api.audits.getAvailableSlots(e);P(t||[])}catch(e){console.error("Error fetching slots:",e),P([])}},F=(n=(()=>{let e=[],t=new Date;t.setHours(9,20,0,0);let r=new Date;r.setHours(23,0,0,0);let a=new Date(t);for(;a<=r;){let t=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0");e.push(`${t}:${r}`),a.setMinutes(a.getMinutes()+20)}return e})(),i={},Array.isArray(D)&&D.forEach(e=>{i[e.time]=e.count}),n.map(e=>({time:e,disabled:(i[e]||0)>=10})));if(!t)return null;let H=e=>{let{name:t,value:r,type:a}=e.target,s=e.target.checked;if("grupo"===t){let e=j.find(e=>e.numeroEquipo===r&&e.role?.toLowerCase()==="supervisor");g(t=>({...t,grupo:r,numeroEquipo:r,asesor:e?._id||""}))}else g(e=>({...e,[t]:"checkbox"===a?s:r}))},W=async()=>{try{b(!0);let e={...f,scheduledAt:`${f.fecha}T${f.hora}:00`,fechaCreacionQR:f.fechaCreacionQR?new Date(f.fechaCreacionQR).toISOString():null};if(e.asesor||delete e.asesor,e.grupo||delete e.grupo,e.numeroEquipo||delete e.numeroEquipo,e.auditor=f.auditor||null,e.administrador=f.administrador||null,h?e.supervisor||(e.supervisor=null):delete e.supervisor,y&&f.fecha&&f.hora&&(e.scheduledAt=new Date(`${f.fecha}T${f.hora}:00`).toISOString()),a.auditor?._id&&!f.auditor){let e=l?._id===a.auditor._id,t=(()=>{if(l?.role?.toLowerCase()!=="supervisor")return!1;let e=a.asesor?.numeroEquipo||a.numeroEquipo,t=l?.numeroEquipo;return e&&t&&String(e)===String(t)})();if(!h&&!t&&!e){ea.toast.error("No tienes permiso para quitar al auditor asignado. Solo gerencia, el supervisor del equipo o el auditor mismo pueden hacerlo."),b(!1);return}}if(a.administrador?._id&&!f.administrador){let e=l?._id===a.administrador._id;if(!h&&!e){ea.toast.error("No tienes permiso para quitar al administrador asignado"),b(!1);return}}let t=await er.api.audits.update(a._id,e);ea.toast.success("Auditoría actualizada"),s(t.data),r()}catch(e){console.error("Error updating audit:",e),ea.toast.error(e.response?.data?.message||"Error al actualizar auditoría")}finally{b(!1)}},[G,Y]=(0,U.useState)(!1);if((0,U.useEffect)(()=>(Y(!0),()=>Y(!1)),[]),!G)return null;let{createPortal:X}=e.r(56667);return X((0,B.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-4xl rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]","dark"===o?"bg-[#1a1333] border border-white/10":"bg-white"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("px-6 py-4 border-b flex items-center justify-between","dark"===o?"border-white/10":"border-gray-100"),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-lg font-semibold","dark"===o?"text-white":"text-gray-800"),children:"Editar Auditoría"}),(0,B.jsxs)("p",{className:(0,V.cn)("text-sm","dark"===o?"text-gray-400":"text-gray-500"),children:[a.nombre," - ",a.cuil]})]}),(0,B.jsx)("button",{onClick:r,className:(0,V.cn)("p-2 rounded-lg transition-colors","dark"===o?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("flex border-b","dark"===o?"border-white/10":"border-gray-100"),children:[(0,B.jsx)("button",{onClick:()=>N("details"),className:(0,V.cn)("flex-1 px-4 py-3 text-sm font-medium transition-colors border-b-2","details"===w?"dark"===o?"border-purple-500 text-purple-400":"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Detalles"}),(0,B.jsx)("button",{onClick:()=>N("history"),className:(0,V.cn)("flex-1 px-4 py-3 text-sm font-medium transition-colors border-b-2","history"===w?"dark"===o?"border-purple-500 text-purple-400":"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Historial"})]}),(0,B.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,B.jsx)("fieldset",{disabled:"asesor"===d,className:"contents",children:"details"===w?(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Afiliado"}),(0,B.jsx)("input",{name:"nombre",value:f.nombre,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Teléfono"}),(0,B.jsx)("input",{name:"telefono",value:f.telefono,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"CUIL"}),(0,B.jsx)("input",{name:"cuil",value:f.cuil,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Obra Social Anterior"}),(0,B.jsxs)("select",{name:"obraSocialAnterior",value:f.obraSocialAnterior,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"-- Seleccionar --"}),uP.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Obra Social Vendida"}),(0,B.jsx)("select",{name:"obraSocialVendida",value:f.obraSocialVendida,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:uI.map(e=>(0,B.jsx)("option",{value:e,children:e},e))})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Estado"}),(0,B.jsxs)("select",{name:"status",value:f.status,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccionar estado..."}),f.status&&!p.includes(f.status)&&(0,B.jsx)("option",{value:f.status,children:f.status}),p.map(e=>(0,B.jsx)("option",{value:e,disabled:"Reprogramada"===e&&!y,children:e},e))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Tipo"}),(0,B.jsx)("select",{name:"tipoVenta",value:f.tipoVenta,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:uL.map(e=>(0,B.jsx)("option",{value:e,children:e},e))})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Asesor"}),(0,B.jsxs)("select",{name:"asesor",value:f.asesor,onChange:H,disabled:!h,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm",!h&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccione"}),L?.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Grupo"}),(0,B.jsxs)("select",{name:"grupo",value:f.grupo,onChange:H,disabled:!h,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm",!h&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccione"}),E?.map(e=>(0,B.jsx)("option",{value:e.nombre||e.name,children:e.nombre||e.name},e._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Supervisor"}),(0,B.jsxs)("select",{name:"supervisor",value:f.supervisor,onChange:H,disabled:!h,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm",!h&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccione"}),A?.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombre," ",e.numeroEquipo?`(${e.numeroEquipo})`:""]},e._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Auditor"}),(0,B.jsxs)("select",{name:"auditor",value:f.auditor,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccione"}),T?.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Administrador"}),(0,B.jsxs)("select",{name:"administrador",value:f.administrador,onChange:H,disabled:!h&&!u,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm",!h&&!u&&"opacity-60 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccione"}),O?.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Fecha (día)"}),(0,B.jsx)("input",{type:"date",name:"fecha",value:f.fecha,onChange:H,disabled:!y,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm",!y&&"opacity-50 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Hora (Turno)"}),(0,B.jsxs)("select",{name:"hora",value:f.hora,onChange:H,disabled:!y,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm",!y&&"opacity-50 cursor-not-allowed","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccionar hora"}),F.map(e=>(0,B.jsxs)("option",{value:e.time,disabled:e.disabled&&e.time!==f.hora,children:[e.time," ",e.disabled?"(Lleno)":""]},e.time))]})]})]}),["administrativo","gerencia"].includes(l?.role?.toLowerCase()||"")&&(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Fecha Creación QR"}),(0,B.jsx)("input",{type:"date",name:"fechaCreacionQR",value:f.fechaCreacionQR,onChange:H,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("input",{type:"checkbox",id:"reprogramar",checked:y,onChange:e=>{let t=e.target.checked;v(t),t&&g(e=>({...e,status:"Reprogramada"}))},className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,B.jsx)("label",{htmlFor:"reprogramar",className:(0,V.cn)("text-sm font-medium","dark"===o?"text-gray-300":"text-gray-700"),children:"Reprogramar turno (habilitar fecha/hora)"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===o?"text-gray-300":"text-gray-700"),children:"Datos Extra / Notas"}),(0,B.jsx)("textarea",{name:"datosExtra",value:f.datosExtra,onChange:H,rows:3,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===o?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("input",{type:"checkbox",name:"isRecuperada",checked:f.isRecuperada,onChange:H,className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,B.jsx)("label",{className:(0,V.cn)("text-sm","dark"===o?"text-gray-300":"text-gray-700"),children:"¿Recuperada?"})]})]}):(0,B.jsxs)("div",{className:"space-y-6",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("h3",{className:(0,V.cn)("text-sm font-semibold mb-3 flex items-center gap-2","dark"===o?"text-white":"text-gray-800"),children:[(0,B.jsx)(ep.Clock,{className:"w-4 h-4"}),"Historial de Estados"]}),(0,B.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-200 dark:border-white/10",children:[a.statusHistory?.slice().reverse().map((e,t)=>(0,B.jsxs)("div",{className:"relative pl-4 pb-2",children:[(0,B.jsx)("div",{className:(0,V.cn)("absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2","dark"===o?"bg-gray-900 border-purple-500":"bg-white border-purple-500")}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm font-medium","dark"===o?"text-gray-200":"text-gray-800"),children:e.value}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs","dark"===o?"text-gray-400":"text-gray-500"),children:[e.updatedBy?.nombre||"Sistema"," - ",new Date(e.updatedAt).toLocaleString()]})]},t)),(!a.statusHistory||0===a.statusHistory.length)&&(0,B.jsx)("p",{className:"text-sm text-gray-500 pl-4",children:"No hay historial de estados"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("h3",{className:(0,V.cn)("text-sm font-semibold mb-3 flex items-center gap-2","dark"===o?"text-white":"text-gray-800"),children:[(0,B.jsx)(q.Users,{className:"w-4 h-4"}),"Historial de Asesores"]}),(0,B.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-200 dark:border-white/10",children:[a.asesorHistory?.slice().reverse().map((e,t)=>(0,B.jsxs)("div",{className:"relative pl-4 pb-2",children:[(0,B.jsx)("div",{className:(0,V.cn)("absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2","dark"===o?"bg-gray-900 border-blue-500":"bg-white border-blue-500")}),(0,B.jsxs)("p",{className:(0,V.cn)("text-sm font-medium","dark"===o?"text-gray-200":"text-gray-800"),children:[e.previousAsesor?.nombre||e.previousAsesor?.name||"Sin Asesor"," → ",e.newAsesor?.nombre||e.newAsesor?.name||"Sin Asesor"]}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs","dark"===o?"text-gray-400":"text-gray-500"),children:[e.changedBy?.nombre||e.changedBy?.name||"Sistema"," - ",new Date(e.changedAt).toLocaleString()]})]},t)),(!a.asesorHistory||0===a.asesorHistory.length)&&(0,B.jsx)("p",{className:"text-sm text-gray-500 pl-4",children:"No hay historial de cambios de asesor"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("h3",{className:(0,V.cn)("text-sm font-semibold mb-3 flex items-center gap-2","dark"===o?"text-white":"text-gray-800"),children:[(0,B.jsx)(et.MessageSquare,{className:"w-4 h-4"}),"Historial de Comentarios"]}),(0,B.jsxs)("div",{className:"space-y-3 pl-2 border-l-2 border-gray-200 dark:border-white/10",children:[a.datosExtraHistory?.slice().reverse().map((e,t)=>(0,B.jsxs)("div",{className:"relative pl-4 pb-2",children:[(0,B.jsx)("div",{className:(0,V.cn)("absolute -left-[9px] top-1 w-4 h-4 rounded-full border-2","dark"===o?"bg-gray-900 border-green-500":"bg-white border-green-500")}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm font-medium","dark"===o?"text-gray-200":"text-gray-800"),children:e.value}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs","dark"===o?"text-gray-400":"text-gray-500"),children:[e.updatedBy?.nombre||"Sistema"," - ",new Date(e.updatedAt).toLocaleString()]})]},t)),(!a.datosExtraHistory||0===a.datosExtraHistory.length)&&(0,B.jsx)("p",{className:"text-sm text-gray-500 pl-4",children:"No hay historial de comentarios"})]})]})]})})}),(0,B.jsxs)("div",{className:(0,V.cn)("px-6 py-4 border-t flex justify-end gap-3","dark"===o?"border-white/10":"border-gray-100"),children:[(0,B.jsx)("button",{onClick:r,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===o?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-600"),children:"Cancelar"}),(0,B.jsxs)("button",{onClick:W,disabled:x,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",x?"opacity-50 cursor-not-allowed":"hover:opacity-90","bg-purple-600"),children:[(0,B.jsx)(eh.Save,{className:"w-4 h-4"}),x?"Guardando...":"Guardar Cambios"]})]})]})}),document.body)}let uF=["OSDE","OSDEPYM","IOMA","OSSEG","OSDE 210","OSFATUN","OSDE GBA","OSECAC (126205)","OSPRERA","OMINT","OSSEGUR","OSPR","OSUTHGRA (108803)","OSBLYCA","UOM","OSPM","OSPECON (105408)","Elevar (114307)","OSCHOCA (105804)","OSPEP (113908)","OSPROTURA","OSPSIP (119708)","OSEIV (122401)","OSPIF (108100)","OSIPA (114208)","OSPESESGYPE (107206)","OSTCARA (126007)","OSPIT (121002)","OSMP (111209)","OSPECA (103709)","OSPIQYP (118705)","OSBLYCA (102904)","VIASANO (2501)","OSPCYD (103402)","OSUOMRA (112103)","OSAMOC (3405)","OSPAGA (101000)","OSPF (107404)","OSPIP (116006)","OSPIC","OSG (109202)","OSPERYH (106500)","OSPCRA (104009)"],uB=["Binimed","Meplife","TURF"],uU=["Sin estado","Mensaje enviado","En videollamada","Rechazada","Falta documentación","Falta clave","Reprogramada","Reprogramada (falta confirmar hora)","Completa","No atendió","Tiene dudas","Falta clave y documentación","No le llegan los mensajes","Cortó","Autovinculación","Caída","Rehacer vídeo","Pendiente","QR hecho","AFIP","Baja laboral con nueva alta","Baja laboral sin nueva alta","Padrón","En revisión","Remuneración no válida","Cargada","Aprobada","Aprobada, pero no reconoce clave","Rehacer vídeo","Rechazada","Falta documentación","Falta clave","Falta clave y documentación"],uV=["Alta","Cambio"],uz=(e,t)=>{let r=(e||"").toLowerCase();return"binimed"===r?"dark"===t?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800":"meplife"===r||"meplife "===r?"dark"===t?"bg-green-500/20 text-green-400":"bg-green-200 text-green-800":"turf"===r?"dark"===t?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800":"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700"},uH=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-";function uW(){let e,t,r,a,{theme:s}=(0,z.useTheme)(),{user:n}=(0,iT.useAuth)(),[i,o]=(0,U.useState)([]),[l,c]=(0,U.useState)(!1),[d,h]=(0,U.useState)(!0),[u,m]=(0,U.useState)({afiliado:"",cuil:"",obraAnterior:"",obraVendida:"",estado:"",tipo:"",asesor:"",datos:"",auditor:"",supervisor:"",administrador:""}),[p,f]=(0,U.useState)(""),[g,x]=(0,U.useState)(""),[b,y]=(0,U.useState)([]),[v,w]=(0,U.useState)([]),[N,j]=(0,U.useState)([]),[k,E]=(0,U.useState)([]),[S,T]=(0,U.useState)([]),[C,A]=(0,U.useState)([]),[R,O]=(0,U.useState)(!1),[_,D]=(0,U.useState)(!1),[P,I]=(0,U.useState)(!1),[L,M]=(0,U.useState)(!1),[F,H]=(0,U.useState)(!1),[W,G]=(0,U.useState)(!1),[q,Y]=(0,U.useState)([]),[X,K]=(0,U.useState)([]),[Z,et]=(0,U.useState)([]),[es,en]=(0,U.useState)([]),[ei,eo]=(0,U.useState)([]),[el,ec]=(0,U.useState)(null),[ed,eh]=(0,U.useState)(!1),[em,ep]=(0,U.useState)(!1),[ef,eg]=(0,U.useState)([]),[ex,eb]=(0,U.useState)(!1),[ey,ev]=(0,U.useState)(new Date().toISOString().split("T")[0]),[ew,eN]=(0,U.useState)(!1),[ej,ek]=(0,U.useState)([]),[eE,eT]=(0,U.useState)(!1),[eC,eA]=(0,U.useState)(new Date().toISOString().split("T")[0]),eR=(0,U.useRef)(null),eO=(0,U.useRef)(null),e_=(0,U.useRef)(null),eD=(0,U.useRef)(null),eP=(0,U.useRef)(null),eI=(0,U.useRef)(null),eL=(()=>{try{let e=localStorage.getItem("token");if(!e)return null;let t=JSON.parse(atob(e.split(".")[1]));return t?.role||null}catch{return null}})(),eM="supervisor"===eL||"Supervisor"===eL,eF="admin"===eL||"Admin"===eL,eB="gerencia"===eL||"Gerencia"===eL,eU="asesor"===eL||"Asesor"===eL,eV=(e,t)=>{let r=(e||"").trim();r&&t(e=>e.includes(r)?e.filter(e=>e!==r):[...e,r])},ez=(e,t,r)=>0===e.length?t:1===e.length?e[0]:`${e.length} ${r}`,eH=async()=>{try{c(!0);let e=(()=>{let e={...u};if(v.length>0&&!v.includes("Sin estado")&&(e.estado=v.map(e=>e.trim()).join(",")),N.length>0&&(e.asesor=N.map(e=>e.trim()).filter(Boolean).join(",")),k.length>0&&(e.auditor=k.map(e=>e.trim()).filter(Boolean).join(",")),S.length>0&&(e.supervisor=S.map(e=>e.trim()).filter(Boolean).join(",")),C.length>0&&(e.administrador=C.map(e=>e.trim()).filter(Boolean).join(",")),b.length>0&&(e.grupo=b.map(e=>e.trim()).filter(Boolean).join(",")),u.cuil&&""!==u.cuil.trim())delete e.dateFrom,delete e.dateTo,delete e.date;else if(p&&g)e.dateFrom=p,e.dateTo=g;else{let t,r,a,s,n,i;p||g||(r=(t=new Date(new Date().toLocaleString("en-US",{timeZone:"America/Argentina/Buenos_Aires"}))).getHours(),a=t.getMinutes(),(23===r&&a>=1||r>23)&&t.setDate(t.getDate()+1),s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),e.date=`${s}-${n}-${i}`)}return Object.keys(e).forEach(t=>{(""===e[t]||null===e[t]||void 0===e[t])&&delete e[t]}),e})(),{data:t}=await er.api.audits.list(e),r=Array.isArray(t)?t:[],a=r;if(v.length>0)a=v.includes("Sin estado")?r.filter(e=>{let t=(e.status||"").trim(),r=!t||"Seleccione"===t||"Seleccionar estado..."===t,a=v.includes(t);return r||a}):r;else{let e=["cargada","aprobada"];a=r.filter(t=>{let r=(t.status||"").toLowerCase();return!e.includes(r)})}o(a)}catch(e){console.error(e),ea.toast.error("Error al cargar auditorías"),o([])}finally{c(!1)}},eW=async()=>{try{let e=await er.api.users.list(),t=Array.isArray(e.data)?e.data:[],r=t.filter(e=>{let t=e?.active!==!1,r="asesor"===e.role||"Asesor"===e.role,a=("auditor"===e.role||"Auditor"===e.role)&&e.numeroEquipo;return t&&(r||a)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));Y(r);let a=t.filter(e=>{let t=e?.active!==!1,r=e?.role;return t&&("auditor"===r||"Auditor"===r||"gerencia"===r||"Gerencia"===r||"supervisor"===r||"Supervisor"===r)&&e.nombre}).sort((e,t)=>e.nombre.localeCompare(t.nombre));et(a);let s=await er.api.groups.list(),n=Array.isArray(s.data)?s.data:[];K(n.sort((e,t)=>(e.nombre||"").localeCompare(t.nombre||"")));let i=t.filter(e=>e?.active!==!1&&("supervisor"===e.role||"Supervisor"===e.role)&&e.nombre).sort((e,t)=>e.nombre.localeCompare(t.nombre));en(i);let o=t.filter(e=>e?.active!==!1&&("admin"===e.role||"Admin"===e.role)&&e.nombre).sort((e,t)=>e.nombre.localeCompare(t.nombre));eo(o)}catch(e){console.error("Error al cargar opciones de filtros:",e)}},e$=(e,t)=>{m(r=>({...r,[e]:t}))},eG=async e=>{if(confirm("¿Estás seguro de eliminar esta auditoría?"))try{await er.api.audits.delete(e),ea.toast.success("Auditoría eliminada"),eH()}catch(e){console.error("Error deleting audit:",e),ea.toast.error("Error al eliminar auditoría")}},eq=async e=>{eb(!0);try{let{data:t}=await er.api.audits.getAvailableSlots(e);eg(Array.isArray(t)?t:[])}catch(e){console.error(e),ea.toast.error("No se pudieron cargar los turnos")}finally{eb(!1)}},eY=async e=>{eT(!0);try{let{data:t}=await er.api.audits.getSalesStats(e);ek(Array.isArray(t)?t:[])}catch(e){console.error(e),ea.toast.error("No se pudieron cargar las estadísticas")}finally{eT(!1)}};return(0,U.useEffect)(()=>{eH(),eW();let e=(0,iy.connectSocket)();e.emit("audits:subscribeAll"),console.log("[Seguimiento] Subscribed to audits_all room");let t=e=>{console.log("[Socket] New audit received:",e._id),o(t=>{if(t.some(t=>t._id===e._id))return t;let r=[e,...t];return ea.toast.info(`Nueva auditor\xeda: ${e.nombre}`,{duration:3e3}),r})},r=e=>{console.log("[Socket] Audit update received:",e._id),o(t=>{let r=t.findIndex(t=>t._id===e._id);if(-1===r)return t;let a=[...t];return a[r]={...t[r],...e},a}),ec(t=>t&&t._id===e._id?(ed&&e.updatedBy!==n?._id&&ea.toast.warning("Esta auditoría fue modificada por otro usuario",{duration:5e3}),{...t,...e}):t)},a=e=>{console.log("[Socket] Audit deleted:",e._id),o(t=>t.filter(t=>t._id!==e._id)),el&&el._id===e._id&&(eh(!1),ec(null),ea.toast.error("La auditoría que estabas editando fue eliminada",{duration:5e3}))};return e.on("audits:new",t),e.on("audit:update",r),e.on("audit:deleted",a),()=>{e.off("audits:new",t),e.off("audit:update",r),e.off("audit:deleted",a),e.emit("audits:unsubscribeAll"),console.log("[Seguimiento] Unsubscribed from audits_all room")}},[ed,el]),(0,U.useEffect)(()=>{eH()},[u,b,v,N,k,S,C,p,g]),(0,U.useEffect)(()=>{let e=[{ref:eR,setOpen:O},{ref:eO,setOpen:D},{ref:e_,setOpen:I},{ref:eD,setOpen:M},{ref:eP,setOpen:H},{ref:eI,setOpen:G}],t=t=>{e.forEach(({ref:e,setOpen:r})=>{e.current&&!e.current.contains(t.target)&&r(!1)})};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6 backdrop-blur-sm relative z-20","dark"===s?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,B.jsx)(i0,{className:(0,V.cn)("w-5 h-5","dark"===s?"text-purple-400":"text-purple-500")}),(0,B.jsx)("h3",{className:(0,V.cn)("font-semibold","dark"===s?"text-white":"text-gray-800"),children:"Filtros"})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3 mb-3",children:[(0,B.jsx)("input",{type:"text",placeholder:"Buscar afiliado",value:u.afiliado,onChange:e=>e$("afiliado",e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,B.jsx)("input",{type:"text",placeholder:"Buscar CUIL",value:u.cuil,onChange:e=>e$("cuil",e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,B.jsxs)("select",{value:u.obraAnterior,onChange:e=>e$("obraAnterior",e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Obra social anterior"}),uF.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]}),(0,B.jsxs)("select",{value:u.obraVendida,onChange:e=>e$("obraVendida",e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Obra social vendida"}),uB.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]}),(0,B.jsxs)("div",{className:"relative",ref:eO,children:[(0,B.jsxs)("button",{onClick:()=>D(!_),className:(0,V.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("span",{className:"truncate",children:ez(v,"Estado","estados")}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})]}),_&&(0,B.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,B.jsx)("button",{type:"button",onClick:()=>w(uU),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),v.length>0&&(0,B.jsx)("button",{type:"button",onClick:()=>w([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),uU.map(e=>(0,B.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:v.includes(e),onChange:()=>eV(e,w),className:"accent-blue-600"}),(0,B.jsx)("span",{className:"dark:text-gray-200",children:e})]},e))]})]}),(0,B.jsxs)("select",{value:u.tipo,onChange:e=>e$("tipo",e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Tipo"}),uV.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-3 mb-3",children:[(0,B.jsxs)("div",{className:"relative",ref:e_,children:[(0,B.jsxs)("button",{onClick:()=>I(!P),className:(0,V.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("span",{className:"truncate",children:ez(N,"Asesor","asesores")}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})]}),P&&(0,B.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,B.jsx)("button",{type:"button",onClick:()=>j(q.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),N.length>0&&(0,B.jsx)("button",{type:"button",onClick:()=>j([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),q.map(e=>(0,B.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:N.includes(e.nombre),onChange:()=>eV(e.nombre,j),className:"accent-blue-600"}),(0,B.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,B.jsxs)("div",{className:"relative",ref:eR,children:[(0,B.jsxs)("button",{onClick:()=>O(!R),className:(0,V.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("span",{className:"truncate",children:ez(b,"Grupo","grupos")}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})]}),R&&(0,B.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,B.jsx)("button",{type:"button",onClick:()=>y(X.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),b.length>0&&(0,B.jsx)("button",{type:"button",onClick:()=>y([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),X.map(e=>(0,B.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:b.includes(e.nombre),onChange:()=>eV(e.nombre,y),className:"accent-blue-600"}),(0,B.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,B.jsxs)("div",{className:"relative",ref:eD,children:[(0,B.jsxs)("button",{onClick:()=>M(!L),className:(0,V.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("span",{className:"truncate",children:ez(k,"Auditor","auditores")}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})]}),L&&(0,B.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,B.jsx)("button",{type:"button",onClick:()=>E(Z.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),k.length>0&&(0,B.jsx)("button",{type:"button",onClick:()=>E([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),Z.map(e=>(0,B.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:k.includes(e.nombre),onChange:()=>eV(e.nombre,E),className:"accent-blue-600"}),(0,B.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),("auditor"===eL||"Auditor"===eL||eB||eF)&&(0,B.jsxs)("div",{className:"relative",ref:eP,children:[(0,B.jsxs)("button",{onClick:()=>H(!F),className:(0,V.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("span",{className:"truncate",children:ez(S,"Supervisor","supervisores")}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})]}),F&&(0,B.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,B.jsx)("button",{type:"button",onClick:()=>T(es.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),S.length>0&&(0,B.jsx)("button",{type:"button",onClick:()=>T([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),es.map(e=>(0,B.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:S.includes(e.nombre),onChange:()=>eV(e.nombre,T),className:"accent-blue-600"}),(0,B.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]}),(0,B.jsxs)("div",{className:"relative",ref:eI,children:[(0,B.jsxs)("button",{onClick:()=>G(!W),className:(0,V.cn)("w-full flex items-center justify-between px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("span",{className:"truncate",children:ez(C,"Admin","admins")}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})]}),W&&(0,B.jsxs)("div",{className:"absolute z-50 mt-1 w-full max-h-56 overflow-y-auto rounded-lg shadow-lg border bg-white dark:bg-gray-800 dark:border-gray-700",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800",children:[(0,B.jsx)("button",{type:"button",onClick:()=>A(ei.map(e=>e.nombre)),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Seleccionar todos"}),C.length>0&&(0,B.jsx)("button",{type:"button",onClick:()=>A([]),className:"text-xs text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Limpiar"})]}),ei.map(e=>(0,B.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:C.includes(e.nombre),onChange:()=>eV(e.nombre,A),className:"accent-blue-600"}),(0,B.jsx)("span",{className:"dark:text-gray-200",children:e.nombre})]},e._id))]})]})]}),(0,B.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:(0,V.cn)("text-xs block mb-1","dark"===s?"text-gray-400":"text-gray-500"),children:"Desde"}),(0,B.jsx)("input",{type:"date",value:p,onChange:e=>f(e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:(0,V.cn)("text-xs block mb-1","dark"===s?"text-gray-400":"text-gray-500"),children:"Hasta"}),(0,B.jsx)("input",{type:"date",value:g,onChange:e=>x(e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsx)("div",{className:"flex-1"}),(0,B.jsx)("button",{onClick:eH,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===s?"bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30":"bg-cyan-500 text-white hover:bg-cyan-600"),children:"Aplicar filtros"}),(0,B.jsx)("button",{onClick:()=>{m({afiliado:"",cuil:"",obraAnterior:"",obraVendida:"",estado:"",tipo:"",asesor:"",datos:"",auditor:"",supervisor:"",administrador:""}),f(""),x(""),y([]),w([]),j([]),E([]),T([]),A([])},className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===s?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Limpiar"}),!["asesor","supervisor"].includes(n?.role?.toLowerCase()||"")&&(0,B.jsxs)("button",{onClick:()=>{if(!i||0===i.length)return void ea.toast.info("No hay datos para exportar");let e=um(i.map(e=>{let t=e.telefono||"-";if(eM||eU){let r=e.asesor?.numeroEquipo,a=n?.numeroEquipo;r&&a&&r!==a&&(t="***")}return{Fecha:e.scheduledAt?new Date(e.scheduledAt).toLocaleDateString("es-AR"):"-",Hora:e.scheduledAt?new Date(e.scheduledAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"-",Afiliado:e.nombre||"-",CUIL:e.cuil||"-",Teléfono:t,"Obra Social Anterior":e.obraSocialAnterior||"-","Obra Social Vendida":e.obraSocialVendida||"-",Estado:e.status||"-",Tipo:e.tipoVenta||"-",Asesor:e.asesor?.nombre||"-",Supervisor:uH(e),Grupo:e.groupId?.nombre||"-",Auditor:e.auditor?.nombre||"-",Administrador:e.administrador?.nombre||"-","¿Recuperada?":e.isRecuperada?"Sí":"No"}})),t=up();uf(t,e,"Auditorías");let r=new Date().toISOString().slice(0,10);uc(t,`audits_${p||r}.xlsx`),ea.toast.success("Exportado correctamente")},className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2",style:{backgroundColor:"#17C787"},children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),"Exportar"]}),(0,B.jsxs)("button",{onClick:()=>{ep(!0),eq(ey)},className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2","bg-purple-600 hover:bg-purple-700"),children:[(0,B.jsx)(Q.Calendar,{className:"w-4 h-4"}),"Turnos"]}),(eM||eB)&&(0,B.jsxs)("button",{onClick:()=>{eN(!0),eY(eC)},className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white flex items-center gap-2","bg-indigo-600 hover:bg-indigo-700"),children:[(0,B.jsx)(iL.BarChart3,{className:"w-4 h-4"}),"Estadísticas"]})]})]}),i.length>0&&(e={},t=0,i.forEach(r=>{let a=r.status||"Sin estado";e[a]=(e[a]||0)+1,r.isRecuperada&&t++}),r=i.length,a=Object.entries(e).sort((e,t)=>t[1]-e[1]),(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-3 mb-4","dark"===s?"bg-gradient-to-r from-blue-900/20 to-indigo-900/20 border-blue-700/30":"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"),children:(0,B.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[(0,B.jsxs)("span",{className:(0,V.cn)("font-bold","dark"===s?"text-gray-200":"text-gray-800"),children:["Total: ",(0,B.jsx)("span",{className:"dark"===s?"text-blue-400":"text-blue-600",children:r})]}),a.map(([e,t])=>(0,B.jsxs)("span",{className:"dark"===s?"text-gray-300":"text-gray-700",children:[(0,B.jsxs)("span",{className:"font-semibold",children:[e,":"]})," ",(0,B.jsx)("span",{className:"dark"===s?"text-indigo-400":"text-indigo-600",children:t})]},e)),t>0&&(0,B.jsxs)("span",{className:"dark"===s?"text-gray-300":"text-gray-700",children:[(0,B.jsx)("span",{className:"font-semibold",children:"Recuperadas:"})," ",(0,B.jsx)("span",{className:"dark"===s?"text-green-400":"text-green-600",children:t})]})]})})),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border overflow-hidden","dark"===s?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-xs",children:[(0,B.jsx)("thead",{className:(0,V.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===s?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,B.jsxs)("tr",{children:[(0,B.jsx)("th",{className:"px-2 py-2 w-[120px]",children:"Fecha"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[150px]",children:"Afiliado"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"CUIL"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"Teléfono"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ant"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ven"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[120px]",children:"Estado"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"Tipo"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Asesor"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Supervisor"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[60px]",children:"Grupo"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Auditor"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Admin"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[80px] text-center",children:"Recup."}),(0,B.jsx)("th",{className:"px-2 py-2 w-[80px] text-center",children:"Acciones"})]})}),(0,B.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:l?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:15,className:"px-4 py-8 text-center opacity-50",children:(0,B.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando auditorías..."]})})}):0===i.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:15,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron auditorías"})}):i.map((e,t)=>{var r;let a;return(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors group",((e,t)=>{if(!e)return"";let r={"mensaje enviado":{light:"bg-cyan-50 hover:bg-cyan-100",dark:"bg-cyan-900/20 hover:bg-cyan-900/30"},"en videollamada":{light:"bg-blue-100 hover:bg-blue-200",dark:"bg-blue-900/30 hover:bg-blue-900/40"},"falta documentación":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},"falta clave":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},reprogramada:{light:"bg-violet-50 hover:bg-violet-100",dark:"bg-violet-900/20 hover:bg-violet-900/30"},"reprogramada (falta confirmar hora)":{light:"bg-violet-50 hover:bg-violet-100",dark:"bg-violet-900/20 hover:bg-violet-900/30"},completa:{light:"bg-lime-100 hover:bg-lime-200",dark:"bg-lime-900/30 hover:bg-lime-900/40"},"qr hecho":{light:"bg-green-100 hover:bg-green-200",dark:"bg-green-900/30 hover:bg-green-900/40"},aprobada:{light:"bg-teal-100 hover:bg-teal-200",dark:"bg-teal-900/30 hover:bg-teal-900/40"},"aprobada, pero no reconoce clave":{light:"bg-yellow-100 hover:bg-yellow-200",dark:"bg-yellow-900/30 hover:bg-yellow-900/40"},"no atendió":{light:"bg-yellow-50 hover:bg-yellow-100",dark:"bg-yellow-900/20 hover:bg-yellow-900/30"},"tiene dudas":{light:"bg-pink-50 hover:bg-pink-100",dark:"bg-pink-900/20 hover:bg-pink-900/30"},"falta clave y documentación":{light:"bg-orange-50 hover:bg-orange-100",dark:"bg-orange-900/20 hover:bg-orange-900/30"},"no le llegan los mensajes":{light:"bg-purple-50 hover:bg-purple-100",dark:"bg-purple-900/20 hover:bg-purple-900/30"},cortó:{light:"bg-yellow-50 hover:bg-yellow-100",dark:"bg-yellow-900/20 hover:bg-yellow-900/30"},autovinculación:{light:"bg-amber-100 hover:bg-amber-200",dark:"bg-amber-900/30 hover:bg-amber-900/40"},caída:{light:"bg-red-100 hover:bg-red-200",dark:"bg-red-900/30 hover:bg-red-900/40"},pendiente:{light:"bg-gray-100 hover:bg-gray-200",dark:"bg-gray-700/30 hover:bg-gray-700/40"},"rehacer vídeo":{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"},rechazada:{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"},"baja remuneración":{light:"bg-red-50 hover:bg-red-100",dark:"bg-red-900/20 hover:bg-red-900/30"}}[e.toLowerCase()];return r?"dark"===t?r.dark:r.light:""})(e.status,s)||(t%2==0?"":"dark"===s?"bg-white/[0.02]":"bg-gray-50/50")),children:[(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-2.5 text-center","dark"===s?"text-gray-400":"text-gray-600"),children:"qr hecho"===(e.status||"").toLowerCase()&&e.fechaCreacionQR?(0,B.jsxs)("div",{className:"flex flex-col items-center",children:[(0,B.jsx)("span",{className:"text-purple-500 font-medium",children:(e=>{if(!e)return"-";let t=e.split("T")[0];if(!t)return"-";let[r,a,s]=t.split("-");return r&&a&&s?`${s}/${a}/${r}`:"-"})(e.fechaCreacionQR)}),(0,B.jsx)("span",{className:"text-[10px] text-gray-400",children:"(QR)"})]}):(e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`})(e.scheduledAt)}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center font-medium truncate max-w-[150px]",title:e.nombre,children:e.nombre}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center font-mono opacity-70 truncate",children:e.cuil||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center font-mono opacity-70 truncate",children:(eM||eU)&&e.asesor?.numeroEquipo!==n?.numeroEquipo?"***":e.telefono}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center truncate max-w-[80px]",title:e.obraSocialAnterior,children:e.obraSocialAnterior||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,B.jsx)("span",{className:(0,V.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[80px]",uz(e.obraSocialVendida,s)),children:e.obraSocialVendida})}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,B.jsx)("span",{className:(0,V.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px]",(r=e.status,a=({"mensaje enviado":{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-500/20 text-cyan-400"},"en videollamada":{light:"bg-blue-600 text-white",dark:"bg-blue-500/30 text-blue-300"},"falta documentación":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"falta clave":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},reprogramada:{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},"reprogramada (falta confirmar hora)":{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-400"},completa:{light:"bg-lime-600 text-white",dark:"bg-lime-500/30 text-lime-300"},"qr hecho":{light:"bg-green-600 text-white",dark:"bg-green-500/30 text-green-300"},aprobada:{light:"bg-teal-600 text-white",dark:"bg-teal-500/30 text-teal-300"},"no atendió":{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},"tiene dudas":{light:"bg-pink-100 text-pink-800",dark:"bg-pink-500/20 text-pink-400"},"falta clave y documentación":{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-400"},"no le llegan los mensajes":{light:"bg-purple-100 text-purple-800",dark:"bg-purple-500/20 text-purple-400"},cortó:{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-400"},autovinculación:{light:"bg-amber-700 text-white",dark:"bg-amber-500/30 text-amber-300"},caída:{light:"bg-red-600 text-white",dark:"bg-red-500/30 text-red-300"},pendiente:{light:"bg-gray-200 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"rehacer vídeo":{light:"bg-red-300 text-red-900",dark:"bg-red-500/20 text-red-400"},rechazada:{light:"bg-red-100 text-red-700",dark:"bg-red-500/20 text-red-400"},"aprobada, pero no reconoce clave":{light:"bg-yellow-600 text-white",dark:"bg-yellow-500/30 text-yellow-300"}})[(r||"").toLowerCase()]||{light:"bg-gray-100 text-gray-700",dark:"bg-gray-500/20 text-gray-400"},"dark"===s?a.dark:a.light)),title:e.status,children:e.status})}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:e.tipoVenta||"-"}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 text-center","dark"===s?"text-gray-300":"text-gray-700"),children:e.asesor?.nombre||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-[10px] font-medium truncate max-w-[120px] inline-block",((e,t)=>{if(!e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=e.toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";if(r.includes("belen")&&r.includes("salaverry"))return"dark"===t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800";if(r.includes("analia")&&r.includes("suarez"))return"dark"===t?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800";if(r.includes("erika")&&r.includes("cardozo"))return"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800";if(r.includes("aryel")&&r.includes("puiggros"))return"dark"===t?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800";if(r.includes("joaquin")&&r.includes("valdez")||r.includes("joquin")&&r.includes("valdez"))return"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800";if(r.includes("luciano")&&r.includes("carugno"))return"dark"===t?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800";if(r.includes("alejandro")&&r.includes("mejail"))return"dark"===t?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800";if(r.includes("gaston")&&r.includes("sarmiento"))return"dark"===t?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-900 text-rose-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-900 text-indigo-200"}],s=0;for(let t=0;t<e.length;t++)s=e.charCodeAt(t)+((s<<5)-s);let n=Math.abs(s)%a.length,i=a[n];return"dark"===t?i.dark:i.light})(uH(e),s)),title:uH(e),children:uH(e)})}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,B.jsx)("span",{className:(0,V.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-semibold truncate max-w-[60px]","dark"===s?"bg-indigo-900 text-indigo-200":"bg-indigo-100 text-indigo-800"),children:e.asesor?.numeroEquipo||"-"})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 text-center","dark"===s?"text-gray-400":"text-gray-600"),children:e.auditor?.nombre||"-"}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 text-center","dark"===s?"text-gray-400":"text-gray-600"),children:e.administrador?.nombre||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:e.isRecuperada?(0,B.jsx)("span",{className:"inline-flex items-center justify-center px-2 py-1 rounded text-[10px] font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"Sí"}):(0,B.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-1 transition-opacity",children:[!eU&&(0,B.jsx)("button",{onClick:()=>{ec(e),eh(!0)},className:"p-1 hover:bg-blue-100 text-blue-600 rounded dark:hover:bg-blue-900/30 dark:text-blue-400",title:"Editar",children:(0,B.jsx)(eS,{className:"w-3 h-3"})}),(eF||eB)&&(0,B.jsx)("button",{onClick:()=>eG(e._id),className:"p-1 hover:bg-red-100 text-red-600 rounded dark:hover:bg-red-900/30 dark:text-red-400",title:"Eliminar",children:(0,B.jsx)(eu.Trash2,{className:"w-3 h-3"})})]})})]},e._id)})})]})})}),el&&ed&&(0,iZ.createPortal)((0,B.jsx)(uM,{isOpen:ed,onClose:()=>{eh(!1),ec(null)},audit:el,onSave:e=>{o(t=>t.map(t=>t._id===e._id?e:t)),eh(!1),ec(null)}}),document.body),em&&(0,B.jsx)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-20 p-4 bg-black/50 backdrop-blur-sm",children:(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] overflow-hidden flex flex-col","dark"===s?"bg-gray-900 border border-white/10":"bg-white"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-4 border-b","dark"===s?"border-gray-700 bg-purple-900/20":"border-gray-200 bg-gradient-to-r from-purple-50 to-blue-50"),children:[(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:"bg-purple-600 p-2 rounded-lg",children:(0,B.jsx)(Q.Calendar,{className:"w-6 h-6 text-white"})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-xl font-semibold","dark"===s?"text-white":"text-gray-800"),children:"Turnos Disponibles"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-500"),children:"Consulta la disponibilidad de turnos por fecha"})]})]}),(0,B.jsx)("button",{className:(0,V.cn)("p-2 rounded-lg transition","dark"===s?"hover:bg-gray-800":"hover:bg-gray-100"),onClick:()=>ep(!1),children:(0,B.jsx)(ee.X,{className:(0,V.cn)("w-6 h-6","dark"===s?"text-gray-400":"text-gray-600")})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 border-b","dark"===s?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-2","dark"===s?"text-gray-300":"text-gray-700"),children:"Seleccionar fecha:"}),(0,B.jsx)("input",{type:"date",value:ey,onChange:e=>{var t;ev(t=e.target.value),eq(t)},className:(0,V.cn)("p-2 border rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent","dark"===s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 border-b","dark"===s?"bg-blue-900/20 border-gray-700":"bg-blue-50 border-gray-200"),children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs font-semibold mb-2","dark"===s?"text-gray-300":"text-gray-700"),children:"Leyenda de disponibilidad:"}),(0,B.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:"w-4 h-4 rounded bg-green-100 border border-green-300"}),(0,B.jsx)("span",{className:"dark"===s?"text-gray-300":"",children:"5-10 cupos disponibles"})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:"w-4 h-4 rounded bg-yellow-100 border border-yellow-300"}),(0,B.jsx)("span",{className:"dark"===s?"text-gray-300":"",children:"3-4 cupos disponibles"})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:"w-4 h-4 rounded bg-orange-100 border border-orange-300"}),(0,B.jsx)("span",{className:"dark"===s?"text-gray-300":"",children:"1-2 cupos disponibles"})]}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("div",{className:"w-4 h-4 rounded bg-red-100 border border-red-300"}),(0,B.jsx)("span",{className:"dark"===s?"text-gray-300":"",children:"Turno completo"})]})]})]}),(0,B.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:ex?(0,B.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,B.jsx)(J.RefreshCw,{className:"w-12 h-12 animate-spin text-purple-600"}),(0,B.jsx)("span",{className:(0,V.cn)("ml-3","dark"===s?"text-gray-400":"text-gray-600"),children:"Cargando turnos..."})]}):0===ef.length?(0,B.jsx)("div",{className:(0,V.cn)("text-center py-12","dark"===s?"text-gray-400":"text-gray-500"),children:(0,B.jsx)("p",{children:"No hay turnos disponibles para esta fecha."})}):(0,B.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:ef.map(e=>{let t,r=10-e.count,a=r<=0;return(0,B.jsxs)("div",{className:`p-4 rounded-lg border-2 transition-all ${(t=10-e.count)<=0?"bg-red-100 text-red-800 border-red-300":t>=1&&t<=2?"bg-orange-100 text-orange-800 border-orange-300":t>=3&&t<=4?"bg-yellow-100 text-yellow-800 border-yellow-300":"bg-green-100 text-green-800 border-green-300"} ${a?"opacity-60":"hover:shadow-md"}`,children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,B.jsx)("span",{className:"text-lg font-bold",children:e.time}),a&&(0,B.jsx)(ee.X,{className:"w-5 h-5"})]}),(0,B.jsxs)("div",{className:"text-xs space-y-1",children:[(0,B.jsxs)("div",{className:"flex justify-between",children:[(0,B.jsx)("span",{className:"text-gray-600",children:"Pactadas:"}),(0,B.jsxs)("span",{className:"font-semibold",children:[e.count,"/10"]})]}),(0,B.jsxs)("div",{className:"flex justify-between",children:[(0,B.jsx)("span",{className:"text-gray-600",children:"Disponibles:"}),(0,B.jsx)("span",{className:"font-bold",children:Math.max(0,r)})]})]}),a&&(0,B.jsx)("div",{className:"mt-2 text-xs font-semibold text-center",children:"COMPLETO"})]},e.time)})})}),(0,B.jsxs)("div",{className:(0,V.cn)("p-4 border-t flex justify-between items-center","dark"===s?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-50"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)("span",{className:"font-semibold",children:"Total de turnos:"})," ",ef.length,(0,B.jsx)("span",{className:"ml-4 font-semibold",children:"Auditorías pactadas:"})," ",ef.reduce((e,t)=>e+t.count,0)]}),(0,B.jsx)("button",{className:"px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700 transition",onClick:()=>ep(!1),children:"Cerrar"})]})]})}),ew&&(0,B.jsx)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-20 p-4 bg-black/50 backdrop-blur-sm",children:(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl shadow-2xl w-full max-w-2xl max-h-[85vh] overflow-hidden flex flex-col","dark"===s?"bg-gray-900 border border-white/10":"bg-white"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center justify-between p-5 border-b","dark"===s?"border-gray-700 bg-indigo-900/20":"border-gray-200 bg-gradient-to-r from-indigo-50 to-purple-50"),children:[(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:"bg-indigo-600 p-2 rounded-lg",children:(0,B.jsx)(iL.BarChart3,{className:"w-6 h-6 text-white"})}),(0,B.jsxs)("div",{children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-xl font-semibold","dark"===s?"text-white":"text-gray-800"),children:"Estadísticas de Contactación"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-500"),children:"Afiliados contactados por obra social anterior"})]})]}),(0,B.jsx)("button",{className:(0,V.cn)("p-2 rounded-lg transition","dark"===s?"hover:bg-gray-800":"hover:bg-gray-100"),onClick:()=>eN(!1),children:(0,B.jsx)(ee.X,{className:(0,V.cn)("w-6 h-6","dark"===s?"text-gray-400":"text-gray-600")})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("p-5 border-b","dark"===s?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"),children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-2","dark"===s?"text-gray-300":"text-gray-700"),children:"Seleccionar fecha:"}),(0,B.jsx)("input",{type:"date",value:eC,onChange:e=>{var t;eA(t=e.target.value),eY(t)},className:(0,V.cn)("p-2 border rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent","dark"===s?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300")})]}),(0,B.jsx)("div",{className:"flex-1 overflow-y-auto p-5",children:eE?(0,B.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,B.jsx)(J.RefreshCw,{className:"w-12 h-12 animate-spin text-indigo-600"}),(0,B.jsx)("span",{className:(0,V.cn)("ml-3","dark"===s?"text-gray-400":"text-gray-600"),children:"Cargando estadísticas..."})]}):0===ej.length?(0,B.jsx)("div",{className:(0,V.cn)("text-center py-12","dark"===s?"text-gray-400":"text-gray-500"),children:(0,B.jsx)("p",{className:"font-medium",children:"No hay contactaciones registradas para esta fecha."})}):(0,B.jsx)("div",{className:"space-y-3",children:ej.map((e,t)=>{let r=ej.reduce((e,t)=>e+t.count,0),a=(e.count/r*100).toFixed(1),n=["#4F46E5","#7C3AED","#2563EB","#6B7280"];return(0,B.jsxs)("div",{className:(0,V.cn)("rounded-lg p-4 border-l-4 hover:shadow-md transition","dark"===s?"bg-gradient-to-r from-gray-800 to-gray-700":"bg-gradient-to-r from-white to-gray-50"),style:{borderLeftColor:n[t%n.length]},children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("div",{className:(0,V.cn)("flex items-center justify-center w-8 h-8 rounded-full font-bold text-sm","dark"===s?"bg-indigo-900 text-indigo-300":"bg-indigo-100 text-indigo-700"),children:t+1}),(0,B.jsx)("div",{children:(0,B.jsx)("span",{className:`font-semibold text-base ${uz(e.obraSocial,s)} px-3 py-1 rounded-full inline-block`,children:e.obraSocial})})]}),(0,B.jsxs)("div",{className:"text-right",children:[(0,B.jsx)("div",{className:(0,V.cn)("text-2xl font-bold","dark"===s?"text-indigo-400":"text-indigo-600"),children:e.count}),(0,B.jsx)("div",{className:(0,V.cn)("text-xs","dark"===s?"text-gray-400":"text-gray-500"),children:"contactaciones"})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("w-full rounded-full h-2 mt-2","dark"===s?"bg-gray-600":"bg-gray-200"),children:(0,B.jsx)("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:{width:`${a}%`}})}),(0,B.jsxs)("div",{className:(0,V.cn)("text-xs mt-1 text-right","dark"===s?"text-gray-400":"text-gray-600"),children:[a,"% del total"]})]},e.obraSocial)})})}),(0,B.jsxs)("div",{className:(0,V.cn)("p-5 border-t flex justify-between items-center","dark"===s?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-50"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("text-sm","dark"===s?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)("span",{className:"font-semibold",children:"Total contactaciones:"})," ",ej.reduce((e,t)=>e+t.count,0),(0,B.jsx)("span",{className:"ml-4 font-semibold",children:"Obras sociales:"})," ",ej.length]}),(0,B.jsx)("button",{className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition",onClick:()=>eN(!1),children:"Cerrar"})]})]})})]})}let u$=["OSDE","OSDEPYM","IOMA","OSSEG","OSDE 210","OSFATUN","OSDE GBA","OSECAC (126205)","OSPRERA","OMINT","OSSEGUR","OSPR","OSUTHGRA (108803)","OSBLYCA","UOM","OSPM","OSPECON (105408)","Elevar (114307)","OSCHOCA (105804)","OSPEP (113908)","OSPROTURA","OSPSIP (119708)","OSEIV (122401)","OSPIF (108100)","OSIPA (114208)","OSPESESGYPE (107206)","OSTCARA (126007)","OSPIT (121002)","OSMP (111209)","OSPECA (103709)","OSPIQYP (118705)","OSBLYCA (102904)","VIASANO (2501)","OSPCYD (103402)","OSUOMRA (112103)","OSAMOC (3405)","OSPAGA (101000)","OSPF (107404)","OSPIP (116006)","OSPIC","OSG (109202)","OSPERYH (106500)","OSPCRA (104009)"],uG=["Binimed","Meplife","TURF"],uq=["alta","cambio"];function uY(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),r=(0,U.useRef)(null),a=t?.role?.toLowerCase()==="supervisor",s=["gerencia","auditor"].includes(t?.role?.toLowerCase()||""),[n,i]=(0,U.useState)({nombre:"",cuil:"",telefono:"",tipoVenta:"alta",obraSocialAnterior:"",obraSocialVendida:"Binimed",fecha:"",hora:"",supervisor:"",asesor:"",validador:"",datosExtra:""}),[o,l]=(0,U.useState)([]),[c,d]=(0,U.useState)([]),[h,u]=(0,U.useState)([]),[m,p]=(0,U.useState)([]),[f,g]=(0,U.useState)(!1),[x,b]=(0,U.useState)(!1),[y,v]=(0,U.useState)(!1),[w,N]=(0,U.useState)(!1),[j,k]=(0,U.useState)({current:0,total:0}),[E,S]=(0,U.useState)([]);(0,U.useEffect)(()=>{s&&T()},[s]),(0,U.useEffect)(()=>{n.supervisor?A(n.supervisor):a&&C()},[n.supervisor,a]),(0,U.useEffect)(()=>{console.log("Validadores useEffect triggered:",{otroEquipo:f,asesor:n.asesor,user:t?.nombre,numeroEquipo:t?.numeroEquipo,isSupervisor:a}),f?_():O()},[f,n.asesor,t,a]),(0,U.useEffect)(()=>{n.fecha&&D(n.fecha)},[n.fecha]),(0,U.useEffect)(()=>{let e=sessionStorage.getItem("prefillAudit");if(e)try{let t=JSON.parse(e);i(e=>({...e,nombre:t.nombre||"",cuil:t.cuil||"",telefono:t.telefono||"",obraSocialAnterior:t.obraSocialAnterior||"",datosExtra:t.localidad?`Localidad: ${t.localidad}`:""})),sessionStorage.removeItem("prefillAudit"),ea.toast.info("Datos precargados desde Lead Management")}catch(e){console.error("Error parsing prefill data",e)}},[]);let T=async()=>{try{let{data:e}=await er.api.users.list(),t=Array.isArray(e)?e:[];d(t.filter(e=>e.role?.toLowerCase()==="supervisor"&&!1!==e.active))}catch(e){console.error(e)}},C=async()=>{try{let{data:e}=await er.api.users.list("scope=group"),r=Array.isArray(e)?e:[],s=t?.numeroEquipo,n=r.filter(e=>{let t=!1!==e.active,r=e.nombre&&e.nombre.trim().length>0,n=["asesor","auditor","supervisor"].includes(e.role?.toLowerCase()),i=!a||!s||String(e.numeroEquipo)===String(s);return t&&r&&n&&i}).sort((e,t)=>e.nombre.localeCompare(t.nombre));l(n)}catch(e){console.error(e),ea.toast.error("Error al cargar asesores")}},A=async e=>{try{let{data:t}=await er.api.users.list(),r=Array.isArray(t)?t:[],a=r.find(t=>t._id===e);if(!a?.numeroEquipo)return void l([]);let s=r.filter(e=>{let t=!1!==e.active,r=e.nombre&&e.nombre.trim().length>0,s=["asesor","auditor","supervisor"].includes(e.role?.toLowerCase()),n=String(e.numeroEquipo)===String(a.numeroEquipo);return t&&r&&s&&n}).sort((e,t)=>e.nombre.localeCompare(t.nombre));l(s),R(a.numeroEquipo,r)}catch(e){console.error(e),ea.toast.error("Error al cargar asesores del equipo")}},R=(e,t)=>{u(t.filter(t=>{let r=!1!==t.active,a=t.nombre&&t.nombre.trim().length>0,s=String(t.numeroEquipo)===String(e);return r&&a&&s}).sort((e,t)=>e.nombre.localeCompare(t.nombre)))},O=async()=>{try{let e=t?.numeroEquipo;if(s){if(!n.supervisor)return void u([]);let t=c.find(e=>e._id===n.supervisor);t&&(e=t.numeroEquipo)}if(console.log("loadValidadores called",{role:t?.role,userTeam:t?.numeroEquipo,targetTeam:e,supervisor:n.supervisor}),!e){console.log("No targetNumeroEquipo, setting validadores to empty"),u([]);return}let{data:r}=await er.api.users.list("scope=group"),i=(Array.isArray(r)?r:[]).filter(r=>{let s=!1!==r.active,i=r.nombre&&r.nombre.trim().length>0,o=String(r.numeroEquipo)===String(e),l=!n.asesor||r._id!==n.asesor,c=a||r._id!==t?._id;return s&&i&&o&&l&&c}).sort((e,t)=>e.nombre.localeCompare(t.nombre));console.log("Filtered validadores:",i.length,"users from team",e),u(i)}catch(e){console.error("Error loading validadores:",e)}},_=async()=>{try{let{data:e}=await er.api.users.list("includeAllAuditors=true"),t=(Array.isArray(e)?e:[]).filter(e=>{let t=!1!==e.active,r=e.nombre&&e.nombre.trim().length>0,a=["asesor","supervisor","auditor","gerencia"].includes(e.role?.toLowerCase()),s=!n.asesor||e._id!==n.asesor;return t&&r&&a&&s}).sort((e,t)=>e.nombre.localeCompare(t.nombre));u(t)}catch(e){console.error(e)}},D=async e=>{try{v(!0);let{data:t}=await er.api.audits.getAvailableSlots(e);p(Array.isArray(t)?t:[])}catch(e){console.error(e),p([])}finally{v(!1)}},P=(0,U.useMemo)(()=>{let e=(()=>{let e=[],t=new Date;t.setHours(9,20,0,0);let r=new Date;r.setHours(23,0,0,0);let a=new Date(t);for(;a<=r;){let t=String(a.getHours()).padStart(2,"0"),r=String(a.getMinutes()).padStart(2,"0");e.push(`${t}:${r}`),a.setMinutes(a.getMinutes()+20)}return e})(),t={};return Array.isArray(m)&&m.forEach(e=>{t[e.time]=e.count}),e.map(e=>({time:e,disabled:(t[e]||0)>=10}))},[m]),I=(e,t)=>{i(r=>({...r,[e]:t}))},L=async e=>{e.preventDefault();let t=n.nombre.trim()?/^\d{11}$/.test(n.cuil)?n.telefono&&!/^\d{10}$/.test(n.telefono.replace(/\D/g,""))?"Teléfono debe tener 10 dígitos":n.fecha?n.hora?n.asesor?n.validador?s&&!n.supervisor?"Supervisor es requerido":null:"Validador es requerido":"Asesor es requerido":"Hora es requerida":"Fecha es requerida":"CUIL debe tener exactamente 11 dígitos":"Nombre es requerido";if(t)return void ea.toast.error(t);try{b(!0);let e=new Date(`${n.fecha}T${n.hora}:00`),t={nombre:n.nombre,cuil:n.cuil,telefono:n.telefono,tipoVenta:n.tipoVenta,obraSocialAnterior:n.obraSocialAnterior,obraSocialVendida:n.obraSocialVendida,scheduledAt:e.toISOString(),asesor:n.asesor,validador:n.validador,datosExtra:n.datosExtra,status:"Pendiente"};n.supervisor&&(t.supervisor=n.supervisor),await er.api.audits.create(t),ea.toast.success("Auditoría creada exitosamente"),i({nombre:"",cuil:"",telefono:"",tipoVenta:"alta",obraSocialAnterior:"",obraSocialVendida:"Binimed",fecha:"",hora:"",supervisor:"",asesor:"",validador:"",datosExtra:""})}catch(t){console.error("Full error:",t),console.error("Error response:",t.response),console.error("Error response data:",JSON.stringify(t.response?.data,null,2)),console.error("Error status:",t.response?.status),t.response?.data?.error&&(console.error("Error details:",JSON.stringify(t.response.data.error,null,2)),console.error("Error code:",t.response.data.error.code),console.error("Error message:",t.response.data.error.message),console.error("Error traceId:",t.response.data.error.traceId),console.error("Error details array:",t.response.data.error.details));let e="Error al crear auditoría";t.response?.data?.error?"string"==typeof t.response.data.error?e=t.response.data.error:"object"==typeof t.response.data.error&&t.response.data.error.message&&(e=t.response.data.error.message):t.response?.data?.message?e=t.response.data.message:t.message&&(e=t.message),ea.toast.error(e)}finally{b(!1)}},M=async e=>{let t=e.target.files?.[0];if(t)try{N(!0),k({current:0,total:0}),S([]);let{accepted:e,rejected:r}=(await er.api.audits.bulkUpload(t)).data;ea.toast.success(`${e} auditor\xedas creadas exitosamente`),r&&r.length>0&&(S(r),ea.toast.warning(`${r.length} filas rechazadas`))}catch(e){console.error(e),ea.toast.error(e.response?.data?.message||"Error en carga masiva")}finally{N(!1),r.current&&(r.current.value="")}};return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Pautar Auditoría / Venta"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Crear nuevo turno de auditoría"})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsx)("input",{ref:r,type:"file",accept:".xlsx,.xls,.csv",onChange:M,className:"hidden"}),(0,B.jsxs)("button",{onClick:()=>r.current?.click(),disabled:w,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",w?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-green-500 text-white hover:bg-green-600"),children:[w?(0,B.jsx)(eT,{className:"w-4 h-4 animate-spin"}):(0,B.jsx)(el.Upload,{className:"w-4 h-4"}),"Carga Masiva"]})]})]}),E.length>0&&(0,B.jsx)("div",{className:(0,V.cn)("rounded-xl border p-4","dark"===e?"bg-red-500/10 border-red-500/20":"bg-red-50 border-red-200"),children:(0,B.jsxs)("div",{className:"flex items-start gap-3",children:[(0,B.jsx)(ek,{className:"w-5 h-5 text-red-500 mt-0.5"}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold text-sm mb-2","dark"===e?"text-red-400":"text-red-700"),children:["Filas rechazadas (",E.length,")"]}),(0,B.jsxs)("div",{className:"space-y-1 text-xs",children:[E.slice(0,5).map((t,r)=>(0,B.jsxs)("div",{className:"dark"===e?"text-red-300":"text-red-600",children:["Fila ",t.row,": ",t.reason]},r)),E.length>5&&(0,B.jsxs)("div",{className:"text-gray-500",children:["... y ",E.length-5," más"]})]}),(0,B.jsx)("button",{onClick:()=>S([]),className:"mt-2 text-xs underline hover:no-underline",children:"Cerrar"})]})]})}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6 backdrop-blur-sm max-w-2xl mx-auto","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,B.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Nombre de afiliado ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsx)("input",{type:"text",value:n.nombre,onChange:e=>I("nombre",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),required:!0})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["CUIL ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsx)("input",{type:"text",placeholder:"11 dígitos",value:n.cuil,onChange:e=>I("cuil",e.target.value.replace(/\D/g,"")),maxLength:11,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),required:!0})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Teléfono"}),(0,B.jsx)("input",{type:"tel",value:n.telefono,onChange:e=>I("telefono",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Tipo de venta"}),(0,B.jsx)("select",{value:n.tipoVenta,onChange:e=>I("tipoVenta",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:uq.map(e=>(0,B.jsx)("option",{value:e,children:e},e))})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Obra social vendida"}),(0,B.jsx)("select",{value:n.obraSocialVendida,onChange:e=>I("obraSocialVendida",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:uG.map(e=>(0,B.jsx)("option",{value:e,children:e},e))})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Obra social anterior"}),(0,B.jsxs)("select",{value:n.obraSocialAnterior,onChange:e=>I("obraSocialAnterior",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"-- Seleccionar --"}),u$.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Fecha (día) ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsx)("input",{type:"date",value:n.fecha,onChange:e=>I("fecha",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Hora (turno) ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsxs)("select",{value:n.hora,onChange:e=>I("hora",e.target.value),disabled:y,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,B.jsx)("option",{value:"",children:"-- Seleccionar --"}),P.map(({time:e,disabled:t})=>(0,B.jsxs)("option",{value:e,disabled:t,children:[e," ",t?"(lleno)":""]},e))]})]})]}),s&&(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Supervisor ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsxs)("select",{value:n.supervisor,onChange:e=>I("supervisor",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,B.jsx)("option",{value:"",children:"-- Seleccionar supervisor --"}),c.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Asesor ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsxs)("select",{value:n.asesor,onChange:e=>I("asesor",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,B.jsx)("option",{value:"",children:"-- Seleccionar asesor --"}),o.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]}),s&&!n.supervisor&&(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-1","dark"===e?"text-cyan-400":"text-cyan-600"),children:"Primero selecciona un supervisor"})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:["Validador ",(0,B.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,B.jsxs)("select",{value:n.validador,onChange:e=>I("validador",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),required:!0,children:[(0,B.jsx)("option",{value:"",children:"-- Seleccionar validador --"}),h.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombre," (",e.role,")"]},e._id))]}),(0,B.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,B.jsx)("input",{type:"checkbox",id:"otroEquipo",checked:f,onChange:e=>g(e.target.checked),className:"w-4 h-4 rounded"}),(0,B.jsx)("label",{htmlFor:"otroEquipo",className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:"Pertenece a otro equipo"})]}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-1","text-gray-500"),children:"Selecciona un compañero de tu equipo que validará la venta"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Datos extra (opcional)"}),(0,B.jsx)("textarea",{placeholder:"Ejemplo: Afiliado con familiares, enfermedad preexistente, observaciones...",value:n.datosExtra,onChange:e=>I("datosExtra",e.target.value),rows:3,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,B.jsxs)("button",{type:"submit",disabled:x,className:(0,V.cn)("w-full px-6 py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",x?"opacity-50 cursor-not-allowed":"","bg-gradient-to-r from-cyan-500 to-teal-500 text-white hover:from-cyan-600 hover:to-teal-600"),children:[x?(0,B.jsx)(eT,{className:"w-4 h-4 animate-spin"}):(0,B.jsx)(G.Send,{className:"w-4 h-4"}),x?"Creando...":"Crear Auditoría"]})]})})]})}let uX=["Falta documentación","Falta clave","Falta clave y documentación","Completa","Rechazó","QR hecho","Aprobada","Aprobada, pero no reconoce clave","Cortó","Autovinculación","Caída","Pendiente","Cargada","Contactado"],uK=["Binimed","Meplife","TURF"];function uQ({audit:t,onClose:r,onSave:a}){let{theme:s}=(0,z.useTheme)(),{user:n}=(0,iT.useAuth)(),i="Cargada"===t.status,[o,l]=(0,U.useState)({nombre:t.nombre||"",cuil:t.cuil||"",telefono:t.telefono||"",obraSocialVendida:t.obraSocialVendida||"",status:t.status||"Pendiente",administrador:"object"==typeof t.administrador?t.administrador?._id:t.administrador||"",datosExtra:t.datosExtra||""}),[c,d]=(0,U.useState)(!1),[h,u]=(0,U.useState)(!1),[m,p]=(0,U.useState)([]);(0,U.useEffect)(()=>{(async()=>{try{let{data:e}=await er.api.users.list(),t=(Array.isArray(e)?e:[]).filter(e=>"administrativo"===e.role&&!1!==e.active);p(t)}catch(e){console.error("Error loading admins:",e)}})()},[]);let f=async e=>{if(e.preventDefault(),!o.nombre||!o.cuil||!o.telefono||!o.obraSocialVendida||!o.status)return void ea.toast.error("Por favor complete todos los campos obligatorios");d(!0);try{let e={...o};(""===o.administrador||"Seleccione"===o.administrador)&&(e.administrador=null);let{data:s}=await er.api.audits.update(t._id,e);ea.toast.success("Recuperación actualizada correctamente"),a(s),r()}catch(e){console.error(e),ea.toast.error(e.response?.data?.message||"Error al actualizar")}finally{d(!1)}},g=async()=>{if(confirm("¿Estás seguro de que deseas ELIMINAR esta recuperación? Esta acción no se puede deshacer.")){u(!0);try{await er.api.audits.delete(t._id),ea.toast.success("Recuperación eliminada correctamente"),a(null,t._id),r()}catch(e){console.error(e),ea.toast.error(e.response?.data?.message||"Error al eliminar")}finally{u(!1)}}},[x,b]=(0,U.useState)(!1);if((0,U.useEffect)(()=>(b(!0),()=>b(!1)),[]),!x)return null;let{createPortal:y}=e.r(56667);return y((0,B.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-[9999] p-4 animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl border","dark"===s?"bg-gray-900 border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"sticky top-0 z-10 bg-gradient-to-r from-purple-600 to-blue-600 p-6 flex justify-between items-center text-white",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:"text-xl font-bold",children:"Editar Recuperación"}),(0,B.jsxs)("p",{className:"text-sm text-purple-100 mt-1 opacity-90",children:[t.nombre," - ",t.cuil]})]}),(0,B.jsx)("button",{onClick:r,className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("form",{onSubmit:f,className:"p-6 space-y-6",children:[(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-xl text-sm space-y-3","dark"===s?"bg-white/5":"bg-gray-50"),children:[(0,B.jsx)("h3",{className:"font-semibold opacity-70",children:"📋 Información Original"}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:"opacity-60 block text-xs",children:"Asesor original"}),(0,B.jsx)("span",{className:"font-medium",children:t.asesor?.nombre||t.asesor?.email||"-"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:"opacity-60 block text-xs",children:"Supervisor original"}),(0,B.jsx)("span",{className:"font-medium",children:t.asesor?.supervisor?.nombre||"-"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:"opacity-60 block text-xs",children:"Grupo original"}),(0,B.jsx)("span",{className:"font-medium",children:t.asesor?.numeroEquipo||"-"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("span",{className:"opacity-60 block text-xs",children:"Fecha inicio"}),(0,B.jsx)("span",{className:"font-medium",children:t.scheduledAt?new Date(t.scheduledAt).toLocaleDateString("es-AR"):"-"})]})]})]}),(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Nombre *"}),(0,B.jsx)("input",{type:"text",value:o.nombre,onChange:e=>l({...o,nombre:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200"),required:!0})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"CUIL *"}),(0,B.jsx)("input",{type:"text",value:o.cuil,onChange:e=>l({...o,cuil:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200"),required:!0})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Teléfono *"}),(0,B.jsx)("input",{type:"text",value:o.telefono,onChange:e=>l({...o,telefono:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200"),required:!0})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Obra Social Vendida *"}),(0,B.jsxs)("select",{value:o.obraSocialVendida,onChange:e=>l({...o,obraSocialVendida:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200"),required:!0,children:[(0,B.jsx)("option",{value:"",children:"Seleccionar..."}),uK.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Estado *"}),(0,B.jsx)("select",{value:o.status,onChange:e=>l({...o,status:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200"),required:!0,children:uX.map(e=>{let t=("Aprobada"===e||"Aprobada, pero no reconoce clave"===e)&&!i;return(0,B.jsxs)("option",{value:e,disabled:t,children:[e," ",t?"(req. Cargada)":""]},e)})})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Administrador (opcional)"}),(0,B.jsxs)("select",{value:o.administrador,onChange:e=>l({...o,administrador:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200"),children:[(0,B.jsx)("option",{value:"",children:"Sin asignar"}),m.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre||e.email},e._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Datos Extra / Notas"}),(0,B.jsx)("textarea",{value:o.datosExtra,onChange:e=>l({...o,datosExtra:e.target.value}),rows:3,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===s?"bg-black/20 border-white/10 text-white":"bg-white border-gray-200")})]})]}),(0,B.jsxs)("div",{className:"flex justify-between items-center pt-6 border-t border-gray-200 dark:border-white/10",children:[(0,B.jsxs)("button",{type:"button",onClick:g,disabled:h||c,className:"flex items-center gap-2 px-4 py-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-sm font-medium",children:[(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"}),h?"Eliminando...":"Eliminar"]}),(0,B.jsxs)("div",{className:"flex gap-3",children:[(0,B.jsx)("button",{type:"button",onClick:r,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===s?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Cancelar"}),(0,B.jsxs)("button",{type:"submit",disabled:c||h,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg text-sm font-medium transition-all shadow-lg shadow-purple-500/20",children:[(0,B.jsx)(eh.Save,{className:"w-4 h-4"}),c?"Guardando...":"Guardar Cambios"]})]})]})]})]})}),document.body)}let uJ={Pendiente:{bg:"bg-gray-100",text:"text-gray-700",darkBg:"bg-gray-500/20",darkText:"text-gray-400"},"Falta clave":{bg:"bg-yellow-100",text:"text-yellow-700",darkBg:"bg-yellow-500/20",darkText:"text-yellow-400"},Rechazada:{bg:"bg-red-100",text:"text-red-700",darkBg:"bg-red-500/20",darkText:"text-red-400"},Completa:{bg:"bg-green-100",text:"text-green-700",darkBg:"bg-green-500/20",darkText:"text-green-400"},"QR hecho":{bg:"bg-blue-100",text:"text-blue-700",darkBg:"bg-blue-500/20",darkText:"text-blue-400"}};function uZ(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!0),[n,i]=(0,U.useState)({afiliado:"",cuil:"",obraSocialVendida:"",estado:"",fechaDesde:"",fechaHasta:""}),[o,l]=(0,U.useState)(!1),[c,d]=(0,U.useState)(null),h=async()=>{try{s(!0);let{data:e}=await er.api.audits.list({ignoreDate:!0});r(Array.isArray(e)?e:[])}catch(e){console.error(e),ea.toast.error("Error al cargar recuperaciones")}finally{s(!1)}};(0,U.useEffect)(()=>{h()},[]);let u=(0,U.useMemo)(()=>{let e=["Falta clave","Falta documentación","Falta clave y documentación","Pendiente"];return t.filter(t=>!!e.includes(t.status)&&(!n.afiliado||!!t.nombre?.toLowerCase().includes(n.afiliado.toLowerCase()))&&(!n.cuil||!!t.cuil?.includes(n.cuil))&&(!n.obraSocialVendida||t.obraSocialVendida===n.obraSocialVendida)&&(!n.estado||t.status===n.estado)&&(!n.fechaDesde||!(new Date(t.statusUpdatedAt||t.scheduledAt||t.createdAt).toISOString().split("T")[0]<n.fechaDesde))&&(!n.fechaHasta||!(new Date(t.statusUpdatedAt||t.scheduledAt||t.createdAt).toISOString().split("T")[0]>n.fechaHasta))&&!0).sort((e,t)=>new Date(e.scheduledAt||e.createdAt).getTime()-new Date(t.scheduledAt||t.createdAt).getTime())},[t,n]);return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6 backdrop-blur-sm","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,B.jsx)(i0,{className:(0,V.cn)("w-5 h-5","dark"===e?"text-purple-400":"text-purple-500")}),(0,B.jsx)("h3",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Filtros"})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-3",children:[(0,B.jsx)("input",{type:"text",placeholder:"Buscar afiliado...",value:n.afiliado,onChange:e=>i({...n,afiliado:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,B.jsx)("input",{type:"text",placeholder:"Buscar CUIL...",value:n.cuil,onChange:e=>i({...n,cuil:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")}),(0,B.jsxs)("select",{value:n.obraSocialVendida,onChange:e=>i({...n,obraSocialVendida:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todas las Obras Sociales"}),(0,B.jsx)("option",{value:"Binimed",children:"Binimed"}),(0,B.jsx)("option",{value:"Meplife",children:"Meplife"}),(0,B.jsx)("option",{value:"TURF",children:"TURF"})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[(0,B.jsxs)("select",{value:n.estado,onChange:e=>i({...n,estado:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todos los Estados"}),(0,B.jsx)("option",{value:"Pendiente",children:"Pendiente"}),(0,B.jsx)("option",{value:"Falta clave",children:"Falta clave"}),(0,B.jsx)("option",{value:"Rechazada",children:"Rechazada"}),(0,B.jsx)("option",{value:"Completa",children:"Completa"})]}),(0,B.jsx)("input",{type:"date",placeholder:"Desde",value:n.fechaDesde,onChange:e=>i({...n,fechaDesde:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,B.jsx)("input",{type:"date",placeholder:"Hasta",value:n.fechaHasta,onChange:e=>i({...n,fechaHasta:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,B.jsx)("button",{onClick:()=>{i({afiliado:"",cuil:"",obraSocialVendida:"",estado:"",fechaDesde:"",fechaHasta:""})},className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","dark"===e?"bg-white/10 hover:bg-white/20 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:"Limpiar"})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-xs",children:[(0,B.jsx)("thead",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:(0,B.jsx)("tr",{children:["TIEMPO","INICIO","AFILIADO","CUIL","TELÉFONO","O.SOCIAL","ASESOR","SUPERVISOR","GRUPO","ADMIN","ESTADO",""].map(t=>(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-3 text-left font-semibold whitespace-nowrap","dark"===e?"text-gray-300":"text-gray-700"),children:t},t))})}),(0,B.jsx)("tbody",{children:a?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:12,className:"px-4 py-8 text-center opacity-50",children:(0,B.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando..."]})})}):0===u.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:12,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron recuperaciones"})}):u.map((t,r)=>{var a;let s,n,i,o,c,h=uJ[t.status]||uJ.Pendiente,u=(a=t.statusUpdatedAt||t.scheduledAt||t.createdAt,s=new Date,n=new Date(a),(o=Math.floor((i=Math.floor((s.getTime()-n.getTime())/36e5))/24))>0?`${o}d ${i%24}h`:`${i}h`),m=(c=parseInt(u))<16?"text-green-500":c<20?"text-yellow-500":c<24?"text-orange-500":"text-red-500";return(0,B.jsxs)("tr",{className:(0,V.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)(ep.Clock,{className:(0,V.cn)("w-4 h-4",m)}),(0,B.jsx)("span",{className:(0,V.cn)("font-medium",m),children:u})]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 whitespace-nowrap","dark"===e?"text-gray-300":"text-gray-700"),children:t.scheduledAt?new Date(t.scheduledAt).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit"}):"-"}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 font-medium","dark"===e?"text-white":"text-gray-800"),children:t.nombre}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 whitespace-nowrap","dark"===e?"text-gray-400":"text-gray-600"),children:t.cuil}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 whitespace-nowrap","dark"===e?"text-cyan-400":"text-cyan-600"),children:t.telefono}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded text-xs font-medium","Binimed"===t.obraSocialVendida?"dark"===e?"bg-green-500/20 text-green-300":"bg-green-100 text-green-700":"dark"===e?"bg-pink-500/20 text-pink-300":"bg-pink-100 text-pink-700"),children:t.obraSocialVendida})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 whitespace-nowrap","dark"===e?"text-gray-300":"text-gray-700"),children:t.asesor?.nombre||"-"}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded text-xs font-medium","dark"===e?"bg-cyan-500/20 text-cyan-300":"bg-cyan-100 text-cyan-700"),children:t.asesor?.supervisor?.nombre||"-"})}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded text-xs font-medium","dark"===e?"bg-orange-500/20 text-orange-300":"bg-orange-100 text-orange-700"),children:t.asesor?.numeroEquipo||"-"})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 whitespace-nowrap","dark"===e?"text-gray-400":"text-gray-600"),children:t.administrador?.nombre||"-"}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded text-xs font-medium whitespace-nowrap","dark"===e?h.darkBg:h.bg,"dark"===e?h.darkText:h.text),children:t.status})}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("button",{onClick:()=>{d(t),l(!0)},className:(0,V.cn)("p-1.5 rounded-lg transition-colors","dark"===e?"hover:bg-purple-500/20 text-purple-400":"hover:bg-purple-50 text-purple-600"),children:(0,B.jsx)(eS,{className:"w-4 h-4"})})})]},t._id)})})]})})}),o&&c&&(0,B.jsx)(uQ,{audit:c,onClose:()=>l(!1),onSave:(e,t)=>{t?r(e=>e.filter(e=>e._id!==t)):e&&r(t=>t.map(t=>t._id===e._id?e:t))}})]})}let u0=["Binimed","Meplife","TURF"],u1=e=>e.supervisorSnapshot?.nombre?e.supervisorSnapshot.nombre:e.asesor?.supervisor?.nombre?e.asesor.supervisor.nombre:"-",u2=e=>{if(!e)return"-";let t=e.split("T")[0];if(!t)return"-";let[r,a,s]=t.split("-");return r&&a&&s?`${s}/${a}/${r}`:"-"};function u5(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),r=t?.role?.toLowerCase()==="gerencia",[a,s]=(0,U.useState)([]),[n,i]=(0,U.useState)(!0),[o,l]=(0,U.useState)(1),[c,d]=(0,U.useState)(!1),[h,u]=(0,U.useState)(!1),[m,p]=(0,U.useState)(""),[f,g]=(0,U.useState)(""),[x,b]=(0,U.useState)(!0),[y,v]=(0,U.useState)({afiliado:"",cuil:"",asesor:"",supervisor:"",auditor:"",administrador:"",obraSocialVendida:"",estado:"",dateFrom:"",dateTo:"",dateField:"fechaCreacionQR"}),[w,N]=(0,U.useState)([]),[j,k]=(0,U.useState)([]),[E,S]=(0,U.useState)([]),[T,C]=(0,U.useState)([]),A=async(e=!1)=>{try{i(!0);let t=e?{...y,dateField:"fechaCreacionQR"}:{},{data:r}=await er.api.liquidation.list(t);s(Array.isArray(r)?r:[])}catch(e){console.error(e),ea.toast.error("Error al cargar datos")}finally{i(!1)}},R=async()=>{try{let{data:e}=await er.api.users.list(),t=Array.isArray(e)?e:[];N(t.filter(e=>e.role?.toLowerCase()==="asesor")),k(t.filter(e=>e.role?.toLowerCase()==="supervisor")),S(t.filter(e=>e.role?.toLowerCase()==="auditor")),C(t.filter(e=>e.role?.toLowerCase()==="admin"))}catch(e){console.error(e)}};(0,U.useEffect)(()=>{A(),R();let e=(0,iy.connectSocket)();e.emit("audits:subscribeAll"),console.log("[Liquidación] Subscribed to audits_all room");let t=e=>{console.log("[Socket] New audit received:",e._id),s(t=>{if(t.some(t=>t._id===e._id))return t;let r=[e,...t];return["Cargada","Aprobada","QR hecho"].includes(e.status)&&ea.toast.info(`Nueva venta en liquidaci\xf3n: ${e.nombre}`,{duration:3e3}),r})},r=e=>{console.log("[Socket] Audit update received:",e._id),s(t=>{let r=t.findIndex(t=>t._id===e._id);if(-1===r)return[e,...t];let a=[...t];return a[r]={...t[r],...e},a})},a=e=>{console.log("[Socket] Audit deleted:",e._id),s(t=>t.filter(t=>t._id!==e._id))};return e.on("audits:new",t),e.on("audit:update",r),e.on("audit:deleted",a),()=>{e.off("audits:new",t),e.off("audit:update",r),e.off("audit:deleted",a),e.emit("audits:unsubscribeAll"),console.log("[Liquidación] Unsubscribed from audits_all room")}},[]);let O=(0,U.useMemo)(()=>{let e={};return a.forEach(t=>{let r,a,s,n,i;if(!["Cargada","Aprobada","QR hecho"].includes(t.status))return;let o=(a=(r=new Date(new Date("QR hecho"===t.status&&t.fechaCreacionQR||t.scheduledAt||t.createdAt))).getDay(),s=r.getHours(),n=r.getMinutes(),4===a&&(s>23||23===s&&n>=1)&&(r.setDate(r.getDate()+1),r.setHours(0,0,0,0)),i=r.getDay(),r.setDate(r.getDate()-(5===i?0:6===i?1:0===i?2:i+2)),r.setHours(0,0,0,0),r).toISOString().split("T")[0];e[o]||(e[o]=[]),e[o].push(t)}),Object.entries(e).sort((e,t)=>new Date(t[0]).getTime()-new Date(e[0]).getTime()).map(([e,t])=>({start:e,items:t}))},[a]),_=(0,U.useMemo)(()=>{let e=a.filter(e=>["Cargada","Aprobada","QR hecho"].includes(e.status));return(e=y.dateFrom||y.dateTo?e.filter(e=>{let t=new Date("QR hecho"===e.status&&e.fechaCreacionQR||e.scheduledAt).toISOString().split("T")[0];return(!y.dateFrom||!(t<y.dateFrom))&&(!y.dateTo||!(t>y.dateTo))}):O[o-1]?.items||[]).filter(e=>(!y.afiliado||!!e.nombre?.toLowerCase().includes(y.afiliado.toLowerCase()))&&(!y.cuil||!!e.cuil?.includes(y.cuil))&&(!y.asesor||e.asesor?._id===y.asesor)&&(!y.supervisor||e.asesor?.supervisor?._id===y.supervisor)&&(!y.auditor||e.auditor?._id===y.auditor)&&(!y.administrador||e.administrador?._id===y.administrador)&&(!y.obraSocialVendida||e.obraSocialVendida===y.obraSocialVendida)&&(!y.estado||e.status===y.estado)&&!0).sort((e,t)=>new Date(t.scheduledAt).getTime()-new Date(e.scheduledAt).getTime())},[a,O,o,y]),D=async()=>{try{console.log("📊 Exportando liquidación...",y);let e=await er.api.liquidation.export(y);console.log("📊 Respuesta:",e.data instanceof Blob?"Blob válido":"ERROR: No es Blob");let t=e.data instanceof Blob?e.data:new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.setAttribute("download",`liquidacion_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(r),console.log("✅ Descarga completada"),ea.toast.success("Archivo exportado correctamente")}catch(e){console.error("❌ Error al exportar:",e),ea.toast.error("Error al exportar")}},P=(0,U.useMemo)(()=>{let e=_.filter(e=>"QR hecho"===e.status),t=_.filter(e=>"Cargada"===e.status),r=_.filter(e=>"Aprobada"===e.status),a={};e.forEach(e=>{let t="-"===u1(e)?"Sin supervisor":u1(e);a[t]=(a[t]||0)+1});let s=Object.entries(a).map(([e,t])=>({name:e,count:t})).sort((e,t)=>t.count-e.count);return{qr:e.length,cargada:t.length,aprobada:r.length,total:_.length,supervisorStats:s}},[_]),I=async()=>{try{u(!0);let e=await er.api.audits.recalculateSupervisors({dateFrom:m||void 0,dateTo:f||void 0,onlyMissing:x});ea.toast.success(`Recalculaci\xf3n completada: ${e.data.success} exitosos, ${e.data.errors} errores`),d(!1),A()}catch(e){console.error("Error recalculating supervisors:",e),ea.toast.error(e.response?.data?.error||"Error al recalcular supervisores")}finally{u(!1)}};return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 shadow-sm","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex flex-col md:flex-row justify-between gap-4 mb-6",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Liquidación (QR Hecho)"}),(0,B.jsx)("p",{className:"text-sm opacity-60",children:"Semana laboral: Viernes a Jueves"})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[r&&(0,B.jsxs)("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium",children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4"}),"Recalcular Supervisores"]}),(0,B.jsxs)("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),"Exportar Excel"]})]})]}),!y.dateFrom&&!y.dateTo&&O.length>0&&(0,B.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-white/5 p-3 rounded-xl mb-4",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)("span",{className:"text-sm font-medium",children:"Semana:"}),(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)("button",{onClick:()=>l(Math.max(1,o-1)),disabled:1===o,className:"p-1 hover:bg-gray-200 dark:hover:bg-white/10 rounded disabled:opacity-50",children:"←"}),(0,B.jsx)("span",{className:"px-3 py-1 bg-purple-600 text-white rounded text-sm font-bold",children:o}),(0,B.jsx)("button",{onClick:()=>l(Math.min(O.length,o+1)),disabled:o===O.length,className:"p-1 hover:bg-gray-200 dark:hover:bg-white/10 rounded disabled:opacity-50",children:"→"})]}),(0,B.jsxs)("span",{className:"text-xs opacity-60",children:["de ",O.length]})]}),(0,B.jsxs)("div",{className:"flex gap-3 text-xs font-medium",children:[(0,B.jsxs)("span",{className:"px-2 py-1 bg-green-500/20 text-green-600 rounded",children:["QR: ",P.qr]}),(0,B.jsxs)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-600 rounded",children:["Cargada: ",P.cargada]}),(0,B.jsxs)("span",{className:"px-2 py-1 bg-teal-500/20 text-teal-600 rounded",children:["Aprobada: ",P.aprobada]})]})]}),P.supervisorStats.length>0&&(0,B.jsx)("div",{className:(0,V.cn)("p-3 rounded-xl text-xs mb-4","dark"===e?"bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-white/10":"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-100"),children:(0,B.jsxs)("div",{className:"flex flex-wrap gap-x-3 gap-y-1",children:[(0,B.jsxs)("span",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["QR Hechos: ",P.qr]}),(0,B.jsx)("span",{className:"opacity-50",children:"|"}),P.supervisorStats.map((t,r)=>(0,B.jsxs)("span",{className:"dark"===e?"text-gray-300":"text-gray-700",children:[t.name,": ",(0,B.jsx)("span",{className:"dark"===e?"text-cyan-400":"text-cyan-600",children:t.count}),r<P.supervisorStats.length-1&&(0,B.jsx)("span",{className:"ml-2 opacity-50",children:"|"})]},t.name))]})}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3",children:[(0,B.jsx)("input",{placeholder:"Buscar afiliado...",value:y.afiliado,onChange:e=>v({...y,afiliado:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,B.jsx)("input",{placeholder:"Buscar CUIL...",value:y.cuil,onChange:e=>v({...y,cuil:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,B.jsxs)("select",{value:y.asesor,onChange:e=>v({...y,asesor:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,B.jsx)("option",{value:"",children:"Todos los Asesores"}),w.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]}),(0,B.jsxs)("select",{value:y.supervisor,onChange:e=>v({...y,supervisor:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,B.jsx)("option",{value:"",children:"Todos los Supervisores"}),j.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3 mb-3",children:[(0,B.jsxs)("select",{value:y.auditor,onChange:e=>v({...y,auditor:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,B.jsx)("option",{value:"",children:"Todos los Auditores"}),E.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]}),(0,B.jsxs)("select",{value:y.administrador,onChange:e=>v({...y,administrador:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,B.jsx)("option",{value:"",children:"Todos los Administradores"}),T.map(e=>(0,B.jsx)("option",{value:e._id,children:e.nombre},e._id))]}),(0,B.jsxs)("select",{value:y.obraSocialVendida,onChange:e=>v({...y,obraSocialVendida:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,B.jsx)("option",{value:"",children:"Todas las Obras Sociales"}),u0.map(e=>(0,B.jsx)("option",{value:e,children:e},e))]}),(0,B.jsxs)("select",{value:y.estado,onChange:e=>v({...y,estado:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white"),children:[(0,B.jsx)("option",{value:"",children:"Todos los Estados"}),(0,B.jsx)("option",{value:"QR hecho",children:"QR hecho"}),(0,B.jsx)("option",{value:"Cargada",children:"Cargada"}),(0,B.jsx)("option",{value:"Aprobada",children:"Aprobada"})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,B.jsx)("input",{type:"date",placeholder:"Fecha desde",value:y.dateFrom,onChange:e=>v({...y,dateFrom:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,B.jsx)("input",{type:"date",placeholder:"Fecha hasta",value:y.dateTo,onChange:e=>v({...y,dateTo:e.target.value}),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-black/20 border-white/10":"bg-white")}),(0,B.jsx)("button",{onClick:()=>A(!0),className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm transition-colors",children:"Buscar"}),(0,B.jsx)("button",{onClick:()=>{v({afiliado:"",cuil:"",asesor:"",supervisor:"",auditor:"",administrador:"",obraSocialVendida:"",estado:"",dateFrom:"",dateTo:"",dateField:"fechaCreacionQR"}),setTimeout(()=>A(!1),0)},className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-white/10 dark:hover:bg-white/20 rounded-lg text-sm transition-colors",children:"Limpiar Filtros"})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border shadow-sm overflow-hidden","dark"===e?"bg-white/5 border-white/10":"bg-white border-gray-200"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-xs",children:[(0,B.jsx)("thead",{className:(0,V.cn)("text-left font-semibold uppercase tracking-wider sticky top-0 z-10","dark"===e?"bg-gray-900 text-gray-300":"bg-gray-50 text-gray-600"),children:(0,B.jsxs)("tr",{children:[(0,B.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"Fecha"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[150px]",children:"Afiliado"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[100px]",children:"CUIL"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[80px]",children:"O.S. Ven"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Asesor"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Supervisor"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Auditor"}),(0,B.jsx)("th",{className:"px-2 py-2 min-w-[100px]",children:"Admin"}),(0,B.jsx)("th",{className:"px-2 py-2 w-[60px] text-center",children:"Recup."})]})}),(0,B.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-white/5",children:n?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:9,className:"px-4 py-8 text-center opacity-50",children:(0,B.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4 animate-spin"}),"Cargando..."]})})}):0===_.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:9,className:"px-4 py-8 text-center opacity-50",children:"No se encontraron registros"})}):_.map((t,r)=>(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-gray-50",r%2==0?"":"dark"===e?"bg-white/[0.02]":"bg-gray-50/50"),children:[(0,B.jsx)("td",{className:"px-2 py-1.5 whitespace-nowrap opacity-70",children:t.fechaCreacionQR?u2(t.fechaCreacionQR):t.scheduledAt?u2(t.scheduledAt):"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 font-medium truncate max-w-[150px]",title:t.nombre,children:t.nombre}),(0,B.jsx)("td",{className:"px-2 py-1.5 font-mono opacity-70 truncate",children:t.cuil}),(0,B.jsx)("td",{className:"px-2 py-1.5",children:(0,B.jsx)("span",{className:"inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 truncate max-w-[80px]",children:t.obraSocialVendida})}),(0,B.jsx)("td",{className:"px-2 py-1.5 truncate max-w-[100px]",title:t.asesor?.nombre,children:t.asesor?.nombre||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5",children:(0,B.jsx)("span",{className:(0,V.cn)("inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium truncate max-w-[100px]",((e,t)=>{if(!e)return"dark"===t?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-700";let r=0;for(let t=0;t<e.length;t++)r=e.charCodeAt(t)+((r<<5)-r);let a=[{light:"bg-red-100 text-red-800",dark:"bg-red-500/20 text-red-300"},{light:"bg-orange-100 text-orange-800",dark:"bg-orange-500/20 text-orange-300"},{light:"bg-amber-100 text-amber-800",dark:"bg-amber-500/20 text-amber-300"},{light:"bg-yellow-100 text-yellow-800",dark:"bg-yellow-500/20 text-yellow-300"},{light:"bg-lime-100 text-lime-800",dark:"bg-lime-500/20 text-lime-300"},{light:"bg-green-100 text-green-800",dark:"bg-green-500/20 text-green-300"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-500/20 text-emerald-300"},{light:"bg-teal-100 text-teal-800",dark:"bg-teal-500/20 text-teal-300"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-500/20 text-cyan-300"},{light:"bg-sky-100 text-sky-800",dark:"bg-sky-500/20 text-sky-300"},{light:"bg-blue-100 text-blue-800",dark:"bg-blue-500/20 text-blue-300"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-500/20 text-indigo-300"},{light:"bg-violet-100 text-violet-800",dark:"bg-violet-500/20 text-violet-300"},{light:"bg-purple-100 text-purple-800",dark:"bg-purple-500/20 text-purple-300"},{light:"bg-fuchsia-100 text-fuchsia-800",dark:"bg-fuchsia-500/20 text-fuchsia-300"},{light:"bg-pink-100 text-pink-800",dark:"bg-pink-500/20 text-pink-300"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-500/20 text-rose-300"}],s=Math.abs(r)%a.length,n=a[s];return"dark"===t?n.dark:n.light})(u1(t),e)),title:u1(t),children:u1(t)})}),(0,B.jsx)("td",{className:"px-2 py-1.5 truncate max-w-[100px]",title:t.auditor?.nombre,children:t.auditor?.nombre||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 truncate max-w-[100px]",title:t.administrador?.nombre,children:t.administrador?.nombre||"-"}),(0,B.jsx)("td",{className:"px-2 py-1.5 text-center",children:t.isRecuperada?(0,B.jsx)(uS,{className:"w-3 h-3 text-green-500 mx-auto"}):(0,B.jsx)("span",{className:"text-gray-300 dark:text-gray-700",children:"-"})})]},t._id))})]})})}),c&&(0,B.jsx)(u4,{children:(0,B.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-2xl","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Recalcular Supervisores"}),(0,B.jsx)("button",{onClick:()=>d(!1),className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsx)("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20 text-blue-600 dark:text-blue-400 text-sm",children:"Esta acción recalculará el supervisor asignado a cada venta basándose en la fecha de la venta y el historial de equipos de los asesores."}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Desde"}),(0,B.jsx)("input",{type:"date",value:m,onChange:e=>p(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Hasta"}),(0,B.jsx)("input",{type:"date",value:f,onChange:e=>g(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:x,onChange:e=>b(e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-purple-600 focus:ring-purple-600"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"Solo ventas sin supervisor asignado (snapshot)"})]})]}),(0,B.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,B.jsx)("button",{onClick:()=>d(!1),className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,B.jsxs)("button",{onClick:I,disabled:h,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",h?"bg-purple-600/50 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"),children:[h&&(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4 animate-spin"}),h?"Recalculando...":"Confirmar"]})]})]})})})]})}function u4({children:t}){let[r,a]=(0,U.useState)(!1);if((0,U.useEffect)(()=>(a(!0),()=>a(!1)),[]),!r)return null;let{createPortal:s}=e.r(56667);return s(t,document.body)}var u3=e.i(42410),u6=e.i(44126);let u8=(0,Y.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),u7=(0,Y.default)("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),u9=(0,Y.default)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),me=(0,Y.default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);function mt(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)(!0),[a,s]=(0,U.useState)([]),[n,i]=(0,U.useState)([]),[o,l]=(0,U.useState)(""),[c,d]=(0,U.useState)(""),[h,u]=(0,U.useState)(""),[m,p]=(0,U.useState)({auditsWeek:0,auditsMonth:0,auditsPrevMonth:0,auditsTotal:0,salesWeek:0,salesMonth:0,salesMaxWeek:0,salesMaxMonth:0,salesIncomplete:0}),[f,g]=(0,U.useState)(!1);(0,U.useEffect)(()=>{x()},[]),(0,U.useEffect)(()=>{h?b(h):p({auditsWeek:0,auditsMonth:0,auditsPrevMonth:0,auditsTotal:0,salesWeek:0,salesMonth:0,salesMaxWeek:0,salesMaxMonth:0,salesIncomplete:0})},[h]);let x=async()=>{try{r(!0);let[e,t]=await Promise.all([er.api.employees.list(),er.api.users.list()]);s(e.data),i(t.data||[]);let a=e.data.find(e=>e.activo);a&&u(a._id)}catch(e){console.error("Error fetching employees:",e),ea.toast.error("Error al cargar empleados")}finally{r(!1)}},b=async e=>{let t=a.find(t=>t._id===e);if(t&&t.userId)try{g(!0);let e=t.userId._id,r=(t.userId.role||"").toLowerCase(),a="supervisor"===r,s=t.userId.numeroEquipo,n=await er.api.audits.list({userId:e}),i=Array.isArray(n.data)?n.data:[],o=[];if(a&&s)try{let e=await er.api.users.list(),t=(Array.isArray(e.data)?e.data:[]).filter(e=>e.numeroEquipo===s).map(e=>er.api.audits.list({userId:e._id}).then(t=>(Array.isArray(t.data)?t.data:[]).filter(t=>(t.asesor?._id||t.asesor)===e._id)).catch(t=>(console.error(`Error fetching audits for ${e.nombre}:`,t),[])));o=(await Promise.all(t)).flat()}catch(e){console.error("Error fetching team sales for supervisor:",e),o=[]}let l=e=>{let t=new Date(e),r=t.getDay(),a=t.getHours(),s=t.getMinutes(),n=new Date(t);n.setDate(t.getDate()-(r<4?r+3:r-4)),n.setHours(23,1,0,0),(r<4||4===r&&(a<23||23===a&&s<1))&&n.setDate(n.getDate()-7);let i=new Date(n);return i.setDate(i.getDate()+7),{start:n,end:i}},c=new Date,d=l(c),h=new Date(c.getFullYear(),c.getMonth(),1),u=new Date(c.getFullYear(),c.getMonth()+1,0,23,59,59),m=new Date(c.getFullYear(),c.getMonth()-1,1),f=new Date(c.getFullYear(),c.getMonth(),0,23,59,59),x=i.filter(t=>{let r=t.auditor?._id||t.auditor,a=(t.status||"").toLowerCase();return r===e&&"qr hecho"===a}),b=x.filter(e=>{let t=new Date(e.scheduledAt||e.createdAt);return t>=d.start&&t<d.end}).length,y=x.filter(e=>{let t=new Date(e.scheduledAt||e.createdAt);return t>=h&&t<=u}).length,v=x.filter(e=>{let t=new Date(e.scheduledAt||e.createdAt);return t>=m&&t<=f}).length,w=x.length,N=a?o:i,j=N.filter(t=>{let r=(t.status||"").toLowerCase();return a?"qr hecho"===r:(t.asesor?._id||t.asesor)===e&&"qr hecho"===r}),k=N.filter(t=>!!a||(t.asesor?._id||t.asesor)===e),E=j.filter(e=>{let t=new Date(e.scheduledAt||e.createdAt);return t>=d.start&&t<d.end}).length,S=new Map;j.forEach(e=>{let t=new Date(e.scheduledAt||e.createdAt),r=l(t).start.toISOString();S.set(r,(S.get(r)||0)+1)});let T=S.size>0?Math.max(...Array.from(S.values())):0,C=new Map;j.forEach(e=>{let t=new Date(e.scheduledAt||e.createdAt),r=`${t.getFullYear()}-${t.getMonth()}`;C.set(r,(C.get(r)||0)+1)});let A=C.size>0?Math.max(...Array.from(C.values())):0,R=k.filter(e=>{let t=(e.status||"").toLowerCase();return"qr hecho"!==t}).length;p({auditsWeek:b,auditsMonth:y,auditsPrevMonth:v,auditsTotal:w,salesWeek:E,salesMonth:E,salesMaxWeek:T,salesMaxMonth:A,salesIncomplete:R})}catch(e){console.error("Error fetching stats:",e),ea.toast.error("Error al cargar estadísticas del empleado")}finally{g(!1)}},y=a.length,v=a.filter(e=>e.activo).length,w=a.filter(e=>!e.activo).length,N=a.filter(e=>e.firmoContrato).length,j=new Set(a.map(e=>e.cargo)).size,k=[{label:"Total Empleados",value:y,icon:q.Users,color:"#1E88E5"},{label:"Activos",value:v,icon:u3.UserCheck,color:"#17C787"},{label:"Inactivos",value:w,icon:u6.UserX,color:"#C8376B"},{label:"Con Contrato",value:N,icon:u8,color:"#F4C04A"},{label:"Cargos",value:j,icon:u7,color:"#C62FA8"}],E=a.filter(e=>{let t=!o||e.cargo.toLowerCase()===o.toLowerCase(),r=!0;if(c&&e.userId){let t="string"==typeof e.userId?e.userId:e.userId._id,a=n.find(e=>e._id===t);r=a?.numeroEquipo===c}return t&&r&&e.activo}),S=a.find(e=>e._id===h);return t?(0,B.jsx)("div",{className:"flex justify-center py-12",children:(0,B.jsx)(eT,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsx)("div",{className:"flex flex-wrap gap-3",children:k.map((t,r)=>{let a=t.icon;return(0,B.jsxs)("div",{className:(0,V.cn)("flex-1 min-w-[140px] rounded-xl border p-4 flex items-center justify-between","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,B.jsx)("p",{className:(0,V.cn)("text-2xl font-bold","dark"===e?"text-white":"text-gray-800"),style:{color:t.color},children:t.value})]}),(0,B.jsx)(a,{className:"w-6 h-6",style:{color:t.color}})]},r)})}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-lg font-semibold mb-4","dark"===e?"text-white":"text-gray-800"),children:"Estadísticas de Empleados"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mb-4","dark"===e?"text-gray-400":"text-gray-600"),children:"Seleccione un empleado para ver sus estadísticas según su rol"}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("text-xs font-medium flex items-center gap-1 mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)(i0,{className:"w-3 h-3",style:{color:"#1E88E5"}}),"Filtrar por Rol"]}),(0,B.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todos los roles"}),Array.from(new Set(a.map(e=>e.cargo))).map(e=>(0,B.jsx)("option",{value:e,children:e},e))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("text-xs font-medium flex items-center gap-1 mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:[(0,B.jsx)(q.Users,{className:"w-3 h-3",style:{color:"#17C787"}}),"Filtrar por Equipo"]}),(0,B.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todos los equipos"}),Array.from(new Set(n.filter(e=>!1!==e.active&&e.numeroEquipo).map(e=>e.numeroEquipo))).sort().map(e=>(0,B.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs font-medium flex items-center gap-1 mb-1","dark"===e?"text-gray-400":"text-gray-600"),children:"Acciones Rápidas"}),(0,B.jsxs)("button",{onClick:()=>{l(""),d("")},className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors","dark"===e?"bg-[#C8376B]/20 text-[#C8376B] hover:bg-[#C8376B]/30":"bg-[#C8376B]/10 text-[#C8376B] hover:bg-[#C8376B]/20"),children:[(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"}),"Limpiar Filtros"]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-xs font-medium mb-1 block","dark"===e?"text-gray-400":"text-gray-600"),children:"Seleccionar Empleado (filtrado)"}),(0,B.jsxs)("select",{value:h,onChange:e=>u(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccionar..."}),E.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombreCompleto," - ",e.cargo," ",e.numeroEquipo?`(Eq. ${e.numeroEquipo})`:""]},e._id))]})]})]}),S&&(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl border p-4 mb-6","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("font-semibold mb-3","dark"===e?"text-white":"text-gray-800"),children:"Información del Empleado"}),(0,B.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:"Nombre:"}),(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:S.nombreCompleto})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:"Cargo:"}),(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:S.cargo})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:"Equipo:"}),(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:S.numeroEquipo||"-"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:"Fecha de Ingreso:"}),(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:new Date(S.fechaIngreso).toLocaleDateString()})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:"Estado:"}),(0,B.jsx)("p",{className:"font-medium",style:{color:S.activo?"#17C787":"#C8376B"},children:S.activo?"Activo":"Inactivo"})]})]})]}),f&&(0,B.jsx)("div",{className:"flex justify-center py-8",children:(0,B.jsx)(eT,{className:"w-6 h-6 animate-spin text-purple-500"})}),!f&&S&&(0,B.jsxs)("div",{className:"mb-6",children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold mb-3 flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)(iL.BarChart3,{className:"w-4 h-4",style:{color:"#17C787"}}),"Estadísticas de Auditorías"]}),(0,B.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{label:"Auditorías (Semana)",value:m.auditsWeek,color:"#17C787",icon:iL.BarChart3},{label:"Auditorías (Mes)",value:m.auditsMonth,color:"#1E88E5",icon:Q.Calendar},{label:"Auditorías (Mes Anterior)",value:m.auditsPrevMonth,color:"#C62FA8",icon:Q.Calendar},{label:"Total Auditorías",value:m.auditsTotal,color:"#F4C04A",icon:u9}].map((e,t)=>{let r=e.icon;return(0,B.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:`${e.color}15`},children:[(0,B.jsxs)("p",{className:"text-xs flex items-center gap-1 mb-1",style:{color:e.color},children:[(0,B.jsx)(r,{className:"w-3 h-3"}),e.label]}),(0,B.jsx)("p",{className:"text-2xl font-bold",style:{color:e.color},children:e.value})]},t)})})]}),!f&&S&&(0,B.jsxs)("div",{children:[(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold mb-3 flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)(me,{className:"w-4 h-4",style:{color:"#1E88E5"}}),"Estadísticas de Ventas (También Vende)"]}),(0,B.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[{label:"Ventas (Semana)",value:m.salesWeek,color:"#17C787"},{label:"Ventas (Mes)",value:m.salesMonth,color:"#1E88E5"},{label:"Máx. Semanal",value:m.salesMaxWeek,color:"#F4C04A"},{label:"Máx. Mensual",value:m.salesMaxMonth,color:"#C8376B"},{label:"Incompletas/Pendientes",value:m.salesIncomplete,color:"#F4C04A"}].map((e,t)=>(0,B.jsxs)("div",{className:"rounded-xl p-4",style:{backgroundColor:`${e.color}15`},children:[(0,B.jsx)("p",{className:"text-xs mb-1",style:{color:e.color},children:e.label}),(0,B.jsx)("p",{className:"text-2xl font-bold",style:{color:e.color},children:e.value})]},t))})]})]})]})}function mr({userId:e,teamHistory:t=[],currentNumeroEquipo:r,onUpdate:a}){let{theme:s}=(0,z.useTheme)(),{user:n}=(0,iT.useAuth)(),i=n?.role?.toLowerCase()||"",o="gerencia"===i||i.includes("rrhh")||i.includes("rr.hh"),[l,c]=(0,U.useState)(!1),[d,h]=(0,U.useState)(""),[u,m]=(0,U.useState)(""),[p,f]=(0,U.useState)(""),[g,x]=(0,U.useState)(!1),b=async()=>{if(!d||!u)return void ea.toast.error("Equipo y fecha de inicio son requeridos");try{x(!0),await er.api.users.addTeamChange(e,{nuevoEquipo:d,fechaInicio:u,notes:p}),ea.toast.success("Cambio de equipo registrado exitosamente"),c(!1),h(""),m(""),f(""),a()}catch(e){console.error("Error adding team change:",e),ea.toast.error(e.response?.data?.error||"Error al registrar cambio de equipo")}finally{x(!1)}};return(0,B.jsxs)("div",{className:"space-y-3",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)(q.Users,{className:"w-4 h-4 text-purple-500"}),(0,B.jsx)("h4",{className:(0,V.cn)("font-medium","dark"===s?"text-white":"text-gray-800"),children:"Historial de Equipos"})]}),o&&(0,B.jsxs)("button",{onClick:()=>c(!0),className:"flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium bg-purple-600 text-white hover:bg-purple-700 transition-colors",children:[(0,B.jsx)(eE.Plus,{className:"w-3 h-3"}),"Cambiar Equipo"]})]}),0===t.length?(0,B.jsxs)("div",{className:(0,V.cn)("p-4 rounded-lg border text-center text-sm","dark"===s?"bg-white/5 border-white/10 text-gray-400":"bg-gray-50 border-gray-200 text-gray-500"),children:[(0,B.jsx)(ek,{className:"w-5 h-5 mx-auto mb-2 opacity-50"}),"No hay historial de equipos registrado"]}):(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-xs",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:"dark"===s?"bg-white/5":"bg-gray-50",children:[(0,B.jsx)("th",{className:(0,V.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Equipo"}),(0,B.jsx)("th",{className:(0,V.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Desde"}),(0,B.jsx)("th",{className:(0,V.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Hasta"}),(0,B.jsx)("th",{className:(0,V.cn)("px-2 py-2 text-left font-semibold","dark"===s?"text-gray-400":"text-gray-600"),children:"Notas"})]})}),(0,B.jsx)("tbody",{children:t.map(e=>(0,B.jsxs)("tr",{className:(0,V.cn)("border-t","dark"===s?"border-white/5":"border-gray-200"),children:[(0,B.jsx)("td",{className:"px-2 py-2",children:(0,B.jsxs)("span",{className:(0,V.cn)("px-2 py-0.5 rounded text-xs font-medium",e.fechaFin?"dark"===s?"bg-white/10 text-gray-300":"bg-gray-100 text-gray-700":"bg-green-500/20 text-green-600"),children:[e.numeroEquipo," ",!e.fechaFin&&"(Actual)"]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:new Date(e.fechaInicio).toLocaleDateString("es-AR")}),(0,B.jsx)("td",{className:(0,V.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:e.fechaFin?new Date(e.fechaFin).toLocaleDateString("es-AR"):"-"}),(0,B.jsx)("td",{className:(0,V.cn)("px-2 py-2","dark"===s?"text-gray-400":"text-gray-600"),children:e.notes||"-"})]},e._id))})]})}),l&&(0,B.jsx)("div",{className:"fixed inset-0 z-[100] flex items-start justify-center p-4 pt-20 overflow-y-auto",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-md rounded-2xl border p-6 shadow-xl","dark"===s?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-semibold mb-4","dark"===s?"text-white":"text-gray-800"),children:"Cambiar Equipo"}),(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Nuevo Equipo (numeroEquipo) *"}),(0,B.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"Ej: 42",className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Fecha de Inicio *"}),(0,B.jsx)("input",{type:"date",value:u,onChange:e=>m(e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===s?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===s?"text-gray-300":"text-gray-700"),children:"Notas (opcional)"}),(0,B.jsx)("textarea",{rows:2,value:p,onChange:e=>f(e.target.value),placeholder:"Motivo del cambio...",className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===s?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),r&&(0,B.jsxs)("div",{className:"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20 text-yellow-600 dark:text-yellow-500 text-xs",children:["⚠️ El equipo actual (",r,") se cerrará automáticamente el día anterior a la fecha de inicio."]})]}),(0,B.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,B.jsx)("button",{onClick:()=>c(!1),className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===s?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,B.jsx)("button",{onClick:b,disabled:g||!d||!u,className:"px-4 py-2 rounded-lg text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Guardando...":"Confirmar Cambio"})]})]})})]})}let ma={supervisor:"#17C787",auditor:"#1E88E5",asesor:"#F4C04A",admin:"#C62FA8","rr.hh":"#C8376B",gerencia:"#7C3AED"};function ms(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),r=["rr.hh","gerencia"].includes(t?.role?.toLowerCase()||""),[a,s]=(0,U.useState)([]),[n,i]=(0,U.useState)(!0),[o,l]=(0,U.useState)(""),[c,d]=(0,U.useState)(""),[h,u]=(0,U.useState)(!1),[m,p]=(0,U.useState)(null),[f,g]=(0,U.useState)(!1),[x,b]=(0,U.useState)({});(0,U.useEffect)(()=>{y()},[]);let y=async()=>{try{i(!0);let e=(await er.api.employees.list()).data.filter(e=>e.activo);if(s(e),m){let t=e.find(e=>e._id===m._id);t&&p(t)}}catch(e){console.error("Error fetching employees:",e),ea.toast.error("Error al cargar empleados")}finally{i(!1)}},v=async()=>{if(m)try{g(!0),await er.api.employees.update(m._id,x),ea.toast.success("Empleado actualizado correctamente"),m.activo&&!x.activo&&ea.toast.warning("Empleado desactivado. El usuario asociado también ha sido desactivado."),u(!1),y()}catch(e){console.error("Error updating employee:",e),ea.toast.error("Error al actualizar empleado")}finally{g(!1)}},w=async e=>{if(confirm("¿Estás seguro de eliminar este empleado? Esta acción no se puede deshacer."))try{await er.api.employees.delete(e),ea.toast.success("Empleado eliminado"),y()}catch(e){console.error("Error deleting employee:",e),ea.toast.error("Error al eliminar empleado")}},N=a.filter(e=>{let t=e.nombreCompleto.toLowerCase().includes(o.toLowerCase())||e.userId?.email.toLowerCase().includes(o.toLowerCase())||e.userId?.nombre.toLowerCase().includes(o.toLowerCase()),r=e.userId?.numeroEquipo||e.numeroEquipo,a=!c||r===c;return t&&a}).reduce((e,t)=>{let r=t.userId?.numeroEquipo||t.numeroEquipo||"Sin Equipo";return e[r]||(e[r]=[]),e[r].push(t),e},{}),j=a.length,k=a.filter(e=>e.firmoContrato).length,E=new Set(a.map(e=>e.cargo)).size,S=[{label:"Total Activos",value:j,icon:u3.UserCheck,color:"#17C787"},{label:"Con Contrato",value:k,icon:u8,color:"#F4C04A"},{label:"Cargos Distintos",value:E,icon:u7,color:"#C62FA8"}];return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsx)("div",{className:"flex flex-wrap gap-3",children:S.map((t,r)=>{let a=t.icon;return(0,B.jsxs)("div",{className:(0,V.cn)("flex-1 min-w-[140px] rounded-xl border p-4 flex items-center justify-between","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,B.jsx)("p",{className:"text-2xl font-bold",style:{color:t.color},children:t.value})]}),(0,B.jsx)(a,{className:"w-6 h-6",style:{color:t.color}})]},r)})}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center gap-2 mb-4 px-3 py-2 rounded-lg w-fit","bg-[#17C787]/10"),children:[(0,B.jsx)(iW.CheckCircle,{className:"w-4 h-4",style:{color:"#17C787"}}),(0,B.jsx)("span",{className:"text-sm",style:{color:"#17C787"},children:"Mostrando solo personal activo"})]}),(0,B.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,B.jsxs)("div",{className:"flex-1 relative",children:[(0,B.jsx)(iK.Search,{className:(0,V.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,B.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email...",value:o,onChange:e=>l(e.target.value),className:(0,V.cn)("w-full pl-10 pr-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,B.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:(0,V.cn)("px-4 py-2 rounded-lg border text-sm min-w-[180px]","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todos los equipos"}),Object.keys(N).sort().map(e=>(0,B.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})]}),n&&(0,B.jsx)("div",{className:"flex justify-center py-12",children:(0,B.jsx)(J.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}),!n&&0===a.length&&(0,B.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No hay empleados activos registrados."}),!n&&Object.entries(N).map(([t,a])=>(0,B.jsxs)("div",{className:"mb-6",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,B.jsx)(i0,{className:"w-4 h-4",style:{color:"#1E88E5"}}),(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["Equipo ",t]})]}),(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-sm",children:[(0,B.jsx)("thead",{children:(0,B.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["NOMBRE","F. ENTREVISTA","F. INGRESO","CARGO","TELÉFONO","CONTRATO","ACTIVO","ACCIONES"].map(t=>(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-semibold text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:t},t))})}),(0,B.jsx)("tbody",{children:a.map(t=>(0,B.jsxs)("tr",{className:(0,V.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:t.nombreCompleto}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:t.userId?.email})]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.fechaEntrevista?new Date(t.fechaEntrevista).toLocaleDateString():"-"}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.fechaIngreso?new Date(t.fechaIngreso).toLocaleDateString():"-"}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium text-white capitalize",style:{backgroundColor:ma[t.cargo]||"#6B7280"},children:t.cargo})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.telefonoPersonal||"-"}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)(iW.CheckCircle,{className:"w-5 h-5",style:{color:t.firmoContrato?"#17C787":"#C8376B"}})}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:"text-xs font-medium",style:{color:"#17C787"},children:"Sí"})}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("div",{className:"flex items-center gap-2",children:r&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("button",{onClick:()=>{p(t),b({nombreCompleto:t.nombreCompleto,telefonoPersonal:t.telefonoPersonal,fechaEntrevista:t.fechaEntrevista,fechaIngreso:t.fechaIngreso?new Date(t.fechaIngreso).toISOString().split("T")[0]:"",firmoContrato:t.firmoContrato,activo:t.activo,notas:t.notas,fechaBaja:t.fechaBaja?new Date(t.fechaBaja).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],motivoBaja:t.motivoBaja||""}),u(!0)},className:(0,V.cn)("p-1 rounded hover:bg-white/10 transition-colors","dark"===e?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:(0,B.jsx)(eS,{className:"w-4 h-4"})}),(0,B.jsx)("button",{onClick:()=>w(t._id),className:"p-1 rounded hover:bg-red-500/10 text-red-400 hover:text-red-500 transition-colors",children:(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"})})]})})})]},t._id))})]})})]},t))]}),h&&m&&(0,B.jsx)(mn,{children:(0,B.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-xl flex flex-col max-h-[90vh]","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-6 flex-shrink-0",children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Editar Empleado"}),(0,B.jsx)("button",{onClick:()=>u(!1),className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Nombre Completo *"}),(0,B.jsx)("input",{type:"text",value:x.nombreCompleto,onChange:e=>b({...x,nombreCompleto:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Teléfono Personal"}),(0,B.jsx)("input",{type:"text",value:x.telefonoPersonal,onChange:e=>b({...x,telefonoPersonal:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Cargo"}),(0,B.jsx)("input",{type:"text",value:m.cargo,disabled:!0,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm capitalize","dark"===e?"bg-white/10 border-white/10 text-gray-400":"bg-gray-100 border-gray-200 text-gray-500")})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Entrevista"}),(0,B.jsx)("input",{type:"date",value:x.fechaEntrevista?new Date(x.fechaEntrevista).toISOString().split("T")[0]:"",onChange:e=>b({...x,fechaEntrevista:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Ingreso"}),(0,B.jsx)("input",{type:"date",value:x.fechaIngreso,onChange:e=>b({...x,fechaIngreso:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,B.jsxs)("div",{className:"flex items-center gap-6",children:[(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:x.firmoContrato,onChange:e=>b({...x,firmoContrato:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"¿Firmó el contrato?"})]}),(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:x.activo,onChange:e=>b({...x,activo:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"¿Activo?"})]})]}),!x.activo&&(0,B.jsxs)("div",{className:"space-y-4 animate-fade-in-up",children:[(0,B.jsx)("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-500 text-xs",children:"⚠️ Al desactivar el empleado, el usuario asociado también será desactivado automáticamente."}),(0,B.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Egreso *"}),(0,B.jsx)("input",{type:"date",value:x.fechaBaja,onChange:e=>b({...x,fechaBaja:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Motivo de Baja *"}),(0,B.jsx)("textarea",{rows:2,value:x.motivoBaja,onChange:e=>b({...x,motivoBaja:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),placeholder:"Indique el motivo de la baja..."})]})]})]}),m.userId&&(0,B.jsx)(mr,{userId:m.userId._id,teamHistory:m.userId.teamHistory,currentNumeroEquipo:m.userId.numeroEquipo,onUpdate:y}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,B.jsx)("textarea",{rows:3,value:x.notas,onChange:e=>b({...x,notas:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),placeholder:"Observaciones adicionales..."})]})]}),(0,B.jsxs)("div",{className:"flex justify-end gap-3 mt-6 flex-shrink-0",children:[(0,B.jsx)("button",{onClick:()=>u(!1),className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,B.jsx)("button",{onClick:v,disabled:f,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",f?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#17C787"},children:f?"Guardando...":"Guardar Cambios"})]})]})})})]})}function mn({children:t}){let[r,a]=(0,U.useState)(!1);if((0,U.useEffect)(()=>(a(!0),()=>a(!1)),[]),!r)return null;let{createPortal:s}=e.r(56667);return s(t,document.body)}let mi={supervisor:"#17C787",auditor:"#1E88E5",asesor:"#F4C04A",admin:"#C62FA8",rrhh:"#C8376B",gerencia:"#7C3AED"};function mo(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),r=["rrhh","rr.hh","gerencia"].includes(t?.role?.toLowerCase()||""),[a,s]=(0,U.useState)([]),[n,i]=(0,U.useState)(!0),[o,l]=(0,U.useState)(""),[c,d]=(0,U.useState)(""),[h,u]=(0,U.useState)(!1),[m,p]=(0,U.useState)(null),[f,g]=(0,U.useState)(!1),[x,b]=(0,U.useState)({});(0,U.useEffect)(()=>{y()},[]);let y=async()=>{try{i(!0);let e=(await er.api.employees.list()).data.filter(e=>!e.activo);s(e)}catch(e){console.error("Error fetching employees:",e),ea.toast.error("Error al cargar empleados")}finally{i(!1)}},v=async()=>{if(m)try{g(!0),await er.api.employees.update(m._id,x),ea.toast.success("Empleado actualizado correctamente"),!m.activo&&x.activo&&ea.toast.success("Empleado reactivado. Recuerda reactivar el usuario manualmente si es necesario."),u(!1),y()}catch(e){console.error("Error updating employee:",e),ea.toast.error("Error al actualizar empleado")}finally{g(!1)}},w=async e=>{if(confirm("¿Estás seguro de eliminar DEFINITIVAMENTE este empleado? Esta acción no se puede deshacer."))try{await er.api.employees.delete(e),ea.toast.success("Empleado eliminado permanentemente"),y()}catch(e){console.error("Error deleting employee:",e),ea.toast.error("Error al eliminar empleado")}},N=a.filter(e=>{let t=e.nombreCompleto.toLowerCase().includes(o.toLowerCase())||e.userId?.email.toLowerCase().includes(o.toLowerCase())||e.userId?.nombre.toLowerCase().includes(o.toLowerCase()),r=!c||e.numeroEquipo===c;return t&&r}).reduce((e,t)=>{let r=t.numeroEquipo||"Sin Equipo";return e[r]||(e[r]=[]),e[r].push(t),e},{}),j=[{label:"Total Inactivos",value:a.length,icon:u6.UserX,color:"#C8376B"}];return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsx)("div",{className:"flex flex-wrap gap-3",children:j.map((t,r)=>{let a=t.icon;return(0,B.jsxs)("div",{className:(0,V.cn)("flex-1 min-w-[140px] rounded-xl border p-4 flex items-center justify-between","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-xs","dark"===e?"text-gray-400":"text-gray-500"),children:t.label}),(0,B.jsx)("p",{className:"text-2xl font-bold",style:{color:t.color},children:t.value})]}),(0,B.jsx)(a,{className:"w-6 h-6",style:{color:t.color}})]},r)})}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center gap-2 mb-4 px-3 py-2 rounded-lg w-fit","bg-[#C8376B]/10"),children:[(0,B.jsx)(iG.XCircle,{className:"w-4 h-4",style:{color:"#C8376B"}}),(0,B.jsx)("span",{className:"text-sm",style:{color:"#C8376B"},children:"Mostrando solo personal inactivo"})]}),(0,B.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,B.jsxs)("div",{className:"flex-1 relative",children:[(0,B.jsx)(iK.Search,{className:(0,V.cn)("absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4","dark"===e?"text-gray-500":"text-gray-400")}),(0,B.jsx)("input",{type:"text",placeholder:"Buscar por nombre, email...",value:o,onChange:e=>l(e.target.value),className:(0,V.cn)("w-full pl-10 pr-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,B.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:(0,V.cn)("px-4 py-2 rounded-lg border text-sm min-w-[180px]","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todos los equipos"}),Object.keys(N).sort().map(e=>(0,B.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})]}),n&&(0,B.jsx)("div",{className:"flex justify-center py-12",children:(0,B.jsx)(J.RefreshCw,{className:"w-8 h-8 animate-spin text-purple-500"})}),!n&&0===a.length&&(0,B.jsx)("div",{className:"text-center py-12 text-gray-500",children:"No hay empleados inactivos registrados."}),!n&&Object.entries(N).map(([t,a])=>(0,B.jsxs)("div",{className:"mb-6",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,B.jsx)(i0,{className:"w-4 h-4",style:{color:"#1E88E5"}}),(0,B.jsxs)("h3",{className:(0,V.cn)("font-semibold","dark"===e?"text-white":"text-gray-800"),children:["Equipo ",t]})]}),(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-sm",children:[(0,B.jsx)("thead",{children:(0,B.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["NOMBRE","F. BAJA","MOTIVO","CARGO","TELÉFONO","CONTRATO","ACTIVO","ACCIONES"].map(t=>(0,B.jsx)("th",{className:(0,V.cn)("px-3 py-2 text-left font-semibold text-xs","dark"===e?"text-gray-400":"text-gray-600"),children:t},t))})}),(0,B.jsx)("tbody",{children:a.map(t=>(0,B.jsxs)("tr",{className:(0,V.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("font-medium","dark"===e?"text-white":"text-gray-800"),children:t.nombreCompleto}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs","text-gray-500"),children:t.userId?.email})]})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.fechaBaja?new Date(t.fechaBaja).toLocaleDateString():"-"}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3 max-w-[150px] truncate","dark"===e?"text-gray-400":"text-gray-600"),children:t.motivoBaja||"-"}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium text-white capitalize",style:{backgroundColor:mi[t.cargo]||"#6B7280"},children:t.cargo})}),(0,B.jsx)("td",{className:(0,V.cn)("px-3 py-3","dark"===e?"text-gray-400":"text-gray-600"),children:t.telefonoPersonal||"-"}),(0,B.jsx)("td",{className:"px-3 py-3",children:t.firmoContrato?(0,B.jsx)(iW.CheckCircle,{className:"w-5 h-5",style:{color:"#17C787"}}):(0,B.jsx)(iG.XCircle,{className:"w-5 h-5",style:{color:"#C8376B"}})}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium text-white",style:{backgroundColor:"#C8376B"},children:"No"})}),(0,B.jsx)("td",{className:"px-3 py-3",children:(0,B.jsx)("div",{className:"flex items-center gap-2",children:r&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("button",{onClick:()=>{p(t),b({nombreCompleto:t.nombreCompleto,telefonoPersonal:t.telefonoPersonal,fechaEntrevista:t.fechaEntrevista,fechaIngreso:t.fechaIngreso?new Date(t.fechaIngreso).toISOString().split("T")[0]:"",firmoContrato:t.firmoContrato,activo:t.activo,notas:t.notas,motivoBaja:t.motivoBaja}),u(!0)},className:(0,V.cn)("p-1 rounded hover:bg-white/10 transition-colors","dark"===e?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),title:"Editar",children:(0,B.jsx)(eS,{className:"w-4 h-4"})}),(0,B.jsx)("button",{onClick:async()=>{if(confirm(`\xbfEst\xe1s seguro de reactivar a ${t.nombreCompleto}? Esto tambi\xe9n reactivar\xe1 su usuario.`))try{await er.api.employees.update(t._id,{activo:!0}),ea.toast.success("Empleado y usuario reactivados correctamente"),y()}catch(e){console.error("Error reactivating employee:",e),ea.toast.error("Error al reactivar empleado")}},className:"p-1 rounded hover:bg-green-500/10 text-green-400 hover:text-green-500 transition-colors",title:"Reactivar",children:(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4"})}),(0,B.jsx)("button",{onClick:()=>w(t._id),className:"p-1 rounded hover:bg-red-500/10 text-red-400 hover:text-red-500 transition-colors",title:"Eliminar Definitivamente",children:(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"})})]})})})]},t._id))})]})})]},t))]}),h&&m&&(0,B.jsx)(ml,{children:(0,B.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-lg rounded-2xl border p-6 shadow-xl flex flex-col max-h-[90vh]","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-6 flex-shrink-0",children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Editar Empleado"}),(0,B.jsx)("button",{onClick:()=>u(!1),className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"space-y-4 overflow-y-auto flex-1 pr-2",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Nombre Completo *"}),(0,B.jsx)("input",{type:"text",value:x.nombreCompleto,onChange:e=>b({...x,nombreCompleto:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Teléfono Personal"}),(0,B.jsx)("input",{type:"text",value:x.telefonoPersonal,onChange:e=>b({...x,telefonoPersonal:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Cargo"}),(0,B.jsx)("input",{type:"text",defaultValue:m.cargo,disabled:!0,className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm capitalize","dark"===e?"bg-white/10 border-white/10 text-gray-400":"bg-gray-100 border-gray-200 text-gray-500")})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Entrevista"}),(0,B.jsx)("input",{type:"date",value:x.fechaEntrevista?new Date(x.fechaEntrevista).toISOString().split("T")[0]:"",onChange:e=>b({...x,fechaEntrevista:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Ingreso"}),(0,B.jsx)("input",{type:"date",value:x.fechaIngreso,onChange:e=>b({...x,fechaIngreso:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,B.jsxs)("div",{className:"flex items-center gap-6",children:[(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:x.firmoContrato,onChange:e=>b({...x,firmoContrato:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"¿Firmó el contrato?"})]}),(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:x.activo,onChange:e=>b({...x,activo:e.target.checked}),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"¿Activo?"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Motivo de Baja"}),(0,B.jsx)("textarea",{rows:2,value:x.motivoBaja||"",onChange:e=>b({...x,motivoBaja:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),placeholder:"Razón de la baja..."})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,B.jsx)("textarea",{rows:3,value:x.notas,onChange:e=>b({...x,notas:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400"),placeholder:"Observaciones adicionales..."})]})]}),(0,B.jsxs)("div",{className:"flex justify-end gap-3 mt-6 flex-shrink-0",children:[(0,B.jsx)("button",{onClick:()=>u(!1),className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Cancelar"}),(0,B.jsx)("button",{onClick:v,disabled:f,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors flex items-center gap-2",f?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#17C787"},children:f?"Guardando...":"Guardar Cambios"})]})]})})})]})}function ml({children:t}){let[r,a]=(0,U.useState)(!1);if((0,U.useEffect)(()=>(a(!0),()=>a(!1)),[]),!r)return null;let{createPortal:s}=e.r(56667);return s(t,document.body)}var mc=e.i(50362);let md=(0,Y.default)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var mh=e.i(22426);function mu(){let{theme:e}=(0,z.useTheme)();(0,mh.useRouter)();let[t,r]=(0,U.useState)(!1),[a,s]=(0,U.useState)([]),[n,i]=(0,U.useState)(new Set),[o,l]=(0,U.useState)(!0),[c,d]=(0,U.useState)({userId:"",nombreCompleto:"",telefonoPersonal:"",numeroEquipo:"",fechaEntrevista:"",fechaIngreso:new Date().toISOString().split("T")[0],cargo:"",firmoContrato:!1,activo:!0,fotoDNI:null,notas:""});(0,U.useEffect)(()=>{h()},[]);let h=async()=>{try{l(!0);let[e,t]=await Promise.all([er.api.users.list(),er.api.employees.list()]);s(e.data);let r=new Set(t.data.map(e=>e.userId?._id||e.userId));i(r)}catch(e){console.error("Error fetching data:",e),ea.toast.error("Error al cargar datos iniciales")}finally{l(!1)}},u=(e,t)=>{d(r=>({...r,[e]:t}))},m=()=>{d({userId:"",nombreCompleto:"",telefonoPersonal:"",numeroEquipo:"",fechaEntrevista:"",fechaIngreso:new Date().toISOString().split("T")[0],cargo:"",firmoContrato:!1,activo:!0,fotoDNI:null,notas:""})},p=async()=>{if(!c.userId)return void ea.toast.error("Debe seleccionar un usuario");if(!c.nombreCompleto)return void ea.toast.error("El nombre completo es obligatorio");try{r(!0);let e={...c,fotoDNI:""};await er.api.employees.create(e),ea.toast.success("Empleado creado exitosamente"),m(),h()}catch(e){console.error("Error creating employee:",e),ea.toast.error(e.response?.data?.message||"Error al crear empleado")}finally{r(!1)}},f=a.filter(e=>!n.has(e._id));return o?(0,B.jsx)("div",{className:"flex justify-center py-12",children:(0,B.jsx)(eT,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,B.jsx)("div",{className:"space-y-6 animate-fade-in-up",children:(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{className:"mb-6",children:[(0,B.jsx)("h2",{className:(0,V.cn)("text-xl font-semibold mb-1","dark"===e?"text-white":"text-gray-800"),children:"Nuevo Empleado"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:"Complete los datos del nuevo empleado asociándolo a una cuenta de usuario existente"})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl border p-4 mb-6","dark"===e?"bg-gradient-to-r from-[#1E88E5]/10 to-[#0E6FFF]/10 border-[#1E88E5]/30":"bg-gradient-to-r from-[#1E88E5]/5 to-[#0E6FFF]/5 border-[#1E88E5]/20"),children:[(0,B.jsxs)("label",{className:(0,V.cn)("text-sm font-medium mb-2 block","dark"===e?"text-gray-300":"text-gray-700"),children:["Usuario de la Plataforma ",(0,B.jsx)("span",{style:{color:"#C8376B"},children:"*"})]}),(0,B.jsxs)("select",{value:c.userId,onChange:e=>{var t;let r;return t=e.target.value,void((r=a.find(e=>e._id===t))?d(e=>({...e,userId:t,nombreCompleto:r.nombre,numeroEquipo:r.numeroEquipo||"",cargo:r.role})):d(e=>({...e,userId:""})))},className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Seleccionar usuario..."}),f.map(e=>(0,B.jsxs)("option",{value:e._id,children:[e.nombre," (",e.email,") - ",e.role]},e._id))]}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-2","text-[#1E88E5]"),children:"Seleccione la cuenta de usuario que quedará asociada a este empleado. Solo se muestran usuarios sin ficha de empleado."})]}),(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:["Nombre Completo ",(0,B.jsx)("span",{style:{color:"#C8376B"},children:"*"})]}),(0,B.jsx)("input",{type:"text",value:c.nombreCompleto,onChange:e=>u("nombreCompleto",e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Teléfono Personal"}),(0,B.jsx)("input",{type:"text",placeholder:"Ej: 1112345678",value:c.telefonoPersonal,onChange:e=>u("telefonoPersonal",e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Número de Equipo"}),(0,B.jsx)("input",{type:"text",value:c.numeroEquipo,onChange:e=>u("numeroEquipo",e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Entrevista"}),(0,B.jsx)("input",{type:"date",value:c.fechaEntrevista,onChange:e=>u("fechaEntrevista",e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Fecha de Ingreso"}),(0,B.jsx)("input",{type:"date",value:c.fechaIngreso,onChange:e=>u("fechaIngreso",e.target.value),className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-1","text-[#F4C04A]"),children:"Por defecto se asigna la fecha de creación de la cuenta"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Cargo (Rol)"}),(0,B.jsx)("div",{className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm capitalize","bg-[#17C787]/10 border-[#17C787]/30 text-[#17C787]"),children:c.cargo||"El cargo se obtiene automáticamente del rol del usuario"}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-1","text-gray-500"),children:"El cargo se obtiene automáticamente del rol del usuario"})]}),(0,B.jsxs)("div",{className:(0,V.cn)("flex items-center gap-6 p-4 rounded-lg border","dark"===e?"bg-white/5 border-white/10":"bg-gray-50 border-gray-200"),children:[(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:c.firmoContrato,onChange:e=>u("firmoContrato",e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-[#1E88E5] focus:ring-[#1E88E5]"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"¿Firmó el contrato?"})]}),(0,B.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,B.jsx)("input",{type:"checkbox",checked:c.activo,onChange:e=>u("activo",e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-[#17C787] focus:ring-[#17C787]"}),(0,B.jsx)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-300":"text-gray-700"),children:"¿Activo?"})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsxs)("label",{className:(0,V.cn)("text-sm font-medium mb-1 flex items-center gap-1","dark"===e?"text-gray-300":"text-gray-700"),children:[(0,B.jsx)(md,{className:"w-4 h-4",style:{color:"#F4C04A"}}),"Foto del DNI (.jpg, .png)"]}),(0,B.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png",onChange:e=>{e.target.files&&e.target.files[0]&&d(t=>({...t,fotoDNI:e.target.files[0]}))},disabled:!0,className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm file:mr-4 file:py-1 file:px-3 file:rounded file:border-0 file:text-sm file:font-medium opacity-50 cursor-not-allowed","dark"===e?"bg-white/5 border-white/10 text-white file:bg-[#1E88E5]/20 file:text-[#1E88E5]":"bg-white border-gray-200 text-gray-800 file:bg-[#1E88E5]/10 file:text-[#1E88E5]")}),(0,B.jsx)("p",{className:(0,V.cn)("text-xs mt-1","text-gray-500"),children:"Carga de imágenes deshabilitada temporalmente"})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("text-sm font-medium mb-1 block","dark"===e?"text-gray-300":"text-gray-700"),children:"Notas"}),(0,B.jsx)("textarea",{placeholder:"Observaciones adicionales...",value:c.notas,onChange:e=>u("notas",e.target.value),rows:4,className:(0,V.cn)("w-full px-4 py-2.5 rounded-lg border text-sm resize-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("flex justify-end gap-3 mt-6 pt-6 border-t","dark"===e?"border-white/10":"border-gray-200"),children:[(0,B.jsxs)("button",{onClick:m,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4"}),"Limpiar Formulario"]}),(0,B.jsxs)("button",{onClick:p,disabled:t,className:(0,V.cn)("px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-colors text-white",t?"opacity-50 cursor-not-allowed":"hover:opacity-90"),style:{backgroundColor:"#1E88E5"},children:[t?(0,B.jsx)(eT,{className:"w-4 h-4 animate-spin"}):(0,B.jsx)(mc.UserPlus,{className:"w-4 h-4"}),"Crear Empleado"]})]})]})})}let mm=(0,Y.default)("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),mp=(0,Y.default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),mf=(0,Y.default)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var mg=e.i(85744);let mx={asesor:"#1E88E5",supervisor:"#17C787",auditor:"#F4C04A",administrativo:"#9C27B0",gerencia:"#C8376B","rr.hh":"#607D8B"},mb=["asesor","supervisor","auditor","administrativo","gerencia","RR.HH"];function my(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!0),[n,i]=(0,U.useState)(""),[o,l]=(0,U.useState)(""),[c,d]=(0,U.useState)("desc"),[h,u]=(0,U.useState)(1),[m,p]=(0,U.useState)(!1),[f,g]=(0,U.useState)(!1),[x,b]=(0,U.useState)(null),[y,v]=(0,U.useState)(null),[w,N]=(0,U.useState)(!1),[j,k]=(0,U.useState)({nombre:"",email:"",password:"",role:"asesor",numeroEquipo:""});(0,U.useEffect)(()=>{E()},[]);let E=async()=>{try{s(!0);let e=await er.api.users.list();console.log("Usuarios fetched:",e.data),r(e.data)}catch(e){console.error("Error fetching users:",e),ea.toast.error("Error al cargar usuarios")}finally{s(!1)}},S=async()=>{try{await er.api.users.create(j),ea.toast.success("Usuario creado correctamente"),g(!1),E(),O()}catch(e){console.error("Error creating user:",e),ea.toast.error(e.response?.data?.message||"Error al crear usuario")}},T=async()=>{if(y)try{let e={nombre:j.nombre,email:j.email,role:j.role,numeroEquipo:j.numeroEquipo};j.password&&(e.password=j.password),await er.api.users.update(y._id,e),j.password&&await er.api.users.changePassword(y._id,{password:j.password}),ea.toast.success("Usuario actualizado correctamente"),p(!1),E()}catch(e){console.error("Error updating user:",e),ea.toast.error(e.response?.data?.message||"Error al actualizar usuario")}},C=async e=>{if(confirm("¿Estás seguro de que deseas eliminar este usuario?"))try{await er.api.users.delete(e),ea.toast.success("Usuario eliminado correctamente"),E()}catch(e){console.error("Error deleting user:",e),ea.toast.error(e.response?.data?.message||"Error al eliminar usuario")}},A=async e=>{try{await er.api.users.update(e._id,{active:!e.active}),ea.toast.success(`Usuario ${e.active?"desactivado":"activado"} correctamente`),E()}catch(e){console.error("Error toggling user status:",e),ea.toast.error("Error al cambiar estado del usuario")}},R=async(e,t)=>{try{await er.api.users.update(e._id,{role:t}),ea.toast.success("Rol actualizado correctamente"),b(null),E()}catch(e){console.error("Error changing role:",e),ea.toast.error("Error al cambiar rol")}},O=()=>{k({nombre:"",email:"",password:"",role:"asesor",numeroEquipo:""}),v(null)},_=t.filter(e=>{let t=e.nombre.toLowerCase().includes(n.toLowerCase())||e.email.toLowerCase().includes(n.toLowerCase()),r=!o||e.numeroEquipo===o;return t&&r}),D=Math.ceil(_.length/10),P=_.slice((h-1)*10,10*h),I=Array.from(new Set(t.map(e=>e.numeroEquipo).filter(Boolean))).sort();return a?(0,B.jsx)("div",{className:"flex justify-center py-12",children:(0,B.jsx)(eT,{className:"w-8 h-8 animate-spin text-purple-500"})}):(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-white border-gray-200 shadow-sm"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3",children:[(0,B.jsx)(q.Users,{className:"w-6 h-6",style:{color:"#1E88E5"}}),(0,B.jsx)("h2",{className:(0,V.cn)("text-xl font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Gestión de Usuarios"})]}),(0,B.jsxs)("button",{onClick:()=>{O(),g(!0)},className:"flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors hover:opacity-90",style:{backgroundColor:"#17C787"},children:[(0,B.jsx)(eE.Plus,{className:"w-4 h-4"}),"Nuevo Usuario"]})]}),(0,B.jsx)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:(0,B.jsx)("div",{className:"flex-1 relative",children:(0,B.jsx)("input",{type:"text",placeholder:"Buscar por nombre o email...",value:n,onChange:e=>i(e.target.value),className:(0,V.cn)("w-full px-4 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white placeholder-gray-500":"bg-white border-gray-200 text-gray-800 placeholder-gray-400")})})}),(0,B.jsx)("div",{className:"flex flex-wrap gap-3 mb-6",children:(0,B.jsxs)("select",{value:o,onChange:e=>l(e.target.value),className:(0,V.cn)("px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:[(0,B.jsx)("option",{value:"",children:"Todos los grupos"}),I.map(e=>(0,B.jsxs)("option",{value:e,children:["Equipo ",e]},e))]})}),(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full text-sm",children:[(0,B.jsx)("thead",{children:(0,B.jsx)("tr",{className:"dark"===e?"bg-white/5":"bg-gray-50",children:["Nombre","Email","Rol","Grupo","Estado","Acciones"].map(t=>(0,B.jsx)("th",{className:(0,V.cn)("px-4 py-3 text-center font-semibold","dark"===e?"text-gray-300":"text-gray-700"),children:t},t))})}),(0,B.jsx)("tbody",{children:P.map(t=>(0,B.jsxs)("tr",{className:(0,V.cn)("border-t transition-colors","dark"===e?"border-white/5 hover:bg-white/5":"border-gray-100 hover:bg-gray-50"),children:[(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-center","dark"===e?"text-cyan-400":"text-cyan-600"),children:t.nombre}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-center","dark"===e?"text-gray-400":"text-gray-600"),children:t.email}),(0,B.jsxs)("td",{className:"px-4 py-3 text-center relative",children:[(0,B.jsx)("button",{onClick:()=>{var e;b(x===(e=t._id)?null:e)},className:"px-3 py-1 rounded text-xs font-medium text-white cursor-pointer hover:opacity-80 transition-opacity capitalize",style:{backgroundColor:mx[t.role?.toLowerCase()]||"#6B7280"},children:t.role}),x===t._id&&(0,iZ.createPortal)((0,B.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-xs rounded-xl border p-4 shadow-2xl","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("h4",{className:(0,V.cn)("text-sm font-semibold mb-3","dark"===e?"text-white":"text-gray-800"),children:["Cambiar rol de ",t.nombre]}),(0,B.jsx)("div",{className:"space-y-1 max-h-[60vh] overflow-y-auto",children:mb.map(r=>(0,B.jsxs)("button",{onClick:()=>R(t,r),className:(0,V.cn)("w-full px-3 py-2 rounded-lg text-sm font-medium text-left transition-colors capitalize flex items-center justify-between",t.role===r?"dark"===e?"bg-white/10 text-white":"bg-gray-100 text-gray-800":"dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-600"),children:[r,t.role===r&&(0,B.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"})]},r))}),(0,B.jsx)("div",{className:"flex gap-2 mt-4 pt-3 border-t border-gray-100 dark:border-white/10",children:(0,B.jsx)("button",{onClick:()=>b(null),className:(0,V.cn)("flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors border","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-500 hover:bg-gray-50"),children:"Cancelar"})})]})}),document.body)]}),(0,B.jsx)("td",{className:(0,V.cn)("px-4 py-3 text-center","dark"===e?"text-gray-400":"text-gray-600"),children:t.numeroEquipo||"-"}),(0,B.jsx)("td",{className:"px-4 py-3 text-center",children:(0,B.jsx)("span",{className:"text-xs font-medium",style:{color:t.active?"#17C787":"#C8376B"},children:t.active?"Activo":"Inactivo"})}),(0,B.jsx)("td",{className:"px-4 py-3",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,B.jsx)("button",{onClick:()=>A(t),className:"p-1.5 rounded transition-colors text-white",style:{backgroundColor:"#F4C04A"},title:t.active?"Desactivar":"Activar",children:(0,B.jsx)(mm,{className:"w-4 h-4"})}),(0,B.jsx)("button",{onClick:()=>{v(t),k({nombre:t.nombre,email:t.email,password:"",role:t.role,numeroEquipo:t.numeroEquipo||""}),p(!0)},className:"p-1.5 rounded transition-colors text-white",style:{backgroundColor:"#17C787"},title:"Editar",children:(0,B.jsx)(eS,{className:"w-4 h-4"})}),(0,B.jsx)("button",{onClick:()=>C(t._id),className:"p-1.5 rounded transition-colors text-white",style:{backgroundColor:"#C8376B"},title:"Eliminar",children:(0,B.jsx)(eu.Trash2,{className:"w-4 h-4"})})]})})]},t._id))})]})}),D>1&&(0,B.jsxs)("div",{className:"flex items-center justify-center gap-4 mt-6",children:[(0,B.jsxs)("button",{onClick:()=>u(Math.max(1,h-1)),disabled:1===h,className:(0,V.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors border disabled:opacity-50","dark"===e?"border-white/10 text-gray-400 hover:bg-white/5":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:[(0,B.jsx)(mp,{className:"w-4 h-4"}),"Anterior"]}),(0,B.jsxs)("span",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-600"),children:["Página ",h," de ",D]}),(0,B.jsxs)("button",{onClick:()=>u(Math.min(D,h+1)),disabled:h===D,className:(0,V.cn)("flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors disabled:opacity-50","dark"===e?"bg-gray-700 text-white hover:bg-gray-600":"bg-gray-800 text-white hover:bg-gray-700"),children:["Siguiente",(0,B.jsx)(mf,{className:"w-4 h-4"})]})]})]}),(m||f)&&(0,iZ.createPortal)((0,B.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 animate-in fade-in duration-200",children:(0,B.jsxs)("div",{className:(0,V.cn)("w-full max-w-md rounded-2xl border p-6 shadow-xl max-h-[85vh] overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)(eS,{className:"w-5 h-5",style:{color:"#1E88E5"}}),(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:f?"Nuevo usuario":"Editar usuario"})]}),(0,B.jsx)("button",{onClick:()=>{p(!1),g(!1)},className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsxs)("div",{className:"space-y-4",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Nombre"}),(0,B.jsx)("input",{type:"text",value:j.nombre,onChange:e=>k({...j,nombre:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Email"}),(0,B.jsx)("input",{type:"email",value:j.email,onChange:e=>k({...j,email:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:f?"Contraseña":"Nueva contraseña (opcional)"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)("input",{type:w?"text":"password",value:j.password,onChange:e=>k({...j,password:e.target.value}),placeholder:f?"********":"Dejar vacío para mantener actual",className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm pr-10","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")}),(0,B.jsx)("button",{type:"button",onClick:()=>N(!w),className:(0,V.cn)("absolute right-3 top-1/2 -translate-y-1/2","dark"===e?"text-gray-500":"text-gray-400"),children:w?(0,B.jsx)(mg.EyeOff,{className:"w-4 h-4"}):(0,B.jsx)(em.Eye,{className:"w-4 h-4"})})]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Rol"}),(0,B.jsx)("select",{value:j.role,onChange:e=>k({...j,role:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm capitalize","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800"),children:mb.map(e=>(0,B.jsx)("option",{value:e,children:e},e))})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:(0,V.cn)("block text-sm font-medium mb-1","dark"===e?"text-gray-300":"text-gray-700"),children:"Grupo (opcional)"}),(0,B.jsx)("input",{type:"text",value:j.numeroEquipo,onChange:e=>k({...j,numeroEquipo:e.target.value}),className:(0,V.cn)("w-full px-3 py-2 rounded-lg border text-sm","dark"===e?"bg-white/5 border-white/10 text-white":"bg-white border-gray-200 text-gray-800")})]})]}),(0,B.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,B.jsx)("button",{onClick:()=>{p(!1),g(!1)},className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors text-white",style:{backgroundColor:"#1E88E5"},children:"Cancelar"}),(0,B.jsx)("button",{onClick:f?S:T,className:"px-4 py-2 rounded-lg text-sm font-medium text-white transition-colors",style:{backgroundColor:"#17C787"},children:"Guardar"})]})]})}),document.body)]})}function mv(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!1),[n,i]=(0,U.useState)(0);(0,U.useEffect)(()=>{o()},[]);let o=async()=>{s(!0);try{let{data:e}=await er.api.affiliates.getFresh();r(e.data||[]),i(e.total||0)}catch(e){console.error("Error fetching fresh data:",e),ea.toast.error("Error al cargar datos frescos")}finally{s(!1)}};return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)("span",{className:"p-2 rounded-lg bg-emerald-500/20 text-emerald-500",children:(0,B.jsx)(eN.Sparkles,{className:"w-6 h-6"})}),"Datos Frescos"]}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:"Afiliados sin registros en Auditorías o Contactar Afiliados"})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("button",{onClick:o,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"),children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,B.jsxs)("button",{onClick:()=>{if(0===t.length)return void ea.toast.info("No hay datos para exportar");let e=um(t.map(e=>({Nombre:e.nombre,CUIL:e.cuil,"Obra Social":e.obraSocial,Teléfono:e.telefono,Localidad:e.localidad}))),r=up();uf(r,e,"Datos Frescos"),uc(r,`datos_frescos_${new Date().toISOString().slice(0,10)}.xlsx`),ea.toast.success("Archivo exportado exitosamente")},disabled:0===t.length,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2",0===t.length?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),"Exportar"]})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-sm font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Total de datos frescos"}),(0,B.jsx)("p",{className:(0,V.cn)("text-3xl font-bold mt-1","dark"===e?"text-white":"text-gray-900"),children:n})]}),(0,B.jsx)("div",{className:(0,V.cn)("p-4 rounded-xl","dark"===e?"bg-emerald-500/10":"bg-emerald-50"),children:(0,B.jsx)(eN.Sparkles,{className:(0,V.cn)("w-8 h-8","dark"===e?"text-emerald-400":"text-emerald-600")})})]})}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:(0,V.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,B.jsx)("th",{className:"px-6 py-4",children:"Nombre"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"CUIL"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Obra Social"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Teléfono"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Localidad"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:a?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-5 h-5 animate-spin text-emerald-500"}),(0,B.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===t.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"No hay datos frescos disponibles"})}):t.map(t=>(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,B.jsx)("td",{className:"px-6 py-4 font-medium",children:t.nombre}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.cuil}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.obraSocial}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.telefono}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.localidad})]},t._id))})]})})})]})}function mw(){let{theme:e}=(0,z.useTheme)(),[t,r]=(0,U.useState)([]),[a,s]=(0,U.useState)(!1),[n,i]=(0,U.useState)(0);(0,U.useEffect)(()=>{o()},[]);let o=async()=>{s(!0);try{let{data:e}=await er.api.affiliates.getReusableData();r(e.data||[]),i(e.total||0)}catch(e){console.error("Error fetching reusable data:",e),ea.toast.error("Error al cargar datos reutilizables")}finally{s(!1)}};return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)("span",{className:"p-2 rounded-lg bg-blue-500/20 text-blue-500",children:(0,B.jsx)(iF.Recycle,{className:"w-6 h-6"})}),"Datos Reutilizables"]}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:"Registros de auditorías en suspenso o sin contacto establecido"})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("button",{onClick:o,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-white/5 text-gray-300 hover:bg-white/10 border border-white/10":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-200"),children:[(0,B.jsx)(J.RefreshCw,{className:"w-4 h-4"}),"Actualizar"]}),(0,B.jsxs)("button",{onClick:()=>{if(0===t.length)return void ea.toast.info("No hay datos para exportar");let e=um(t.map(e=>({Nombre:e.nombre,CUIL:e.cuil,Teléfono:e.telefono,"Obra Social":e.obraSocial,Localidad:e.localidad,Estado:e.estado}))),r=up();uf(r,e,"Datos Reutilizables"),uc(r,`datos_reutilizables_${new Date().toISOString().slice(0,10)}.xlsx`),ea.toast.success("Archivo exportado exitosamente")},disabled:0===t.length,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2",0===t.length?"opacity-50 cursor-not-allowed":"","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),"Exportar"]})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border p-6","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("p",{className:(0,V.cn)("text-sm font-medium","dark"===e?"text-gray-400":"text-gray-600"),children:"Total de registros reutilizables"}),(0,B.jsx)("p",{className:(0,V.cn)("text-3xl font-bold mt-1","dark"===e?"text-white":"text-gray-900"),children:n})]}),(0,B.jsx)("div",{className:(0,V.cn)("p-4 rounded-xl","dark"===e?"bg-blue-500/10":"bg-blue-50"),children:(0,B.jsx)(iF.Recycle,{className:(0,V.cn)("w-8 h-8","dark"===e?"text-blue-400":"text-blue-600")})})]})}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:(0,V.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,B.jsx)("th",{className:"px-6 py-4",children:"Nombre"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"CUIL"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Teléfono"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Obra Social"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Localidad"}),(0,B.jsx)("th",{className:"px-6 py-4",children:"Estado"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:a?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-5 h-5 animate-spin text-blue-500"}),(0,B.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===t.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No hay datos reutilizables disponibles"})}):t.map(t=>{var r;let a;return(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,B.jsx)("td",{className:"px-6 py-4 font-medium",children:t.nombre}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.cuil}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.telefono}),(0,B.jsx)("td",{className:"px-6 py-4",children:t.obraSocial}),(0,B.jsx)("td",{className:"px-6 py-4",children:"DESCONOCIDO"===t.localidad?(0,B.jsx)("span",{className:"italic text-gray-400",children:t.localidad}):t.localidad}),(0,B.jsx)("td",{className:"px-6 py-4",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-1 rounded-md text-xs font-medium",(r=t.estado,"no atendió"===(a=r.toLowerCase())?"dark"===e?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800":"reprogramada (falta confirmar hora)"===a?"dark"===e?"bg-violet-500/20 text-violet-400":"bg-violet-100 text-violet-800":"tiene dudas"===a?"dark"===e?"bg-pink-500/20 text-pink-400":"bg-pink-100 text-pink-800":"dark"===e?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800")),children:t.estado})})]},t._id)})})]})})})]})}var mN=e.i(77982);let mj=(0,Y.default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),mk=(0,Y.default)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);function mE(){let{theme:e}=(0,z.useTheme)(),t=(0,mh.useRouter)(),[r,a]=(0,U.useState)([]),[s,n]=(0,U.useState)(!1),[i,o]=(0,U.useState)("pending");(0,U.useEffect)(()=>{l()},[i]);let l=async()=>{n(!0);try{let{data:e}=await er.api.affiliates.getAssigned({status:i});a(e.affiliates)}catch(e){ea.toast.error("Error cargando asignaciones")}finally{n(!1)}},c=async(e,s,n="")=>{try{if(a(t=>t.map(t=>t._id===e?{...t,leadStatus:s}:t)),await er.api.affiliates.updateStatus(e,{status:s,note:n}),ea.toast.success(`Estado actualizado: ${s}`),"Venta"===s){let a=r.find(t=>t._id===e);a&&(sessionStorage.setItem("prefillAudit",JSON.stringify({nombre:a.nombre,cuil:a.cuil,telefono:a.telefono1,obraSocialAnterior:a.obraSocial,localidad:a.localidad})),t.push("/dashboard/audits/follow-up?action=create"))}else"pending"===i&&["No interesado","Fallido"].includes(s)&&setTimeout(l,500)}catch(e){ea.toast.error("Error actualizando estado"),l()}};return(0,B.jsxs)("div",{className:"space-y-6 p-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsx)("h1",{className:(0,V.cn)("text-2xl font-bold","dark"===e?"text-white":"text-gray-900"),children:"Contactar Afiliados"}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm","dark"===e?"text-gray-400":"text-gray-500"),children:"Gestiona tus leads asignados"})]}),(0,B.jsxs)("div",{className:"flex bg-gray-100 dark:bg-white/5 p-1 rounded-lg",children:[(0,B.jsx)("button",{onClick:()=>o("pending"),className:(0,V.cn)("px-4 py-2 text-sm font-medium rounded-md transition-all","pending"===i?"bg-white dark:bg-gray-800 shadow text-purple-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400"),children:"Pendientes"}),(0,B.jsx)("button",{onClick:()=>o("all"),className:(0,V.cn)("px-4 py-2 text-sm font-medium rounded-md transition-all","all"===i?"bg-white dark:bg-gray-800 shadow text-purple-600":"text-gray-500 hover:text-gray-700 dark:text-gray-400"),children:"Todos"})]})]}),s?(0,B.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Cargando asignaciones..."}):0===r.length?(0,B.jsxs)("div",{className:"text-center py-12 text-gray-500 bg-gray-50 dark:bg-white/5 rounded-xl border border-dashed border-gray-200 dark:border-white/10",children:[(0,B.jsx)("p",{className:"text-lg font-medium",children:"No tienes leads asignados"}),(0,B.jsx)("p",{className:"text-sm",children:"Solicita nuevos leads a tu supervisor"})]}):(0,B.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(t=>(0,B.jsxs)("div",{className:(0,V.cn)("rounded-xl border p-5 transition-all hover:shadow-lg","dark"===e?"bg-[#1a1333] border-white/10 hover:border-purple-500/50":"bg-white border-gray-200 hover:border-purple-200"),children:[(0,B.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,B.jsxs)("div",{children:[(0,B.jsx)("h3",{className:(0,V.cn)("font-bold text-lg","dark"===e?"text-white":"text-gray-900"),children:t.nombre}),(0,B.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,B.jsx)("span",{className:(0,V.cn)("text-xs px-2 py-0.5 rounded-full border","dark"===e?"border-white/10 bg-white/5 text-gray-300":"border-gray-200 bg-gray-50 text-gray-600"),children:t.cuil}),(0,B.jsx)("span",{className:(0,V.cn)("text-xs font-medium px-2 py-0.5 rounded-full","Pendiente"===t.leadStatus?"bg-yellow-100 text-yellow-800":"Asignado"===t.leadStatus?"bg-blue-100 text-blue-800":"No contesta"===t.leadStatus?"bg-orange-100 text-orange-800":"Venta"===t.leadStatus?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:t.leadStatus})]})]})}),(0,B.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,B.jsx)(mN.Phone,{className:"w-4 h-4 text-gray-400"}),(0,B.jsx)("a",{href:`tel:${t.telefono1}`,className:"hover:underline text-purple-600 font-medium",children:t.telefono1})]}),(0,B.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,B.jsx)(mk,{className:"w-4 h-4 text-gray-400"}),(0,B.jsx)("span",{className:"dark"===e?"text-gray-300":"text-gray-700",children:t.obraSocial})]}),(0,B.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[(0,B.jsx)(mj,{className:"w-4 h-4 text-gray-400"}),(0,B.jsx)("span",{className:"dark"===e?"text-gray-300":"text-gray-700",children:t.localidad})]})]}),(0,B.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,B.jsxs)("button",{onClick:()=>c(t._id,"Venta"),className:"col-span-2 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",children:[(0,B.jsx)(iW.CheckCircle,{className:"w-4 h-4"}),"Venta Exitosa"]}),(0,B.jsxs)("button",{onClick:()=>c(t._id,"No contesta"),className:(0,V.cn)("py-2 rounded-lg text-sm font-medium border transition-colors flex items-center justify-center gap-2","dark"===e?"border-orange-500/30 text-orange-400 hover:bg-orange-500/10":"border-orange-200 text-orange-700 hover:bg-orange-50"),children:[(0,B.jsx)(ep.Clock,{className:"w-4 h-4"}),"No contesta"]}),(0,B.jsxs)("button",{onClick:()=>c(t._id,"No interesado"),className:(0,V.cn)("py-2 rounded-lg text-sm font-medium border transition-colors flex items-center justify-center gap-2","dark"===e?"border-red-500/30 text-red-400 hover:bg-red-500/10":"border-red-200 text-red-700 hover:bg-red-50"),children:[(0,B.jsx)(iG.XCircle,{className:"w-4 h-4"}),"No interesado"]})]})]},t._id))})]})}let mS=e=>{if(!e)return"-";let t=new Date(e);if(Number.isNaN(t.getTime()))return"-";let r=t.toLocaleDateString("es-AR"),a=t.toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${r} ${a}`};function mT(){let{theme:e}=(0,z.useTheme)(),{user:t}=(0,iT.useAuth)(),[r,a]=(0,U.useState)([]),[s,n]=(0,U.useState)(!1),[i,o]=(0,U.useState)(!0),[l,c]=(0,U.useState)(1),[d,h]=(0,U.useState)(1),[u,m]=(0,U.useState)({}),[p,f]=(0,U.useState)(!1),[g,x]=(0,U.useState)(""),[b,y]=(0,U.useState)({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),[v,w]=(0,U.useState)(!1),[N,j]=(0,U.useState)(!1),[k,E]=(0,U.useState)([]),[S,T]=(0,U.useState)([]),C=(0,U.useRef)(null),A=(0,U.useRef)(null);(0,U.useEffect)(()=>{R(),O()},[]),(0,U.useEffect)(()=>{let e=e=>{C.current&&!C.current.contains(e.target)&&w(!1),A.current&&!A.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let R=async()=>{try{let e=await er.api.users.list(),t=Array.isArray(e.data)?e.data:[],r=t.filter(e=>!1!==e.active&&("asesor"===e.role||"Asesor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));E(r);let a=t.filter(e=>!1!==e.active&&("supervisor"===e.role||"Supervisor"===e.role)).sort((e,t)=>e.nombre.localeCompare(t.nombre));T(a)}catch(e){console.error("Error loading filter options:",e)}},O=async()=>{try{n(!0);let{data:e}=await er.api.affiliates.getFailed({page:l,limit:100}),t=e.affiliates||[];e.stats&&m(e.stats),b.asesor&&(t=t.filter(e=>e.assignedTo?.nombre?.toLowerCase().includes(b.asesor.toLowerCase()))),b.supervisor&&(t=t.filter(e=>e.supervisor?.toLowerCase().includes(b.supervisor.toLowerCase()))),b.cuil&&(t=t.filter(e=>e.cuil.includes(b.cuil))),a(t),h(e.pages)}catch(e){console.error(e),ea.toast.error("Error al cargar afiliaciones fallidas")}finally{n(!1)}},_=(e,t)=>{y(r=>({...r,[e]:t}))};return(0,B.jsxs)("div",{className:"space-y-6 animate-fade-in-up",children:[(0,B.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,B.jsxs)("div",{children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-2xl font-bold flex items-center gap-2","dark"===e?"text-white":"text-gray-800"),children:[(0,B.jsx)("span",{className:"p-2 rounded-lg bg-red-500/20 text-red-500",children:(0,B.jsx)(ek,{className:"w-6 h-6"})}),"Afiliaciones Fallidas"]}),(0,B.jsx)("p",{className:(0,V.cn)("text-sm mt-1","dark"===e?"text-gray-400":"text-gray-500"),children:"Listado de ventas caídas, rechazadas y leads fallidos"})]}),(0,B.jsx)("div",{className:"flex gap-2",children:(0,B.jsxs)("button",{onClick:()=>{if(!r.length)return void ea.toast.info("No hay datos para exportar");let e=um(r.map(e=>({Fecha:mS(e.lastInteraction),Nombre:e.nombre,CUIL:e.cuil,Teléfono:e.telefono,Estado:e.leadStatus,Motivo:e.motivo,Asesor:e.assignedTo?.nombre||"-",Supervisor:e.supervisor||"-",Origen:"audit"===e.source?"Auditoría":"Base de Datos"}))),t=up();uf(t,e,"Afiliaciones Fallidas"),uc(t,`afiliaciones_fallidas_${new Date().toISOString().slice(0,10)}.xlsx`)},className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-all flex items-center gap-2","dark"===e?"bg-green-500/20 text-green-300 hover:bg-green-500/30":"bg-green-100 text-green-700 hover:bg-green-200"),children:[(0,B.jsx)(ij.Download,{className:"w-4 h-4"}),"Exportar"]})})]}),(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 transition-all duration-300","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,B.jsxs)("div",{className:"flex items-center gap-2",children:[(0,B.jsx)(i0,{className:(0,V.cn)("w-4 h-4","dark"===e?"text-purple-400":"text-purple-600")}),(0,B.jsx)("h3",{className:(0,V.cn)("font-medium","dark"===e?"text-gray-200":"text-gray-700"),children:"Filtros"})]}),(0,B.jsx)("button",{onClick:()=>o(!i),className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/5":"hover:bg-gray-100"),children:i?(0,B.jsx)(i2,{className:"w-4 h-4"}):(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4"})})]}),i&&(0,B.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,B.jsxs)("div",{className:"relative",ref:C,children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Asesor"}),(0,B.jsxs)("div",{onClick:()=>w(!v),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,B.jsx)("span",{className:"truncate",children:b.asesor||"Todos los asesores"}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),v&&(0,B.jsxs)("div",{className:(0,V.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,B.jsx)("div",{onClick:()=>{_("asesor",""),w(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los asesores"}),k.map(t=>(0,B.jsx)("div",{onClick:()=>{_("asesor",t.nombre),w(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",b.asesor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,B.jsxs)("div",{className:"relative",ref:A,children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Supervisor"}),(0,B.jsxs)("div",{onClick:()=>j(!N),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border cursor-pointer flex items-center justify-between","dark"===e?"bg-white/5 border-white/10 text-gray-300 hover:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-700 hover:border-purple-300"),children:[(0,B.jsx)("span",{className:"truncate",children:b.supervisor||"Todos los supervisores"}),(0,B.jsx)(i1.ChevronDown,{className:"w-4 h-4 opacity-50"})]}),N&&(0,B.jsxs)("div",{className:(0,V.cn)("absolute top-full left-0 w-full mt-1 rounded-xl border shadow-xl z-50 max-h-60 overflow-y-auto","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-100"),children:[(0,B.jsx)("div",{onClick:()=>{_("supervisor",""),j(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:"Todos los supervisores"}),S.map(t=>(0,B.jsx)("div",{onClick:()=>{_("supervisor",t.nombre),j(!1)},className:(0,V.cn)("px-3 py-2 text-sm cursor-pointer transition-colors","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700",b.supervisor===t.nombre&&("dark"===e?"bg-purple-500/20 text-purple-300":"bg-purple-50 text-purple-700")),children:t.nombre},t._id))]})]}),(0,B.jsxs)("div",{children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"CUIL"}),(0,B.jsxs)("div",{className:"relative",children:[(0,B.jsx)("input",{type:"text",value:b.cuil,onChange:e=>_("cuil",e.target.value),placeholder:"Buscar por CUIL...",className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border pl-9 transition-all outline-none","dark"===e?"bg-white/5 border-white/10 text-white placeholder:text-gray-500 focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 placeholder:text-gray-400 focus:border-purple-300")}),(0,B.jsx)(iK.Search,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),(0,B.jsxs)("div",{className:"flex gap-2",children:[(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Desde"}),(0,B.jsx)("input",{type:"date",value:b.dateFrom,onChange:e=>_("dateFrom",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]}),(0,B.jsxs)("div",{className:"flex-1",children:[(0,B.jsx)("label",{className:"text-xs font-medium mb-1.5 block text-gray-500",children:"Hasta"}),(0,B.jsx)("input",{type:"date",value:b.dateTo,onChange:e=>_("dateTo",e.target.value),className:(0,V.cn)("w-full px-3 py-2 rounded-xl text-sm border outline-none","dark"===e?"bg-white/5 border-white/10 text-white focus:border-purple-500/50":"bg-gray-50 border-gray-200 text-gray-900 focus:border-purple-300")})]})]})]}),(0,B.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,B.jsx)("button",{onClick:()=>{y({asesor:"",supervisor:"",cuil:"",dateFrom:"",dateTo:""}),O()},className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium transition-colors","dark"===e?"text-gray-400 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:"Limpiar filtros"}),(0,B.jsx)("button",{onClick:O,className:(0,V.cn)("px-4 py-2 rounded-xl text-sm font-medium text-white shadow-lg shadow-purple-500/20 transition-all hover:scale-105 active:scale-95","bg-gradient-to-r from-purple-600 to-blue-600"),children:"Aplicar filtros"})]})]}),(0,B.jsx)("div",{className:(0,V.cn)("rounded-2xl border overflow-hidden","dark"===e?"bg-[#1a1333]/50 border-white/5":"bg-white border-gray-100 shadow-sm"),children:(0,B.jsx)("div",{className:"overflow-x-auto",children:(0,B.jsxs)("table",{className:"w-full",children:[(0,B.jsx)("thead",{children:(0,B.jsxs)("tr",{className:(0,V.cn)("text-left text-xs font-medium uppercase tracking-wider","dark"===e?"bg-white/5 text-gray-400":"bg-gray-50 text-gray-500"),children:[(0,B.jsx)("th",{className:"px-4 py-3",children:"Fecha"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"Afiliado"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"CUIL"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"Teléfono"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"Estado"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"Motivo"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"Asesor"}),(0,B.jsx)("th",{className:"px-4 py-3",children:"Supervisor"})]})}),(0,B.jsx)("tbody",{className:(0,V.cn)("divide-y","dark"===e?"divide-white/5":"divide-gray-100"),children:s?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:8,className:"px-4 py-3 text-center",children:(0,B.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,B.jsx)(J.RefreshCw,{className:"w-5 h-5 animate-spin text-purple-500"}),(0,B.jsx)("span",{className:"text-gray-500",children:"Cargando datos..."})]})})}):0===r.length?(0,B.jsx)("tr",{children:(0,B.jsx)("td",{colSpan:8,className:"px-4 py-6 text-center text-gray-500",children:"No se encontraron afiliaciones fallidas"})}):r.map(t=>{var r;let a;return(0,B.jsxs)("tr",{className:(0,V.cn)("transition-colors text-sm","dark"===e?"hover:bg-white/5 text-gray-300":"hover:bg-gray-50 text-gray-700"),children:[(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:mS(t.lastInteraction)}),(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap font-medium text-xs",children:t.nombre.toUpperCase()}),(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:t.cuil||"-"}),(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:t.telefono||"-"}),(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded-md text-xs font-medium",(r=t.leadStatus,(a=r?.toLowerCase()||"").includes("fallido")||a.includes("rechazada")||a.includes("caída")?"dark"===e?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800":a.includes("interesado")?"dark"===e?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800":a.includes("cortó")?"dark"===e?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800":"dark"===e?"bg-gray-500/20 text-gray-400":"bg-gray-100 text-gray-800")),children:t.leadStatus})}),(0,B.jsx)("td",{className:"px-4 py-3",children:t.motivo&&"-"!==t.motivo?(0,B.jsxs)("button",{onClick:()=>{x((e=>{if(!e||"-"===e)return"-";let t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)})(t.motivo)),f(!0)},className:(0,V.cn)("flex items-center gap-1 px-2 py-0.5 rounded-md text-xs font-medium transition-colors","dark"===e?"bg-purple-500/20 text-purple-300 hover:bg-purple-500/30":"bg-purple-100 text-purple-700 hover:bg-purple-200"),children:[(0,B.jsx)(em.Eye,{className:"w-3 h-3"}),"Ver"]}):(0,B.jsx)("span",{className:"text-gray-400 text-xs",children:"-"})}),(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-xs",children:t.assignedTo?.nombre||"-"}),(0,B.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,B.jsx)("span",{className:(0,V.cn)("px-2 py-0.5 rounded-md text-xs font-medium",((e,t)=>{let r=(e||"").toLowerCase();if(r.includes("nahuel")&&r.includes("sanchez")||r.includes("nahia")&&r.includes("avellaneda")||r.includes("santiago")&&r.includes("goldsztein")||r.includes("facundo")&&r.includes("tevez"))return"dark"===t?"bg-red-900 text-red-200":"bg-red-100 text-red-800";if(r.includes("abigail")&&r.includes("vera"))return"dark"===t?"bg-fuchsia-900 text-fuchsia-200":"bg-fuchsia-100 text-fuchsia-800";if(r.includes("mateo")&&r.includes("viera"))return"dark"===t?"bg-blue-900 text-blue-200":"bg-blue-100 text-blue-800";if(r.includes("belen")&&r.includes("salaverry"))return"dark"===t?"bg-purple-900 text-purple-200":"bg-purple-100 text-purple-800";if(r.includes("analia")&&r.includes("suarez"))return"dark"===t?"bg-pink-900 text-pink-200":"bg-pink-100 text-pink-800";if(r.includes("erika")&&r.includes("cardozo"))return"dark"===t?"bg-green-900 text-green-200":"bg-green-100 text-green-800";if(r.includes("aryel")&&r.includes("puiggros"))return"dark"===t?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800";if(r.includes("joaquin")&&r.includes("valdez")||r.includes("joquin")&&r.includes("vald ez"))return"dark"===t?"bg-violet-900 text-violet-200":"bg-violet-100 text-violet-800";if(r.includes("luciano")&&r.includes("carugno"))return"dark"===t?"bg-gray-700 text-gray-200":"bg-gray-200 text-gray-800";if(r.includes("alejandro")&&r.includes("mejail"))return"dark"===t?"bg-amber-900 text-amber-200":"bg-amber-100 text-amber-800";if(r.includes("gaston")&&r.includes("sarmiento"))return"dark"===t?"bg-orange-900 text-orange-200":"bg-orange-100 text-orange-800";let a=[{light:"bg-teal-100 text-teal-800",dark:"bg-teal-900 text-teal-200"},{light:"bg-cyan-100 text-cyan-800",dark:"bg-cyan-900 text-cyan-200"},{light:"bg-rose-100 text-rose-800",dark:"bg-rose-900 text-rose-200"},{light:"bg-emerald-100 text-emerald-800",dark:"bg-emerald-900 text-emerald-200"},{light:"bg-indigo-100 text-indigo-800",dark:"bg-indigo-900 text-indigo-200"}],s=e.length%a.length;return"dark"===t?a[s].dark:a[s].light})(t.supervisor||"",e)),children:t.supervisor||"-"})})]},t._id)})})]})})}),p&&(0,iZ.createPortal)((0,B.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 animate-in fade-in duration-200",onClick:()=>f(!1),children:(0,B.jsxs)("div",{onClick:e=>e.stopPropagation(),className:(0,V.cn)("animate-in zoom-in-95 fade-in duration-200","relative max-w-lg w-full rounded-2xl shadow-2xl border p-6","dark"===e?"bg-[#1a1333] border-white/10":"bg-white border-gray-200"),children:[(0,B.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,B.jsx)("h3",{className:(0,V.cn)("text-lg font-semibold","dark"===e?"text-white":"text-gray-800"),children:"Motivo del Estado"}),(0,B.jsx)("button",{onClick:()=>f(!1),className:(0,V.cn)("p-1 rounded-lg transition-colors","dark"===e?"hover:bg-white/10 text-gray-400 hover:text-white":"hover:bg-gray-100 text-gray-500 hover:text-gray-700"),children:(0,B.jsx)(ee.X,{className:"w-5 h-5"})})]}),(0,B.jsx)("div",{className:(0,V.cn)("p-4 rounded-lg","dark"===e?"bg-white/5":"bg-gray-50"),children:(0,B.jsx)("p",{className:(0,V.cn)("text-sm whitespace-pre-wrap","dark"===e?"text-gray-300":"text-gray-700"),children:g})})]})}),document.body)]})}var mC=e.i(59173),mA=e.i(20095);let mR={"reportes-globales":"Reportes de Mensajería","mensajeria-masiva":"Mensajería Masiva","base-afiliados":"Base de Afiliados","base-afiliados-estadistica":"Estadística","base-afiliados-exitosas":"Afiliaciones exitosas","base-afiliados-exportaciones":"Exportaciones","base-afiliados-configuracion":"Configuración de envíos","base-afiliados-lista":"Lista de afiliados","base-afiliados-cargar":"Cargar archivo","base-afiliados-frescos":"Datos frescos","base-afiliados-reutilizables":"Datos reutilizables","base-afiliados-fallidas":"Afiliaciones fallidas","contactar-afiliados":"Contactar Afiliados","contactar-afiliados-administracion":"Administración de datos","contactar-afiliados-datos-dia":"Datos del día","palabras-prohibidas":"Palabras Prohibidas","palabras-prohibidas-lista":"Lista de palabras","palabras-prohibidas-detecciones":"Detecciones","palabras-prohibidas-agregar":"Agregar palabra",auditorias:"Auditorías","auditorias-seguimiento":"Seguimiento","auditorias-crear-turno":"Crear turno","auditorias-recuperaciones":"Recuperaciones","auditorias-liquidacion":"Liquidación","recursos-humanos":"Recursos Humanos","rrhh-estadisticas":"Estadísticas de Empleados","rrhh-activos":"Personal Activo","rrhh-inactivos":"Personal Inactivo","rrhh-agregar":"Añadir Empleado","gestion-usuarios":"Gestión de Usuarios"};function mO({activeSection:e,onSectionChange:t}){let{theme:r}=(0,z.useTheme)(),{user:a}=(0,iT.useAuth)(),s=e||"",n="reportes-globales"===s||s.startsWith("base-afiliados")||s.startsWith("palabras-prohibidas")||s.startsWith("auditorias")||s.startsWith("rrhh")||"gestion-usuarios"===s||s.startsWith("mensajeria"),i="mensajeria-masiva"===s,[o,l]=(0,U.useState)(!1),c=(0,iy.useSocket)(),[d,h]=(0,U.useState)(0);(0,U.useEffect)(()=>{u()},[]),(0,U.useEffect)(()=>(c&&c.on("new_message",()=>{u()}),()=>{c&&c.off("new_message")}),[c]);let u=async()=>{try{let e=await er.api.internalMessages.getUnreadCount();h(e.data.unreadCount)}catch(e){console.error("Error loading unread count",e)}};return(0,B.jsxs)("main",{className:"flex-1 p-4 pt-20 lg:pt-8 lg:p-8 overflow-auto w-full",children:[(0,B.jsxs)("div",{className:"mb-6 lg:mb-8",children:[(0,B.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,B.jsx)("div",{className:(0,V.cn)("w-8 h-8 lg:w-10 lg:h-10 rounded-lg flex items-center justify-center","dark"===r?"bg-gradient-to-br from-purple-500/20 to-blue-500/20":"bg-gradient-to-br from-[#00C794]/20 to-[#0078A0]/20"),children:(0,B.jsx)("span",{className:"text-xl lg:text-2xl",children:"😄"})}),(0,B.jsx)("h1",{className:(0,V.cn)("text-2xl lg:text-3xl font-bold","dark"===r?"text-white":"text-gray-700"),children:"Somos equipo, somos solución"})]}),(0,B.jsxs)("p",{className:(0,V.cn)("text-sm lg:text-base","dark"===r?"text-gray-400":"text-gray-600"),children:["Bienvenido,"," ",(0,B.jsx)("span",{className:(0,V.cn)("font-medium","dark"===r?"text-purple-400":"text-[#00C794]"),children:a?.nombre||"Usuario"}),". Selecciona una opción en el menú lateral."]})]}),(0,B.jsxs)("div",{className:(0,V.cn)("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6 mb-6 lg:mb-8 transition-all duration-500 ease-out overflow-hidden",n?"max-h-0 opacity-0 mb-0 pointer-events-none":"max-h-[500px] opacity-100"),children:[(0,B.jsx)(W,{title:"Mensajes enviados hoy",value:165,icon:G.Send,color:"primary",delay:1}),(0,B.jsx)(W,{title:"Usuarios activos",value:13,icon:q.Users,color:"secondary",delay:2}),(0,B.jsx)(W,{title:"Contactos cargados",value:383,icon:X,color:"accent",delay:3})]}),"reportes-globales"===e?(0,B.jsx)(eo,{}):i?(0,B.jsx)(iA,{}):"base-afiliados-estadistica"===e?(0,B.jsx)(iB,{}):"base-afiliados-exitosas"===e?(0,B.jsx)(ub,{}):"base-afiliados-exportaciones"===e?(0,B.jsx)(iz,{}):"base-afiliados-configuracion"===e?(0,B.jsx)(iX,{}):"base-afiliados-lista"===e?(0,B.jsx)(iQ,{}):"base-afiliados-cargar"===e?(0,B.jsx)(iJ,{}):"base-afiliados-frescos"===e?(0,B.jsx)(mv,{}):"base-afiliados-reutilizables"===e?(0,B.jsx)(mw,{}):"base-afiliados-fallidas"===e?(0,B.jsx)(mT,{}):"contactar-afiliados"===e?(0,B.jsx)(mE,{}):"contactar-afiliados-administracion"===e?(0,B.jsx)(mC.ContactarAdministracion,{}):"contactar-afiliados-datos-dia"===e?(0,B.jsx)(mA.ContactarDatosDia,{}):"palabras-prohibidas-lista"===e?(0,B.jsx)(uE,{}):"palabras-prohibidas-detecciones"===e?(0,B.jsx)(uC,{}):"palabras-prohibidas-agregar"===e?(0,B.jsx)(u_,{}):"auditorias-seguimiento"===e?(0,B.jsx)(uW,{}):"auditorias-crear-turno"===e?(0,B.jsx)(uY,{}):"auditorias-recuperaciones"===e?(0,B.jsx)(uZ,{}):"auditorias-liquidacion"===e?(0,B.jsx)(u5,{}):"rrhh-estadisticas"===e?(0,B.jsx)(mt,{}):"rrhh-activos"===e?(0,B.jsx)(ms,{}):"rrhh-inactivos"===e?(0,B.jsx)(mo,{}):"rrhh-agregar"===e?(0,B.jsx)(mu,{}):"gestion-usuarios"===e?(0,B.jsx)(my,{}):s.startsWith("base-afiliados")?(0,B.jsx)("div",{className:"animate-fade-in-up",children:(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===r?"bg-gradient-to-br from-white/5 to-white/[0.02] border-white/10":"bg-gradient-to-br from-[#F5F0E8] to-white border-[#00C794]/20 shadow-lg shadow-[#00C794]/10"),children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold mb-4 flex items-center gap-2","dark"===r?"text-white":"text-gray-700"),children:[(0,B.jsx)("span",{className:(0,V.cn)("w-2 h-2 rounded-full animate-pulse","dark"===r?"bg-purple-500":"bg-[#00C794]")}),mR[e]||"Base de Afiliados"]}),(0,B.jsxs)("p",{className:(0,V.cn)("text-xs lg:text-sm leading-relaxed","dark"===r?"text-gray-400":"text-gray-600"),children:["Estás viendo la sección de"," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===r?"text-purple-400":"text-[#00C794]"),children:mR[e]}),". Próximamente disponible."]})]})}):(0,B.jsx)("div",{className:"animate-fade-in-up",children:(0,B.jsxs)("div",{className:(0,V.cn)("rounded-2xl border p-4 lg:p-6 backdrop-blur-sm","dark"===r?"bg-gradient-to-br from-white/5 to-transparent border border-white/5 hover:border-purple-500/30 hover:shadow-purple-500/10":"bg-gradient-to-br from-[#F5F0E8] to-white border border-[#00C794]/20 hover:border-[#00C794]/50 hover:shadow-[#00C794]/20"),children:[(0,B.jsxs)("h2",{className:(0,V.cn)("text-lg lg:text-xl font-semibold mb-4 flex items-center gap-2","dark"===r?"text-white":"text-gray-700"),children:[(0,B.jsx)("span",{className:(0,V.cn)("w-2 h-2 rounded-full animate-pulse","dark"===r?"bg-purple-500":"bg-[#00C794]")}),mR[e]||"Somos equipo, somos solución"]}),(0,B.jsxs)("p",{className:(0,V.cn)("text-sm lg:text-base","dark"===r?"text-gray-400":"text-gray-600"),children:["Estás viendo la sección de"," ",(0,B.jsx)("span",{className:(0,V.cn)("dark"===r?"text-purple-400":"text-[#00C794]"),children:mR[e]}),". Aquí podrás gestionar todas las funcionalidades relacionadas con esta área."]}),(0,B.jsx)("div",{className:"mt-4 lg:mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3 lg:gap-4",children:[1,2,3,4].map(e=>(0,B.jsx)("div",{className:(0,V.cn)("h-24 lg:h-32 rounded-xl flex items-center justify-center group transition-all duration-300 hover:shadow-lg","dark"===r?"bg-gradient-to-br from-white/5 to-transparent border border-white/5 hover:border-purple-500/30 hover:shadow-purple-500/10":"bg-gradient-to-br from-[#F5F0E8] to-white border border-[#00C794]/20 hover:border-[#00C794]/50 hover:shadow-[#00C794]/20"),children:(0,B.jsxs)("span",{className:(0,V.cn)("text-sm transition-colors","dark"===r?"text-gray-600 group-hover:text-gray-400":"text-gray-400 group-hover:text-[#00C794]"),children:["Contenido ",e]})},e))})]})}),(0,B.jsxs)("button",{onClick:()=>l(!0),className:(0,V.cn)("fixed bottom-6 right-6 lg:bottom-10 lg:right-10 w-12 h-12 lg:w-14 lg:h-14 rounded-full text-white shadow-lg flex items-center justify-center hover:scale-110 transition-transform duration-300 animate-float z-[100]","dark"===r?"bg-gradient-to-br from-purple-600 to-blue-600 shadow-purple-500/30":"bg-gradient-to-br from-[#00C794] to-[#0078A0] shadow-[#00C794]/30"),children:[(0,B.jsx)(K.Mail,{className:"w-5 h-5 lg:w-6 lg:h-6"}),d>0&&(0,B.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-sm ring-2 ring-white dark:ring-gray-900 animate-bounce",children:d>99?"99+":d})]}),(0,B.jsx)(iI,{isOpen:o,onClose:()=>{l(!1),u()}})]})}e.s(["DashboardContent",()=>mO],55387)}]);